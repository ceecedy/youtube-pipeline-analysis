[0m03:09:05.583482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90285430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90b70ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90b72f00>]}


============================== 03:09:05.584516 | 7dd3fe98-a7aa-473b-9203-fea8b8856492 ==============================
[0m03:09:05.584516 [info ] [MainThread]: Running with dbt=1.8.9
[0m03:09:05.584923 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'quiet': 'False', 'debug': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --models youtube_data.marts.dim_categories', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'empty': 'False', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'printer_width': '80', 'profiles_dir': '/usr/local/airflow/include/dbt', 'log_path': '/usr/local/airflow/include/dbt/logs', 'use_colors': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'warn_error': 'None'}
[0m03:09:06.334188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7dd3fe98-a7aa-473b-9203-fea8b8856492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73bf61e0>]}
[0m03:09:06.374848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7dd3fe98-a7aa-473b-9203-fea8b8856492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9021ed80>]}
[0m03:09:06.375366 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m03:09:06.431787 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 2 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m03:09:06.432750 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.87171084, "process_in_blocks": "0", "process_kernel_time": 0.262096, "process_mem_max_rss": "209244", "process_out_blocks": "4", "process_user_time": 1.90698}
[0m03:09:06.433154 [debug] [MainThread]: Command `dbt run` failed at 03:09:06.433084 after 0.87 seconds
[0m03:09:06.433424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90309040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90309880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff739ef740>]}
[0m03:09:06.433684 [debug] [MainThread]: Flushing usage events
[0m03:09:17.633105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7be8ec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d930a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e6d56a0>]}


============================== 03:09:17.634294 | 49e718dc-eef8-49e9-aeb7-5337148617f0 ==============================
[0m03:09:17.634294 [info ] [MainThread]: Running with dbt=1.8.9
[0m03:09:17.634682 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'empty': 'None', 'fail_fast': 'False', 'partial_parse': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/usr/local/airflow/include/dbt/logs', 'quiet': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'use_experimental_parser': 'False', 'no_print': 'None', 'static_parser': 'True', 'printer_width': '80', 'version_check': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'invocation_command': 'dbt deps', 'target_path': 'None', 'write_json': 'True', 'indirect_selection': 'eager'}
[0m03:09:17.683724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49e718dc-eef8-49e9-aeb7-5337148617f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d1ae4b0>]}
[0m03:09:17.696937 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-szdcxhx8'
[0m03:09:17.697231 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m03:09:17.824166 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m03:09:17.825156 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m03:09:17.887955 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m03:09:17.893686 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m03:09:17.925125 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m03:09:17.928224 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m03:09:17.960130 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m03:09:17.962673 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m03:09:18.596810 [info ] [MainThread]: Installed from version 1.3.0
[0m03:09:18.597199 [info ] [MainThread]: Up to date!
[0m03:09:18.597651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '49e718dc-eef8-49e9-aeb7-5337148617f0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bd5e330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b77e4b0>]}
[0m03:09:18.597948 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m03:09:20.956358 [info ] [MainThread]: Installed from version 0.10.4
[0m03:09:20.956716 [info ] [MainThread]: Up to date!
[0m03:09:20.957101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '49e718dc-eef8-49e9-aeb7-5337148617f0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b8b3110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b8b0980>]}
[0m03:09:20.957391 [info ] [MainThread]: Installing calogica/dbt_date
[0m03:09:21.429827 [info ] [MainThread]: Installed from version 0.10.1
[0m03:09:21.430423 [info ] [MainThread]: Up to date!
[0m03:09:21.431115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '49e718dc-eef8-49e9-aeb7-5337148617f0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b7eabd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b7eae70>]}
[0m03:09:21.433157 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 3.8224654, "process_in_blocks": "184", "process_kernel_time": 0.199596, "process_mem_max_rss": "102636", "process_out_blocks": "20354", "process_user_time": 0.984675}
[0m03:09:21.433653 [debug] [MainThread]: Command `dbt deps` succeeded at 03:09:21.433572 after 3.82 seconds
[0m03:09:21.434055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fbaa2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b9244a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b765fd0>]}
[0m03:09:21.434359 [debug] [MainThread]: Flushing usage events
[0m03:09:28.755287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f0a9970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f2e5820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fbe5e20>]}


============================== 03:09:28.756325 | c3459c37-002f-4e0b-adbd-812a4f773ec0 ==============================
[0m03:09:28.756325 [info ] [MainThread]: Running with dbt=1.8.9
[0m03:09:28.756727 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --models youtube_data.marts.dim_categories', 'debug': 'False', 'write_json': 'True', 'partial_parse': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'warn_error': 'None', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'introspect': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'printer_width': '80'}
[0m03:09:29.367993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3459c37-002f-4e0b-adbd-812a4f773ec0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff826078f0>]}
[0m03:09:29.393704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3459c37-002f-4e0b-adbd-812a4f773ec0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83778290>]}
[0m03:09:29.394115 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m03:09:29.459924 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m03:09:29.460784 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m03:09:29.461069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c3459c37-002f-4e0b-adbd-812a4f773ec0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff826758b0>]}
[0m03:09:30.677406 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 15 unused configuration paths:
- models.youtube_data.staging
- models.youtube_data.marts.fact_video_metrics
- models.youtube_data.staging.staging_video
- models.youtube_data.marts.fact_video_comments
- models.youtube_data.staging.staging_region
- models.youtube_data.marts.dim_categories
- models.youtube_data.staging.staging_channel
- models.youtube_data.staging.staging_video_metrics
- models.youtube_data.marts.dim_regions
- models.youtube_data.target
- models.youtube_data.marts.dim_videos
- models.youtube_data.staging.staging_category
- models.youtube_data.staging.staging_video_comments
- models.youtube_data.marts.dim_channels
- models.youtube_data.marts
[0m03:09:30.684675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3459c37-002f-4e0b-adbd-812a4f773ec0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff824c3470>]}
[0m03:09:30.771215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3459c37-002f-4e0b-adbd-812a4f773ec0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff815b0b00>]}
[0m03:09:30.771616 [info ] [MainThread]: Found 12 models, 137 data tests, 2 sources, 867 macros
[0m03:09:30.771924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3459c37-002f-4e0b-adbd-812a4f773ec0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81576ff0>]}
[0m03:09:30.773835 [info ] [MainThread]: 
[0m03:09:30.774251 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m03:09:30.774902 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project'
[0m03:09:30.775176 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:09:31.700521 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project, now list_yt-e2e-data-cycle-project_youtube)
[0m03:09:31.701605 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:09:32.821413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3459c37-002f-4e0b-adbd-812a4f773ec0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82391c10>]}
[0m03:09:32.822843 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:09:32.823751 [info ] [MainThread]: 
[0m03:09:32.828573 [debug] [Thread-1 (]: Began running node model.youtube_data.dim_categories
[0m03:09:32.829649 [info ] [Thread-1 (]: 1 of 1 START sql view model youtube.dim_categories ............................. [RUN]
[0m03:09:32.830707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now model.youtube_data.dim_categories)
[0m03:09:32.831464 [debug] [Thread-1 (]: Began compiling node model.youtube_data.dim_categories
[0m03:09:32.844021 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_data.dim_categories"
[0m03:09:32.848433 [debug] [Thread-1 (]: Began executing node model.youtube_data.dim_categories
[0m03:09:32.883433 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_data.dim_categories"
[0m03:09:32.885690 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:09:32.887123 [debug] [Thread-1 (]: On model.youtube_data.dim_categories: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "model.youtube_data.dim_categories"} */


  create or replace view `yt-e2e-data-cycle-project`.`youtube`.`dim_categories`
  OPTIONS()
  as WITH category_data AS (
    SELECT * 
    FROM `yt-e2e-data-cycle-project`.`youtube`.`staging_category`
),

category_lookup AS (
    SELECT * 
    FROM UNNEST([
        STRUCT(1 AS category_id, 'Film & Animation' AS category_name, 'Videos related to film and animation.' AS category_description),
        STRUCT(2 AS category_id, 'Autos & Vehicles' AS category_name, 'Videos related to cars, trucks, motorcycles, and vehicles.' AS category_description),
        STRUCT(10 AS category_id, 'Music' AS category_name, 'Videos related to music, music videos, and performances.' AS category_description),
        STRUCT(15 AS category_id, 'Pets & Animals' AS category_name, 'Videos related to pets, animals, and wildlife.' AS category_description),
        STRUCT(17 AS category_id, 'Sports' AS category_name, 'Videos related to sports events, commentary, and athletics.' AS category_description),
        STRUCT(18 AS category_id, 'Short Movies' AS category_name, 'Short films and independent films.' AS category_description),
        STRUCT(19 AS category_id, 'Travel & Events' AS category_name, 'Videos related to travel and live events.' AS category_description),
        STRUCT(20 AS category_id, 'Gaming' AS category_name, 'Videos related to video games, game commentary, and more.' AS category_description),
        STRUCT(22 AS category_id, 'People & Blogs' AS category_name, 'Personal vlogs and commentary.' AS category_description),
        STRUCT(23 AS category_id, 'Comedy' AS category_name, 'Videos related to comedic content.' AS category_description),
        STRUCT(24 AS category_id, 'Entertainment' AS category_name, 'Content related to entertainment and celebrity culture.' AS category_description),
        STRUCT(25 AS category_id, 'News & Politics' AS category_name, 'News and political commentary or events.' AS category_description),
        STRUCT(26 AS category_id, 'Howto & Style' AS category_name, 'How-to videos and style-related content.' AS category_description),
        STRUCT(27 AS category_id, 'Education' AS category_name, 'Educational content for various fields and topics.' AS category_description),
        STRUCT(28 AS category_id, 'Science & Technology' AS category_name, 'Videos related to science, tech, and innovations.' AS category_description),
        STRUCT(29 AS category_id, 'Nonprofits & Activism' AS category_name, 'Content related to nonprofits, activism, and charitable causes.' AS category_description),
        STRUCT(30 AS category_id, 'Movies' AS category_name, 'Full-length movies, movie trailers, and related content.' AS category_description),
        STRUCT(31 AS category_id, 'Anime & Animation' AS category_name, 'Anime series, animation, and related content.' AS category_description),
        STRUCT(32 AS category_id, 'Action & Adventure' AS category_name, 'Videos related to action and adventure content.' AS category_description),
        STRUCT(33 AS category_id, 'Classics' AS category_name, 'Classic movies, TV shows, and content.' AS category_description),
        STRUCT(34 AS category_id, 'Documentaries' AS category_name, 'Documentaries and docuseries content.' AS category_description),
        STRUCT(35 AS category_id, 'Drama' AS category_name, 'Dramas, TV shows, and related content.' AS category_description),
        STRUCT(36 AS category_id, 'Family & Parenting' AS category_name, 'Videos related to family life and parenting.' AS category_description),
        STRUCT(37 AS category_id, 'Home & Garden' AS category_name, 'Content about home improvement, gardens, and DIY projects.' AS category_description),
        STRUCT(38 AS category_id, 'Lifestyle' AS category_name, 'Videos about lifestyle, health, wellness, and more.' AS category_description),
        STRUCT(39 AS category_id, 'Music Videos' AS category_name, 'Music video content, including live and pre-recorded.' AS category_description),
        STRUCT(40 AS category_id, 'Reality TV' AS category_name, 'Reality TV shows and unscripted content.' AS category_description)
    ]) AS category_lookup
)

SELECT 
    ROW_NUMBER() OVER (ORDER BY c.category_id) as pk_category_id,  
    c.category_id AS category_id,
    COALESCE(c.category_name, l.category_name) AS category_name,
    COALESCE(c.category_description, l.category_description) AS category_description
FROM category_data c
LEFT JOIN category_lookup l 
    ON c.category_id = l.category_id;


[0m03:09:34.153189 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:9bd9f137-25c5-4956-92ad-dae4a4280d06&page=queryresults
[0m03:09:34.992137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3459c37-002f-4e0b-adbd-812a4f773ec0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83306a20>]}
[0m03:09:34.993915 [info ] [Thread-1 (]: 1 of 1 OK created sql view model youtube.dim_categories ........................ [[32mCREATE VIEW (0 processed)[0m in 2.16s]
[0m03:09:34.995381 [debug] [Thread-1 (]: Finished running node model.youtube_data.dim_categories
[0m03:09:34.998844 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:09:34.999170 [debug] [MainThread]: Connection 'model.youtube_data.dim_categories' was properly closed.
[0m03:09:34.999548 [info ] [MainThread]: 
[0m03:09:34.999966 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.23 seconds (4.23s).
[0m03:09:35.001088 [debug] [MainThread]: Command end result
[0m03:09:35.190615 [info ] [MainThread]: 
[0m03:09:35.191142 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:09:35.191554 [info ] [MainThread]: 
[0m03:09:35.191864 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:09:35.193089 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.4609194, "process_in_blocks": "0", "process_kernel_time": 0.251257, "process_mem_max_rss": "226228", "process_out_blocks": "8087", "process_user_time": 3.52565}
[0m03:09:35.193552 [debug] [MainThread]: Command `dbt run` succeeded at 03:09:35.193475 after 6.46 seconds
[0m03:09:35.193822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff815afcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81577740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f088290>]}
[0m03:09:35.194062 [debug] [MainThread]: Flushing usage events
[0m03:10:04.640670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c423590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c4224e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d2a5cd0>]}


============================== 03:10:04.641939 | f274e21b-a33b-4f26-b9ae-52a1d89b22de ==============================
[0m03:10:04.641939 [info ] [MainThread]: Running with dbt=1.8.9
[0m03:10:04.642391 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'profiles_dir': '/usr/local/airflow/include/dbt', 'empty': 'None', 'printer_width': '80', 'log_format': 'default', 'log_path': '/usr/local/airflow/include/dbt/logs', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'warn_error': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'write_json': 'True', 'invocation_command': 'dbt clean', 'cache_selected_only': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'debug': 'False', 'fail_fast': 'False', 'target_path': 'None'}
[0m03:10:04.695984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f274e21b-a33b-4f26-b9ae-52a1d89b22de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c316a80>]}
[0m03:10:04.701445 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
        The default package install path has changed from `dbt_modules` to
`dbt_packages`.         Please update `clean-targets` in `dbt_project.yml` and
check `.gitignore` as well.         Or, set `packages-install-path: dbt_modules`
if you'd like to keep the current value.
[0m03:10:04.701763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f274e21b-a33b-4f26-b9ae-52a1d89b22de', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c1b3800>]}
[0m03:10:04.707633 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.09099008, "process_in_blocks": "0", "process_kernel_time": 0.119013, "process_mem_max_rss": "95200", "process_out_blocks": "4", "process_user_time": 0.738081}
[0m03:10:04.708133 [debug] [MainThread]: Command `dbt clean` succeeded at 03:10:04.708052 after 0.09 seconds
[0m03:10:04.708405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c3d7ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cd608c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c161f10>]}
[0m03:10:04.708748 [debug] [MainThread]: Flushing usage events
[0m03:10:10.394639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93429760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95fc5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93429580>]}


============================== 03:10:10.395735 | 4094bb22-3977-4391-8434-a6e7a37b4782 ==============================
[0m03:10:10.395735 [info ] [MainThread]: Running with dbt=1.8.9
[0m03:10:10.396149 [debug] [MainThread]: running dbt with arguments {'log_path': '/usr/local/airflow/include/dbt/logs', 'empty': 'None', 'version_check': 'True', 'introspect': 'True', 'printer_width': '80', 'profiles_dir': '/usr/local/airflow/include/dbt', 'partial_parse': 'True', 'static_parser': 'True', 'quiet': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'debug': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'target_path': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'invocation_command': 'dbt deps', 'warn_error': 'None', 'write_json': 'True'}
[0m03:10:10.446812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4094bb22-3977-4391-8434-a6e7a37b4782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9486f4d0>]}
[0m03:10:10.547781 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-fwuki9ag'
[0m03:10:10.548224 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m03:10:10.587662 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m03:10:10.589166 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m03:10:10.651479 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m03:10:10.654845 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m03:10:10.687028 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m03:10:10.690009 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m03:10:10.722438 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m03:10:10.725205 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m03:10:11.313170 [info ] [MainThread]: Installed from version 1.3.0
[0m03:10:11.313537 [info ] [MainThread]: Up to date!
[0m03:10:11.314166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4094bb22-3977-4391-8434-a6e7a37b4782', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff944005c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94401160>]}
[0m03:10:11.314523 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m03:10:12.528508 [info ] [MainThread]: Installed from version 0.10.4
[0m03:10:12.528981 [info ] [MainThread]: Up to date!
[0m03:10:12.529436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4094bb22-3977-4391-8434-a6e7a37b4782', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff944005c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94401190>]}
[0m03:10:12.529723 [info ] [MainThread]: Installing calogica/dbt_date
[0m03:10:12.976651 [info ] [MainThread]: Installed from version 0.10.1
[0m03:10:12.977150 [info ] [MainThread]: Up to date!
[0m03:10:12.977651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4094bb22-3977-4391-8434-a6e7a37b4782', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9333e600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9333dac0>]}
[0m03:10:12.979483 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.607747, "process_in_blocks": "0", "process_kernel_time": 0.19297, "process_mem_max_rss": "102560", "process_out_blocks": "20354", "process_user_time": 0.953621}
[0m03:10:12.980095 [debug] [MainThread]: Command `dbt deps` succeeded at 03:10:12.979939 after 2.61 seconds
[0m03:10:12.980531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff978c7020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95fc5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff933a7b60>]}
[0m03:10:12.980840 [debug] [MainThread]: Flushing usage events
[0m03:10:41.694705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafea9700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaffa3f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb00fe480>]}


============================== 03:10:41.695986 | 2990a3ad-6f47-4e67-aa07-e2029594c166 ==============================
[0m03:10:41.695986 [info ] [MainThread]: Running with dbt=1.8.9
[0m03:10:41.696365 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models youtube_data.marts.dim_categories', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'version_check': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'empty': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'introspect': 'True', 'warn_error': 'None', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'write_json': 'True', 'static_parser': 'True', 'use_colors': 'True', 'fail_fast': 'False'}
[0m03:10:42.307549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2990a3ad-6f47-4e67-aa07-e2029594c166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93d45100>]}
[0m03:10:42.332526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2990a3ad-6f47-4e67-aa07-e2029594c166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95b96540>]}
[0m03:10:42.332991 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m03:10:42.396259 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m03:10:42.397098 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m03:10:42.397380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2990a3ad-6f47-4e67-aa07-e2029594c166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93823620>]}
[0m03:10:43.581432 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 12 unused configuration paths:
- models.youtube_project.staging.staging_video_metrics
- models.youtube_project.staging.staging_region
- models.youtube_project.marts.dim_categories
- models.youtube_project.staging.staging_category
- models.youtube_project.marts.fact_video_metrics
- models.youtube_project.marts.fact_video_comments
- models.youtube_project.marts.dim_channels
- models.youtube_project.staging.staging_channel
- models.youtube_project.marts.dim_regions
- models.youtube_project.staging.staging_video
- models.youtube_project.staging.staging_video_comments
- models.youtube_project.marts.dim_videos
[0m03:10:43.589354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2990a3ad-6f47-4e67-aa07-e2029594c166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92757080>]}
[0m03:10:43.714689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2990a3ad-6f47-4e67-aa07-e2029594c166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff923b82c0>]}
[0m03:10:43.715118 [info ] [MainThread]: Found 12 models, 137 data tests, 2 sources, 867 macros
[0m03:10:43.715407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2990a3ad-6f47-4e67-aa07-e2029594c166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91f3dee0>]}
[0m03:10:43.717417 [info ] [MainThread]: 
[0m03:10:43.718001 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m03:10:43.718791 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project'
[0m03:10:43.719085 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:10:44.508708 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project, now list_yt-e2e-data-cycle-project_youtube)
[0m03:10:44.509734 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:10:45.425534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2990a3ad-6f47-4e67-aa07-e2029594c166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff930b1d60>]}
[0m03:10:45.427126 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:10:45.427918 [info ] [MainThread]: 
[0m03:10:45.432684 [debug] [Thread-1 (]: Began running node model.youtube_project.dim_categories
[0m03:10:45.433742 [info ] [Thread-1 (]: 1 of 1 START sql view model youtube.dim_categories ............................. [RUN]
[0m03:10:45.434928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now model.youtube_project.dim_categories)
[0m03:10:45.435715 [debug] [Thread-1 (]: Began compiling node model.youtube_project.dim_categories
[0m03:10:45.448957 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_project.dim_categories"
[0m03:10:45.452646 [debug] [Thread-1 (]: Began executing node model.youtube_project.dim_categories
[0m03:10:45.481068 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_project.dim_categories"
[0m03:10:45.483481 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:10:45.485005 [debug] [Thread-1 (]: On model.youtube_project.dim_categories: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "model.youtube_project.dim_categories"} */


  create or replace view `yt-e2e-data-cycle-project`.`youtube`.`dim_categories`
  OPTIONS()
  as WITH category_data AS (
    SELECT * 
    FROM `yt-e2e-data-cycle-project`.`youtube`.`staging_category`
),

category_lookup AS (
    SELECT * 
    FROM UNNEST([
        STRUCT(1 AS category_id, 'Film & Animation' AS category_name, 'Videos related to film and animation.' AS category_description),
        STRUCT(2 AS category_id, 'Autos & Vehicles' AS category_name, 'Videos related to cars, trucks, motorcycles, and vehicles.' AS category_description),
        STRUCT(10 AS category_id, 'Music' AS category_name, 'Videos related to music, music videos, and performances.' AS category_description),
        STRUCT(15 AS category_id, 'Pets & Animals' AS category_name, 'Videos related to pets, animals, and wildlife.' AS category_description),
        STRUCT(17 AS category_id, 'Sports' AS category_name, 'Videos related to sports events, commentary, and athletics.' AS category_description),
        STRUCT(18 AS category_id, 'Short Movies' AS category_name, 'Short films and independent films.' AS category_description),
        STRUCT(19 AS category_id, 'Travel & Events' AS category_name, 'Videos related to travel and live events.' AS category_description),
        STRUCT(20 AS category_id, 'Gaming' AS category_name, 'Videos related to video games, game commentary, and more.' AS category_description),
        STRUCT(22 AS category_id, 'People & Blogs' AS category_name, 'Personal vlogs and commentary.' AS category_description),
        STRUCT(23 AS category_id, 'Comedy' AS category_name, 'Videos related to comedic content.' AS category_description),
        STRUCT(24 AS category_id, 'Entertainment' AS category_name, 'Content related to entertainment and celebrity culture.' AS category_description),
        STRUCT(25 AS category_id, 'News & Politics' AS category_name, 'News and political commentary or events.' AS category_description),
        STRUCT(26 AS category_id, 'Howto & Style' AS category_name, 'How-to videos and style-related content.' AS category_description),
        STRUCT(27 AS category_id, 'Education' AS category_name, 'Educational content for various fields and topics.' AS category_description),
        STRUCT(28 AS category_id, 'Science & Technology' AS category_name, 'Videos related to science, tech, and innovations.' AS category_description),
        STRUCT(29 AS category_id, 'Nonprofits & Activism' AS category_name, 'Content related to nonprofits, activism, and charitable causes.' AS category_description),
        STRUCT(30 AS category_id, 'Movies' AS category_name, 'Full-length movies, movie trailers, and related content.' AS category_description),
        STRUCT(31 AS category_id, 'Anime & Animation' AS category_name, 'Anime series, animation, and related content.' AS category_description),
        STRUCT(32 AS category_id, 'Action & Adventure' AS category_name, 'Videos related to action and adventure content.' AS category_description),
        STRUCT(33 AS category_id, 'Classics' AS category_name, 'Classic movies, TV shows, and content.' AS category_description),
        STRUCT(34 AS category_id, 'Documentaries' AS category_name, 'Documentaries and docuseries content.' AS category_description),
        STRUCT(35 AS category_id, 'Drama' AS category_name, 'Dramas, TV shows, and related content.' AS category_description),
        STRUCT(36 AS category_id, 'Family & Parenting' AS category_name, 'Videos related to family life and parenting.' AS category_description),
        STRUCT(37 AS category_id, 'Home & Garden' AS category_name, 'Content about home improvement, gardens, and DIY projects.' AS category_description),
        STRUCT(38 AS category_id, 'Lifestyle' AS category_name, 'Videos about lifestyle, health, wellness, and more.' AS category_description),
        STRUCT(39 AS category_id, 'Music Videos' AS category_name, 'Music video content, including live and pre-recorded.' AS category_description),
        STRUCT(40 AS category_id, 'Reality TV' AS category_name, 'Reality TV shows and unscripted content.' AS category_description)
    ]) AS category_lookup
)

SELECT 
    ROW_NUMBER() OVER (ORDER BY c.category_id) as pk_category_id,  
    c.category_id AS category_id,
    COALESCE(c.category_name, l.category_name) AS category_name,
    COALESCE(c.category_description, l.category_description) AS category_description
FROM category_data c
LEFT JOIN category_lookup l 
    ON c.category_id = l.category_id;


[0m03:10:46.752037 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:433aa310-edee-46c0-bc33-cc4dd0f1aad7&page=queryresults
[0m03:10:47.598881 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2990a3ad-6f47-4e67-aa07-e2029594c166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9411cbc0>]}
[0m03:10:47.599903 [info ] [Thread-1 (]: 1 of 1 OK created sql view model youtube.dim_categories ........................ [[32mCREATE VIEW (0 processed)[0m in 2.16s]
[0m03:10:47.601046 [debug] [Thread-1 (]: Finished running node model.youtube_project.dim_categories
[0m03:10:47.603115 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:10:47.603612 [debug] [MainThread]: Connection 'model.youtube_project.dim_categories' was properly closed.
[0m03:10:47.604099 [info ] [MainThread]: 
[0m03:10:47.604656 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.89 seconds (3.89s).
[0m03:10:47.605812 [debug] [MainThread]: Command end result
[0m03:10:47.729788 [info ] [MainThread]: 
[0m03:10:47.730367 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:10:47.730828 [info ] [MainThread]: 
[0m03:10:47.731337 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:10:47.732239 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.061067, "process_in_blocks": "0", "process_kernel_time": 0.276229, "process_mem_max_rss": "225748", "process_out_blocks": "8113", "process_user_time": 3.483504}
[0m03:10:47.732638 [debug] [MainThread]: Command `dbt run` succeeded at 03:10:47.732554 after 6.06 seconds
[0m03:10:47.732917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb01a3470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff923dd370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff923dd880>]}
[0m03:10:47.733186 [debug] [MainThread]: Flushing usage events
[0m03:13:05.658598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9d30aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa828ff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa828d1f0>]}


============================== 03:13:05.659953 | 162a5449-7f05-41c3-b557-4ff1866d1846 ==============================
[0m03:13:05.659953 [info ] [MainThread]: Running with dbt=1.8.9
[0m03:13:05.660443 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error': 'None', 'log_format': 'default', 'use_colors': 'True', 'empty': 'False', 'invocation_command': 'dbt run --models youtube_data.marts.dim_categories', 'partial_parse': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'quiet': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'debug': 'False', 'cache_selected_only': 'False'}
[0m03:13:06.279975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '162a5449-7f05-41c3-b557-4ff1866d1846', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b65a690>]}
[0m03:13:06.304605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '162a5449-7f05-41c3-b557-4ff1866d1846', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8ea30e0>]}
[0m03:13:06.305007 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m03:13:06.380254 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m03:13:06.452737 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m03:13:06.453157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '162a5449-7f05-41c3-b557-4ff1866d1846', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8afa0260>]}
[0m03:13:07.591152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '162a5449-7f05-41c3-b557-4ff1866d1846', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b145940>]}
[0m03:13:07.733806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '162a5449-7f05-41c3-b557-4ff1866d1846', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa1fa810>]}
[0m03:13:07.734220 [info ] [MainThread]: Found 12 models, 137 data tests, 2 sources, 867 macros
[0m03:13:07.734512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '162a5449-7f05-41c3-b557-4ff1866d1846', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8000b30>]}
[0m03:13:07.736316 [info ] [MainThread]: 
[0m03:13:07.736738 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m03:13:07.737523 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project'
[0m03:13:07.737802 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:13:08.471202 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project, now create_yt-e2e-data-cycle-project_youtube_youtube)
[0m03:13:08.471900 [debug] [ThreadPool]: Creating schema "database: "yt-e2e-data-cycle-project"
schema: "youtube_youtube"
"
[0m03:13:08.480420 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:13:08.481794 [debug] [ThreadPool]: On create_yt-e2e-data-cycle-project_youtube_youtube: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "connection_name": "create_yt-e2e-data-cycle-project_youtube_youtube"} */
create schema if not exists `yt-e2e-data-cycle-project`.`youtube_youtube`
  
[0m03:13:09.332945 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:d044edc2-0f45-4c8d-b4f1-7dfd66a681ab&page=queryresults
[0m03:13:10.329767 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_yt-e2e-data-cycle-project_youtube_youtube, now list_yt-e2e-data-cycle-project_youtube_youtube)
[0m03:13:10.330840 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:13:11.139475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '162a5449-7f05-41c3-b557-4ff1866d1846', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a9c8e90>]}
[0m03:13:11.141806 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:13:11.143277 [info ] [MainThread]: 
[0m03:13:11.149021 [debug] [Thread-1 (]: Began running node model.youtube_project.dim_categories
[0m03:13:11.150191 [info ] [Thread-1 (]: 1 of 1 START sql table model youtube_youtube.dim_categories .................... [RUN]
[0m03:13:11.151206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube_youtube, now model.youtube_project.dim_categories)
[0m03:13:11.152108 [debug] [Thread-1 (]: Began compiling node model.youtube_project.dim_categories
[0m03:13:11.164781 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_project.dim_categories"
[0m03:13:11.168276 [debug] [Thread-1 (]: Began executing node model.youtube_project.dim_categories
[0m03:13:11.204628 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_project.dim_categories"
[0m03:13:11.206338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:11.207807 [debug] [Thread-1 (]: On model.youtube_project.dim_categories: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "model.youtube_project.dim_categories"} */

  
    

    create or replace table `yt-e2e-data-cycle-project`.`youtube_youtube`.`dim_categories`
      
    
    

    OPTIONS()
    as (
      WITH category_data AS (
    SELECT * 
    FROM `yt-e2e-data-cycle-project`.`youtube_youtube`.`staging_category`
),

category_lookup AS (
    SELECT * 
    FROM UNNEST([
        STRUCT(1 AS category_id, 'Film & Animation' AS category_name, 'Videos related to film and animation.' AS category_description),
        STRUCT(2 AS category_id, 'Autos & Vehicles' AS category_name, 'Videos related to cars, trucks, motorcycles, and vehicles.' AS category_description),
        STRUCT(10 AS category_id, 'Music' AS category_name, 'Videos related to music, music videos, and performances.' AS category_description),
        STRUCT(15 AS category_id, 'Pets & Animals' AS category_name, 'Videos related to pets, animals, and wildlife.' AS category_description),
        STRUCT(17 AS category_id, 'Sports' AS category_name, 'Videos related to sports events, commentary, and athletics.' AS category_description),
        STRUCT(18 AS category_id, 'Short Movies' AS category_name, 'Short films and independent films.' AS category_description),
        STRUCT(19 AS category_id, 'Travel & Events' AS category_name, 'Videos related to travel and live events.' AS category_description),
        STRUCT(20 AS category_id, 'Gaming' AS category_name, 'Videos related to video games, game commentary, and more.' AS category_description),
        STRUCT(22 AS category_id, 'People & Blogs' AS category_name, 'Personal vlogs and commentary.' AS category_description),
        STRUCT(23 AS category_id, 'Comedy' AS category_name, 'Videos related to comedic content.' AS category_description),
        STRUCT(24 AS category_id, 'Entertainment' AS category_name, 'Content related to entertainment and celebrity culture.' AS category_description),
        STRUCT(25 AS category_id, 'News & Politics' AS category_name, 'News and political commentary or events.' AS category_description),
        STRUCT(26 AS category_id, 'Howto & Style' AS category_name, 'How-to videos and style-related content.' AS category_description),
        STRUCT(27 AS category_id, 'Education' AS category_name, 'Educational content for various fields and topics.' AS category_description),
        STRUCT(28 AS category_id, 'Science & Technology' AS category_name, 'Videos related to science, tech, and innovations.' AS category_description),
        STRUCT(29 AS category_id, 'Nonprofits & Activism' AS category_name, 'Content related to nonprofits, activism, and charitable causes.' AS category_description),
        STRUCT(30 AS category_id, 'Movies' AS category_name, 'Full-length movies, movie trailers, and related content.' AS category_description),
        STRUCT(31 AS category_id, 'Anime & Animation' AS category_name, 'Anime series, animation, and related content.' AS category_description),
        STRUCT(32 AS category_id, 'Action & Adventure' AS category_name, 'Videos related to action and adventure content.' AS category_description),
        STRUCT(33 AS category_id, 'Classics' AS category_name, 'Classic movies, TV shows, and content.' AS category_description),
        STRUCT(34 AS category_id, 'Documentaries' AS category_name, 'Documentaries and docuseries content.' AS category_description),
        STRUCT(35 AS category_id, 'Drama' AS category_name, 'Dramas, TV shows, and related content.' AS category_description),
        STRUCT(36 AS category_id, 'Family & Parenting' AS category_name, 'Videos related to family life and parenting.' AS category_description),
        STRUCT(37 AS category_id, 'Home & Garden' AS category_name, 'Content about home improvement, gardens, and DIY projects.' AS category_description),
        STRUCT(38 AS category_id, 'Lifestyle' AS category_name, 'Videos about lifestyle, health, wellness, and more.' AS category_description),
        STRUCT(39 AS category_id, 'Music Videos' AS category_name, 'Music video content, including live and pre-recorded.' AS category_description),
        STRUCT(40 AS category_id, 'Reality TV' AS category_name, 'Reality TV shows and unscripted content.' AS category_description)
    ]) AS category_lookup
)

SELECT 
    ROW_NUMBER() OVER (ORDER BY c.category_id) as pk_category_id,  
    c.category_id AS category_id,
    COALESCE(c.category_name, l.category_name) AS category_name,
    COALESCE(c.category_description, l.category_description) AS category_description
FROM category_data c
LEFT JOIN category_lookup l 
    ON c.category_id = l.category_id
    );
  
[0m03:13:12.266512 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:06a3ee27-a572-41f2-9025-9d09012c08c7&page=queryresults
[0m03:13:12.268555 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:06a3ee27-a572-41f2-9025-9d09012c08c7&page=queryresults
[0m03:13:12.278314 [debug] [Thread-1 (]: Database Error in model dim_categories (models/youtube_data/marts/dim_categories.sql)
  Not found: Table yt-e2e-data-cycle-project:youtube_youtube.staging_category was not found in location US
  compiled code at target/run/youtube_project/models/youtube_data/marts/dim_categories.sql
[0m03:13:12.280971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '162a5449-7f05-41c3-b557-4ff1866d1846', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b02d5e0>]}
[0m03:13:12.282114 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model youtube_youtube.dim_categories ........... [[31mERROR[0m in 1.13s]
[0m03:13:12.283232 [debug] [Thread-1 (]: Finished running node model.youtube_project.dim_categories
[0m03:13:12.286321 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:13:12.286909 [debug] [MainThread]: Connection 'model.youtube_project.dim_categories' was properly closed.
[0m03:13:12.287468 [info ] [MainThread]: 
[0m03:13:12.288110 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.55 seconds (4.55s).
[0m03:13:12.289691 [debug] [MainThread]: Command end result
[0m03:13:12.359157 [info ] [MainThread]: 
[0m03:13:12.359533 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:13:12.359856 [info ] [MainThread]: 
[0m03:13:12.360241 [error] [MainThread]:   Database Error in model dim_categories (models/youtube_data/marts/dim_categories.sql)
  Not found: Table yt-e2e-data-cycle-project:youtube_youtube.staging_category was not found in location US
  compiled code at target/run/youtube_project/models/youtube_data/marts/dim_categories.sql
[0m03:13:12.360510 [info ] [MainThread]: 
[0m03:13:12.360823 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:13:12.361664 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.7263837, "process_in_blocks": "0", "process_kernel_time": 0.278616, "process_mem_max_rss": "225648", "process_out_blocks": "8126", "process_user_time": 3.526803}
[0m03:13:12.362013 [debug] [MainThread]: Command `dbt run` failed at 03:13:12.361949 after 6.73 seconds
[0m03:13:12.362266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa83b32f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8d44ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aff2e70>]}
[0m03:13:12.362497 [debug] [MainThread]: Flushing usage events
[0m03:16:04.588611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e6bfb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ef72a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ebf62a0>]}


============================== 03:16:04.589909 | 56be86c7-42d1-43b7-8bb9-6bbbfc2b3090 ==============================
[0m03:16:04.589909 [info ] [MainThread]: Running with dbt=1.8.9
[0m03:16:04.590297 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'partial_parse': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'empty': 'False', 'quiet': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'static_parser': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'printer_width': '80', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --models youtube_data.marts.dim_categories', 'introspect': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'warn_error': 'None', 'use_colors': 'True', 'write_json': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'debug': 'False', 'send_anonymous_usage_stats': 'True'}
[0m03:16:05.225746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56be86c7-42d1-43b7-8bb9-6bbbfc2b3090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff720f97c0>]}
[0m03:16:05.250270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56be86c7-42d1-43b7-8bb9-6bbbfc2b3090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff633655e0>]}
[0m03:16:05.250656 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m03:16:05.317966 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m03:16:05.374875 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m03:16:05.375310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '56be86c7-42d1-43b7-8bb9-6bbbfc2b3090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7efd0440>]}
[0m03:16:06.566983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56be86c7-42d1-43b7-8bb9-6bbbfc2b3090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff618f39b0>]}
[0m03:16:06.710146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56be86c7-42d1-43b7-8bb9-6bbbfc2b3090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60dadaf0>]}
[0m03:16:06.710519 [info ] [MainThread]: Found 12 models, 137 data tests, 2 sources, 867 macros
[0m03:16:06.710788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56be86c7-42d1-43b7-8bb9-6bbbfc2b3090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff611893a0>]}
[0m03:16:06.712633 [info ] [MainThread]: 
[0m03:16:06.713094 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m03:16:06.713776 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project'
[0m03:16:06.714058 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:16:07.592026 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project, now list_yt-e2e-data-cycle-project_youtube_youtube)
[0m03:16:07.592958 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:16:08.398278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56be86c7-42d1-43b7-8bb9-6bbbfc2b3090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61fc6ba0>]}
[0m03:16:08.400344 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:16:08.402133 [info ] [MainThread]: 
[0m03:16:08.408221 [debug] [Thread-1 (]: Began running node model.youtube_project.dim_categories
[0m03:16:08.409477 [info ] [Thread-1 (]: 1 of 1 START sql table model youtube_youtube.dim_categories .................... [RUN]
[0m03:16:08.410609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube_youtube, now model.youtube_project.dim_categories)
[0m03:16:08.411381 [debug] [Thread-1 (]: Began compiling node model.youtube_project.dim_categories
[0m03:16:08.423439 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_project.dim_categories"
[0m03:16:08.425391 [debug] [Thread-1 (]: Began executing node model.youtube_project.dim_categories
[0m03:16:08.460973 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_project.dim_categories"
[0m03:16:08.462115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:16:08.463544 [debug] [Thread-1 (]: On model.youtube_project.dim_categories: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "model.youtube_project.dim_categories"} */

  
    

    create or replace table `yt-e2e-data-cycle-project`.`youtube_youtube`.`dim_categories`
      
    
    

    OPTIONS()
    as (
      WITH category_data AS (
    SELECT * 
    FROM `yt-e2e-data-cycle-project`.`youtube_youtube`.`staging_category`
),

category_lookup AS (
    SELECT * 
    FROM UNNEST([
        STRUCT(1 AS category_id, 'Film & Animation' AS category_name, 'Videos related to film and animation.' AS category_description),
        STRUCT(2 AS category_id, 'Autos & Vehicles' AS category_name, 'Videos related to cars, trucks, motorcycles, and vehicles.' AS category_description),
        STRUCT(10 AS category_id, 'Music' AS category_name, 'Videos related to music, music videos, and performances.' AS category_description),
        STRUCT(15 AS category_id, 'Pets & Animals' AS category_name, 'Videos related to pets, animals, and wildlife.' AS category_description),
        STRUCT(17 AS category_id, 'Sports' AS category_name, 'Videos related to sports events, commentary, and athletics.' AS category_description),
        STRUCT(18 AS category_id, 'Short Movies' AS category_name, 'Short films and independent films.' AS category_description),
        STRUCT(19 AS category_id, 'Travel & Events' AS category_name, 'Videos related to travel and live events.' AS category_description),
        STRUCT(20 AS category_id, 'Gaming' AS category_name, 'Videos related to video games, game commentary, and more.' AS category_description),
        STRUCT(22 AS category_id, 'People & Blogs' AS category_name, 'Personal vlogs and commentary.' AS category_description),
        STRUCT(23 AS category_id, 'Comedy' AS category_name, 'Videos related to comedic content.' AS category_description),
        STRUCT(24 AS category_id, 'Entertainment' AS category_name, 'Content related to entertainment and celebrity culture.' AS category_description),
        STRUCT(25 AS category_id, 'News & Politics' AS category_name, 'News and political commentary or events.' AS category_description),
        STRUCT(26 AS category_id, 'Howto & Style' AS category_name, 'How-to videos and style-related content.' AS category_description),
        STRUCT(27 AS category_id, 'Education' AS category_name, 'Educational content for various fields and topics.' AS category_description),
        STRUCT(28 AS category_id, 'Science & Technology' AS category_name, 'Videos related to science, tech, and innovations.' AS category_description),
        STRUCT(29 AS category_id, 'Nonprofits & Activism' AS category_name, 'Content related to nonprofits, activism, and charitable causes.' AS category_description),
        STRUCT(30 AS category_id, 'Movies' AS category_name, 'Full-length movies, movie trailers, and related content.' AS category_description),
        STRUCT(31 AS category_id, 'Anime & Animation' AS category_name, 'Anime series, animation, and related content.' AS category_description),
        STRUCT(32 AS category_id, 'Action & Adventure' AS category_name, 'Videos related to action and adventure content.' AS category_description),
        STRUCT(33 AS category_id, 'Classics' AS category_name, 'Classic movies, TV shows, and content.' AS category_description),
        STRUCT(34 AS category_id, 'Documentaries' AS category_name, 'Documentaries and docuseries content.' AS category_description),
        STRUCT(35 AS category_id, 'Drama' AS category_name, 'Dramas, TV shows, and related content.' AS category_description),
        STRUCT(36 AS category_id, 'Family & Parenting' AS category_name, 'Videos related to family life and parenting.' AS category_description),
        STRUCT(37 AS category_id, 'Home & Garden' AS category_name, 'Content about home improvement, gardens, and DIY projects.' AS category_description),
        STRUCT(38 AS category_id, 'Lifestyle' AS category_name, 'Videos about lifestyle, health, wellness, and more.' AS category_description),
        STRUCT(39 AS category_id, 'Music Videos' AS category_name, 'Music video content, including live and pre-recorded.' AS category_description),
        STRUCT(40 AS category_id, 'Reality TV' AS category_name, 'Reality TV shows and unscripted content.' AS category_description)
    ]) AS category_lookup
)

SELECT 
    ROW_NUMBER() OVER (ORDER BY c.category_id) as pk_category_id,  
    c.category_id AS category_id,
    COALESCE(c.category_name, l.category_name) AS category_name,
    COALESCE(c.category_description, l.category_description) AS category_description
FROM category_data c
LEFT JOIN category_lookup l 
    ON c.category_id = l.category_id
    );
  
[0m03:16:09.527834 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:c3434f27-ae5b-4155-936f-81880029267e&page=queryresults
[0m03:16:09.530787 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:c3434f27-ae5b-4155-936f-81880029267e&page=queryresults
[0m03:16:09.539652 [debug] [Thread-1 (]: Database Error in model dim_categories (models/youtube_data/marts/dim_categories.sql)
  Not found: Table yt-e2e-data-cycle-project:youtube_youtube.staging_category was not found in location US
  compiled code at target/run/youtube_project/models/youtube_data/marts/dim_categories.sql
[0m03:16:09.542166 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56be86c7-42d1-43b7-8bb9-6bbbfc2b3090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6188d760>]}
[0m03:16:09.543480 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model youtube_youtube.dim_categories ........... [[31mERROR[0m in 1.13s]
[0m03:16:09.544899 [debug] [Thread-1 (]: Finished running node model.youtube_project.dim_categories
[0m03:16:09.547691 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:16:09.548246 [debug] [MainThread]: Connection 'model.youtube_project.dim_categories' was properly closed.
[0m03:16:09.548833 [info ] [MainThread]: 
[0m03:16:09.549392 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.84 seconds (2.84s).
[0m03:16:09.550855 [debug] [MainThread]: Command end result
[0m03:16:09.616535 [info ] [MainThread]: 
[0m03:16:09.616926 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:16:09.617292 [info ] [MainThread]: 
[0m03:16:09.617726 [error] [MainThread]:   Database Error in model dim_categories (models/youtube_data/marts/dim_categories.sql)
  Not found: Table yt-e2e-data-cycle-project:youtube_youtube.staging_category was not found in location US
  compiled code at target/run/youtube_project/models/youtube_data/marts/dim_categories.sql
[0m03:16:09.617991 [info ] [MainThread]: 
[0m03:16:09.618272 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:16:09.618990 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.0557137, "process_in_blocks": "0", "process_kernel_time": 0.274243, "process_mem_max_rss": "225564", "process_out_blocks": "8124", "process_user_time": 3.511929}
[0m03:16:09.619322 [debug] [MainThread]: Command `dbt run` failed at 03:16:09.619258 after 5.06 seconds
[0m03:16:09.619582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82bb7050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f6e6360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f6e4110>]}
[0m03:16:09.619821 [debug] [MainThread]: Flushing usage events
[0m03:22:14.927305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb45a58b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4629040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb45a5880>]}


============================== 03:22:14.928621 | 1feb7112-d1cf-42dd-a6c2-9724ae7cbcf0 ==============================
[0m03:22:14.928621 [info ] [MainThread]: Running with dbt=1.8.9
[0m03:22:14.929119 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'introspect': 'True', 'printer_width': '80', 'no_print': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt run --models youtube_data.marts.dim_categories', 'use_colors': 'True', 'empty': 'False', 'debug': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'quiet': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'static_parser': 'True', 'log_format': 'default'}
[0m03:22:15.559863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1feb7112-d1cf-42dd-a6c2-9724ae7cbcf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4479880>]}
[0m03:22:15.584636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1feb7112-d1cf-42dd-a6c2-9724ae7cbcf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97e61e50>]}
[0m03:22:15.585037 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m03:22:15.649433 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m03:22:15.704926 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m03:22:15.705376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1feb7112-d1cf-42dd-a6c2-9724ae7cbcf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4e74650>]}
[0m03:22:16.896453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1feb7112-d1cf-42dd-a6c2-9724ae7cbcf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97295df0>]}
[0m03:22:17.037592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1feb7112-d1cf-42dd-a6c2-9724ae7cbcf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97304350>]}
[0m03:22:17.037989 [info ] [MainThread]: Found 12 models, 137 data tests, 2 sources, 867 macros
[0m03:22:17.038277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1feb7112-d1cf-42dd-a6c2-9724ae7cbcf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff972f2870>]}
[0m03:22:17.040184 [info ] [MainThread]: 
[0m03:22:17.040639 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m03:22:17.041321 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project'
[0m03:22:17.041578 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:22:17.816349 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project, now list_yt-e2e-data-cycle-project_youtube)
[0m03:22:17.817470 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:22:18.694117 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now list_yt-e2e-data-cycle-project_youtube_youtube)
[0m03:22:18.698471 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:22:19.511669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1feb7112-d1cf-42dd-a6c2-9724ae7cbcf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97d06db0>]}
[0m03:22:19.512644 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:22:19.513349 [info ] [MainThread]: 
[0m03:22:19.516538 [debug] [Thread-1 (]: Began running node model.youtube_project.dim_categories
[0m03:22:19.517317 [info ] [Thread-1 (]: 1 of 1 START sql table model youtube.dim_categories ............................ [RUN]
[0m03:22:19.517996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube_youtube, now model.youtube_project.dim_categories)
[0m03:22:19.518475 [debug] [Thread-1 (]: Began compiling node model.youtube_project.dim_categories
[0m03:22:19.527253 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_project.dim_categories"
[0m03:22:19.529614 [debug] [Thread-1 (]: Began executing node model.youtube_project.dim_categories
[0m03:22:19.561387 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_project.dim_categories"
[0m03:22:19.562540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:22:19.563782 [debug] [Thread-1 (]: On model.youtube_project.dim_categories: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "model.youtube_project.dim_categories"} */

  
    

    create or replace table `yt-e2e-data-cycle-project`.`youtube`.`dim_categories`
      
    
    

    OPTIONS()
    as (
      WITH category_data AS (
    SELECT * 
    FROM `yt-e2e-data-cycle-project`.`youtube_youtube`.`staging_category`
),

category_lookup AS (
    SELECT * 
    FROM UNNEST([
        STRUCT(1 AS category_id, 'Film & Animation' AS category_name, 'Videos related to film and animation.' AS category_description),
        STRUCT(2 AS category_id, 'Autos & Vehicles' AS category_name, 'Videos related to cars, trucks, motorcycles, and vehicles.' AS category_description),
        STRUCT(10 AS category_id, 'Music' AS category_name, 'Videos related to music, music videos, and performances.' AS category_description),
        STRUCT(15 AS category_id, 'Pets & Animals' AS category_name, 'Videos related to pets, animals, and wildlife.' AS category_description),
        STRUCT(17 AS category_id, 'Sports' AS category_name, 'Videos related to sports events, commentary, and athletics.' AS category_description),
        STRUCT(18 AS category_id, 'Short Movies' AS category_name, 'Short films and independent films.' AS category_description),
        STRUCT(19 AS category_id, 'Travel & Events' AS category_name, 'Videos related to travel and live events.' AS category_description),
        STRUCT(20 AS category_id, 'Gaming' AS category_name, 'Videos related to video games, game commentary, and more.' AS category_description),
        STRUCT(22 AS category_id, 'People & Blogs' AS category_name, 'Personal vlogs and commentary.' AS category_description),
        STRUCT(23 AS category_id, 'Comedy' AS category_name, 'Videos related to comedic content.' AS category_description),
        STRUCT(24 AS category_id, 'Entertainment' AS category_name, 'Content related to entertainment and celebrity culture.' AS category_description),
        STRUCT(25 AS category_id, 'News & Politics' AS category_name, 'News and political commentary or events.' AS category_description),
        STRUCT(26 AS category_id, 'Howto & Style' AS category_name, 'How-to videos and style-related content.' AS category_description),
        STRUCT(27 AS category_id, 'Education' AS category_name, 'Educational content for various fields and topics.' AS category_description),
        STRUCT(28 AS category_id, 'Science & Technology' AS category_name, 'Videos related to science, tech, and innovations.' AS category_description),
        STRUCT(29 AS category_id, 'Nonprofits & Activism' AS category_name, 'Content related to nonprofits, activism, and charitable causes.' AS category_description),
        STRUCT(30 AS category_id, 'Movies' AS category_name, 'Full-length movies, movie trailers, and related content.' AS category_description),
        STRUCT(31 AS category_id, 'Anime & Animation' AS category_name, 'Anime series, animation, and related content.' AS category_description),
        STRUCT(32 AS category_id, 'Action & Adventure' AS category_name, 'Videos related to action and adventure content.' AS category_description),
        STRUCT(33 AS category_id, 'Classics' AS category_name, 'Classic movies, TV shows, and content.' AS category_description),
        STRUCT(34 AS category_id, 'Documentaries' AS category_name, 'Documentaries and docuseries content.' AS category_description),
        STRUCT(35 AS category_id, 'Drama' AS category_name, 'Dramas, TV shows, and related content.' AS category_description),
        STRUCT(36 AS category_id, 'Family & Parenting' AS category_name, 'Videos related to family life and parenting.' AS category_description),
        STRUCT(37 AS category_id, 'Home & Garden' AS category_name, 'Content about home improvement, gardens, and DIY projects.' AS category_description),
        STRUCT(38 AS category_id, 'Lifestyle' AS category_name, 'Videos about lifestyle, health, wellness, and more.' AS category_description),
        STRUCT(39 AS category_id, 'Music Videos' AS category_name, 'Music video content, including live and pre-recorded.' AS category_description),
        STRUCT(40 AS category_id, 'Reality TV' AS category_name, 'Reality TV shows and unscripted content.' AS category_description)
    ]) AS category_lookup
)

SELECT 
    ROW_NUMBER() OVER (ORDER BY c.category_id) as pk_category_id,  
    c.category_id AS category_id,
    COALESCE(c.category_name, l.category_name) AS category_name,
    COALESCE(c.category_description, l.category_description) AS category_description
FROM category_data c
LEFT JOIN category_lookup l 
    ON c.category_id = l.category_id
    );
  
[0m03:22:20.434531 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:fd62431c-02d4-4f1b-8e77-bc77f88fa352&page=queryresults
[0m03:22:20.437277 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:fd62431c-02d4-4f1b-8e77-bc77f88fa352&page=queryresults
[0m03:22:20.446943 [debug] [Thread-1 (]: Database Error in model dim_categories (models/youtube_data/marts/dim_categories.sql)
  Not found: Table yt-e2e-data-cycle-project:youtube_youtube.staging_category was not found in location US
  compiled code at target/run/youtube_project/models/youtube_data/marts/dim_categories.sql
[0m03:22:20.449715 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1feb7112-d1cf-42dd-a6c2-9724ae7cbcf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97759550>]}
[0m03:22:20.451024 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model youtube.dim_categories ................... [[31mERROR[0m in 0.93s]
[0m03:22:20.452423 [debug] [Thread-1 (]: Finished running node model.youtube_project.dim_categories
[0m03:22:20.455768 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:22:20.456374 [debug] [MainThread]: Connection 'model.youtube_project.dim_categories' was properly closed.
[0m03:22:20.456966 [info ] [MainThread]: 
[0m03:22:20.457555 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.42 seconds (3.42s).
[0m03:22:20.459444 [debug] [MainThread]: Command end result
[0m03:22:20.526499 [info ] [MainThread]: 
[0m03:22:20.526904 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:22:20.527235 [info ] [MainThread]: 
[0m03:22:20.527690 [error] [MainThread]:   Database Error in model dim_categories (models/youtube_data/marts/dim_categories.sql)
  Not found: Table yt-e2e-data-cycle-project:youtube_youtube.staging_category was not found in location US
  compiled code at target/run/youtube_project/models/youtube_data/marts/dim_categories.sql
[0m03:22:20.527967 [info ] [MainThread]: 
[0m03:22:20.528268 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:22:20.529000 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.626409, "process_in_blocks": "0", "process_kernel_time": 0.277801, "process_mem_max_rss": "225592", "process_out_blocks": "8124", "process_user_time": 3.529185}
[0m03:22:20.529361 [debug] [MainThread]: Command `dbt run` failed at 03:22:20.529290 after 5.63 seconds
[0m03:22:20.529642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4a4ef60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4629040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb492b3b0>]}
[0m03:22:20.529932 [debug] [MainThread]: Flushing usage events
[0m03:26:54.667621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93130cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9155c5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff922a2ea0>]}


============================== 03:26:54.669374 | b58cb868-3c63-4501-908b-609498a49f7a ==============================
[0m03:26:54.669374 [info ] [MainThread]: Running with dbt=1.8.9
[0m03:26:54.669841 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'printer_width': '80', 'log_format': 'default', 'profiles_dir': '/usr/local/airflow/include/dbt', 'write_json': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'invocation_command': 'dbt clean', 'log_path': '/usr/local/airflow/include/dbt/logs', 'static_parser': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'target_path': 'None', 'log_cache_events': 'False', 'version_check': 'True', 'empty': 'None', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m03:26:54.732389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b58cb868-3c63-4501-908b-609498a49f7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9121f4d0>]}
[0m03:26:54.739827 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
        The default package install path has changed from `dbt_modules` to
`dbt_packages`.         Please update `clean-targets` in `dbt_project.yml` and
check `.gitignore` as well.         Or, set `packages-install-path: dbt_modules`
if you'd like to keep the current value.
[0m03:26:54.740356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b58cb868-3c63-4501-908b-609498a49f7a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92144b90>]}
[0m03:26:54.748925 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.108658955, "process_in_blocks": "0", "process_kernel_time": 0.192633, "process_mem_max_rss": "95324", "process_out_blocks": "4", "process_user_time": 0.844779}
[0m03:26:54.749738 [debug] [MainThread]: Command `dbt clean` succeeded at 03:26:54.749634 after 0.11 seconds
[0m03:26:54.750042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff922cf110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90f36840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff911fe570>]}
[0m03:26:54.750373 [debug] [MainThread]: Flushing usage events
[0m03:27:38.731195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3f29040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3df9430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb42fe840>]}


============================== 03:27:38.732486 | 02eacd05-7038-4980-be72-4bb103792fe7 ==============================
[0m03:27:38.732486 [info ] [MainThread]: Running with dbt=1.8.9
[0m03:27:38.732908 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'use_colors': 'True', 'introspect': 'True', 'warn_error': 'None', 'invocation_command': 'dbt run --models youtube_data.marts.dim_categories', 'target_path': 'None', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'write_json': 'True', 'quiet': 'False', 'debug': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'no_print': 'None', 'fail_fast': 'False', 'empty': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '/usr/local/airflow/include/dbt', 'log_format': 'default'}
[0m03:27:39.386293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02eacd05-7038-4980-be72-4bb103792fe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5246630>]}
[0m03:27:39.410864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02eacd05-7038-4980-be72-4bb103792fe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97f883b0>]}
[0m03:27:39.411251 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m03:27:39.476240 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m03:27:39.477079 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m03:27:39.477359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '02eacd05-7038-4980-be72-4bb103792fe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9710a120>]}
[0m03:27:40.665637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02eacd05-7038-4980-be72-4bb103792fe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff961b4140>]}
[0m03:27:40.749595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02eacd05-7038-4980-be72-4bb103792fe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95d98530>]}
[0m03:27:40.749977 [info ] [MainThread]: Found 12 models, 137 data tests, 2 sources, 867 macros
[0m03:27:40.750249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02eacd05-7038-4980-be72-4bb103792fe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96d524e0>]}
[0m03:27:40.752231 [info ] [MainThread]: 
[0m03:27:40.752699 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m03:27:40.753386 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project'
[0m03:27:40.753669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:27:41.583911 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project, now list_yt-e2e-data-cycle-project_youtube_youtube)
[0m03:27:41.586044 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:27:42.388271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02eacd05-7038-4980-be72-4bb103792fe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96d53fe0>]}
[0m03:27:42.391621 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:27:42.393454 [info ] [MainThread]: 
[0m03:27:42.401037 [debug] [Thread-1 (]: Began running node model.youtube_project.dim_categories
[0m03:27:42.402905 [info ] [Thread-1 (]: 1 of 1 START sql table model youtube_youtube.dim_categories .................... [RUN]
[0m03:27:42.404071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube_youtube, now model.youtube_project.dim_categories)
[0m03:27:42.404936 [debug] [Thread-1 (]: Began compiling node model.youtube_project.dim_categories
[0m03:27:42.419029 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_project.dim_categories"
[0m03:27:42.424351 [debug] [Thread-1 (]: Began executing node model.youtube_project.dim_categories
[0m03:27:42.462095 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_project.dim_categories"
[0m03:27:42.464395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:27:42.466124 [debug] [Thread-1 (]: On model.youtube_project.dim_categories: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "model.youtube_project.dim_categories"} */

  
    

    create or replace table `yt-e2e-data-cycle-project`.`youtube_youtube`.`dim_categories`
      
    
    

    OPTIONS()
    as (
      WITH category_data AS (
    SELECT * 
    FROM `yt-e2e-data-cycle-project`.`youtube_youtube`.`staging_category`
),

category_lookup AS (
    SELECT * 
    FROM UNNEST([
        STRUCT(1 AS category_id, 'Film & Animation' AS category_name, 'Videos related to film and animation.' AS category_description),
        STRUCT(2 AS category_id, 'Autos & Vehicles' AS category_name, 'Videos related to cars, trucks, motorcycles, and vehicles.' AS category_description),
        STRUCT(10 AS category_id, 'Music' AS category_name, 'Videos related to music, music videos, and performances.' AS category_description),
        STRUCT(15 AS category_id, 'Pets & Animals' AS category_name, 'Videos related to pets, animals, and wildlife.' AS category_description),
        STRUCT(17 AS category_id, 'Sports' AS category_name, 'Videos related to sports events, commentary, and athletics.' AS category_description),
        STRUCT(18 AS category_id, 'Short Movies' AS category_name, 'Short films and independent films.' AS category_description),
        STRUCT(19 AS category_id, 'Travel & Events' AS category_name, 'Videos related to travel and live events.' AS category_description),
        STRUCT(20 AS category_id, 'Gaming' AS category_name, 'Videos related to video games, game commentary, and more.' AS category_description),
        STRUCT(22 AS category_id, 'People & Blogs' AS category_name, 'Personal vlogs and commentary.' AS category_description),
        STRUCT(23 AS category_id, 'Comedy' AS category_name, 'Videos related to comedic content.' AS category_description),
        STRUCT(24 AS category_id, 'Entertainment' AS category_name, 'Content related to entertainment and celebrity culture.' AS category_description),
        STRUCT(25 AS category_id, 'News & Politics' AS category_name, 'News and political commentary or events.' AS category_description),
        STRUCT(26 AS category_id, 'Howto & Style' AS category_name, 'How-to videos and style-related content.' AS category_description),
        STRUCT(27 AS category_id, 'Education' AS category_name, 'Educational content for various fields and topics.' AS category_description),
        STRUCT(28 AS category_id, 'Science & Technology' AS category_name, 'Videos related to science, tech, and innovations.' AS category_description),
        STRUCT(29 AS category_id, 'Nonprofits & Activism' AS category_name, 'Content related to nonprofits, activism, and charitable causes.' AS category_description),
        STRUCT(30 AS category_id, 'Movies' AS category_name, 'Full-length movies, movie trailers, and related content.' AS category_description),
        STRUCT(31 AS category_id, 'Anime & Animation' AS category_name, 'Anime series, animation, and related content.' AS category_description),
        STRUCT(32 AS category_id, 'Action & Adventure' AS category_name, 'Videos related to action and adventure content.' AS category_description),
        STRUCT(33 AS category_id, 'Classics' AS category_name, 'Classic movies, TV shows, and content.' AS category_description),
        STRUCT(34 AS category_id, 'Documentaries' AS category_name, 'Documentaries and docuseries content.' AS category_description),
        STRUCT(35 AS category_id, 'Drama' AS category_name, 'Dramas, TV shows, and related content.' AS category_description),
        STRUCT(36 AS category_id, 'Family & Parenting' AS category_name, 'Videos related to family life and parenting.' AS category_description),
        STRUCT(37 AS category_id, 'Home & Garden' AS category_name, 'Content about home improvement, gardens, and DIY projects.' AS category_description),
        STRUCT(38 AS category_id, 'Lifestyle' AS category_name, 'Videos about lifestyle, health, wellness, and more.' AS category_description),
        STRUCT(39 AS category_id, 'Music Videos' AS category_name, 'Music video content, including live and pre-recorded.' AS category_description),
        STRUCT(40 AS category_id, 'Reality TV' AS category_name, 'Reality TV shows and unscripted content.' AS category_description)
    ]) AS category_lookup
)

SELECT 
    ROW_NUMBER() OVER (ORDER BY c.category_id) as pk_category_id,  
    c.category_id AS category_id,
    COALESCE(c.category_name, l.category_name) AS category_name,
    COALESCE(c.category_description, l.category_description) AS category_description
FROM category_data c
LEFT JOIN category_lookup l 
    ON c.category_id = l.category_id
    );
  
[0m03:27:43.415971 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:bf9c88c1-06a4-4f1e-b404-82ca9288c494&page=queryresults
[0m03:27:43.418683 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:bf9c88c1-06a4-4f1e-b404-82ca9288c494&page=queryresults
[0m03:27:43.431598 [debug] [Thread-1 (]: Database Error in model dim_categories (models/youtube_data/marts/dim_categories.sql)
  Not found: Table yt-e2e-data-cycle-project:youtube_youtube.staging_category was not found in location US
  compiled code at target/run/youtube_project/models/youtube_data/marts/dim_categories.sql
[0m03:27:43.434207 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02eacd05-7038-4980-be72-4bb103792fe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9594a1b0>]}
[0m03:27:43.435590 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model youtube_youtube.dim_categories ........... [[31mERROR[0m in 1.03s]
[0m03:27:43.438209 [debug] [Thread-1 (]: Finished running node model.youtube_project.dim_categories
[0m03:27:43.443476 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:27:43.444201 [debug] [MainThread]: Connection 'model.youtube_project.dim_categories' was properly closed.
[0m03:27:43.444815 [info ] [MainThread]: 
[0m03:27:43.445443 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.69 seconds (2.69s).
[0m03:27:43.446980 [debug] [MainThread]: Command end result
[0m03:27:43.606975 [info ] [MainThread]: 
[0m03:27:43.607363 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:27:43.607716 [info ] [MainThread]: 
[0m03:27:43.608060 [error] [MainThread]:   Database Error in model dim_categories (models/youtube_data/marts/dim_categories.sql)
  Not found: Table yt-e2e-data-cycle-project:youtube_youtube.staging_category was not found in location US
  compiled code at target/run/youtube_project/models/youtube_data/marts/dim_categories.sql
[0m03:27:43.608379 [info ] [MainThread]: 
[0m03:27:43.608642 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:27:43.609625 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.903995, "process_in_blocks": "0", "process_kernel_time": 0.267668, "process_mem_max_rss": "226224", "process_out_blocks": "8124", "process_user_time": 3.515786}
[0m03:27:43.610007 [debug] [MainThread]: Command `dbt run` failed at 03:27:43.609946 after 4.90 seconds
[0m03:27:43.610260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4b141d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4fc0380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4fc0470>]}
[0m03:27:43.610480 [debug] [MainThread]: Flushing usage events
[0m03:28:56.999071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa78cab10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa604e2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5669580>]}


============================== 03:28:57.000603 | dd4159d0-0ffd-49d7-93eb-b6052be2831f ==============================
[0m03:28:57.000603 [info ] [MainThread]: Running with dbt=1.8.9
[0m03:28:57.001102 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'use_colors': 'True', 'version_check': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --models youtube_data.marts.dim_categories', 'cache_selected_only': 'False', 'partial_parse': 'True'}
[0m03:28:57.633906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd4159d0-0ffd-49d7-93eb-b6052be2831f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89717b90>]}
[0m03:28:57.659131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd4159d0-0ffd-49d7-93eb-b6052be2831f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff899317c0>]}
[0m03:28:57.659535 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m03:28:57.722960 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m03:28:57.778141 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m03:28:57.778545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dd4159d0-0ffd-49d7-93eb-b6052be2831f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5f38680>]}
[0m03:28:58.926174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd4159d0-0ffd-49d7-93eb-b6052be2831f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8810af60>]}
[0m03:28:59.070270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd4159d0-0ffd-49d7-93eb-b6052be2831f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7517c80>]}
[0m03:28:59.070674 [info ] [MainThread]: Found 12 models, 137 data tests, 2 sources, 867 macros
[0m03:28:59.070959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd4159d0-0ffd-49d7-93eb-b6052be2831f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6b45f10>]}
[0m03:28:59.072833 [info ] [MainThread]: 
[0m03:28:59.073309 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m03:28:59.074048 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project'
[0m03:28:59.074317 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:28:59.895378 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project, now list_yt-e2e-data-cycle-project_youtube)
[0m03:28:59.896264 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:29:00.717603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd4159d0-0ffd-49d7-93eb-b6052be2831f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87d69f70>]}
[0m03:29:00.719184 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:29:00.720143 [info ] [MainThread]: 
[0m03:29:00.724945 [debug] [Thread-1 (]: Began running node model.youtube_project.dim_categories
[0m03:29:00.726079 [info ] [Thread-1 (]: 1 of 1 START sql table model youtube.dim_categories ............................ [RUN]
[0m03:29:00.727167 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now model.youtube_project.dim_categories)
[0m03:29:00.727947 [debug] [Thread-1 (]: Began compiling node model.youtube_project.dim_categories
[0m03:29:00.744953 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_project.dim_categories"
[0m03:29:00.748195 [debug] [Thread-1 (]: Began executing node model.youtube_project.dim_categories
[0m03:29:00.782308 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_project.dim_categories"
[0m03:29:00.783493 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:29:00.784918 [debug] [Thread-1 (]: On model.youtube_project.dim_categories: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "model.youtube_project.dim_categories"} */

  
    

    create or replace table `yt-e2e-data-cycle-project`.`youtube`.`dim_categories`
      
    
    

    OPTIONS()
    as (
      WITH category_data AS (
    SELECT * 
    FROM `yt-e2e-data-cycle-project`.`youtube`.`staging_category`
),

category_lookup AS (
    SELECT * 
    FROM UNNEST([
        STRUCT(1 AS category_id, 'Film & Animation' AS category_name, 'Videos related to film and animation.' AS category_description),
        STRUCT(2 AS category_id, 'Autos & Vehicles' AS category_name, 'Videos related to cars, trucks, motorcycles, and vehicles.' AS category_description),
        STRUCT(10 AS category_id, 'Music' AS category_name, 'Videos related to music, music videos, and performances.' AS category_description),
        STRUCT(15 AS category_id, 'Pets & Animals' AS category_name, 'Videos related to pets, animals, and wildlife.' AS category_description),
        STRUCT(17 AS category_id, 'Sports' AS category_name, 'Videos related to sports events, commentary, and athletics.' AS category_description),
        STRUCT(18 AS category_id, 'Short Movies' AS category_name, 'Short films and independent films.' AS category_description),
        STRUCT(19 AS category_id, 'Travel & Events' AS category_name, 'Videos related to travel and live events.' AS category_description),
        STRUCT(20 AS category_id, 'Gaming' AS category_name, 'Videos related to video games, game commentary, and more.' AS category_description),
        STRUCT(22 AS category_id, 'People & Blogs' AS category_name, 'Personal vlogs and commentary.' AS category_description),
        STRUCT(23 AS category_id, 'Comedy' AS category_name, 'Videos related to comedic content.' AS category_description),
        STRUCT(24 AS category_id, 'Entertainment' AS category_name, 'Content related to entertainment and celebrity culture.' AS category_description),
        STRUCT(25 AS category_id, 'News & Politics' AS category_name, 'News and political commentary or events.' AS category_description),
        STRUCT(26 AS category_id, 'Howto & Style' AS category_name, 'How-to videos and style-related content.' AS category_description),
        STRUCT(27 AS category_id, 'Education' AS category_name, 'Educational content for various fields and topics.' AS category_description),
        STRUCT(28 AS category_id, 'Science & Technology' AS category_name, 'Videos related to science, tech, and innovations.' AS category_description),
        STRUCT(29 AS category_id, 'Nonprofits & Activism' AS category_name, 'Content related to nonprofits, activism, and charitable causes.' AS category_description),
        STRUCT(30 AS category_id, 'Movies' AS category_name, 'Full-length movies, movie trailers, and related content.' AS category_description),
        STRUCT(31 AS category_id, 'Anime & Animation' AS category_name, 'Anime series, animation, and related content.' AS category_description),
        STRUCT(32 AS category_id, 'Action & Adventure' AS category_name, 'Videos related to action and adventure content.' AS category_description),
        STRUCT(33 AS category_id, 'Classics' AS category_name, 'Classic movies, TV shows, and content.' AS category_description),
        STRUCT(34 AS category_id, 'Documentaries' AS category_name, 'Documentaries and docuseries content.' AS category_description),
        STRUCT(35 AS category_id, 'Drama' AS category_name, 'Dramas, TV shows, and related content.' AS category_description),
        STRUCT(36 AS category_id, 'Family & Parenting' AS category_name, 'Videos related to family life and parenting.' AS category_description),
        STRUCT(37 AS category_id, 'Home & Garden' AS category_name, 'Content about home improvement, gardens, and DIY projects.' AS category_description),
        STRUCT(38 AS category_id, 'Lifestyle' AS category_name, 'Videos about lifestyle, health, wellness, and more.' AS category_description),
        STRUCT(39 AS category_id, 'Music Videos' AS category_name, 'Music video content, including live and pre-recorded.' AS category_description),
        STRUCT(40 AS category_id, 'Reality TV' AS category_name, 'Reality TV shows and unscripted content.' AS category_description)
    ]) AS category_lookup
)

SELECT 
    ROW_NUMBER() OVER (ORDER BY c.category_id) as pk_category_id,  
    c.category_id AS category_id,
    COALESCE(c.category_name, l.category_name) AS category_name,
    COALESCE(c.category_description, l.category_description) AS category_description
FROM category_data c
LEFT JOIN category_lookup l 
    ON c.category_id = l.category_id
    );
  
[0m03:29:02.042197 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:50169c24-0b8a-4357-b3fc-55689256e3ea&page=queryresults
[0m03:29:05.347579 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd4159d0-0ffd-49d7-93eb-b6052be2831f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8879fb90>]}
[0m03:29:05.349352 [info ] [Thread-1 (]: 1 of 1 OK created sql table model youtube.dim_categories ....................... [[32mCREATE TABLE (100.0 rows, 4.5 KiB processed)[0m in 4.62s]
[0m03:29:05.350625 [debug] [Thread-1 (]: Finished running node model.youtube_project.dim_categories
[0m03:29:05.352773 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:29:05.353302 [debug] [MainThread]: Connection 'model.youtube_project.dim_categories' was properly closed.
[0m03:29:05.353898 [info ] [MainThread]: 
[0m03:29:05.354505 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.28 seconds (6.28s).
[0m03:29:05.355791 [debug] [MainThread]: Command end result
[0m03:29:05.422800 [info ] [MainThread]: 
[0m03:29:05.423554 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:29:05.423943 [info ] [MainThread]: 
[0m03:29:05.424313 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:29:05.425574 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.452137, "process_in_blocks": "0", "process_kernel_time": 0.245732, "process_mem_max_rss": "225928", "process_out_blocks": "8118", "process_user_time": 3.519493}
[0m03:29:05.426107 [debug] [MainThread]: Command `dbt run` succeeded at 03:29:05.425993 after 8.45 seconds
[0m03:29:05.426492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5967ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87d6b620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87d6ae10>]}
[0m03:29:05.426769 [debug] [MainThread]: Flushing usage events
[0m03:40:38.223584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ff78fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8008e2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ff7b080>]}


============================== 03:40:38.225001 | da404dc9-3e82-40c2-9acc-4f749b151f6d ==============================
[0m03:40:38.225001 [info ] [MainThread]: Running with dbt=1.8.9
[0m03:40:38.225468 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'use_colors': 'True', 'introspect': 'True', 'version_check': 'True', 'printer_width': '80', 'empty': 'False', 'no_print': 'None', 'log_format': 'default', 'indirect_selection': 'eager', 'debug': 'False', 'partial_parse': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'warn_error': 'None', 'static_parser': 'True', 'invocation_command': 'dbt run --models youtube_data.marts.dim_categories'}
[0m03:40:38.874552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da404dc9-3e82-40c2-9acc-4f749b151f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63061100>]}
[0m03:40:38.900969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da404dc9-3e82-40c2-9acc-4f749b151f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63d415b0>]}
[0m03:40:38.901457 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m03:40:38.980734 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m03:40:39.110564 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:40:39.111258 [debug] [MainThread]: Partial parsing: updated file: youtube_project://models/youtube_data/marts/dim_categories.sql
[0m03:40:39.324652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da404dc9-3e82-40c2-9acc-4f749b151f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62a78920>]}
[0m03:40:39.414014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da404dc9-3e82-40c2-9acc-4f749b151f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff621d4b30>]}
[0m03:40:39.414437 [info ] [MainThread]: Found 12 models, 137 data tests, 2 sources, 867 macros
[0m03:40:39.414793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da404dc9-3e82-40c2-9acc-4f749b151f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62a33ec0>]}
[0m03:40:39.416635 [info ] [MainThread]: 
[0m03:40:39.417110 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m03:40:39.417931 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project'
[0m03:40:39.418233 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:40:40.232850 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project, now list_yt-e2e-data-cycle-project_youtube)
[0m03:40:40.234384 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:40:41.042509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da404dc9-3e82-40c2-9acc-4f749b151f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6217e480>]}
[0m03:40:41.043755 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:40:41.044529 [info ] [MainThread]: 
[0m03:40:41.049154 [debug] [Thread-1 (]: Began running node model.youtube_project.dim_categories
[0m03:40:41.049963 [info ] [Thread-1 (]: 1 of 1 START sql table model youtube.dim_categories ............................ [RUN]
[0m03:40:41.050801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now model.youtube_project.dim_categories)
[0m03:40:41.051300 [debug] [Thread-1 (]: Began compiling node model.youtube_project.dim_categories
[0m03:40:41.059732 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_project.dim_categories"
[0m03:40:41.061252 [debug] [Thread-1 (]: Began executing node model.youtube_project.dim_categories
[0m03:40:41.090228 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_project.dim_categories"
[0m03:40:41.091224 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:40:41.092399 [debug] [Thread-1 (]: On model.youtube_project.dim_categories: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "model.youtube_project.dim_categories"} */

  
    

    create or replace table `yt-e2e-data-cycle-project`.`youtube`.`dim_categories`
      
    
    

    OPTIONS()
    as (
      WITH category_data AS (
    SELECT * 
    FROM `yt-e2e-data-cycle-project`.`youtube`.`staging_category`
),

category_lookup AS (
    SELECT * 
    FROM (VALUES
        (1, 'Film & Animation', 'Videos related to film and animation.'),
        (2, 'Autos & Vehicles', 'Videos related to cars, trucks, motorcycles, and vehicles.'),
        (10, 'Music', 'Videos related to music, music videos, and performances.'),
        (15, 'Pets & Animals', 'Videos related to pets, animals, and wildlife.'),
        (17, 'Sports', 'Videos related to sports events, commentary, and athletics.'),
        (18, 'Short Movies', 'Short films and independent films.'),
        (19, 'Travel & Events', 'Videos related to travel and live events.'),
        (20, 'Gaming', 'Videos related to video games, game commentary, and more.'),
        (22, 'People & Blogs', 'Personal vlogs and commentary.'),
        (23, 'Comedy', 'Videos related to comedic content.'),
        (24, 'Entertainment', 'Content related to entertainment and celebrity culture.'),
        (25, 'News & Politics', 'News and political commentary or events.'),
        (26, 'Howto & Style', 'How-to videos and style-related content.'),
        (27, 'Education', 'Educational content for various fields and topics.'),
        (28, 'Science & Technology', 'Videos related to science, tech, and innovations.'),
        (29, 'Nonprofits & Activism', 'Content related to nonprofits, activism, and charitable causes.'),
        (30, 'Movies', 'Full-length movies, movie trailers, and related content.'),
        (31, 'Anime & Animation', 'Anime series, animation, and related content.'),
        (32, 'Action & Adventure', 'Videos related to action and adventure content.'),
        (33, 'Classics', 'Classic movies, TV shows, and content.'),
        (34, 'Documentaries', 'Documentaries and docuseries content.'),
        (35, 'Drama', 'Dramas, TV shows, and related content.'),
        (36, 'Family & Parenting', 'Videos related to family life and parenting.'),
        (37, 'Home & Garden', 'Content about home improvement, gardens, and DIY projects.'),
        (38, 'Lifestyle', 'Videos about lifestyle, health, wellness, and more.'),
        (39, 'Music Videos', 'Music video content, including live and pre-recorded.'),
        (40, 'Reality TV', 'Reality TV shows and unscripted content.')
    ) AS lookup(category_id, category_name, category_description)
)

SELECT 
    ROW_NUMBER() OVER (ORDER BY c.category_id) as pk_category_id,  
    c.category_id AS category_id,
    COALESCE(s.category_name, l.category_name) AS category_name,
    COALESCE(s.category_description, l.category_description) AS category_description
FROM category_data c
LEFT JOIN category_lookup l 
    ON c.category_id = l.category_id
    );
  
[0m03:40:41.964532 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:1f1aa21a-904c-4068-bf98-ddb0b4fc3fd3&page=queryresults
[0m03:40:41.966732 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword JOIN but got "," at [21:73]; reason: invalidQuery, location: query, message: Syntax error: Expected keyword JOIN but got "," at [21:73]')
[0m03:40:42.472962 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:ad29fa99-2c98-4ad4-80e2-41d9cdceae89&page=queryresults
[0m03:40:42.474654 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:ad29fa99-2c98-4ad4-80e2-41d9cdceae89&page=queryresults
[0m03:40:42.483781 [debug] [Thread-1 (]: Database Error in model dim_categories (models/youtube_data/marts/dim_categories.sql)
  Syntax error: Expected keyword JOIN but got "," at [21:73]
  compiled code at target/run/youtube_project/models/youtube_data/marts/dim_categories.sql
[0m03:40:42.486067 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da404dc9-3e82-40c2-9acc-4f749b151f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ff79820>]}
[0m03:40:42.487250 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model youtube.dim_categories ................... [[31mERROR[0m in 1.43s]
[0m03:40:42.488482 [debug] [Thread-1 (]: Finished running node model.youtube_project.dim_categories
[0m03:40:42.491739 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:40:42.492372 [debug] [MainThread]: Connection 'model.youtube_project.dim_categories' was properly closed.
[0m03:40:42.493067 [info ] [MainThread]: 
[0m03:40:42.493957 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.08 seconds (3.08s).
[0m03:40:42.495580 [debug] [MainThread]: Command end result
[0m03:40:42.638250 [info ] [MainThread]: 
[0m03:40:42.638702 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:40:42.639048 [info ] [MainThread]: 
[0m03:40:42.639473 [error] [MainThread]:   Database Error in model dim_categories (models/youtube_data/marts/dim_categories.sql)
  Syntax error: Expected keyword JOIN but got "," at [21:73]
  compiled code at target/run/youtube_project/models/youtube_data/marts/dim_categories.sql
[0m03:40:42.639743 [info ] [MainThread]: 
[0m03:40:42.640018 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:40:42.640944 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.4432364, "process_in_blocks": "0", "process_kernel_time": 0.281117, "process_mem_max_rss": "225416", "process_out_blocks": "8220", "process_user_time": 2.656008}
[0m03:40:42.641312 [debug] [MainThread]: Command `dbt run` failed at 03:40:42.641249 after 4.44 seconds
[0m03:40:42.641577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f8fc470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff628fff20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80aec4d0>]}
[0m03:40:42.641823 [debug] [MainThread]: Flushing usage events
[0m03:42:44.049591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87ca9880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bd3d1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87c5dd30>]}


============================== 03:42:44.050922 | 76e30616-08bf-4ced-a5bd-82c80e8ab141 ==============================
[0m03:42:44.050922 [info ] [MainThread]: Running with dbt=1.8.9
[0m03:42:44.051301 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --models youtube_data.marts.dim_categories', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'log_path': '/usr/local/airflow/include/dbt/logs', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'no_print': 'None', 'quiet': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'debug': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'printer_width': '80', 'empty': 'False', 'introspect': 'True', 'use_experimental_parser': 'False'}
[0m03:42:44.683560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76e30616-08bf-4ced-a5bd-82c80e8ab141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bc01790>]}
[0m03:42:44.708495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76e30616-08bf-4ced-a5bd-82c80e8ab141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff891ae5d0>]}
[0m03:42:44.708908 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m03:42:44.771651 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m03:42:44.894445 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:42:44.895100 [debug] [MainThread]: Partial parsing: updated file: youtube_project://models/youtube_data/marts/dim_categories.sql
[0m03:42:45.106797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76e30616-08bf-4ced-a5bd-82c80e8ab141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b194680>]}
[0m03:42:45.187762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76e30616-08bf-4ced-a5bd-82c80e8ab141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ad005f0>]}
[0m03:42:45.188156 [info ] [MainThread]: Found 12 models, 137 data tests, 2 sources, 867 macros
[0m03:42:45.188444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76e30616-08bf-4ced-a5bd-82c80e8ab141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ab42c90>]}
[0m03:42:45.190281 [info ] [MainThread]: 
[0m03:42:45.190742 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m03:42:45.191428 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project'
[0m03:42:45.191726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:42:46.084454 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project, now list_yt-e2e-data-cycle-project_youtube)
[0m03:42:46.085572 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:42:46.899202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76e30616-08bf-4ced-a5bd-82c80e8ab141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ab2b320>]}
[0m03:42:46.900667 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:42:46.901648 [info ] [MainThread]: 
[0m03:42:46.906530 [debug] [Thread-1 (]: Began running node model.youtube_project.dim_categories
[0m03:42:46.907596 [info ] [Thread-1 (]: 1 of 1 START sql table model youtube.dim_categories ............................ [RUN]
[0m03:42:46.908548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now model.youtube_project.dim_categories)
[0m03:42:46.909408 [debug] [Thread-1 (]: Began compiling node model.youtube_project.dim_categories
[0m03:42:46.925545 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_project.dim_categories"
[0m03:42:46.927340 [debug] [Thread-1 (]: Began executing node model.youtube_project.dim_categories
[0m03:42:46.963465 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_project.dim_categories"
[0m03:42:46.964715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:42:46.976150 [debug] [Thread-1 (]: On model.youtube_project.dim_categories: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "model.youtube_project.dim_categories"} */

  
    

    create or replace table `yt-e2e-data-cycle-project`.`youtube`.`dim_categories`
      
    
    

    OPTIONS()
    as (
      WITH category_data AS (
    SELECT * 
    FROM `yt-e2e-data-cycle-project`.`youtube`.`staging_category`
),

category_lookup AS (
    SELECT * 
    FROM (VALUES
        (1, 'Film & Animation', 'Videos related to film and animation.'),
        (2, 'Autos & Vehicles', 'Videos related to cars, trucks, motorcycles, and vehicles.'),
        (10, 'Music', 'Videos related to music, music videos, and performances.'),
        (15, 'Pets & Animals', 'Videos related to pets, animals, and wildlife.'),
        (17, 'Sports', 'Videos related to sports events, commentary, and athletics.'),
        (18, 'Short Movies', 'Short films and independent films.'),
        (19, 'Travel & Events', 'Videos related to travel and live events.'),
        (20, 'Gaming', 'Videos related to video games, game commentary, and more.'),
        (22, 'People & Blogs', 'Personal vlogs and commentary.'),
        (23, 'Comedy', 'Videos related to comedic content.'),
        (24, 'Entertainment', 'Content related to entertainment and celebrity culture.'),
        (25, 'News & Politics', 'News and political commentary or events.'),
        (26, 'Howto & Style', 'How-to videos and style-related content.'),
        (27, 'Education', 'Educational content for various fields and topics.'),
        (28, 'Science & Technology', 'Videos related to science, tech, and innovations.'),
        (29, 'Nonprofits & Activism', 'Content related to nonprofits, activism, and charitable causes.'),
        (30, 'Movies', 'Full-length movies, movie trailers, and related content.'),
        (31, 'Anime & Animation', 'Anime series, animation, and related content.'),
        (32, 'Action & Adventure', 'Videos related to action and adventure content.'),
        (33, 'Classics', 'Classic movies, TV shows, and content.'),
        (34, 'Documentaries', 'Documentaries and docuseries content.'),
        (35, 'Drama', 'Dramas, TV shows, and related content.'),
        (36, 'Family & Parenting', 'Videos related to family life and parenting.'),
        (37, 'Home & Garden', 'Content about home improvement, gardens, and DIY projects.'),
        (38, 'Lifestyle', 'Videos about lifestyle, health, wellness, and more.'),
        (39, 'Music Videos', 'Music video content, including live and pre-recorded.'),
        (40, 'Reality TV', 'Reality TV shows and unscripted content.')
    ) AS lookup(category_id, category_name, category_description)
)

SELECT 
    ROW_NUMBER() OVER (ORDER BY c.category_id) as pk_category_id,  
    c.category_id AS category_id,
    COALESCE(s.category_name, l.category_name) AS category_name,
    COALESCE(s.category_description, l.category_description) AS category_description
FROM category_data c
LEFT JOIN category_lookup l  
    ON c.category_id = l.category_id
    );
  
[0m03:42:47.818556 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:95ea880e-9151-48b9-94fb-910cf73896da&page=queryresults
[0m03:42:47.820916 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword JOIN but got "," at [21:73]; reason: invalidQuery, location: query, message: Syntax error: Expected keyword JOIN but got "," at [21:73]')
[0m03:42:49.161717 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:e6a83330-b01c-4020-b5d5-3b25c0709512&page=queryresults
[0m03:42:49.164278 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:e6a83330-b01c-4020-b5d5-3b25c0709512&page=queryresults
[0m03:42:49.174892 [debug] [Thread-1 (]: Database Error in model dim_categories (models/youtube_data/marts/dim_categories.sql)
  Syntax error: Expected keyword JOIN but got "," at [21:73]
  compiled code at target/run/youtube_project/models/youtube_data/marts/dim_categories.sql
[0m03:42:49.177671 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76e30616-08bf-4ced-a5bd-82c80e8ab141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b0c00e0>]}
[0m03:42:49.178971 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model youtube.dim_categories ................... [[31mERROR[0m in 2.27s]
[0m03:42:49.180176 [debug] [Thread-1 (]: Finished running node model.youtube_project.dim_categories
[0m03:42:49.183397 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:42:49.184000 [debug] [MainThread]: Connection 'model.youtube_project.dim_categories' was properly closed.
[0m03:42:49.184594 [info ] [MainThread]: 
[0m03:42:49.185240 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.99 seconds (3.99s).
[0m03:42:49.186692 [debug] [MainThread]: Command end result
[0m03:42:49.322991 [info ] [MainThread]: 
[0m03:42:49.323413 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:42:49.323829 [info ] [MainThread]: 
[0m03:42:49.324221 [error] [MainThread]:   Database Error in model dim_categories (models/youtube_data/marts/dim_categories.sql)
  Syntax error: Expected keyword JOIN but got "," at [21:73]
  compiled code at target/run/youtube_project/models/youtube_data/marts/dim_categories.sql
[0m03:42:49.324514 [info ] [MainThread]: 
[0m03:42:49.324830 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:42:49.325717 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.3005853, "process_in_blocks": "0", "process_kernel_time": 0.277286, "process_mem_max_rss": "225332", "process_out_blocks": "8220", "process_user_time": 2.634724}
[0m03:42:49.326055 [debug] [MainThread]: Command `dbt run` failed at 03:42:49.325992 after 5.30 seconds
[0m03:42:49.326314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87f8f980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88066db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff883c9eb0>]}
[0m03:42:49.326592 [debug] [MainThread]: Flushing usage events
[0m03:49:03.307645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d08d730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cc85400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cc87bf0>]}


============================== 03:49:03.308984 | f82f8357-8ea3-4335-a98e-ee44362190b8 ==============================
[0m03:49:03.308984 [info ] [MainThread]: Running with dbt=1.8.9
[0m03:49:03.309471 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'invocation_command': 'dbt run --models youtube_data.marts.dim_categories', 'warn_error': 'None', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'empty': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'target_path': 'None', 'introspect': 'True', 'no_print': 'None', 'log_format': 'default', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '/usr/local/airflow/include/dbt'}
[0m03:49:03.933428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f82f8357-8ea3-4335-a98e-ee44362190b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff814ba4e0>]}
[0m03:49:03.957932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f82f8357-8ea3-4335-a98e-ee44362190b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff803737a0>]}
[0m03:49:03.958320 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m03:49:04.025002 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m03:49:04.155614 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:49:04.156264 [debug] [MainThread]: Partial parsing: updated file: youtube_project://models/youtube_data/marts/dim_categories.sql
[0m03:49:04.411118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f82f8357-8ea3-4335-a98e-ee44362190b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff800c3e90>]}
[0m03:49:04.505387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f82f8357-8ea3-4335-a98e-ee44362190b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fd006e0>]}
[0m03:49:04.505779 [info ] [MainThread]: Found 12 models, 137 data tests, 2 sources, 867 macros
[0m03:49:04.506081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f82f8357-8ea3-4335-a98e-ee44362190b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8004aba0>]}
[0m03:49:04.507932 [info ] [MainThread]: 
[0m03:49:04.508410 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m03:49:04.509057 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project'
[0m03:49:04.509301 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:49:05.387708 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project, now list_yt-e2e-data-cycle-project_youtube)
[0m03:49:05.388658 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:49:06.307909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f82f8357-8ea3-4335-a98e-ee44362190b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fd48800>]}
[0m03:49:06.310677 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:49:06.311922 [info ] [MainThread]: 
[0m03:49:06.319042 [debug] [Thread-1 (]: Began running node model.youtube_project.dim_categories
[0m03:49:06.320302 [info ] [Thread-1 (]: 1 of 1 START sql table model youtube.dim_categories ............................ [RUN]
[0m03:49:06.321475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now model.youtube_project.dim_categories)
[0m03:49:06.322245 [debug] [Thread-1 (]: Began compiling node model.youtube_project.dim_categories
[0m03:49:06.338683 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_project.dim_categories"
[0m03:49:06.341046 [debug] [Thread-1 (]: Began executing node model.youtube_project.dim_categories
[0m03:49:06.389401 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_project.dim_categories"
[0m03:49:06.390791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:49:06.392662 [debug] [Thread-1 (]: On model.youtube_project.dim_categories: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "model.youtube_project.dim_categories"} */

  
    

    create or replace table `yt-e2e-data-cycle-project`.`youtube`.`dim_categories`
      
    
    

    OPTIONS()
    as (
      WITH category_data AS (
    SELECT * 
    FROM `yt-e2e-data-cycle-project`.`youtube`.`staging_category`
),

category_lookup AS (
    SELECT * 
    FROM (VALUES
        (1, 'Film & Animation', 'Videos related to film and animation.'),
        (2, 'Autos & Vehicles', 'Videos related to cars, trucks, motorcycles, and vehicles.'),
        (10, 'Music', 'Videos related to music, music videos, and performances.'),
        (15, 'Pets & Animals', 'Videos related to pets, animals, and wildlife.'),
        (17, 'Sports', 'Videos related to sports events, commentary, and athletics.'),
        (18, 'Short Movies', 'Short films and independent films.'),
        (19, 'Travel & Events', 'Videos related to travel and live events.'),
        (20, 'Gaming', 'Videos related to video games, game commentary, and more.'),
        (22, 'People & Blogs', 'Personal vlogs and commentary.'),
        (23, 'Comedy', 'Videos related to comedic content.'),
        (24, 'Entertainment', 'Content related to entertainment and celebrity culture.'),
        (25, 'News & Politics', 'News and political commentary or events.'),
        (26, 'Howto & Style', 'How-to videos and style-related content.'),
        (27, 'Education', 'Educational content for various fields and topics.'),
        (28, 'Science & Technology', 'Videos related to science, tech, and innovations.'),
        (29, 'Nonprofits & Activism', 'Content related to nonprofits, activism, and charitable causes.'),
        (30, 'Movies', 'Full-length movies, movie trailers, and related content.'),
        (31, 'Anime & Animation', 'Anime series, animation, and related content.'),
        (32, 'Action & Adventure', 'Videos related to action and adventure content.'),
        (33, 'Classics', 'Classic movies, TV shows, and content.'),
        (34, 'Documentaries', 'Documentaries and docuseries content.'),
        (35, 'Drama', 'Dramas, TV shows, and related content.'),
        (36, 'Family & Parenting', 'Videos related to family life and parenting.'),
        (37, 'Home & Garden', 'Content about home improvement, gardens, and DIY projects.'),
        (38, 'Lifestyle', 'Videos about lifestyle, health, wellness, and more.'),
        (39, 'Music Videos', 'Music video content, including live and pre-recorded.'),
        (40, 'Reality TV', 'Reality TV shows and unscripted content.')
    ) AS lookup(category_id, category_name, category_description)
)

SELECT 
    ROW_NUMBER() OVER (ORDER BY c.category_id) as pk_category_id,  
    c.category_id AS category_id,
    COALESCE(c.category_name, l.category_name) AS category_name,
    COALESCE(c.category_description, l.category_description) AS category_description
FROM category_data c
LEFT JOIN category_lookup l  
    ON c.category_id = l.category_id
    );
  
[0m03:49:07.220260 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:9eb92d8c-1762-4ac7-94fa-b0b064dcf03a&page=queryresults
[0m03:49:07.221557 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword JOIN but got "," at [21:73]; reason: invalidQuery, location: query, message: Syntax error: Expected keyword JOIN but got "," at [21:73]')
[0m03:49:08.038159 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:4de1d528-dff6-4096-b193-d70ad78812ae&page=queryresults
[0m03:49:08.039623 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:4de1d528-dff6-4096-b193-d70ad78812ae&page=queryresults
[0m03:49:08.050834 [debug] [Thread-1 (]: Database Error in model dim_categories (models/youtube_data/marts/dim_categories.sql)
  Syntax error: Expected keyword JOIN but got "," at [21:73]
  compiled code at target/run/youtube_project/models/youtube_data/marts/dim_categories.sql
[0m03:49:08.053839 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f82f8357-8ea3-4335-a98e-ee44362190b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff800c1010>]}
[0m03:49:08.056320 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model youtube.dim_categories ................... [[31mERROR[0m in 1.73s]
[0m03:49:08.059027 [debug] [Thread-1 (]: Finished running node model.youtube_project.dim_categories
[0m03:49:08.064762 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:49:08.065507 [debug] [MainThread]: Connection 'model.youtube_project.dim_categories' was properly closed.
[0m03:49:08.066174 [info ] [MainThread]: 
[0m03:49:08.066834 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.56 seconds (3.56s).
[0m03:49:08.068323 [debug] [MainThread]: Command end result
[0m03:49:08.234602 [info ] [MainThread]: 
[0m03:49:08.235084 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:49:08.235446 [info ] [MainThread]: 
[0m03:49:08.235876 [error] [MainThread]:   Database Error in model dim_categories (models/youtube_data/marts/dim_categories.sql)
  Syntax error: Expected keyword JOIN but got "," at [21:73]
  compiled code at target/run/youtube_project/models/youtube_data/marts/dim_categories.sql
[0m03:49:08.236141 [info ] [MainThread]: 
[0m03:49:08.236451 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:49:08.237384 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.9540844, "process_in_blocks": "0", "process_kernel_time": 0.277863, "process_mem_max_rss": "225436", "process_out_blocks": "8220", "process_user_time": 2.727473}
[0m03:49:08.237756 [debug] [MainThread]: Command `dbt run` failed at 03:49:08.237684 after 4.95 seconds
[0m03:49:08.238005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80e46420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff906b3e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff951d3620>]}
[0m03:49:08.238215 [debug] [MainThread]: Flushing usage events
[0m03:57:02.716351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa26c2b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2c9a7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa26c1970>]}


============================== 03:57:02.718032 | 34c742ef-a3ad-4d02-b611-2b2599f37fd0 ==============================
[0m03:57:02.718032 [info ] [MainThread]: Running with dbt=1.8.9
[0m03:57:02.718775 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'use_colors': 'True', 'introspect': 'True', 'write_json': 'True', 'printer_width': '80', 'target_path': 'None', 'warn_error': 'None', 'empty': 'False', 'invocation_command': 'dbt run --models youtube_data.marts.dim_categories', 'quiet': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'no_print': 'None', 'log_format': 'default', 'log_path': '/usr/local/airflow/include/dbt/logs', 'static_parser': 'True', 'debug': 'False'}
[0m03:57:03.361087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34c742ef-a3ad-4d02-b611-2b2599f37fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85355fd0>]}
[0m03:57:03.385889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34c742ef-a3ad-4d02-b611-2b2599f37fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff856e0110>]}
[0m03:57:03.386281 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m03:57:03.454344 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m03:57:03.582925 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:57:03.583599 [debug] [MainThread]: Partial parsing: updated file: youtube_project://models/youtube_data/marts/dim_categories.sql
[0m03:57:03.794434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34c742ef-a3ad-4d02-b611-2b2599f37fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff851ab410>]}
[0m03:57:03.876702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34c742ef-a3ad-4d02-b611-2b2599f37fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84f80aa0>]}
[0m03:57:03.877104 [info ] [MainThread]: Found 12 models, 137 data tests, 2 sources, 867 macros
[0m03:57:03.877443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34c742ef-a3ad-4d02-b611-2b2599f37fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84c45e20>]}
[0m03:57:03.879401 [info ] [MainThread]: 
[0m03:57:03.879831 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m03:57:03.880555 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project'
[0m03:57:03.880834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:57:04.734053 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project, now list_yt-e2e-data-cycle-project_youtube)
[0m03:57:04.735725 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:57:05.446546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34c742ef-a3ad-4d02-b611-2b2599f37fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3362780>]}
[0m03:57:05.447865 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:57:05.448958 [info ] [MainThread]: 
[0m03:57:05.453878 [debug] [Thread-1 (]: Began running node model.youtube_project.dim_categories
[0m03:57:05.454930 [info ] [Thread-1 (]: 1 of 1 START sql table model youtube.dim_categories ............................ [RUN]
[0m03:57:05.455855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now model.youtube_project.dim_categories)
[0m03:57:05.456659 [debug] [Thread-1 (]: Began compiling node model.youtube_project.dim_categories
[0m03:57:05.467915 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_project.dim_categories"
[0m03:57:05.470535 [debug] [Thread-1 (]: Began executing node model.youtube_project.dim_categories
[0m03:57:05.507198 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_project.dim_categories"
[0m03:57:05.508421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:57:05.509851 [debug] [Thread-1 (]: On model.youtube_project.dim_categories: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "model.youtube_project.dim_categories"} */

  
    

    create or replace table `yt-e2e-data-cycle-project`.`youtube`.`dim_categories`
      
    
    

    OPTIONS()
    as (
      WITH category_data AS (
    SELECT * 
    FROM `yt-e2e-data-cycle-project`.`youtube`.`staging_category`
),

category_lookup AS (
    SELECT * 
    FROM (VALUES
        (1, 'Film & Animation', 'Videos related to film and animation.'),
        (2, 'Autos & Vehicles', 'Videos related to cars, trucks, motorcycles, and vehicles.'),
        (10, 'Music', 'Videos related to music, music videos, and performances.'),
        (15, 'Pets & Animals', 'Videos related to pets, animals, and wildlife.'),
        (17, 'Sports', 'Videos related to sports events, commentary, and athletics.'),
        (18, 'Short Movies', 'Short films and independent films.'),
        (19, 'Travel & Events', 'Videos related to travel and live events.'),
        (20, 'Gaming', 'Videos related to video games, game commentary, and more.'),
        (22, 'People & Blogs', 'Personal vlogs and commentary.'),
        (23, 'Comedy', 'Videos related to comedic content.'),
        (24, 'Entertainment', 'Content related to entertainment and celebrity culture.'),
        (25, 'News & Politics', 'News and political commentary or events.'),
        (26, 'Howto & Style', 'How-to videos and style-related content.'),
        (27, 'Education', 'Educational content for various fields and topics.'),
        (28, 'Science & Technology', 'Videos related to science, tech, and innovations.'),
        (29, 'Nonprofits & Activism', 'Content related to nonprofits, activism, and charitable causes.'),
        (30, 'Movies', 'Full-length movies, movie trailers, and related content.'),
        (31, 'Anime & Animation', 'Anime series, animation, and related content.'),
        (32, 'Action & Adventure', 'Videos related to action and adventure content.'),
        (33, 'Classics', 'Classic movies, TV shows, and content.'),
        (34, 'Documentaries', 'Documentaries and docuseries content.'),
        (35, 'Drama', 'Dramas, TV shows, and related content.'),
        (36, 'Family & Parenting', 'Videos related to family life and parenting.'),
        (37, 'Home & Garden', 'Content about home improvement, gardens, and DIY projects.'),
        (38, 'Lifestyle', 'Videos about lifestyle, health, wellness, and more.'),
        (39, 'Music Videos', 'Music video content, including live and pre-recorded.'),
        (40, 'Reality TV', 'Reality TV shows and unscripted content.')
    ) AS lookup(category_id, category_name, category_description)
)

SELECT 
    ROW_NUMBER() OVER (ORDER BY c.category_id) AS pk_category_id,  
    c.category_id AS category_id,
    COALESCE(c.category_name, l.category_name) AS category_name,
    COALESCE(c.category_description, l.category_description) AS category_description
FROM category_data c
LEFT JOIN category_lookup l  
    ON c.category_id = l.category_id
    );
  
[0m03:57:06.367979 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:6dc697ad-0ba4-4057-8035-3f69edf76d4b&page=queryresults
[0m03:57:06.370269 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword JOIN but got "," at [21:73]; reason: invalidQuery, location: query, message: Syntax error: Expected keyword JOIN but got "," at [21:73]')
[0m03:57:07.597921 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:d0602ea6-2ef4-4e02-855c-6879ea8312b4&page=queryresults
[0m03:57:07.600690 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:d0602ea6-2ef4-4e02-855c-6879ea8312b4&page=queryresults
[0m03:57:07.611508 [debug] [Thread-1 (]: Database Error in model dim_categories (models/youtube_data/marts/dim_categories.sql)
  Syntax error: Expected keyword JOIN but got "," at [21:73]
  compiled code at target/run/youtube_project/models/youtube_data/marts/dim_categories.sql
[0m03:57:07.615069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34c742ef-a3ad-4d02-b611-2b2599f37fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2725730>]}
[0m03:57:07.616492 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model youtube.dim_categories ................... [[31mERROR[0m in 2.16s]
[0m03:57:07.617819 [debug] [Thread-1 (]: Finished running node model.youtube_project.dim_categories
[0m03:57:07.620978 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:57:07.621574 [debug] [MainThread]: Connection 'model.youtube_project.dim_categories' was properly closed.
[0m03:57:07.622207 [info ] [MainThread]: 
[0m03:57:07.622884 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.74 seconds (3.74s).
[0m03:57:07.624532 [debug] [MainThread]: Command end result
[0m03:57:07.752757 [info ] [MainThread]: 
[0m03:57:07.753140 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:57:07.753531 [info ] [MainThread]: 
[0m03:57:07.753955 [error] [MainThread]:   Database Error in model dim_categories (models/youtube_data/marts/dim_categories.sql)
  Syntax error: Expected keyword JOIN but got "," at [21:73]
  compiled code at target/run/youtube_project/models/youtube_data/marts/dim_categories.sql
[0m03:57:07.754230 [info ] [MainThread]: 
[0m03:57:07.754523 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:57:07.755341 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.066973, "process_in_blocks": "0", "process_kernel_time": 0.310426, "process_mem_max_rss": "225444", "process_out_blocks": "8220", "process_user_time": 2.595289}
[0m03:57:07.755688 [debug] [MainThread]: Command `dbt run` failed at 03:57:07.755624 after 5.07 seconds
[0m03:57:07.755944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8567cd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa205b3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1ea88f0>]}
[0m03:57:07.756176 [debug] [MainThread]: Flushing usage events
[0m04:03:41.457310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2fd5790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb39531a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2fd4f80>]}


============================== 04:03:41.458793 | 7cce9b4d-d91d-4d21-bfaf-d83d3d30d1b6 ==============================
[0m04:03:41.458793 [info ] [MainThread]: Running with dbt=1.8.9
[0m04:03:41.459252 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'no_print': 'None', 'partial_parse': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --models youtube_data.marts.dim_categories', 'use_colors': 'True', 'empty': 'False', 'printer_width': '80'}
[0m04:03:42.120262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7cce9b4d-d91d-4d21-bfaf-d83d3d30d1b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb261e870>]}
[0m04:03:42.144575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7cce9b4d-d91d-4d21-bfaf-d83d3d30d1b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3c0e6f0>]}
[0m04:03:42.144958 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m04:03:42.215551 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m04:03:42.345784 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:03:42.346466 [debug] [MainThread]: Partial parsing: updated file: youtube_project://models/youtube_data/marts/dim_categories.sql
[0m04:03:42.557988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7cce9b4d-d91d-4d21-bfaf-d83d3d30d1b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95114f80>]}
[0m04:03:42.638919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7cce9b4d-d91d-4d21-bfaf-d83d3d30d1b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9569fce0>]}
[0m04:03:42.639340 [info ] [MainThread]: Found 12 models, 137 data tests, 2 sources, 867 macros
[0m04:03:42.639661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cce9b4d-d91d-4d21-bfaf-d83d3d30d1b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff956fc080>]}
[0m04:03:42.641581 [info ] [MainThread]: 
[0m04:03:42.642085 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m04:03:42.642774 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project'
[0m04:03:42.643035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:03:43.659219 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project, now list_yt-e2e-data-cycle-project_youtube)
[0m04:03:43.660575 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:03:44.489108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cce9b4d-d91d-4d21-bfaf-d83d3d30d1b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95dbfb60>]}
[0m04:03:44.490804 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:03:44.491722 [info ] [MainThread]: 
[0m04:03:44.497415 [debug] [Thread-1 (]: Began running node model.youtube_project.dim_categories
[0m04:03:44.498499 [info ] [Thread-1 (]: 1 of 1 START sql table model youtube.dim_categories ............................ [RUN]
[0m04:03:44.499558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now model.youtube_project.dim_categories)
[0m04:03:44.500329 [debug] [Thread-1 (]: Began compiling node model.youtube_project.dim_categories
[0m04:03:44.515557 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_project.dim_categories"
[0m04:03:44.518666 [debug] [Thread-1 (]: Began executing node model.youtube_project.dim_categories
[0m04:03:44.560962 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_project.dim_categories"
[0m04:03:44.562253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:03:44.563766 [debug] [Thread-1 (]: On model.youtube_project.dim_categories: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "model.youtube_project.dim_categories"} */

  
    

    create or replace table `yt-e2e-data-cycle-project`.`youtube`.`dim_categories`
      
    
    

    OPTIONS()
    as (
      WITH category_data AS (
    SELECT * 
    FROM `yt-e2e-data-cycle-project`.`youtube`.`staging_category`
),

category_lookup AS (
    SELECT 
        category_id,
        category_name,
        category_description
    FROM UNNEST([
        STRUCT(1 AS category_id, 'Film & Animation' AS category_name, 'Videos related to film and animation.' AS category_description),
        STRUCT(2 AS category_id, 'Autos & Vehicles' AS category_name, 'Videos related to cars, trucks, motorcycles, and vehicles.' AS category_description),
        STRUCT(10 AS category_id, 'Music' AS category_name, 'Videos related to music, music videos, and performances.' AS category_description),
        STRUCT(15 AS category_id, 'Pets & Animals' AS category_name, 'Videos related to pets, animals, and wildlife.' AS category_description),
        STRUCT(17 AS category_id, 'Sports' AS category_name, 'Videos related to sports events, commentary, and athletics.' AS category_description),
        STRUCT(18 AS category_id, 'Short Movies' AS category_name, 'Short films and independent films.' AS category_description),
        STRUCT(19 AS category_id, 'Travel & Events' AS category_name, 'Videos related to travel and live events.' AS category_description),
        STRUCT(20 AS category_id, 'Gaming' AS category_name, 'Videos related to video games, game commentary, and more.' AS category_description),
        STRUCT(22 AS category_id, 'People & Blogs' AS category_name, 'Personal vlogs and commentary.' AS category_description),
        STRUCT(23 AS category_id, 'Comedy' AS category_name, 'Videos related to comedic content.' AS category_description),
        STRUCT(24 AS category_id, 'Entertainment' AS category_name, 'Content related to entertainment and celebrity culture.' AS category_description),
        STRUCT(25 AS category_id, 'News & Politics' AS category_name, 'News and political commentary or events.' AS category_description),
        STRUCT(26 AS category_id, 'Howto & Style' AS category_name, 'How-to videos and style-related content.' AS category_description),
        STRUCT(27 AS category_id, 'Education' AS category_name, 'Educational content for various fields and topics.' AS category_description),
        STRUCT(28 AS category_id, 'Science & Technology' AS category_name, 'Videos related to science, tech, and innovations.' AS category_description),
        STRUCT(29 AS category_id, 'Nonprofits & Activism' AS category_name, 'Content related to nonprofits, activism, and charitable causes.' AS category_description),
        STRUCT(30 AS category_id, 'Movies' AS category_name, 'Full-length movies, movie trailers, and related content.' AS category_description),
        STRUCT(31 AS category_id, 'Anime & Animation' AS category_name, 'Anime series, animation, and related content.' AS category_description),
        STRUCT(32 AS category_id, 'Action & Adventure' AS category_name, 'Videos related to action and adventure content.' AS category_description),
        STRUCT(33 AS category_id, 'Classics' AS category_name, 'Classic movies, TV shows, and content.' AS category_description),
        STRUCT(34 AS category_id, 'Documentaries' AS category_name, 'Documentaries and docuseries content.' AS category_description),
        STRUCT(35 AS category_id, 'Drama' AS category_name, 'Dramas, TV shows, and related content.' AS category_description),
        STRUCT(36 AS category_id, 'Family & Parenting' AS category_name, 'Videos related to family life and parenting.' AS category_description),
        STRUCT(37 AS category_id, 'Home & Garden' AS category_name, 'Content about home improvement, gardens, and DIY projects.' AS category_description),
        STRUCT(38 AS category_id, 'Lifestyle' AS category_name, 'Videos about lifestyle, health, wellness, and more.' AS category_description),
        STRUCT(39 AS category_id, 'Music Videos' AS category_name, 'Music video content, including live and pre-recorded.' AS category_description),
        STRUCT(40 AS category_id, 'Reality TV' AS category_name, 'Reality TV shows and unscripted content.' AS category_description)
    ]) AS lookup
)

SELECT 
    ROW_NUMBER() OVER (ORDER BY c.category_id) AS pk_category_id,  
    c.category_id AS category_id,
    COALESCE(c.category_name, l.category_name) AS category_name,
    COALESCE(c.category_description, l.category_description) AS category_description
FROM category_data c
LEFT JOIN category_lookup l  
    ON c.category_id = l.category_id
    );
  
[0m04:03:45.409293 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:217640e5-7d2c-48c6-b088-91a41265fe8b&page=queryresults
[0m04:03:45.412388 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword LOOKUP at [51:11]; reason: invalidQuery, location: query, message: Syntax error: Unexpected keyword LOOKUP at [51:11]')
[0m04:03:46.535276 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:c3783ee7-eee1-4aa2-9c35-f5813271d3fc&page=queryresults
[0m04:03:46.538115 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:c3783ee7-eee1-4aa2-9c35-f5813271d3fc&page=queryresults
[0m04:03:46.553930 [debug] [Thread-1 (]: Database Error in model dim_categories (models/youtube_data/marts/dim_categories.sql)
  Syntax error: Unexpected keyword LOOKUP at [51:11]
  compiled code at target/run/youtube_project/models/youtube_data/marts/dim_categories.sql
[0m04:03:46.559999 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cce9b4d-d91d-4d21-bfaf-d83d3d30d1b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95ac1670>]}
[0m04:03:46.562839 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model youtube.dim_categories ................... [[31mERROR[0m in 2.06s]
[0m04:03:46.565696 [debug] [Thread-1 (]: Finished running node model.youtube_project.dim_categories
[0m04:03:46.572249 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:03:46.573086 [debug] [MainThread]: Connection 'model.youtube_project.dim_categories' was properly closed.
[0m04:03:46.574198 [info ] [MainThread]: 
[0m04:03:46.575311 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.93 seconds (3.93s).
[0m04:03:46.577809 [debug] [MainThread]: Command end result
[0m04:03:46.790867 [info ] [MainThread]: 
[0m04:03:46.791385 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:03:46.791828 [info ] [MainThread]: 
[0m04:03:46.792309 [error] [MainThread]:   Database Error in model dim_categories (models/youtube_data/marts/dim_categories.sql)
  Syntax error: Unexpected keyword LOOKUP at [51:11]
  compiled code at target/run/youtube_project/models/youtube_data/marts/dim_categories.sql
[0m04:03:46.792596 [info ] [MainThread]: 
[0m04:03:46.792983 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m04:03:46.794152 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.361199, "process_in_blocks": "0", "process_kernel_time": 0.323801, "process_mem_max_rss": "225600", "process_out_blocks": "8249", "process_user_time": 2.776014}
[0m04:03:46.794538 [debug] [MainThread]: Command `dbt run` failed at 04:03:46.794475 after 5.36 seconds
[0m04:03:46.794816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff968a2f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97bd9520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb36c3dd0>]}
[0m04:03:46.795053 [debug] [MainThread]: Flushing usage events
[0m04:06:23.307025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff998eeb70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99158a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9905d640>]}


============================== 04:06:23.308490 | e521c64d-4053-4267-9281-bb0a948adc59 ==============================
[0m04:06:23.308490 [info ] [MainThread]: Running with dbt=1.8.9
[0m04:06:23.308902 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'no_print': 'None', 'debug': 'False', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '/usr/local/airflow/include/dbt', 'empty': 'False', 'log_format': 'default', 'version_check': 'True', 'use_colors': 'True', 'quiet': 'False', 'invocation_command': 'dbt run --models youtube_data.marts.dim_categories', 'printer_width': '80', 'cache_selected_only': 'False', 'fail_fast': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False'}
[0m04:06:23.993189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e521c64d-4053-4267-9281-bb0a948adc59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff979e0f50>]}
[0m04:06:24.017753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e521c64d-4053-4267-9281-bb0a948adc59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d430ec0>]}
[0m04:06:24.018137 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m04:06:24.088107 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m04:06:24.212724 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:06:24.213409 [debug] [MainThread]: Partial parsing: updated file: youtube_project://models/youtube_data/marts/dim_categories.sql
[0m04:06:24.430392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e521c64d-4053-4267-9281-bb0a948adc59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bcda0f0>]}
[0m04:06:24.518274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e521c64d-4053-4267-9281-bb0a948adc59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bcda5a0>]}
[0m04:06:24.518668 [info ] [MainThread]: Found 12 models, 137 data tests, 2 sources, 867 macros
[0m04:06:24.519013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e521c64d-4053-4267-9281-bb0a948adc59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c078830>]}
[0m04:06:24.520975 [info ] [MainThread]: 
[0m04:06:24.521406 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m04:06:24.522099 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project'
[0m04:06:24.522387 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:06:25.327427 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project, now list_yt-e2e-data-cycle-project_youtube)
[0m04:06:25.329281 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:06:26.180844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e521c64d-4053-4267-9281-bb0a948adc59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c0a28d0>]}
[0m04:06:26.183365 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:06:26.184495 [info ] [MainThread]: 
[0m04:06:26.192308 [debug] [Thread-1 (]: Began running node model.youtube_project.dim_categories
[0m04:06:26.193433 [info ] [Thread-1 (]: 1 of 1 START sql table model youtube.dim_categories ............................ [RUN]
[0m04:06:26.194444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now model.youtube_project.dim_categories)
[0m04:06:26.195119 [debug] [Thread-1 (]: Began compiling node model.youtube_project.dim_categories
[0m04:06:26.214366 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_project.dim_categories"
[0m04:06:26.216977 [debug] [Thread-1 (]: Began executing node model.youtube_project.dim_categories
[0m04:06:26.257632 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_project.dim_categories"
[0m04:06:26.258750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:06:26.260514 [debug] [Thread-1 (]: On model.youtube_project.dim_categories: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "model.youtube_project.dim_categories"} */

  
    

    create or replace table `yt-e2e-data-cycle-project`.`youtube`.`dim_categories`
      
    
    

    OPTIONS()
    as (
      WITH category_data AS (
    SELECT * 
    FROM `yt-e2e-data-cycle-project`.`youtube`.`staging_category`
),

category_lookup AS (
    SELECT 
        category_struct.category_id,
        category_struct.category_name,
        category_struct.category_description
    FROM UNNEST([
        STRUCT(1 AS category_id, 'Film & Animation' AS category_name, 'Videos related to film and animation.' AS category_description),
        STRUCT(2 AS category_id, 'Autos & Vehicles' AS category_name, 'Videos related to cars, trucks, motorcycles, and vehicles.' AS category_description),
        STRUCT(10 AS category_id, 'Music' AS category_name, 'Videos related to music, music videos, and performances.' AS category_description),
        STRUCT(15 AS category_id, 'Pets & Animals' AS category_name, 'Videos related to pets, animals, and wildlife.' AS category_description),
        STRUCT(17 AS category_id, 'Sports' AS category_name, 'Videos related to sports events, commentary, and athletics.' AS category_description),
        STRUCT(18 AS category_id, 'Short Movies' AS category_name, 'Short films and independent films.' AS category_description),
        STRUCT(19 AS category_id, 'Travel & Events' AS category_name, 'Videos related to travel and live events.' AS category_description),
        STRUCT(20 AS category_id, 'Gaming' AS category_name, 'Videos related to video games, game commentary, and more.' AS category_description),
        STRUCT(22 AS category_id, 'People & Blogs' AS category_name, 'Personal vlogs and commentary.' AS category_description),
        STRUCT(23 AS category_id, 'Comedy' AS category_name, 'Videos related to comedic content.' AS category_description),
        STRUCT(24 AS category_id, 'Entertainment' AS category_name, 'Content related to entertainment and celebrity culture.' AS category_description),
        STRUCT(25 AS category_id, 'News & Politics' AS category_name, 'News and political commentary or events.' AS category_description),
        STRUCT(26 AS category_id, 'Howto & Style' AS category_name, 'How-to videos and style-related content.' AS category_description),
        STRUCT(27 AS category_id, 'Education' AS category_name, 'Educational content for various fields and topics.' AS category_description),
        STRUCT(28 AS category_id, 'Science & Technology' AS category_name, 'Videos related to science, tech, and innovations.' AS category_description),
        STRUCT(29 AS category_id, 'Nonprofits & Activism' AS category_name, 'Content related to nonprofits, activism, and charitable causes.' AS category_description),
        STRUCT(30 AS category_id, 'Movies' AS category_name, 'Full-length movies, movie trailers, and related content.' AS category_description),
        STRUCT(31 AS category_id, 'Anime & Animation' AS category_name, 'Anime series, animation, and related content.' AS category_description),
        STRUCT(32 AS category_id, 'Action & Adventure' AS category_name, 'Videos related to action and adventure content.' AS category_description),
        STRUCT(33 AS category_id, 'Classics' AS category_name, 'Classic movies, TV shows, and content.' AS category_description),
        STRUCT(34 AS category_id, 'Documentaries' AS category_name, 'Documentaries and docuseries content.' AS category_description),
        STRUCT(35 AS category_id, 'Drama' AS category_name, 'Dramas, TV shows, and related content.' AS category_description),
        STRUCT(36 AS category_id, 'Family & Parenting' AS category_name, 'Videos related to family life and parenting.' AS category_description),
        STRUCT(37 AS category_id, 'Home & Garden' AS category_name, 'Content about home improvement, gardens, and DIY projects.' AS category_description),
        STRUCT(38 AS category_id, 'Lifestyle' AS category_name, 'Videos about lifestyle, health, wellness, and more.' AS category_description),
        STRUCT(39 AS category_id, 'Music Videos' AS category_name, 'Music video content, including live and pre-recorded.' AS category_description),
        STRUCT(40 AS category_id, 'Reality TV' AS category_name, 'Reality TV shows and unscripted content.' AS category_description)
    ]) AS category_struct
)

SELECT 
    ROW_NUMBER() OVER (ORDER BY c.category_id) AS pk_category_id,  
    c.category_id AS category_id,
    COALESCE(c.category_name, l.category_name) AS category_name,
    COALESCE(c.category_description, l.category_description) AS category_description
FROM category_data c
LEFT JOIN category_lookup l  
    ON c.category_id = l.category_id
    );
  
[0m04:06:27.506164 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:47531ffa-2857-41a0-acda-2e65df8f4f93&page=queryresults
[0m04:06:30.463968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e521c64d-4053-4267-9281-bb0a948adc59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d274530>]}
[0m04:06:30.465777 [info ] [Thread-1 (]: 1 of 1 OK created sql table model youtube.dim_categories ....................... [[32mCREATE TABLE (100.0 rows, 4.5 KiB processed)[0m in 4.27s]
[0m04:06:30.467343 [debug] [Thread-1 (]: Finished running node model.youtube_project.dim_categories
[0m04:06:30.471417 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:06:30.472001 [debug] [MainThread]: Connection 'model.youtube_project.dim_categories' was properly closed.
[0m04:06:30.472688 [info ] [MainThread]: 
[0m04:06:30.473269 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.95 seconds (5.95s).
[0m04:06:30.474621 [debug] [MainThread]: Command end result
[0m04:06:30.667140 [info ] [MainThread]: 
[0m04:06:30.667667 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:06:30.667955 [info ] [MainThread]: 
[0m04:06:30.668230 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:06:30.669377 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.3890204, "process_in_blocks": "0", "process_kernel_time": 0.345364, "process_mem_max_rss": "225148", "process_out_blocks": "8248", "process_user_time": 2.682828}
[0m04:06:30.671672 [debug] [MainThread]: Command `dbt run` succeeded at 04:06:30.671601 after 7.39 seconds
[0m04:06:30.671948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff993e3b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b992c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b992b10>]}
[0m04:06:30.672239 [debug] [MainThread]: Flushing usage events
[0m04:11:41.369125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ef2c140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90ca2750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ef2ed80>]}


============================== 04:11:41.370760 | 55bbbf62-5cf7-4aa0-b5e5-1a614b127754 ==============================
[0m04:11:41.370760 [info ] [MainThread]: Running with dbt=1.8.9
[0m04:11:41.371255 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'write_json': 'True', 'invocation_command': 'dbt run --models youtube_data.marts.dim_categories', 'static_parser': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'no_print': 'None', 'target_path': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt', 'introspect': 'True', 'printer_width': '80', 'fail_fast': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'empty': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'indirect_selection': 'eager', 'partial_parse': 'True', 'version_check': 'True'}
[0m04:11:42.016811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55bbbf62-5cf7-4aa0-b5e5-1a614b127754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71fd5430>]}
[0m04:11:42.049467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55bbbf62-5cf7-4aa0-b5e5-1a614b127754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f5fc110>]}
[0m04:11:42.050041 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m04:11:42.119125 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m04:11:42.248611 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:11:42.249279 [debug] [MainThread]: Partial parsing: updated file: youtube_project://models/youtube_data/marts/dim_categories.sql
[0m04:11:42.463480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55bbbf62-5cf7-4aa0-b5e5-1a614b127754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff713a7950>]}
[0m04:11:42.548373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55bbbf62-5cf7-4aa0-b5e5-1a614b127754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff713a7890>]}
[0m04:11:42.548769 [info ] [MainThread]: Found 12 models, 137 data tests, 2 sources, 867 macros
[0m04:11:42.549123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55bbbf62-5cf7-4aa0-b5e5-1a614b127754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70f530e0>]}
[0m04:11:42.551204 [info ] [MainThread]: 
[0m04:11:42.551741 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m04:11:42.552479 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project'
[0m04:11:42.552801 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:11:43.427793 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project, now list_yt-e2e-data-cycle-project_youtube)
[0m04:11:43.428870 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:11:44.342543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55bbbf62-5cf7-4aa0-b5e5-1a614b127754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71bbf5c0>]}
[0m04:11:44.344941 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:11:44.345673 [info ] [MainThread]: 
[0m04:11:44.351758 [debug] [Thread-1 (]: Began running node model.youtube_project.dim_categories
[0m04:11:44.352902 [info ] [Thread-1 (]: 1 of 1 START sql table model youtube.dim_categories ............................ [RUN]
[0m04:11:44.353825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now model.youtube_project.dim_categories)
[0m04:11:44.354364 [debug] [Thread-1 (]: Began compiling node model.youtube_project.dim_categories
[0m04:11:44.371626 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_project.dim_categories"
[0m04:11:44.374456 [debug] [Thread-1 (]: Began executing node model.youtube_project.dim_categories
[0m04:11:44.398381 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:11:45.279873 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_project.dim_categories"
[0m04:11:45.281514 [debug] [Thread-1 (]: On model.youtube_project.dim_categories: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "model.youtube_project.dim_categories"} */

  
    

    create or replace table `yt-e2e-data-cycle-project`.`youtube`.`dim_categories`
      
    
    

    OPTIONS()
    as (
      WITH category_data AS (
    SELECT * 
    FROM `yt-e2e-data-cycle-project`.`youtube`.`staging_category`
),

category_lookup AS (
    SELECT 
        category_struct.category_id,
        category_struct.category_name,
        category_struct.category_description
    FROM UNNEST([
        STRUCT(1 AS category_id, 'Film & Animation' AS category_name, 'Videos related to film and animation.' AS category_description),
        STRUCT(2 AS category_id, 'Autos & Vehicles' AS category_name, 'Videos related to cars, trucks, motorcycles, and vehicles.' AS category_description),
        STRUCT(10 AS category_id, 'Music' AS category_name, 'Videos related to music, music videos, and performances.' AS category_description),
        STRUCT(15 AS category_id, 'Pets & Animals' AS category_name, 'Videos related to pets, animals, and wildlife.' AS category_description),
        STRUCT(17 AS category_id, 'Sports' AS category_name, 'Videos related to sports events, commentary, and athletics.' AS category_description),
        STRUCT(18 AS category_id, 'Short Movies' AS category_name, 'Short films and independent films.' AS category_description),
        STRUCT(19 AS category_id, 'Travel & Events' AS category_name, 'Videos related to travel and live events.' AS category_description),
        STRUCT(20 AS category_id, 'Gaming' AS category_name, 'Videos related to video games, game commentary, and more.' AS category_description),
        STRUCT(22 AS category_id, 'People & Blogs' AS category_name, 'Personal vlogs and commentary.' AS category_description),
        STRUCT(23 AS category_id, 'Comedy' AS category_name, 'Videos related to comedic content.' AS category_description),
        STRUCT(24 AS category_id, 'Entertainment' AS category_name, 'Content related to entertainment and celebrity culture.' AS category_description),
        STRUCT(25 AS category_id, 'News & Politics' AS category_name, 'News and political commentary or events.' AS category_description),
        STRUCT(26 AS category_id, 'Howto & Style' AS category_name, 'How-to videos and style-related content.' AS category_description),
        STRUCT(27 AS category_id, 'Education' AS category_name, 'Educational content for various fields and topics.' AS category_description),
        STRUCT(28 AS category_id, 'Science & Technology' AS category_name, 'Videos related to science, tech, and innovations.' AS category_description),
        STRUCT(29 AS category_id, 'Nonprofits & Activism' AS category_name, 'Content related to nonprofits, activism, and charitable causes.' AS category_description),
        STRUCT(30 AS category_id, 'Movies' AS category_name, 'Full-length movies, movie trailers, and related content.' AS category_description),
        STRUCT(31 AS category_id, 'Anime & Animation' AS category_name, 'Anime series, animation, and related content.' AS category_description),
        STRUCT(32 AS category_id, 'Action & Adventure' AS category_name, 'Videos related to action and adventure content.' AS category_description),
        STRUCT(33 AS category_id, 'Classics' AS category_name, 'Classic movies, TV shows, and content.' AS category_description),
        STRUCT(34 AS category_id, 'Documentaries' AS category_name, 'Documentaries and docuseries content.' AS category_description),
        STRUCT(35 AS category_id, 'Drama' AS category_name, 'Dramas, TV shows, and related content.' AS category_description),
        STRUCT(36 AS category_id, 'Family & Parenting' AS category_name, 'Videos related to family life and parenting.' AS category_description),
        STRUCT(37 AS category_id, 'Home & Garden' AS category_name, 'Content about home improvement, gardens, and DIY projects.' AS category_description),
        STRUCT(38 AS category_id, 'Lifestyle' AS category_name, 'Videos about lifestyle, health, wellness, and more.' AS category_description),
        STRUCT(39 AS category_id, 'Music Videos' AS category_name, 'Music video content, including live and pre-recorded.' AS category_description),
        STRUCT(40 AS category_id, 'Reality TV' AS category_name, 'Reality TV shows and unscripted content.' AS category_description)
    ]) AS category_struct
)

SELECT 
    ROW_NUMBER() OVER (ORDER BY c.category_id) AS pk_category_id,
    c.category_id AS category_id,
    COALESCE(l.category_name, c.category_name, 'Unknown Category') AS category_name,
    COALESCE(l.category_description, c.category_description, 'Description not found') AS category_description
FROM category_data c
LEFT JOIN category_lookup l
    ON c.category_id = l.category_id;
    );
  
[0m04:11:45.669122 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:06f148b9-05e8-46d5-af98-62e15d76c786&page=queryresults
[0m04:11:45.671360 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [61:37]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got ";" at [61:37]')
[0m04:11:46.797398 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:f3a3080c-98fa-4283-ad9a-d5508424f568&page=queryresults
[0m04:11:46.800366 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:f3a3080c-98fa-4283-ad9a-d5508424f568&page=queryresults
[0m04:11:46.816148 [debug] [Thread-1 (]: Database Error in model dim_categories (models/youtube_data/marts/dim_categories.sql)
  Syntax error: Expected ")" but got ";" at [61:37]
  compiled code at target/run/youtube_project/models/youtube_data/marts/dim_categories.sql
[0m04:11:46.821560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55bbbf62-5cf7-4aa0-b5e5-1a614b127754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff719a9820>]}
[0m04:11:46.824099 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model youtube.dim_categories ................... [[31mERROR[0m in 2.46s]
[0m04:11:46.825761 [debug] [Thread-1 (]: Finished running node model.youtube_project.dim_categories
[0m04:11:46.830300 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:11:46.830835 [debug] [MainThread]: Connection 'model.youtube_project.dim_categories' was properly closed.
[0m04:11:46.831418 [info ] [MainThread]: 
[0m04:11:46.832090 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.28 seconds (4.28s).
[0m04:11:46.833470 [debug] [MainThread]: Command end result
[0m04:11:47.033774 [info ] [MainThread]: 
[0m04:11:47.034375 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:11:47.034717 [info ] [MainThread]: 
[0m04:11:47.035075 [error] [MainThread]:   Database Error in model dim_categories (models/youtube_data/marts/dim_categories.sql)
  Syntax error: Expected ")" but got ";" at [61:37]
  compiled code at target/run/youtube_project/models/youtube_data/marts/dim_categories.sql
[0m04:11:47.035301 [info ] [MainThread]: 
[0m04:11:47.035637 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m04:11:47.036691 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.6912003, "process_in_blocks": "0", "process_kernel_time": 0.272749, "process_mem_max_rss": "225336", "process_out_blocks": "8251", "process_user_time": 2.772614}
[0m04:11:47.037081 [debug] [MainThread]: Command `dbt run` failed at 04:11:47.037016 after 5.69 seconds
[0m04:11:47.037362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eecd250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eecf080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70f4de20>]}
[0m04:11:47.037585 [debug] [MainThread]: Flushing usage events
[0m04:11:54.272919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4734e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4fc3a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa45c0380>]}


============================== 04:11:54.274185 | 1a8b4736-2a49-422e-bc96-a0401fe9509a ==============================
[0m04:11:54.274185 [info ] [MainThread]: Running with dbt=1.8.9
[0m04:11:54.274629 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'warn_error': 'None', 'empty': 'False', 'target_path': 'None', 'debug': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'write_json': 'True', 'no_print': 'None', 'static_parser': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'quiet': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'partial_parse': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'invocation_command': 'dbt run --models youtube_data.marts.dim_categories', 'log_cache_events': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'introspect': 'True'}
[0m04:11:54.933627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a8b4736-2a49-422e-bc96-a0401fe9509a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff875d6b10>]}
[0m04:11:54.958454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a8b4736-2a49-422e-bc96-a0401fe9509a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4e2b2f0>]}
[0m04:11:54.958850 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m04:11:55.026126 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m04:11:55.161818 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:11:55.162592 [debug] [MainThread]: Partial parsing: updated file: youtube_project://models/youtube_data/marts/dim_categories.sql
[0m04:11:55.381799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a8b4736-2a49-422e-bc96-a0401fe9509a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87246c30>]}
[0m04:11:55.465165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a8b4736-2a49-422e-bc96-a0401fe9509a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86e7dc40>]}
[0m04:11:55.465611 [info ] [MainThread]: Found 12 models, 137 data tests, 2 sources, 867 macros
[0m04:11:55.465986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a8b4736-2a49-422e-bc96-a0401fe9509a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86cd6b70>]}
[0m04:11:55.468117 [info ] [MainThread]: 
[0m04:11:55.468568 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m04:11:55.469343 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project'
[0m04:11:55.469659 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:11:56.331200 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project, now list_yt-e2e-data-cycle-project_youtube)
[0m04:11:56.332540 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:11:57.144805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a8b4736-2a49-422e-bc96-a0401fe9509a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff869c2900>]}
[0m04:11:57.146939 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:11:57.147794 [info ] [MainThread]: 
[0m04:11:57.153592 [debug] [Thread-1 (]: Began running node model.youtube_project.dim_categories
[0m04:11:57.154872 [info ] [Thread-1 (]: 1 of 1 START sql table model youtube.dim_categories ............................ [RUN]
[0m04:11:57.156117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now model.youtube_project.dim_categories)
[0m04:11:57.157236 [debug] [Thread-1 (]: Began compiling node model.youtube_project.dim_categories
[0m04:11:57.175265 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_project.dim_categories"
[0m04:11:57.177415 [debug] [Thread-1 (]: Began executing node model.youtube_project.dim_categories
[0m04:11:57.195171 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:11:57.993505 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_project.dim_categories"
[0m04:11:57.995725 [debug] [Thread-1 (]: On model.youtube_project.dim_categories: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "model.youtube_project.dim_categories"} */

  
    

    create or replace table `yt-e2e-data-cycle-project`.`youtube`.`dim_categories`
      
    
    

    OPTIONS()
    as (
      WITH category_data AS (
    SELECT * 
    FROM `yt-e2e-data-cycle-project`.`youtube`.`staging_category`
),

category_lookup AS (
    SELECT 
        category_struct.category_id,
        category_struct.category_name,
        category_struct.category_description
    FROM UNNEST([
        STRUCT(1 AS category_id, 'Film & Animation' AS category_name, 'Videos related to film and animation.' AS category_description),
        STRUCT(2 AS category_id, 'Autos & Vehicles' AS category_name, 'Videos related to cars, trucks, motorcycles, and vehicles.' AS category_description),
        STRUCT(10 AS category_id, 'Music' AS category_name, 'Videos related to music, music videos, and performances.' AS category_description),
        STRUCT(15 AS category_id, 'Pets & Animals' AS category_name, 'Videos related to pets, animals, and wildlife.' AS category_description),
        STRUCT(17 AS category_id, 'Sports' AS category_name, 'Videos related to sports events, commentary, and athletics.' AS category_description),
        STRUCT(18 AS category_id, 'Short Movies' AS category_name, 'Short films and independent films.' AS category_description),
        STRUCT(19 AS category_id, 'Travel & Events' AS category_name, 'Videos related to travel and live events.' AS category_description),
        STRUCT(20 AS category_id, 'Gaming' AS category_name, 'Videos related to video games, game commentary, and more.' AS category_description),
        STRUCT(22 AS category_id, 'People & Blogs' AS category_name, 'Personal vlogs and commentary.' AS category_description),
        STRUCT(23 AS category_id, 'Comedy' AS category_name, 'Videos related to comedic content.' AS category_description),
        STRUCT(24 AS category_id, 'Entertainment' AS category_name, 'Content related to entertainment and celebrity culture.' AS category_description),
        STRUCT(25 AS category_id, 'News & Politics' AS category_name, 'News and political commentary or events.' AS category_description),
        STRUCT(26 AS category_id, 'Howto & Style' AS category_name, 'How-to videos and style-related content.' AS category_description),
        STRUCT(27 AS category_id, 'Education' AS category_name, 'Educational content for various fields and topics.' AS category_description),
        STRUCT(28 AS category_id, 'Science & Technology' AS category_name, 'Videos related to science, tech, and innovations.' AS category_description),
        STRUCT(29 AS category_id, 'Nonprofits & Activism' AS category_name, 'Content related to nonprofits, activism, and charitable causes.' AS category_description),
        STRUCT(30 AS category_id, 'Movies' AS category_name, 'Full-length movies, movie trailers, and related content.' AS category_description),
        STRUCT(31 AS category_id, 'Anime & Animation' AS category_name, 'Anime series, animation, and related content.' AS category_description),
        STRUCT(32 AS category_id, 'Action & Adventure' AS category_name, 'Videos related to action and adventure content.' AS category_description),
        STRUCT(33 AS category_id, 'Classics' AS category_name, 'Classic movies, TV shows, and content.' AS category_description),
        STRUCT(34 AS category_id, 'Documentaries' AS category_name, 'Documentaries and docuseries content.' AS category_description),
        STRUCT(35 AS category_id, 'Drama' AS category_name, 'Dramas, TV shows, and related content.' AS category_description),
        STRUCT(36 AS category_id, 'Family & Parenting' AS category_name, 'Videos related to family life and parenting.' AS category_description),
        STRUCT(37 AS category_id, 'Home & Garden' AS category_name, 'Content about home improvement, gardens, and DIY projects.' AS category_description),
        STRUCT(38 AS category_id, 'Lifestyle' AS category_name, 'Videos about lifestyle, health, wellness, and more.' AS category_description),
        STRUCT(39 AS category_id, 'Music Videos' AS category_name, 'Music video content, including live and pre-recorded.' AS category_description),
        STRUCT(40 AS category_id, 'Reality TV' AS category_name, 'Reality TV shows and unscripted content.' AS category_description)
    ]) AS category_struct
)

SELECT 
    ROW_NUMBER() OVER (ORDER BY c.category_id) AS pk_category_id,
    c.category_id AS category_id,
    COALESCE(l.category_name, c.category_name, 'Unknown Category') AS category_name,
    COALESCE(l.category_description, c.category_description, 'Description not found') AS category_description
FROM category_data c
LEFT JOIN category_lookup l
    ON c.category_id = l.category_id
    );
  
[0m04:11:58.775412 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:ac5c2cd5-9549-4b84-8b94-64ee25e7ef8a&page=queryresults
[0m04:12:01.980804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a8b4736-2a49-422e-bc96-a0401fe9509a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff871cdc10>]}
[0m04:12:01.982027 [info ] [Thread-1 (]: 1 of 1 OK created sql table model youtube.dim_categories ....................... [[32mCREATE TABLE (100.0 rows, 4.5 KiB processed)[0m in 4.82s]
[0m04:12:01.983332 [debug] [Thread-1 (]: Finished running node model.youtube_project.dim_categories
[0m04:12:01.985483 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:12:01.986002 [debug] [MainThread]: Connection 'model.youtube_project.dim_categories' was properly closed.
[0m04:12:01.986636 [info ] [MainThread]: 
[0m04:12:01.987189 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.52 seconds (6.52s).
[0m04:12:01.988551 [debug] [MainThread]: Command end result
[0m04:12:02.145034 [info ] [MainThread]: 
[0m04:12:02.145561 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:12:02.146032 [info ] [MainThread]: 
[0m04:12:02.146309 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:12:02.147267 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.8983417, "process_in_blocks": "0", "process_kernel_time": 0.323288, "process_mem_max_rss": "225288", "process_out_blocks": "8248", "process_user_time": 2.758994}
[0m04:12:02.147666 [debug] [MainThread]: Command `dbt run` succeeded at 04:12:02.147586 after 7.90 seconds
[0m04:12:02.147955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa61fa5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4232c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4197aa0>]}
[0m04:12:02.148189 [debug] [MainThread]: Flushing usage events
[0m04:12:48.899944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa62d58e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8e61520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa65292e0>]}


============================== 04:12:48.901218 | a62bfd33-8bef-45a9-adbe-42a011801c61 ==============================
[0m04:12:48.901218 [info ] [MainThread]: Running with dbt=1.8.9
[0m04:12:48.901768 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'use_colors': 'True', 'introspect': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'quiet': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'static_parser': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'log_path': '/usr/local/airflow/include/dbt/logs', 'invocation_command': 'dbt test --models youtube_data.marts.dim_categories', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'partial_parse': 'True', 'debug': 'False', 'empty': 'None', 'version_check': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m04:12:49.519709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a62bfd33-8bef-45a9-adbe-42a011801c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa62d5970>]}
[0m04:12:49.545354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a62bfd33-8bef-45a9-adbe-42a011801c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aa60aa0>]}
[0m04:12:49.545810 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m04:12:49.609690 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m04:12:49.733914 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:12:49.734240 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:12:49.756553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a62bfd33-8bef-45a9-adbe-42a011801c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89c92480>]}
[0m04:12:49.847948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a62bfd33-8bef-45a9-adbe-42a011801c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff896b55b0>]}
[0m04:12:49.848335 [info ] [MainThread]: Found 12 models, 137 data tests, 2 sources, 867 macros
[0m04:12:49.848605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a62bfd33-8bef-45a9-adbe-42a011801c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a6d9ca0>]}
[0m04:12:49.850556 [info ] [MainThread]: 
[0m04:12:49.851056 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m04:12:49.853531 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project_youtube'
[0m04:12:49.853798 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:12:50.701909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a62bfd33-8bef-45a9-adbe-42a011801c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89792c00>]}
[0m04:12:50.703591 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:12:50.704603 [info ] [MainThread]: 
[0m04:12:50.710887 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_categories_category_description__500__0.f90bd77b54
[0m04:12:50.712141 [info ] [Thread-1 (]: 1 of 9 START test dbt_expectations_expect_column_value_lengths_to_be_between_dim_categories_category_description__500__0  [RUN]
[0m04:12:50.713594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_categories_category_description__500__0.f90bd77b54)
[0m04:12:50.715174 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_categories_category_description__500__0.f90bd77b54
[0m04:12:50.750420 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_categories_category_description__500__0.f90bd77b54"
[0m04:12:50.752465 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_categories_category_description__500__0.f90bd77b54
[0m04:12:50.769043 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_categories_category_description__500__0.f90bd77b54"
[0m04:12:50.770346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:12:50.771856 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_categories_category_description__500__0.f90bd77b54: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_categories_category_description__500__0.f90bd77b54"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and length(
        category_description
    ) >= 0 and length(
        category_description
    ) <= 500
)
 as expression


    from `yt-e2e-data-cycle-project`.`youtube`.`dim_categories`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







      
    ) dbt_internal_test
[0m04:12:51.926330 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:e07086ed-c286-40f6-b5bb-9fd7f71e43ad&page=queryresults
[0m04:12:53.159910 [info ] [Thread-1 (]: 1 of 9 PASS dbt_expectations_expect_column_value_lengths_to_be_between_dim_categories_category_description__500__0  [[32mPASS[0m in 2.45s]
[0m04:12:53.162446 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_categories_category_description__500__0.f90bd77b54
[0m04:12:53.163534 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_categories_category_name__255__1.0116004803
[0m04:12:53.164449 [info ] [Thread-1 (]: 2 of 9 START test dbt_expectations_expect_column_value_lengths_to_be_between_dim_categories_category_name__255__1  [RUN]
[0m04:12:53.165333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_categories_category_description__500__0.f90bd77b54, now test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_categories_category_name__255__1.0116004803)
[0m04:12:53.165998 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_categories_category_name__255__1.0116004803
[0m04:12:53.173601 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_categories_category_name__255__1.0116004803"
[0m04:12:53.175463 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_categories_category_name__255__1.0116004803
[0m04:12:53.179262 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_categories_category_name__255__1.0116004803"
[0m04:12:53.180896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:12:53.183217 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_categories_category_name__255__1.0116004803: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_categories_category_name__255__1.0116004803"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and length(
        category_name
    ) >= 1 and length(
        category_name
    ) <= 255
)
 as expression


    from `yt-e2e-data-cycle-project`.`youtube`.`dim_categories`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







      
    ) dbt_internal_test
[0m04:12:54.486586 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:d4770221-3ed1-4f75-909d-a51c8a7d40df&page=queryresults
[0m04:12:55.716485 [info ] [Thread-1 (]: 2 of 9 PASS dbt_expectations_expect_column_value_lengths_to_be_between_dim_categories_category_name__255__1  [[32mPASS[0m in 2.55s]
[0m04:12:55.720166 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_categories_category_name__255__1.0116004803
[0m04:12:55.721738 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_categories_category_description__STRING.686544036c
[0m04:12:55.722933 [info ] [Thread-1 (]: 3 of 9 START test dbt_expectations_expect_column_values_to_be_of_type_dim_categories_category_description__STRING  [RUN]
[0m04:12:55.724361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_categories_category_name__255__1.0116004803, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_categories_category_description__STRING.686544036c)
[0m04:12:55.725682 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_categories_category_description__STRING.686544036c
[0m04:12:55.746620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:12:56.648314 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_categories_category_description__STRING.686544036c"
[0m04:12:56.651088 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_categories_category_description__STRING.686544036c
[0m04:12:56.658007 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_categories_category_description__STRING.686544036c"
[0m04:12:56.660122 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_categories_category_description__STRING.686544036c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_categories_category_description__STRING.686544036c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('PK_CATEGORY_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('CATEGORY_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('CATEGORY_NAME' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CATEGORY_DESCRIPTION' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'CATEGORY_DESCRIPTION'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:12:57.350600 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:4abc96c4-09e8-4ce9-9336-328a828af18a&page=queryresults
[0m04:12:58.579599 [info ] [Thread-1 (]: 3 of 9 PASS dbt_expectations_expect_column_values_to_be_of_type_dim_categories_category_description__STRING  [[32mPASS[0m in 2.86s]
[0m04:12:58.583203 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_categories_category_description__STRING.686544036c
[0m04:12:58.585060 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_categories_category_id__INT64.fb5bd735b5
[0m04:12:58.586328 [info ] [Thread-1 (]: 4 of 9 START test dbt_expectations_expect_column_values_to_be_of_type_dim_categories_category_id__INT64  [RUN]
[0m04:12:58.587494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_categories_category_description__STRING.686544036c, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_categories_category_id__INT64.fb5bd735b5)
[0m04:12:58.588418 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_categories_category_id__INT64.fb5bd735b5
[0m04:12:58.597549 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:12:59.405615 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_categories_category_id__INT64.fb5bd735b5"
[0m04:12:59.409069 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_categories_category_id__INT64.fb5bd735b5
[0m04:12:59.414337 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_categories_category_id__INT64.fb5bd735b5"
[0m04:12:59.416666 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_categories_category_id__INT64.fb5bd735b5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_categories_category_id__INT64.fb5bd735b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('PK_CATEGORY_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('CATEGORY_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('CATEGORY_NAME' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CATEGORY_DESCRIPTION' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'CATEGORY_ID'
            and
            relation_column_type not in ('INT64')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:13:00.013722 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:3d8f615d-54e2-4271-b308-76b07bddf37d&page=queryresults
[0m04:13:01.244020 [info ] [Thread-1 (]: 4 of 9 PASS dbt_expectations_expect_column_values_to_be_of_type_dim_categories_category_id__INT64  [[32mPASS[0m in 2.66s]
[0m04:13:01.251735 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_categories_category_id__INT64.fb5bd735b5
[0m04:13:01.252744 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_categories_category_name__STRING.92e13d57e5
[0m04:13:01.253466 [info ] [Thread-1 (]: 5 of 9 START test dbt_expectations_expect_column_values_to_be_of_type_dim_categories_category_name__STRING  [RUN]
[0m04:13:01.254253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_categories_category_id__INT64.fb5bd735b5, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_categories_category_name__STRING.92e13d57e5)
[0m04:13:01.255001 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_categories_category_name__STRING.92e13d57e5
[0m04:13:01.261534 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:13:02.066036 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_categories_category_name__STRING.92e13d57e5"
[0m04:13:02.068785 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_categories_category_name__STRING.92e13d57e5
[0m04:13:02.073580 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_categories_category_name__STRING.92e13d57e5"
[0m04:13:02.075872 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_categories_category_name__STRING.92e13d57e5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_categories_category_name__STRING.92e13d57e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('PK_CATEGORY_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('CATEGORY_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('CATEGORY_NAME' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CATEGORY_DESCRIPTION' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'CATEGORY_NAME'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:13:02.779290 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:cca2ac9d-dd55-4c72-94c7-47ab0233147b&page=queryresults
[0m04:13:04.010180 [info ] [Thread-1 (]: 5 of 9 PASS dbt_expectations_expect_column_values_to_be_of_type_dim_categories_category_name__STRING  [[32mPASS[0m in 2.76s]
[0m04:13:04.013273 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_categories_category_name__STRING.92e13d57e5
[0m04:13:04.014994 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_dim_categories_category_id.5f46267320
[0m04:13:04.016191 [info ] [Thread-1 (]: 6 of 9 START test not_null_dim_categories_category_id .......................... [RUN]
[0m04:13:04.017410 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_categories_category_name__STRING.92e13d57e5, now test.youtube_project.not_null_dim_categories_category_id.5f46267320)
[0m04:13:04.018303 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_dim_categories_category_id.5f46267320
[0m04:13:04.030760 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_dim_categories_category_id.5f46267320"
[0m04:13:04.033452 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_dim_categories_category_id.5f46267320
[0m04:13:04.037682 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_dim_categories_category_id.5f46267320"
[0m04:13:04.039587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:13:04.042792 [debug] [Thread-1 (]: On test.youtube_project.not_null_dim_categories_category_id.5f46267320: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_dim_categories_category_id.5f46267320"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select category_id
from `yt-e2e-data-cycle-project`.`youtube`.`dim_categories`
where category_id is null



      
    ) dbt_internal_test
[0m04:13:05.131722 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:3da0d884-1811-4001-8e12-62419a24d57a&page=queryresults
[0m04:13:06.463663 [info ] [Thread-1 (]: 6 of 9 PASS not_null_dim_categories_category_id ................................ [[32mPASS[0m in 2.45s]
[0m04:13:06.465402 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_dim_categories_category_id.5f46267320
[0m04:13:06.466342 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_dim_categories_category_name.f2464757d0
[0m04:13:06.467085 [info ] [Thread-1 (]: 7 of 9 START test not_null_dim_categories_category_name ........................ [RUN]
[0m04:13:06.467861 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_dim_categories_category_id.5f46267320, now test.youtube_project.not_null_dim_categories_category_name.f2464757d0)
[0m04:13:06.468501 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_dim_categories_category_name.f2464757d0
[0m04:13:06.474833 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_dim_categories_category_name.f2464757d0"
[0m04:13:06.476559 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_dim_categories_category_name.f2464757d0
[0m04:13:06.479849 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_dim_categories_category_name.f2464757d0"
[0m04:13:06.481337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:13:06.484495 [debug] [Thread-1 (]: On test.youtube_project.not_null_dim_categories_category_name.f2464757d0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_dim_categories_category_name.f2464757d0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select category_name
from `yt-e2e-data-cycle-project`.`youtube`.`dim_categories`
where category_name is null



      
    ) dbt_internal_test
[0m04:13:07.834601 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:6e839fdb-b6b0-424e-81b5-5f77d3e6e423&page=queryresults
[0m04:13:08.957512 [info ] [Thread-1 (]: 7 of 9 PASS not_null_dim_categories_category_name .............................. [[32mPASS[0m in 2.49s]
[0m04:13:08.960005 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_dim_categories_category_name.f2464757d0
[0m04:13:08.961953 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_dim_categories_pk_category_id.6b057f8947
[0m04:13:08.963225 [info ] [Thread-1 (]: 8 of 9 START test not_null_dim_categories_pk_category_id ....................... [RUN]
[0m04:13:08.964435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_dim_categories_category_name.f2464757d0, now test.youtube_project.not_null_dim_categories_pk_category_id.6b057f8947)
[0m04:13:08.965403 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_dim_categories_pk_category_id.6b057f8947
[0m04:13:08.974686 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_dim_categories_pk_category_id.6b057f8947"
[0m04:13:08.976800 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_dim_categories_pk_category_id.6b057f8947
[0m04:13:08.980139 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_dim_categories_pk_category_id.6b057f8947"
[0m04:13:08.981917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:13:08.984140 [debug] [Thread-1 (]: On test.youtube_project.not_null_dim_categories_pk_category_id.6b057f8947: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_dim_categories_pk_category_id.6b057f8947"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_category_id
from `yt-e2e-data-cycle-project`.`youtube`.`dim_categories`
where pk_category_id is null



      
    ) dbt_internal_test
[0m04:13:10.357922 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:47ffb187-8db8-477f-b143-82d1f6ff05a5&page=queryresults
[0m04:13:11.485958 [info ] [Thread-1 (]: 8 of 9 PASS not_null_dim_categories_pk_category_id ............................. [[32mPASS[0m in 2.52s]
[0m04:13:11.489544 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_dim_categories_pk_category_id.6b057f8947
[0m04:13:11.491345 [debug] [Thread-1 (]: Began running node test.youtube_project.unique_dim_categories_pk_category_id.9257658dd1
[0m04:13:11.492285 [info ] [Thread-1 (]: 9 of 9 START test unique_dim_categories_pk_category_id ......................... [RUN]
[0m04:13:11.493426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_dim_categories_pk_category_id.6b057f8947, now test.youtube_project.unique_dim_categories_pk_category_id.9257658dd1)
[0m04:13:11.494523 [debug] [Thread-1 (]: Began compiling node test.youtube_project.unique_dim_categories_pk_category_id.9257658dd1
[0m04:13:11.505833 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.unique_dim_categories_pk_category_id.9257658dd1"
[0m04:13:11.508143 [debug] [Thread-1 (]: Began executing node test.youtube_project.unique_dim_categories_pk_category_id.9257658dd1
[0m04:13:11.512526 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.unique_dim_categories_pk_category_id.9257658dd1"
[0m04:13:11.514565 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:13:11.517662 [debug] [Thread-1 (]: On test.youtube_project.unique_dim_categories_pk_category_id.9257658dd1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.unique_dim_categories_pk_category_id.9257658dd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select pk_category_id as unique_field
  from `yt-e2e-data-cycle-project`.`youtube`.`dim_categories`
  where pk_category_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m04:13:12.816136 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:44044379-8f76-4954-8e43-890fcf143c6b&page=queryresults
[0m04:13:14.043483 [info ] [Thread-1 (]: 9 of 9 PASS unique_dim_categories_pk_category_id ............................... [[32mPASS[0m in 2.55s]
[0m04:13:14.047295 [debug] [Thread-1 (]: Finished running node test.youtube_project.unique_dim_categories_pk_category_id.9257658dd1
[0m04:13:14.053197 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:13:14.054153 [debug] [MainThread]: Connection 'test.youtube_project.unique_dim_categories_pk_category_id.9257658dd1' was properly closed.
[0m04:13:14.055354 [info ] [MainThread]: 
[0m04:13:14.056686 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 24.20 seconds (24.20s).
[0m04:13:14.066405 [debug] [MainThread]: Command end result
[0m04:13:14.148779 [info ] [MainThread]: 
[0m04:13:14.149340 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:13:14.149715 [info ] [MainThread]: 
[0m04:13:14.150375 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m04:13:14.153858 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 25.279564, "process_in_blocks": "1968", "process_kernel_time": 0.310495, "process_mem_max_rss": "222716", "process_out_blocks": "5790", "process_user_time": 3.174842}
[0m04:13:14.154710 [debug] [MainThread]: Command `dbt test` succeeded at 04:13:14.154516 after 25.28 seconds
[0m04:13:14.155235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa63586e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa410a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa665b6e0>]}
[0m04:13:14.155637 [debug] [MainThread]: Flushing usage events
[0m04:14:04.566077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8908ce30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88fb3470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8908f920>]}


============================== 04:14:04.567470 | 7451b2b3-83b9-4b9f-b119-fb5117d61fb3 ==============================
[0m04:14:04.567470 [info ] [MainThread]: Running with dbt=1.8.9
[0m04:14:04.567930 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'profiles_dir': '/usr/local/airflow/include/dbt', 'log_cache_events': 'False', 'invocation_command': 'dbt run --models youtube_data.marts.dim_channels', 'version_check': 'True', 'introspect': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'static_parser': 'True', 'log_format': 'default', 'no_print': 'None', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'empty': 'False', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'quiet': 'False', 'send_anonymous_usage_stats': 'True'}
[0m04:14:05.244512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7451b2b3-83b9-4b9f-b119-fb5117d61fb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a1b22d0>]}
[0m04:14:05.269231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7451b2b3-83b9-4b9f-b119-fb5117d61fb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d0015e0>]}
[0m04:14:05.269617 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m04:14:05.336082 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m04:14:05.467322 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:14:05.468041 [debug] [MainThread]: Partial parsing: updated file: youtube_project://models/youtube_data/marts/dim_channels.sql
[0m04:14:05.697601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7451b2b3-83b9-4b9f-b119-fb5117d61fb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b713ce0>]}
[0m04:14:05.778796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7451b2b3-83b9-4b9f-b119-fb5117d61fb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6be4ea50>]}
[0m04:14:05.779208 [info ] [MainThread]: Found 12 models, 137 data tests, 2 sources, 867 macros
[0m04:14:05.779495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7451b2b3-83b9-4b9f-b119-fb5117d61fb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bd338f0>]}
[0m04:14:05.781290 [info ] [MainThread]: 
[0m04:14:05.781743 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m04:14:05.782459 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project'
[0m04:14:05.782717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:14:06.585057 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project, now list_yt-e2e-data-cycle-project_youtube)
[0m04:14:06.586072 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:14:07.504759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7451b2b3-83b9-4b9f-b119-fb5117d61fb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c2a56a0>]}
[0m04:14:07.506593 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:14:07.507839 [info ] [MainThread]: 
[0m04:14:07.513672 [debug] [Thread-1 (]: Began running node model.youtube_project.dim_channels
[0m04:14:07.515019 [info ] [Thread-1 (]: 1 of 1 START sql table model youtube.dim_channels .............................. [RUN]
[0m04:14:07.516099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now model.youtube_project.dim_channels)
[0m04:14:07.516828 [debug] [Thread-1 (]: Began compiling node model.youtube_project.dim_channels
[0m04:14:07.532765 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_project.dim_channels"
[0m04:14:07.535616 [debug] [Thread-1 (]: Began executing node model.youtube_project.dim_channels
[0m04:14:07.571994 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_project.dim_channels"
[0m04:14:07.573056 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:14:07.574393 [debug] [Thread-1 (]: On model.youtube_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "model.youtube_project.dim_channels"} */

  
    

    create or replace table `yt-e2e-data-cycle-project`.`youtube`.`dim_channels`
      
    
    cluster by channel_id

    OPTIONS()
    as (
      WITH channel_data AS (
    SELECT * 
    FROM `yt-e2e-data-cycle-project`.`youtube`.`staging_channel`  
),

channel_filled AS (
    SELECT
        channel_id,
        
        -- Clean invalid characters from channel title
        COALESCE(
            REGEXP_REPLACE(channel_title, r'[\x00-\x1F\x7F-\x9F\xAD\uFFFD]', ''), 
            'No Channel Title Available'
        ) AS channel_title,
        
        -- Clean invalid characters from channel description
        COALESCE(
            REGEXP_REPLACE(channel_description, r'[\x00-\x1F\x7F-\x9F\xAD\uFFFD]', ''), 
            'No Channel Description Available'
        ) AS channel_description,
        
        -- If channel_published_at is NULL, replace with CURRENT_TIMESTAMP
        COALESCE(channel_published_at, CURRENT_TIMESTAMP()) AS channel_published_at
    FROM
        channel_data
)

SELECT
    ROW_NUMBER() OVER (PARTITION BY c.channel_id ORDER BY c.channel_published_at DESC) as pk_channel_id,  
    c.channel_id,
    c.channel_title,
    c.channel_description,
    c.channel_published_at
FROM
    channel_filled c
    );
  
[0m04:14:08.731852 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:de916a4d-2c22-4d9a-a8b3-947eb3bee164&page=queryresults
[0m04:14:09.067271 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Cannot parse regular expression: invalid escape sequence: \\u; reason: invalidQuery, location: query, message: Cannot parse regular expression: invalid escape sequence: \\u')
[0m04:14:10.171588 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:b3082473-9604-435b-a85a-06a9494736d0&page=queryresults
[0m04:14:10.476304 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:b3082473-9604-435b-a85a-06a9494736d0&page=queryresults
[0m04:14:10.485837 [debug] [Thread-1 (]: Database Error in model dim_channels (models/youtube_data/marts/dim_channels.sql)
  Cannot parse regular expression: invalid escape sequence: \u
  compiled code at target/run/youtube_project/models/youtube_data/marts/dim_channels.sql
[0m04:14:10.489660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7451b2b3-83b9-4b9f-b119-fb5117d61fb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c1c6c90>]}
[0m04:14:10.491556 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model youtube.dim_channels ..................... [[31mERROR[0m in 2.97s]
[0m04:14:10.492743 [debug] [Thread-1 (]: Finished running node model.youtube_project.dim_channels
[0m04:14:10.495983 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:14:10.496580 [debug] [MainThread]: Connection 'model.youtube_project.dim_channels' was properly closed.
[0m04:14:10.497047 [info ] [MainThread]: 
[0m04:14:10.497491 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.72 seconds (4.72s).
[0m04:14:10.498506 [debug] [MainThread]: Command end result
[0m04:14:10.634384 [info ] [MainThread]: 
[0m04:14:10.634804 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:14:10.635226 [info ] [MainThread]: 
[0m04:14:10.635731 [error] [MainThread]:   Database Error in model dim_channels (models/youtube_data/marts/dim_channels.sql)
  Cannot parse regular expression: invalid escape sequence: \u
  compiled code at target/run/youtube_project/models/youtube_data/marts/dim_channels.sql
[0m04:14:10.636011 [info ] [MainThread]: 
[0m04:14:10.636471 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m04:14:10.637554 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.09755, "process_in_blocks": "0", "process_kernel_time": 0.303794, "process_mem_max_rss": "225484", "process_out_blocks": "8216", "process_user_time": 2.665968}
[0m04:14:10.637937 [debug] [MainThread]: Command `dbt run` failed at 04:14:10.637856 after 6.10 seconds
[0m04:14:10.638191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff898d7f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff898d6720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b73e2d0>]}
[0m04:14:10.638410 [debug] [MainThread]: Flushing usage events
[0m04:17:49.298405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3090e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1cc6480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1eb7920>]}


============================== 04:17:49.299984 | 7b5d7f98-a68c-404a-a935-35d4ba99349d ==============================
[0m04:17:49.299984 [info ] [MainThread]: Running with dbt=1.8.9
[0m04:17:49.300384 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'warn_error': 'None', 'quiet': 'False', 'write_json': 'True', 'invocation_command': 'dbt run --models youtube_data.marts.dim_channels', 'version_check': 'True', 'no_print': 'None', 'debug': 'False', 'use_colors': 'True', 'log_format': 'default', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'cache_selected_only': 'False', 'partial_parse': 'True', 'introspect': 'True', 'empty': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt'}
[0m04:17:49.933246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b5d7f98-a68c-404a-a935-35d4ba99349d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94c152e0>]}
[0m04:17:49.957856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b5d7f98-a68c-404a-a935-35d4ba99349d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96977ef0>]}
[0m04:17:49.958287 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m04:17:50.027802 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m04:17:50.158470 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:17:50.159298 [debug] [MainThread]: Partial parsing: updated file: youtube_project://models/youtube_data/marts/dim_channels.sql
[0m04:17:50.376832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b5d7f98-a68c-404a-a935-35d4ba99349d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93dcd1c0>]}
[0m04:17:50.457967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b5d7f98-a68c-404a-a935-35d4ba99349d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9439f9e0>]}
[0m04:17:50.458353 [info ] [MainThread]: Found 12 models, 137 data tests, 2 sources, 867 macros
[0m04:17:50.458625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b5d7f98-a68c-404a-a935-35d4ba99349d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94597170>]}
[0m04:17:50.460491 [info ] [MainThread]: 
[0m04:17:50.460959 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m04:17:50.461655 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project'
[0m04:17:50.461929 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:17:51.351868 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project, now list_yt-e2e-data-cycle-project_youtube)
[0m04:17:51.352731 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:17:52.141257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b5d7f98-a68c-404a-a935-35d4ba99349d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94597170>]}
[0m04:17:52.142526 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:17:52.143482 [info ] [MainThread]: 
[0m04:17:52.148067 [debug] [Thread-1 (]: Began running node model.youtube_project.dim_channels
[0m04:17:52.149159 [info ] [Thread-1 (]: 1 of 1 START sql table model youtube.dim_channels .............................. [RUN]
[0m04:17:52.150188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now model.youtube_project.dim_channels)
[0m04:17:52.150966 [debug] [Thread-1 (]: Began compiling node model.youtube_project.dim_channels
[0m04:17:52.202122 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_project.dim_channels"
[0m04:17:52.206354 [debug] [Thread-1 (]: Began executing node model.youtube_project.dim_channels
[0m04:17:52.235007 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_project.dim_channels"
[0m04:17:52.236056 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:17:52.237206 [debug] [Thread-1 (]: On model.youtube_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "model.youtube_project.dim_channels"} */

  
    

    create or replace table `yt-e2e-data-cycle-project`.`youtube`.`dim_channels`
      
    
    cluster by channel_id

    OPTIONS()
    as (
      WITH channel_data AS (
    SELECT * 
    FROM `yt-e2e-data-cycle-project`.`youtube`.`staging_channel`  
),

channel_filled AS (
    SELECT
        channel_id,
        
        -- Clean invalid characters from channel title
        COALESCE(
            REGEXP_REPLACE(channel_title, r'[\x00-\x1F\x7F-\x9F\xAD�]', ''), 
            'No Channel Title Available'
        ) AS channel_title,
        
        -- Clean invalid characters from channel description
        COALESCE(
            REGEXP_REPLACE(channel_description, r'[\x00-\x1F\x7F-\x9F\xAD�]', ''), 
            'No Channel Description Available'
        ) AS channel_description,
        
        -- If channel_published_at is NULL, replace with CURRENT_TIMESTAMP
        COALESCE(channel_published_at, CURRENT_TIMESTAMP()) AS channel_published_at
    FROM
        channel_data
)

SELECT
    ROW_NUMBER() OVER (PARTITION BY c.channel_id ORDER BY c.channel_published_at DESC) as pk_channel_id,  
    c.channel_id,
    c.channel_title,
    c.channel_description,
    c.channel_published_at
FROM
    channel_filled c
    );
  
[0m04:17:53.498348 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:753b2895-8a81-4409-93bd-124ffc758f6e&page=queryresults
[0m04:17:56.801329 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b5d7f98-a68c-404a-a935-35d4ba99349d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95485c10>]}
[0m04:17:56.802973 [info ] [Thread-1 (]: 1 of 1 OK created sql table model youtube.dim_channels ......................... [[32mCREATE TABLE (100.0 rows, 28.0 KiB processed)[0m in 4.65s]
[0m04:17:56.804370 [debug] [Thread-1 (]: Finished running node model.youtube_project.dim_channels
[0m04:17:56.806162 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:17:56.806604 [debug] [MainThread]: Connection 'model.youtube_project.dim_channels' was properly closed.
[0m04:17:56.807118 [info ] [MainThread]: 
[0m04:17:56.807602 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.35 seconds (6.35s).
[0m04:17:56.808673 [debug] [MainThread]: Command end result
[0m04:17:56.929503 [info ] [MainThread]: 
[0m04:17:56.929888 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:17:56.930275 [info ] [MainThread]: 
[0m04:17:56.930586 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:17:56.931324 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.6633096, "process_in_blocks": "0", "process_kernel_time": 0.277897, "process_mem_max_rss": "225296", "process_out_blocks": "8213", "process_user_time": 2.639516}
[0m04:17:56.931630 [debug] [MainThread]: Command `dbt run` succeeded at 04:17:56.931574 after 7.66 seconds
[0m04:17:56.931854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb14bdf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94c17740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1661220>]}
[0m04:17:56.932073 [debug] [MainThread]: Flushing usage events
[0m04:19:09.330214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96f795e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96f7bdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96f7be60>]}


============================== 04:19:09.331701 | b3ea2130-e5cc-45e6-ae28-e4bcf9395b24 ==============================
[0m04:19:09.331701 [info ] [MainThread]: Running with dbt=1.8.9
[0m04:19:09.332189 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'invocation_command': 'dbt test --models youtube_data.marts.dim_channels', 'write_json': 'True', 'log_format': 'default', 'no_print': 'None', 'empty': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'use_colors': 'True', 'version_check': 'True', 'quiet': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs'}
[0m04:19:09.982430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3ea2130-e5cc-45e6-ae28-e4bcf9395b24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b2d5760>]}
[0m04:19:10.007206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3ea2130-e5cc-45e6-ae28-e4bcf9395b24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b0ec1a0>]}
[0m04:19:10.007600 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m04:19:10.075628 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m04:19:10.202878 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:19:10.203204 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:19:10.225432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3ea2130-e5cc-45e6-ae28-e4bcf9395b24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a99e9c0>]}
[0m04:19:10.315482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3ea2130-e5cc-45e6-ae28-e4bcf9395b24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a3c5490>]}
[0m04:19:10.315837 [info ] [MainThread]: Found 12 models, 137 data tests, 2 sources, 867 macros
[0m04:19:10.316071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3ea2130-e5cc-45e6-ae28-e4bcf9395b24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a0e0bf0>]}
[0m04:19:10.317956 [info ] [MainThread]: 
[0m04:19:10.318437 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m04:19:10.320878 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project_youtube'
[0m04:19:10.321132 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:19:11.126356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3ea2130-e5cc-45e6-ae28-e4bcf9395b24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a49cf20>]}
[0m04:19:11.127981 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:19:11.128913 [info ] [MainThread]: 
[0m04:19:11.134649 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0.6dcd79a50a
[0m04:19:11.135636 [info ] [Thread-1 (]: 1 of 10 START test dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0  [RUN]
[0m04:19:11.136827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0.6dcd79a50a)
[0m04:19:11.137549 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0.6dcd79a50a
[0m04:19:11.173107 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0.6dcd79a50a"
[0m04:19:11.175093 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0.6dcd79a50a
[0m04:19:11.193033 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0.6dcd79a50a"
[0m04:19:11.194395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:19:11.195925 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0.6dcd79a50a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0.6dcd79a50a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and length(
        channel_description
    ) >= 0 and length(
        channel_description
    ) <= 1000
)
 as expression


    from `yt-e2e-data-cycle-project`.`youtube`.`dim_channels`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







      
    ) dbt_internal_test
[0m04:19:12.455178 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:e37c69de-a573-4044-a3f1-dc0b65a78dac&page=queryresults
[0m04:19:13.685087 [info ] [Thread-1 (]: 1 of 10 PASS dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0  [[32mPASS[0m in 2.55s]
[0m04:19:13.687321 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0.6dcd79a50a
[0m04:19:13.688359 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_title__255__1.c25e64f1e8
[0m04:19:13.689153 [info ] [Thread-1 (]: 2 of 10 START test dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_title__255__1  [RUN]
[0m04:19:13.690098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0.6dcd79a50a, now test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_title__255__1.c25e64f1e8)
[0m04:19:13.690830 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_title__255__1.c25e64f1e8
[0m04:19:13.698148 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_title__255__1.c25e64f1e8"
[0m04:19:13.699769 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_title__255__1.c25e64f1e8
[0m04:19:13.703749 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_title__255__1.c25e64f1e8"
[0m04:19:13.705740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:19:13.707741 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_title__255__1.c25e64f1e8: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_title__255__1.c25e64f1e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and length(
        channel_title
    ) >= 1 and length(
        channel_title
    ) <= 255
)
 as expression


    from `yt-e2e-data-cycle-project`.`youtube`.`dim_channels`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







      
    ) dbt_internal_test
[0m04:19:14.863217 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:4e893750-5182-4b56-8130-66bac75789b4&page=queryresults
[0m04:19:16.035193 [info ] [Thread-1 (]: 2 of 10 PASS dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_title__255__1  [[32mPASS[0m in 2.34s]
[0m04:19:16.038223 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_title__255__1.c25e64f1e8
[0m04:19:16.040386 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_between_dim_channels_channel_published_at__CURRENT_TIMESTAMP___1900_01_01.a687f20d2e
[0m04:19:16.041793 [info ] [Thread-1 (]: 3 of 10 START test dbt_expectations_expect_column_values_to_be_between_dim_channels_channel_published_at__CURRENT_TIMESTAMP___1900_01_01  [RUN]
[0m04:19:16.042884 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_title__255__1.c25e64f1e8, now test.youtube_project.dbt_expectations_expect_column_values_to_be_between_dim_channels_channel_published_at__CURRENT_TIMESTAMP___1900_01_01.a687f20d2e)
[0m04:19:16.043873 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_between_dim_channels_channel_published_at__CURRENT_TIMESTAMP___1900_01_01.a687f20d2e
[0m04:19:16.060756 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_between_dim_channels_channel_published_at__CURRENT_TIMESTAMP___1900_01_01.a687f20d2e"
[0m04:19:16.063656 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_between_dim_channels_channel_published_at__CURRENT_TIMESTAMP___1900_01_01.a687f20d2e
[0m04:19:16.068953 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_between_dim_channels_channel_published_at__CURRENT_TIMESTAMP___1900_01_01.a687f20d2e"
[0m04:19:16.070559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:19:16.073473 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_between_dim_channels_channel_published_at__CURRENT_TIMESTAMP___1900_01_01.a687f20d2e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_between_dim_channels_channel_published_at__CURRENT_TIMESTAMP___1900_01_01.a687f20d2e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and channel_published_at >= 1900-01-01 and channel_published_at <= CURRENT_TIMESTAMP()
)
 as expression


    from `yt-e2e-data-cycle-project`.`youtube`.`dim_channels`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m04:19:17.162088 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:8f74025d-7726-4dd9-b325-c84fd4be83b6&page=queryresults
[0m04:19:17.164532 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for operator >= for argument types: TIMESTAMP, INT64. Supported signature: ANY >= ANY at [20:11]; reason: invalidQuery, location: query, message: No matching signature for operator >= for argument types: TIMESTAMP, INT64. Supported signature: ANY >= ANY at [20:11]')
[0m04:19:18.082260 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:0629fc79-5d2a-4f16-8942-742e0efa26ca&page=queryresults
[0m04:19:18.084609 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:0629fc79-5d2a-4f16-8942-742e0efa26ca&page=queryresults
[0m04:19:18.099884 [debug] [Thread-1 (]: Database Error in test dbt_expectations_expect_column_values_to_be_between_dim_channels_channel_published_at__CURRENT_TIMESTAMP___1900_01_01 (models/youtube_data/marts/schema.yml)
  No matching signature for operator >= for argument types: TIMESTAMP, INT64. Supported signature: ANY >= ANY at [20:11]
  compiled code at target/run/youtube_project/models/youtube_data/marts/schema.yml/dbt_expectations_expect_column_3a54b5f31930b3072b690793d2bbd408.sql
[0m04:19:18.101897 [error] [Thread-1 (]: 3 of 10 ERROR dbt_expectations_expect_column_values_to_be_between_dim_channels_channel_published_at__CURRENT_TIMESTAMP___1900_01_01  [[31mERROR[0m in 2.06s]
[0m04:19:18.103299 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_between_dim_channels_channel_published_at__CURRENT_TIMESTAMP___1900_01_01.a687f20d2e
[0m04:19:18.104903 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_description__STRING.642c21036e
[0m04:19:18.107273 [info ] [Thread-1 (]: 4 of 10 START test dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_description__STRING  [RUN]
[0m04:19:18.108130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_between_dim_channels_channel_published_at__CURRENT_TIMESTAMP___1900_01_01.a687f20d2e, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_description__STRING.642c21036e)
[0m04:19:18.108993 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_description__STRING.642c21036e
[0m04:19:18.125105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:19:19.009618 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_description__STRING.642c21036e"
[0m04:19:19.012167 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_description__STRING.642c21036e
[0m04:19:19.014923 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_description__STRING.642c21036e"
[0m04:19:19.016370 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_description__STRING.642c21036e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_description__STRING.642c21036e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('PK_CHANNEL_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_TITLE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_DESCRIPTION' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'CHANNEL_DESCRIPTION'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:19:19.616604 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:f1b991b7-5078-4999-aa8f-974c314eaa1d&page=queryresults
[0m04:19:20.746764 [info ] [Thread-1 (]: 4 of 10 PASS dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_description__STRING  [[32mPASS[0m in 2.64s]
[0m04:19:20.749804 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_description__STRING.642c21036e
[0m04:19:20.752086 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_id__STRING.fa3801035c
[0m04:19:20.753498 [info ] [Thread-1 (]: 5 of 10 START test dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_id__STRING  [RUN]
[0m04:19:20.754863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_description__STRING.642c21036e, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_id__STRING.fa3801035c)
[0m04:19:20.755819 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_id__STRING.fa3801035c
[0m04:19:20.764059 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:19:21.671339 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_id__STRING.fa3801035c"
[0m04:19:21.674242 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_id__STRING.fa3801035c
[0m04:19:21.680288 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_id__STRING.fa3801035c"
[0m04:19:21.681815 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_id__STRING.fa3801035c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_id__STRING.fa3801035c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('PK_CHANNEL_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_TITLE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_DESCRIPTION' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'CHANNEL_ID'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:19:22.279906 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:bf59375d-6680-44ae-b0ac-18dc02184291&page=queryresults
[0m04:19:23.510603 [info ] [Thread-1 (]: 5 of 10 PASS dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_id__STRING  [[32mPASS[0m in 2.76s]
[0m04:19:23.514086 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_id__STRING.fa3801035c
[0m04:19:23.515973 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_published_at__TIMESTAMP.88c47c5564
[0m04:19:23.517073 [info ] [Thread-1 (]: 6 of 10 START test dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_published_at__TIMESTAMP  [RUN]
[0m04:19:23.518288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_id__STRING.fa3801035c, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_published_at__TIMESTAMP.88c47c5564)
[0m04:19:23.519350 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_published_at__TIMESTAMP.88c47c5564
[0m04:19:23.529671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:19:24.444006 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_published_at__TIMESTAMP.88c47c5564"
[0m04:19:24.447999 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_published_at__TIMESTAMP.88c47c5564
[0m04:19:24.454373 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_published_at__TIMESTAMP.88c47c5564"
[0m04:19:24.457092 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_published_at__TIMESTAMP.88c47c5564: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_published_at__TIMESTAMP.88c47c5564"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('PK_CHANNEL_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_TITLE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_DESCRIPTION' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'CHANNEL_PUBLISHED_AT'
            and
            relation_column_type not in ('TIMESTAMP')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:19:25.097137 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:24dca1f0-5e90-4d82-8f21-4eda6024f25a&page=queryresults
[0m04:19:26.284670 [info ] [Thread-1 (]: 6 of 10 PASS dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_published_at__TIMESTAMP  [[32mPASS[0m in 2.77s]
[0m04:19:26.287497 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_published_at__TIMESTAMP.88c47c5564
[0m04:19:26.288985 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_title__STRING.db4a69ac9c
[0m04:19:26.290478 [info ] [Thread-1 (]: 7 of 10 START test dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_title__STRING  [RUN]
[0m04:19:26.291819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_published_at__TIMESTAMP.88c47c5564, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_title__STRING.db4a69ac9c)
[0m04:19:26.292719 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_title__STRING.db4a69ac9c
[0m04:19:26.301935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:19:27.098542 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_title__STRING.db4a69ac9c"
[0m04:19:27.101379 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_title__STRING.db4a69ac9c
[0m04:19:27.106694 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_title__STRING.db4a69ac9c"
[0m04:19:27.109179 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_title__STRING.db4a69ac9c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_title__STRING.db4a69ac9c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('PK_CHANNEL_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_TITLE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_DESCRIPTION' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'CHANNEL_TITLE'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:19:27.673725 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:c2219979-3bd1-4129-8be4-9034fda8caf0&page=queryresults
[0m04:19:28.759742 [info ] [Thread-1 (]: 7 of 10 PASS dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_title__STRING  [[32mPASS[0m in 2.47s]
[0m04:19:28.763827 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_title__STRING.db4a69ac9c
[0m04:19:28.766797 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_dim_channels_channel_id.93e5e4b23b
[0m04:19:28.769608 [info ] [Thread-1 (]: 8 of 10 START test not_null_dim_channels_channel_id ............................ [RUN]
[0m04:19:28.772530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_title__STRING.db4a69ac9c, now test.youtube_project.not_null_dim_channels_channel_id.93e5e4b23b)
[0m04:19:28.774210 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_dim_channels_channel_id.93e5e4b23b
[0m04:19:28.801699 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_dim_channels_channel_id.93e5e4b23b"
[0m04:19:28.823022 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_dim_channels_channel_id.93e5e4b23b
[0m04:19:28.828818 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_dim_channels_channel_id.93e5e4b23b"
[0m04:19:28.831686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:19:28.833889 [debug] [Thread-1 (]: On test.youtube_project.not_null_dim_channels_channel_id.93e5e4b23b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_dim_channels_channel_id.93e5e4b23b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select channel_id
from `yt-e2e-data-cycle-project`.`youtube`.`dim_channels`
where channel_id is null



      
    ) dbt_internal_test
[0m04:19:30.065691 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:169508fc-827c-455c-8589-e07497e98c57&page=queryresults
[0m04:19:31.304299 [info ] [Thread-1 (]: 8 of 10 PASS not_null_dim_channels_channel_id .................................. [[32mPASS[0m in 2.53s]
[0m04:19:31.309273 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_dim_channels_channel_id.93e5e4b23b
[0m04:19:31.310977 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_dim_channels_channel_title.5f5d78e27d
[0m04:19:31.312309 [info ] [Thread-1 (]: 9 of 10 START test not_null_dim_channels_channel_title ......................... [RUN]
[0m04:19:31.313682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_dim_channels_channel_id.93e5e4b23b, now test.youtube_project.not_null_dim_channels_channel_title.5f5d78e27d)
[0m04:19:31.314639 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_dim_channels_channel_title.5f5d78e27d
[0m04:19:31.328731 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_dim_channels_channel_title.5f5d78e27d"
[0m04:19:31.332744 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_dim_channels_channel_title.5f5d78e27d
[0m04:19:31.338771 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_dim_channels_channel_title.5f5d78e27d"
[0m04:19:31.341129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:19:31.344829 [debug] [Thread-1 (]: On test.youtube_project.not_null_dim_channels_channel_title.5f5d78e27d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_dim_channels_channel_title.5f5d78e27d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select channel_title
from `yt-e2e-data-cycle-project`.`youtube`.`dim_channels`
where channel_title is null



      
    ) dbt_internal_test
[0m04:19:32.391009 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:a490275d-f6aa-4099-9847-cc4e5d04ba40&page=queryresults
[0m04:19:33.399173 [info ] [Thread-1 (]: 9 of 10 PASS not_null_dim_channels_channel_title ............................... [[32mPASS[0m in 2.09s]
[0m04:19:33.401711 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_dim_channels_channel_title.5f5d78e27d
[0m04:19:33.403645 [debug] [Thread-1 (]: Began running node test.youtube_project.unique_dim_channels_channel_id.d14657a1ec
[0m04:19:33.405075 [info ] [Thread-1 (]: 10 of 10 START test unique_dim_channels_channel_id ............................. [RUN]
[0m04:19:33.406237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_dim_channels_channel_title.5f5d78e27d, now test.youtube_project.unique_dim_channels_channel_id.d14657a1ec)
[0m04:19:33.407175 [debug] [Thread-1 (]: Began compiling node test.youtube_project.unique_dim_channels_channel_id.d14657a1ec
[0m04:19:33.423834 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.unique_dim_channels_channel_id.d14657a1ec"
[0m04:19:33.427024 [debug] [Thread-1 (]: Began executing node test.youtube_project.unique_dim_channels_channel_id.d14657a1ec
[0m04:19:33.430915 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.unique_dim_channels_channel_id.d14657a1ec"
[0m04:19:33.433054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:19:33.435887 [debug] [Thread-1 (]: On test.youtube_project.unique_dim_channels_channel_id.d14657a1ec: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.unique_dim_channels_channel_id.d14657a1ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select channel_id as unique_field
  from `yt-e2e-data-cycle-project`.`youtube`.`dim_channels`
  where channel_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m04:19:34.774140 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:6c19e84d-aca1-4fb8-9d39-04a6c0391794&page=queryresults
[0m04:19:36.004925 [error] [Thread-1 (]: 10 of 10 FAIL 9 unique_dim_channels_channel_id ................................. [[31mFAIL 9[0m in 2.60s]
[0m04:19:36.006931 [debug] [Thread-1 (]: Finished running node test.youtube_project.unique_dim_channels_channel_id.d14657a1ec
[0m04:19:36.010520 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:19:36.011017 [debug] [MainThread]: Connection 'test.youtube_project.unique_dim_channels_channel_id.d14657a1ec' was properly closed.
[0m04:19:36.011718 [info ] [MainThread]: 
[0m04:19:36.012419 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 25.69 seconds (25.69s).
[0m04:19:36.016591 [debug] [MainThread]: Command end result
[0m04:19:36.096036 [info ] [MainThread]: 
[0m04:19:36.096746 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m04:19:36.097193 [info ] [MainThread]: 
[0m04:19:36.098320 [error] [MainThread]:   Database Error in test dbt_expectations_expect_column_values_to_be_between_dim_channels_channel_published_at__CURRENT_TIMESTAMP___1900_01_01 (models/youtube_data/marts/schema.yml)
  No matching signature for operator >= for argument types: TIMESTAMP, INT64. Supported signature: ANY >= ANY at [20:11]
  compiled code at target/run/youtube_project/models/youtube_data/marts/schema.yml/dbt_expectations_expect_column_3a54b5f31930b3072b690793d2bbd408.sql
[0m04:19:36.098973 [info ] [MainThread]: 
[0m04:19:36.100148 [error] [MainThread]: [31mFailure in test unique_dim_channels_channel_id (models/youtube_data/marts/schema.yml)[0m
[0m04:19:36.101275 [error] [MainThread]:   Got 9 results, configured to fail if != 0
[0m04:19:36.102171 [info ] [MainThread]: 
[0m04:19:36.104198 [info ] [MainThread]:   compiled code at target/compiled/youtube_project/models/youtube_data/marts/schema.yml/unique_dim_channels_channel_id.sql
[0m04:19:36.105052 [info ] [MainThread]: 
[0m04:19:36.105505 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=2 SKIP=0 TOTAL=10
[0m04:19:36.108777 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 26.804554, "process_in_blocks": "32", "process_kernel_time": 0.35782, "process_mem_max_rss": "223252", "process_out_blocks": "5823", "process_user_time": 3.346793}
[0m04:19:36.110270 [debug] [MainThread]: Command `dbt test` failed at 04:19:36.110080 after 26.81 seconds
[0m04:19:36.111314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96f794c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96f795e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97ca7740>]}
[0m04:19:36.111973 [debug] [MainThread]: Flushing usage events
[0m04:20:56.554543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89bf2810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86d09790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8addd1f0>]}


============================== 04:20:56.556367 | 402a32cc-c515-4718-ab94-82cc7c90d893 ==============================
[0m04:20:56.556367 [info ] [MainThread]: Running with dbt=1.8.9
[0m04:20:56.556873 [debug] [MainThread]: running dbt with arguments {'log_path': '/usr/local/airflow/include/dbt/logs', 'printer_width': '80', 'target_path': 'None', 'warn_error': 'None', 'introspect': 'True', 'no_print': 'None', 'partial_parse': 'True', 'quiet': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --models youtube_data.marts.dim_channels', 'profiles_dir': '/usr/local/airflow/include/dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'write_json': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False'}
[0m04:20:57.202757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '402a32cc-c515-4718-ab94-82cc7c90d893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ade1790>]}
[0m04:20:57.227336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '402a32cc-c515-4718-ab94-82cc7c90d893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a581e50>]}
[0m04:20:57.227737 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m04:20:57.295635 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m04:20:57.416854 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:20:57.417729 [debug] [MainThread]: Partial parsing: updated file: youtube_project://models/youtube_data/marts/schema.yml
[0m04:20:57.637370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '402a32cc-c515-4718-ab94-82cc7c90d893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff697171a0>]}
[0m04:20:57.724742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '402a32cc-c515-4718-ab94-82cc7c90d893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a0f62d0>]}
[0m04:20:57.725134 [info ] [MainThread]: Found 12 models, 138 data tests, 2 sources, 867 macros
[0m04:20:57.725425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '402a32cc-c515-4718-ab94-82cc7c90d893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69346120>]}
[0m04:20:57.727410 [info ] [MainThread]: 
[0m04:20:57.727850 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m04:20:57.730305 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project_youtube'
[0m04:20:57.730614 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:20:58.543147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '402a32cc-c515-4718-ab94-82cc7c90d893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a2b09e0>]}
[0m04:20:58.544812 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:20:58.545628 [info ] [MainThread]: 
[0m04:20:58.550568 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0.6dcd79a50a
[0m04:20:58.551660 [info ] [Thread-1 (]: 1 of 11 START test dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0  [RUN]
[0m04:20:58.552793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0.6dcd79a50a)
[0m04:20:58.553925 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0.6dcd79a50a
[0m04:20:58.567963 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0.6dcd79a50a"
[0m04:20:58.569842 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0.6dcd79a50a
[0m04:20:58.590954 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0.6dcd79a50a"
[0m04:20:58.592557 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:20:58.594129 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0.6dcd79a50a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0.6dcd79a50a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and length(
        channel_description
    ) >= 0 and length(
        channel_description
    ) <= 1000
)
 as expression


    from `yt-e2e-data-cycle-project`.`youtube`.`dim_channels`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







      
    ) dbt_internal_test
[0m04:20:59.611303 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:bdd8e0c7-25c7-47c7-9459-b2ad6cdac955&page=queryresults
[0m04:21:01.103139 [info ] [Thread-1 (]: 1 of 11 PASS dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0  [[32mPASS[0m in 2.55s]
[0m04:21:01.105414 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0.6dcd79a50a
[0m04:21:01.106308 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_title__255__1.c25e64f1e8
[0m04:21:01.106899 [info ] [Thread-1 (]: 2 of 11 START test dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_title__255__1  [RUN]
[0m04:21:01.107565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0.6dcd79a50a, now test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_title__255__1.c25e64f1e8)
[0m04:21:01.108139 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_title__255__1.c25e64f1e8
[0m04:21:01.115800 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_title__255__1.c25e64f1e8"
[0m04:21:01.117140 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_title__255__1.c25e64f1e8
[0m04:21:01.190775 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_title__255__1.c25e64f1e8"
[0m04:21:01.191773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:21:01.192813 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_title__255__1.c25e64f1e8: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_title__255__1.c25e64f1e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and length(
        channel_title
    ) >= 1 and length(
        channel_title
    ) <= 255
)
 as expression


    from `yt-e2e-data-cycle-project`.`youtube`.`dim_channels`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







      
    ) dbt_internal_test
[0m04:21:02.225686 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:236595cf-2156-471f-85f3-5a1332f2f7d4&page=queryresults
[0m04:21:03.455409 [info ] [Thread-1 (]: 2 of 11 PASS dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_title__255__1  [[32mPASS[0m in 2.35s]
[0m04:21:03.459083 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_title__255__1.c25e64f1e8
[0m04:21:03.460661 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_between_dim_channels_channel_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.332c6eee2c
[0m04:21:03.461512 [info ] [Thread-1 (]: 3 of 11 START test dbt_expectations_expect_column_values_to_be_between_dim_channels_channel_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_  [RUN]
[0m04:21:03.462345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_title__255__1.c25e64f1e8, now test.youtube_project.dbt_expectations_expect_column_values_to_be_between_dim_channels_channel_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.332c6eee2c)
[0m04:21:03.463340 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_between_dim_channels_channel_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.332c6eee2c
[0m04:21:03.470059 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_between_dim_channels_channel_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.332c6eee2c"
[0m04:21:03.472219 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_between_dim_channels_channel_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.332c6eee2c
[0m04:21:03.476254 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_between_dim_channels_channel_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.332c6eee2c"
[0m04:21:03.478411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:21:03.480853 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_between_dim_channels_channel_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.332c6eee2c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_between_dim_channels_channel_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.332c6eee2c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and channel_published_at >= TIMESTAMP('1900-01-01 00:00:00') and channel_published_at <= TIMESTAMP('2100-12-31 23:59:59')
)
 as expression


    from `yt-e2e-data-cycle-project`.`youtube`.`dim_channels`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m04:21:04.786238 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:12c24c6b-a620-457d-b809-b8bf19f24e8e&page=queryresults
[0m04:21:06.015127 [info ] [Thread-1 (]: 3 of 11 PASS dbt_expectations_expect_column_values_to_be_between_dim_channels_channel_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_  [[32mPASS[0m in 2.55s]
[0m04:21:06.017692 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_between_dim_channels_channel_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.332c6eee2c
[0m04:21:06.019547 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_description__STRING.642c21036e
[0m04:21:06.020777 [info ] [Thread-1 (]: 4 of 11 START test dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_description__STRING  [RUN]
[0m04:21:06.022002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_between_dim_channels_channel_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.332c6eee2c, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_description__STRING.642c21036e)
[0m04:21:06.023022 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_description__STRING.642c21036e
[0m04:21:06.038856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:21:06.843506 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_description__STRING.642c21036e"
[0m04:21:06.846237 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_description__STRING.642c21036e
[0m04:21:06.850308 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_description__STRING.642c21036e"
[0m04:21:06.852134 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_description__STRING.642c21036e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_description__STRING.642c21036e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('PK_CHANNEL_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_TITLE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_DESCRIPTION' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'CHANNEL_DESCRIPTION'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:21:07.343549 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:b21f93a1-0b0f-43b6-9298-5c02a2856566&page=queryresults
[0m04:21:08.471852 [info ] [Thread-1 (]: 4 of 11 PASS dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_description__STRING  [[32mPASS[0m in 2.45s]
[0m04:21:08.474463 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_description__STRING.642c21036e
[0m04:21:08.476417 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_id__STRING.fa3801035c
[0m04:21:08.477633 [info ] [Thread-1 (]: 5 of 11 START test dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_id__STRING  [RUN]
[0m04:21:08.478765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_description__STRING.642c21036e, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_id__STRING.fa3801035c)
[0m04:21:08.479781 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_id__STRING.fa3801035c
[0m04:21:08.495993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:21:09.281943 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_id__STRING.fa3801035c"
[0m04:21:09.285113 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_id__STRING.fa3801035c
[0m04:21:09.289874 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_id__STRING.fa3801035c"
[0m04:21:09.292847 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_id__STRING.fa3801035c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_id__STRING.fa3801035c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('PK_CHANNEL_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_TITLE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_DESCRIPTION' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'CHANNEL_ID'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:21:09.802820 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:603a1636-edc9-4632-bbd7-d3c40c2607b2&page=queryresults
[0m04:21:10.929968 [info ] [Thread-1 (]: 5 of 11 PASS dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_id__STRING  [[32mPASS[0m in 2.45s]
[0m04:21:10.933060 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_id__STRING.fa3801035c
[0m04:21:10.934533 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_published_at__TIMESTAMP.88c47c5564
[0m04:21:10.935526 [info ] [Thread-1 (]: 6 of 11 START test dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_published_at__TIMESTAMP  [RUN]
[0m04:21:10.936698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_id__STRING.fa3801035c, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_published_at__TIMESTAMP.88c47c5564)
[0m04:21:10.937530 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_published_at__TIMESTAMP.88c47c5564
[0m04:21:10.945293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:21:11.756980 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_published_at__TIMESTAMP.88c47c5564"
[0m04:21:11.760983 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_published_at__TIMESTAMP.88c47c5564
[0m04:21:11.767221 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_published_at__TIMESTAMP.88c47c5564"
[0m04:21:11.769161 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_published_at__TIMESTAMP.88c47c5564: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_published_at__TIMESTAMP.88c47c5564"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('PK_CHANNEL_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_TITLE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_DESCRIPTION' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'CHANNEL_PUBLISHED_AT'
            and
            relation_column_type not in ('TIMESTAMP')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:21:12.260578 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:58dab3e8-41b6-4941-ab20-637f9ca1c092&page=queryresults
[0m04:21:13.589690 [info ] [Thread-1 (]: 6 of 11 PASS dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_published_at__TIMESTAMP  [[32mPASS[0m in 2.65s]
[0m04:21:13.591233 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_published_at__TIMESTAMP.88c47c5564
[0m04:21:13.591990 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_title__STRING.db4a69ac9c
[0m04:21:13.592609 [info ] [Thread-1 (]: 7 of 11 START test dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_title__STRING  [RUN]
[0m04:21:13.593227 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_published_at__TIMESTAMP.88c47c5564, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_title__STRING.db4a69ac9c)
[0m04:21:13.593668 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_title__STRING.db4a69ac9c
[0m04:21:13.598518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:21:14.416942 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_title__STRING.db4a69ac9c"
[0m04:21:14.419634 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_title__STRING.db4a69ac9c
[0m04:21:14.424725 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_title__STRING.db4a69ac9c"
[0m04:21:14.426932 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_title__STRING.db4a69ac9c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_title__STRING.db4a69ac9c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('PK_CHANNEL_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_TITLE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_DESCRIPTION' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'CHANNEL_TITLE'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:21:15.127006 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:dd047418-c441-4474-bbe5-9293f2d9a1d9&page=queryresults
[0m04:21:16.357126 [info ] [Thread-1 (]: 7 of 11 PASS dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_title__STRING  [[32mPASS[0m in 2.76s]
[0m04:21:16.359520 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_title__STRING.db4a69ac9c
[0m04:21:16.361271 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_dim_channels_channel_id.93e5e4b23b
[0m04:21:16.362275 [info ] [Thread-1 (]: 8 of 11 START test not_null_dim_channels_channel_id ............................ [RUN]
[0m04:21:16.363169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_title__STRING.db4a69ac9c, now test.youtube_project.not_null_dim_channels_channel_id.93e5e4b23b)
[0m04:21:16.364295 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_dim_channels_channel_id.93e5e4b23b
[0m04:21:16.384121 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_dim_channels_channel_id.93e5e4b23b"
[0m04:21:16.385723 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_dim_channels_channel_id.93e5e4b23b
[0m04:21:16.389348 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_dim_channels_channel_id.93e5e4b23b"
[0m04:21:16.390854 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:21:16.393088 [debug] [Thread-1 (]: On test.youtube_project.not_null_dim_channels_channel_id.93e5e4b23b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_dim_channels_channel_id.93e5e4b23b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select channel_id
from `yt-e2e-data-cycle-project`.`youtube`.`dim_channels`
where channel_id is null



      
    ) dbt_internal_test
[0m04:21:17.482163 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:87a75c34-f58a-44a4-b379-eee65be42d6b&page=queryresults
[0m04:21:18.712359 [info ] [Thread-1 (]: 8 of 11 PASS not_null_dim_channels_channel_id .................................. [[32mPASS[0m in 2.35s]
[0m04:21:18.714863 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_dim_channels_channel_id.93e5e4b23b
[0m04:21:18.716825 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_dim_channels_channel_title.5f5d78e27d
[0m04:21:18.718145 [info ] [Thread-1 (]: 9 of 11 START test not_null_dim_channels_channel_title ......................... [RUN]
[0m04:21:18.719325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_dim_channels_channel_id.93e5e4b23b, now test.youtube_project.not_null_dim_channels_channel_title.5f5d78e27d)
[0m04:21:18.720311 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_dim_channels_channel_title.5f5d78e27d
[0m04:21:18.728888 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_dim_channels_channel_title.5f5d78e27d"
[0m04:21:18.731629 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_dim_channels_channel_title.5f5d78e27d
[0m04:21:18.735427 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_dim_channels_channel_title.5f5d78e27d"
[0m04:21:18.736823 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:21:18.739095 [debug] [Thread-1 (]: On test.youtube_project.not_null_dim_channels_channel_title.5f5d78e27d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_dim_channels_channel_title.5f5d78e27d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select channel_title
from `yt-e2e-data-cycle-project`.`youtube`.`dim_channels`
where channel_title is null



      
    ) dbt_internal_test
[0m04:21:19.837445 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:4596bbb3-d747-45c6-909b-3be1d4a7f4b4&page=queryresults
[0m04:21:21.066042 [info ] [Thread-1 (]: 9 of 11 PASS not_null_dim_channels_channel_title ............................... [[32mPASS[0m in 2.35s]
[0m04:21:21.068977 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_dim_channels_channel_title.5f5d78e27d
[0m04:21:21.070287 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_dim_channels_pk_channel_id.a37db45220
[0m04:21:21.071308 [info ] [Thread-1 (]: 10 of 11 START test not_null_dim_channels_pk_channel_id ........................ [RUN]
[0m04:21:21.072475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_dim_channels_channel_title.5f5d78e27d, now test.youtube_project.not_null_dim_channels_pk_channel_id.a37db45220)
[0m04:21:21.073325 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_dim_channels_pk_channel_id.a37db45220
[0m04:21:21.080461 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_dim_channels_pk_channel_id.a37db45220"
[0m04:21:21.082446 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_dim_channels_pk_channel_id.a37db45220
[0m04:21:21.087712 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_dim_channels_pk_channel_id.a37db45220"
[0m04:21:21.090055 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:21:21.092733 [debug] [Thread-1 (]: On test.youtube_project.not_null_dim_channels_pk_channel_id.a37db45220: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_dim_channels_pk_channel_id.a37db45220"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_channel_id
from `yt-e2e-data-cycle-project`.`youtube`.`dim_channels`
where pk_channel_id is null



      
    ) dbt_internal_test
[0m04:21:22.193925 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:0ccd42ae-f9b3-428e-8617-471ce25dedc9&page=queryresults
[0m04:21:23.422651 [info ] [Thread-1 (]: 10 of 11 PASS not_null_dim_channels_pk_channel_id .............................. [[32mPASS[0m in 2.35s]
[0m04:21:23.425938 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_dim_channels_pk_channel_id.a37db45220
[0m04:21:23.427990 [debug] [Thread-1 (]: Began running node test.youtube_project.unique_dim_channels_pk_channel_id.18ea0b2251
[0m04:21:23.429092 [info ] [Thread-1 (]: 11 of 11 START test unique_dim_channels_pk_channel_id .......................... [RUN]
[0m04:21:23.430309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_dim_channels_pk_channel_id.a37db45220, now test.youtube_project.unique_dim_channels_pk_channel_id.18ea0b2251)
[0m04:21:23.431246 [debug] [Thread-1 (]: Began compiling node test.youtube_project.unique_dim_channels_pk_channel_id.18ea0b2251
[0m04:21:23.448417 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.unique_dim_channels_pk_channel_id.18ea0b2251"
[0m04:21:23.450511 [debug] [Thread-1 (]: Began executing node test.youtube_project.unique_dim_channels_pk_channel_id.18ea0b2251
[0m04:21:23.453789 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.unique_dim_channels_pk_channel_id.18ea0b2251"
[0m04:21:23.455368 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:21:23.457583 [debug] [Thread-1 (]: On test.youtube_project.unique_dim_channels_pk_channel_id.18ea0b2251: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.unique_dim_channels_pk_channel_id.18ea0b2251"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select pk_channel_id as unique_field
  from `yt-e2e-data-cycle-project`.`youtube`.`dim_channels`
  where pk_channel_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m04:21:24.856075 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:3c7b6494-45d5-4ed6-acb2-f076a4c37dd6&page=queryresults
[0m04:21:25.983378 [error] [Thread-1 (]: 11 of 11 FAIL 2 unique_dim_channels_pk_channel_id .............................. [[31mFAIL 2[0m in 2.55s]
[0m04:21:25.985602 [debug] [Thread-1 (]: Finished running node test.youtube_project.unique_dim_channels_pk_channel_id.18ea0b2251
[0m04:21:25.994850 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:21:25.995482 [debug] [MainThread]: Connection 'test.youtube_project.unique_dim_channels_pk_channel_id.18ea0b2251' was properly closed.
[0m04:21:25.996290 [info ] [MainThread]: 
[0m04:21:25.997088 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 28.27 seconds (28.27s).
[0m04:21:26.001139 [debug] [MainThread]: Command end result
[0m04:21:26.080514 [info ] [MainThread]: 
[0m04:21:26.081252 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:21:26.081556 [info ] [MainThread]: 
[0m04:21:26.082065 [error] [MainThread]: [31mFailure in test unique_dim_channels_pk_channel_id (models/youtube_data/marts/schema.yml)[0m
[0m04:21:26.082481 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m04:21:26.082747 [info ] [MainThread]: 
[0m04:21:26.083098 [info ] [MainThread]:   compiled code at target/compiled/youtube_project/models/youtube_data/marts/schema.yml/unique_dim_channels_pk_channel_id.sql
[0m04:21:26.083416 [info ] [MainThread]: 
[0m04:21:26.083869 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m04:21:26.086420 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 29.558727, "process_in_blocks": "0", "process_kernel_time": 0.35182, "process_mem_max_rss": "226960", "process_out_blocks": "8362", "process_user_time": 3.645221}
[0m04:21:26.087159 [debug] [MainThread]: Command `dbt test` failed at 04:21:26.087033 after 29.56 seconds
[0m04:21:26.088011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b1b7050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86c05190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a046c90>]}
[0m04:21:26.088501 [debug] [MainThread]: Flushing usage events
[0m04:25:49.722101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa530410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9f0c800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa5323c0>]}


============================== 04:25:49.723474 | e9496db6-1d12-4f13-89fc-2aa169bd3dd3 ==============================
[0m04:25:49.723474 [info ] [MainThread]: Running with dbt=1.8.9
[0m04:25:49.723970 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'profiles_dir': '/usr/local/airflow/include/dbt', 'introspect': 'True', 'no_print': 'None', 'use_colors': 'True', 'target_path': 'None', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'debug': 'False', 'log_format': 'default', 'printer_width': '80', 'write_json': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --models youtube_data.marts.dim_channels', 'log_cache_events': 'False', 'partial_parse': 'True', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False'}
[0m04:25:50.421923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9496db6-1d12-4f13-89fc-2aa169bd3dd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eb904a0>]}
[0m04:25:50.446716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9496db6-1d12-4f13-89fc-2aa169bd3dd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac2a6600>]}
[0m04:25:50.447113 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m04:25:50.516093 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m04:25:50.648936 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:25:50.649588 [debug] [MainThread]: Partial parsing: updated file: youtube_project://models/youtube_data/marts/dim_channels.sql
[0m04:25:50.872519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9496db6-1d12-4f13-89fc-2aa169bd3dd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c942f60>]}
[0m04:25:50.958710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9496db6-1d12-4f13-89fc-2aa169bd3dd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c942c90>]}
[0m04:25:50.959135 [info ] [MainThread]: Found 12 models, 138 data tests, 2 sources, 867 macros
[0m04:25:50.959419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9496db6-1d12-4f13-89fc-2aa169bd3dd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cabe5a0>]}
[0m04:25:50.961228 [info ] [MainThread]: 
[0m04:25:50.961715 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m04:25:50.962415 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project'
[0m04:25:50.962663 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:25:51.842049 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project, now list_yt-e2e-data-cycle-project_youtube)
[0m04:25:51.843314 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:25:52.764471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9496db6-1d12-4f13-89fc-2aa169bd3dd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaabd6690>]}
[0m04:25:52.767187 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:25:52.768298 [info ] [MainThread]: 
[0m04:25:52.775768 [debug] [Thread-1 (]: Began running node model.youtube_project.dim_channels
[0m04:25:52.777299 [info ] [Thread-1 (]: 1 of 1 START sql table model youtube.dim_channels .............................. [RUN]
[0m04:25:52.778392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now model.youtube_project.dim_channels)
[0m04:25:52.779898 [debug] [Thread-1 (]: Began compiling node model.youtube_project.dim_channels
[0m04:25:52.796834 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_project.dim_channels"
[0m04:25:52.799584 [debug] [Thread-1 (]: Began executing node model.youtube_project.dim_channels
[0m04:25:52.817593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:25:53.591535 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_project.dim_channels"
[0m04:25:53.593580 [debug] [Thread-1 (]: On model.youtube_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "model.youtube_project.dim_channels"} */

  
    

    create or replace table `yt-e2e-data-cycle-project`.`youtube`.`dim_channels`
      
    
    cluster by channel_id

    OPTIONS()
    as (
      WITH channel_data AS (
    SELECT * 
    FROM `yt-e2e-data-cycle-project`.`youtube`.`staging_channel`  
),

channel_filled AS (
    SELECT
        channel_id,
        
        -- Clean invalid characters from channel title
        COALESCE(
            REGEXP_REPLACE(channel_title, r'[\x00-\x1F\x7F-\x9F\xAD�]', ''), 
            'No Channel Title Available'
        ) AS channel_title,
        
        -- Clean invalid characters from channel description
        COALESCE(
            REGEXP_REPLACE(channel_description, r'[\x00-\x1F\x7F-\x9F\xAD�]', ''), 
            'No Channel Description Available'
        ) AS channel_description,
        
        -- If channel_published_at is NULL, replace with CURRENT_TIMESTAMP
        COALESCE(channel_published_at, CURRENT_TIMESTAMP()) AS channel_published_at
    FROM
        channel_data
)

SELECT
    ROW_NUMBER() OVER (ORDER BY c.channel_id) as pk_channel_id,  
    c.channel_id,
    c.channel_title,
    c.channel_description,
    c.channel_published_at
FROM
    channel_filled c
    );
  
[0m04:25:54.393278 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:4ec3312d-72eb-463c-92f3-e7a8aa57d946&page=queryresults
[0m04:25:57.082321 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9496db6-1d12-4f13-89fc-2aa169bd3dd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8de7c080>]}
[0m04:25:57.083730 [info ] [Thread-1 (]: 1 of 1 OK created sql table model youtube.dim_channels ......................... [[32mCREATE TABLE (100.0 rows, 28.0 KiB processed)[0m in 4.30s]
[0m04:25:57.085121 [debug] [Thread-1 (]: Finished running node model.youtube_project.dim_channels
[0m04:25:57.087257 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:25:57.087766 [debug] [MainThread]: Connection 'model.youtube_project.dim_channels' was properly closed.
[0m04:25:57.088306 [info ] [MainThread]: 
[0m04:25:57.088917 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.13 seconds (6.13s).
[0m04:25:57.090199 [debug] [MainThread]: Command end result
[0m04:25:57.219250 [info ] [MainThread]: 
[0m04:25:57.219633 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:25:57.220139 [info ] [MainThread]: 
[0m04:25:57.220372 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:25:57.221260 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.523037, "process_in_blocks": "0", "process_kernel_time": 0.274551, "process_mem_max_rss": "225640", "process_out_blocks": "8229", "process_user_time": 2.729309}
[0m04:25:57.221602 [debug] [MainThread]: Command `dbt run` succeeded at 04:25:57.221541 after 7.52 seconds
[0m04:25:57.221859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ccd61b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ccd5be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ccd73b0>]}
[0m04:25:57.222072 [debug] [MainThread]: Flushing usage events
[0m04:26:03.478158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0067bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa00678c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa00650a0>]}


============================== 04:26:03.479386 | 269d8e71-3be6-4909-99c5-381e2da7af7d ==============================
[0m04:26:03.479386 [info ] [MainThread]: Running with dbt=1.8.9
[0m04:26:03.479940 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'write_json': 'True', 'introspect': 'True', 'warn_error': 'None', 'printer_width': '80', 'log_cache_events': 'False', 'no_print': 'None', 'invocation_command': 'dbt test --models youtube_data.marts.dim_channels', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'empty': 'None', 'static_parser': 'True', 'quiet': 'False', 'log_format': 'default', 'debug': 'False', 'target_path': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'version_check': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m04:26:04.105713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '269d8e71-3be6-4909-99c5-381e2da7af7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff836c1070>]}
[0m04:26:04.130565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '269d8e71-3be6-4909-99c5-381e2da7af7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83fd1700>]}
[0m04:26:04.130985 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m04:26:04.194946 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m04:26:04.332694 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:26:04.333228 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:26:04.357018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '269d8e71-3be6-4909-99c5-381e2da7af7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff833bf800>]}
[0m04:26:04.451093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '269d8e71-3be6-4909-99c5-381e2da7af7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82b65280>]}
[0m04:26:04.451477 [info ] [MainThread]: Found 12 models, 138 data tests, 2 sources, 867 macros
[0m04:26:04.451800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '269d8e71-3be6-4909-99c5-381e2da7af7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82f33170>]}
[0m04:26:04.453981 [info ] [MainThread]: 
[0m04:26:04.454521 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m04:26:04.457026 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project_youtube'
[0m04:26:04.457345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:26:05.252194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '269d8e71-3be6-4909-99c5-381e2da7af7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff832798e0>]}
[0m04:26:05.253741 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:26:05.254905 [info ] [MainThread]: 
[0m04:26:05.260628 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0.6dcd79a50a
[0m04:26:05.261875 [info ] [Thread-1 (]: 1 of 11 START test dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0  [RUN]
[0m04:26:05.262970 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0.6dcd79a50a)
[0m04:26:05.263840 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0.6dcd79a50a
[0m04:26:05.316595 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0.6dcd79a50a"
[0m04:26:05.317970 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0.6dcd79a50a
[0m04:26:05.331909 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0.6dcd79a50a"
[0m04:26:05.332979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:26:05.334234 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0.6dcd79a50a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0.6dcd79a50a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and length(
        channel_description
    ) >= 0 and length(
        channel_description
    ) <= 1000
)
 as expression


    from `yt-e2e-data-cycle-project`.`youtube`.`dim_channels`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







      
    ) dbt_internal_test
[0m04:26:06.496036 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:2ff38e4d-4b0d-4551-82fc-24ebfb7298d6&page=queryresults
[0m04:26:07.633843 [info ] [Thread-1 (]: 1 of 11 PASS dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0  [[32mPASS[0m in 2.37s]
[0m04:26:07.635656 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0.6dcd79a50a
[0m04:26:07.636502 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_title__255__1.c25e64f1e8
[0m04:26:07.637153 [info ] [Thread-1 (]: 2 of 11 START test dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_title__255__1  [RUN]
[0m04:26:07.637869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0.6dcd79a50a, now test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_title__255__1.c25e64f1e8)
[0m04:26:07.638377 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_title__255__1.c25e64f1e8
[0m04:26:07.645347 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_title__255__1.c25e64f1e8"
[0m04:26:07.647108 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_title__255__1.c25e64f1e8
[0m04:26:07.649941 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_title__255__1.c25e64f1e8"
[0m04:26:07.651067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:26:07.652649 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_title__255__1.c25e64f1e8: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_title__255__1.c25e64f1e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and length(
        channel_title
    ) >= 1 and length(
        channel_title
    ) <= 255
)
 as expression


    from `yt-e2e-data-cycle-project`.`youtube`.`dim_channels`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







      
    ) dbt_internal_test
[0m04:26:08.831991 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:d4f9c951-2616-449f-a239-bbac060c243d&page=queryresults
[0m04:26:10.058772 [info ] [Thread-1 (]: 2 of 11 PASS dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_title__255__1  [[32mPASS[0m in 2.42s]
[0m04:26:10.061889 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_title__255__1.c25e64f1e8
[0m04:26:10.063182 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_between_dim_channels_channel_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.332c6eee2c
[0m04:26:10.065196 [info ] [Thread-1 (]: 3 of 11 START test dbt_expectations_expect_column_values_to_be_between_dim_channels_channel_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_  [RUN]
[0m04:26:10.067374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_title__255__1.c25e64f1e8, now test.youtube_project.dbt_expectations_expect_column_values_to_be_between_dim_channels_channel_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.332c6eee2c)
[0m04:26:10.068655 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_between_dim_channels_channel_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.332c6eee2c
[0m04:26:10.084295 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_between_dim_channels_channel_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.332c6eee2c"
[0m04:26:10.086711 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_between_dim_channels_channel_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.332c6eee2c
[0m04:26:10.093197 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_between_dim_channels_channel_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.332c6eee2c"
[0m04:26:10.094567 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:26:10.096370 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_between_dim_channels_channel_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.332c6eee2c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_between_dim_channels_channel_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.332c6eee2c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and channel_published_at >= TIMESTAMP('1900-01-01 00:00:00') and channel_published_at <= TIMESTAMP('2100-12-31 23:59:59')
)
 as expression


    from `yt-e2e-data-cycle-project`.`youtube`.`dim_channels`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m04:26:11.440464 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:b7126b72-db42-4237-93ca-1752ecaf778d&page=queryresults
[0m04:26:12.620303 [info ] [Thread-1 (]: 3 of 11 PASS dbt_expectations_expect_column_values_to_be_between_dim_channels_channel_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_  [[32mPASS[0m in 2.55s]
[0m04:26:12.622927 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_between_dim_channels_channel_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.332c6eee2c
[0m04:26:12.624297 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_description__STRING.642c21036e
[0m04:26:12.625211 [info ] [Thread-1 (]: 4 of 11 START test dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_description__STRING  [RUN]
[0m04:26:12.626196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_between_dim_channels_channel_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.332c6eee2c, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_description__STRING.642c21036e)
[0m04:26:12.627057 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_description__STRING.642c21036e
[0m04:26:12.645894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:26:13.458563 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_description__STRING.642c21036e"
[0m04:26:13.462140 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_description__STRING.642c21036e
[0m04:26:13.466616 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_description__STRING.642c21036e"
[0m04:26:13.468302 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_description__STRING.642c21036e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_description__STRING.642c21036e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('PK_CHANNEL_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_TITLE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_DESCRIPTION' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'CHANNEL_DESCRIPTION'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:26:13.949942 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:bd57fc22-24b9-4ee4-95f8-c0bd07a4174d&page=queryresults
[0m04:26:15.177899 [info ] [Thread-1 (]: 4 of 11 PASS dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_description__STRING  [[32mPASS[0m in 2.55s]
[0m04:26:15.179888 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_description__STRING.642c21036e
[0m04:26:15.181001 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_id__STRING.fa3801035c
[0m04:26:15.181974 [info ] [Thread-1 (]: 5 of 11 START test dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_id__STRING  [RUN]
[0m04:26:15.183016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_description__STRING.642c21036e, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_id__STRING.fa3801035c)
[0m04:26:15.183743 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_id__STRING.fa3801035c
[0m04:26:15.190315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:26:16.003968 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_id__STRING.fa3801035c"
[0m04:26:16.006778 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_id__STRING.fa3801035c
[0m04:26:16.011733 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_id__STRING.fa3801035c"
[0m04:26:16.013798 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_id__STRING.fa3801035c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_id__STRING.fa3801035c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('PK_CHANNEL_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_TITLE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_DESCRIPTION' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'CHANNEL_ID'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:26:16.819623 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:daf98c30-7438-4977-b2f0-1ba27f22db9d&page=queryresults
[0m04:26:17.942854 [info ] [Thread-1 (]: 5 of 11 PASS dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_id__STRING  [[32mPASS[0m in 2.76s]
[0m04:26:17.944334 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_id__STRING.fa3801035c
[0m04:26:17.945198 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_published_at__TIMESTAMP.88c47c5564
[0m04:26:17.945800 [info ] [Thread-1 (]: 6 of 11 START test dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_published_at__TIMESTAMP  [RUN]
[0m04:26:17.946574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_id__STRING.fa3801035c, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_published_at__TIMESTAMP.88c47c5564)
[0m04:26:17.947067 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_published_at__TIMESTAMP.88c47c5564
[0m04:26:17.954693 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:26:18.769520 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_published_at__TIMESTAMP.88c47c5564"
[0m04:26:18.772251 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_published_at__TIMESTAMP.88c47c5564
[0m04:26:18.777540 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_published_at__TIMESTAMP.88c47c5564"
[0m04:26:18.779680 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_published_at__TIMESTAMP.88c47c5564: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_published_at__TIMESTAMP.88c47c5564"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('PK_CHANNEL_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_TITLE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_DESCRIPTION' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'CHANNEL_PUBLISHED_AT'
            and
            relation_column_type not in ('TIMESTAMP')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:26:19.275635 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:4a33b067-e17e-4af9-9c36-4c8c4275ae0f&page=queryresults
[0m04:26:20.509986 [info ] [Thread-1 (]: 6 of 11 PASS dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_published_at__TIMESTAMP  [[32mPASS[0m in 2.56s]
[0m04:26:20.514001 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_published_at__TIMESTAMP.88c47c5564
[0m04:26:20.515091 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_title__STRING.db4a69ac9c
[0m04:26:20.516258 [info ] [Thread-1 (]: 7 of 11 START test dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_title__STRING  [RUN]
[0m04:26:20.516972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_published_at__TIMESTAMP.88c47c5564, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_title__STRING.db4a69ac9c)
[0m04:26:20.517541 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_title__STRING.db4a69ac9c
[0m04:26:20.529650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:26:21.331236 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_title__STRING.db4a69ac9c"
[0m04:26:21.334059 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_title__STRING.db4a69ac9c
[0m04:26:21.340316 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_title__STRING.db4a69ac9c"
[0m04:26:21.342132 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_title__STRING.db4a69ac9c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_title__STRING.db4a69ac9c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('PK_CHANNEL_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_TITLE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_DESCRIPTION' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'CHANNEL_TITLE'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:26:21.835971 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:ae9119e5-0918-4cb3-b084-3c75a59497f1&page=queryresults
[0m04:26:23.065658 [info ] [Thread-1 (]: 7 of 11 PASS dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_title__STRING  [[32mPASS[0m in 2.55s]
[0m04:26:23.068727 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_title__STRING.db4a69ac9c
[0m04:26:23.070332 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_dim_channels_channel_id.93e5e4b23b
[0m04:26:23.071326 [info ] [Thread-1 (]: 8 of 11 START test not_null_dim_channels_channel_id ............................ [RUN]
[0m04:26:23.072512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_channels_channel_title__STRING.db4a69ac9c, now test.youtube_project.not_null_dim_channels_channel_id.93e5e4b23b)
[0m04:26:23.073296 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_dim_channels_channel_id.93e5e4b23b
[0m04:26:23.090166 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_dim_channels_channel_id.93e5e4b23b"
[0m04:26:23.092658 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_dim_channels_channel_id.93e5e4b23b
[0m04:26:23.096979 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_dim_channels_channel_id.93e5e4b23b"
[0m04:26:23.098488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:26:23.101213 [debug] [Thread-1 (]: On test.youtube_project.not_null_dim_channels_channel_id.93e5e4b23b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_dim_channels_channel_id.93e5e4b23b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select channel_id
from `yt-e2e-data-cycle-project`.`youtube`.`dim_channels`
where channel_id is null



      
    ) dbt_internal_test
[0m04:26:24.192059 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:68e06587-badc-4493-a242-cc678ad4d48f&page=queryresults
[0m04:26:25.418515 [info ] [Thread-1 (]: 8 of 11 PASS not_null_dim_channels_channel_id .................................. [[32mPASS[0m in 2.35s]
[0m04:26:25.420286 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_dim_channels_channel_id.93e5e4b23b
[0m04:26:25.421301 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_dim_channels_channel_title.5f5d78e27d
[0m04:26:25.422180 [info ] [Thread-1 (]: 9 of 11 START test not_null_dim_channels_channel_title ......................... [RUN]
[0m04:26:25.423204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_dim_channels_channel_id.93e5e4b23b, now test.youtube_project.not_null_dim_channels_channel_title.5f5d78e27d)
[0m04:26:25.423875 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_dim_channels_channel_title.5f5d78e27d
[0m04:26:25.434001 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_dim_channels_channel_title.5f5d78e27d"
[0m04:26:25.435648 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_dim_channels_channel_title.5f5d78e27d
[0m04:26:25.439551 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_dim_channels_channel_title.5f5d78e27d"
[0m04:26:25.441449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:26:25.443630 [debug] [Thread-1 (]: On test.youtube_project.not_null_dim_channels_channel_title.5f5d78e27d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_dim_channels_channel_title.5f5d78e27d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select channel_title
from `yt-e2e-data-cycle-project`.`youtube`.`dim_channels`
where channel_title is null



      
    ) dbt_internal_test
[0m04:26:26.643678 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:f82b5a28-9de8-4c3d-b0f3-6dc9e7b1c264&page=queryresults
[0m04:26:27.877492 [info ] [Thread-1 (]: 9 of 11 PASS not_null_dim_channels_channel_title ............................... [[32mPASS[0m in 2.45s]
[0m04:26:27.879272 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_dim_channels_channel_title.5f5d78e27d
[0m04:26:27.880203 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_dim_channels_pk_channel_id.a37db45220
[0m04:26:27.880875 [info ] [Thread-1 (]: 10 of 11 START test not_null_dim_channels_pk_channel_id ........................ [RUN]
[0m04:26:27.881853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_dim_channels_channel_title.5f5d78e27d, now test.youtube_project.not_null_dim_channels_pk_channel_id.a37db45220)
[0m04:26:27.882517 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_dim_channels_pk_channel_id.a37db45220
[0m04:26:27.889251 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_dim_channels_pk_channel_id.a37db45220"
[0m04:26:27.891161 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_dim_channels_pk_channel_id.a37db45220
[0m04:26:27.894144 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_dim_channels_pk_channel_id.a37db45220"
[0m04:26:27.895560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:26:27.897455 [debug] [Thread-1 (]: On test.youtube_project.not_null_dim_channels_pk_channel_id.a37db45220: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_dim_channels_pk_channel_id.a37db45220"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_channel_id
from `yt-e2e-data-cycle-project`.`youtube`.`dim_channels`
where pk_channel_id is null



      
    ) dbt_internal_test
[0m04:26:29.013364 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:f2b934eb-a155-4807-922d-bd2bfb29706f&page=queryresults
[0m04:26:30.234089 [info ] [Thread-1 (]: 10 of 11 PASS not_null_dim_channels_pk_channel_id .............................. [[32mPASS[0m in 2.35s]
[0m04:26:30.237061 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_dim_channels_pk_channel_id.a37db45220
[0m04:26:30.239247 [debug] [Thread-1 (]: Began running node test.youtube_project.unique_dim_channels_pk_channel_id.18ea0b2251
[0m04:26:30.240207 [info ] [Thread-1 (]: 11 of 11 START test unique_dim_channels_pk_channel_id .......................... [RUN]
[0m04:26:30.241321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_dim_channels_pk_channel_id.a37db45220, now test.youtube_project.unique_dim_channels_pk_channel_id.18ea0b2251)
[0m04:26:30.242276 [debug] [Thread-1 (]: Began compiling node test.youtube_project.unique_dim_channels_pk_channel_id.18ea0b2251
[0m04:26:30.253881 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.unique_dim_channels_pk_channel_id.18ea0b2251"
[0m04:26:30.255860 [debug] [Thread-1 (]: Began executing node test.youtube_project.unique_dim_channels_pk_channel_id.18ea0b2251
[0m04:26:30.259809 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.unique_dim_channels_pk_channel_id.18ea0b2251"
[0m04:26:30.261288 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:26:30.263372 [debug] [Thread-1 (]: On test.youtube_project.unique_dim_channels_pk_channel_id.18ea0b2251: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.unique_dim_channels_pk_channel_id.18ea0b2251"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select pk_channel_id as unique_field
  from `yt-e2e-data-cycle-project`.`youtube`.`dim_channels`
  where pk_channel_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m04:26:31.465014 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:0b8c065a-2a12-4332-9abd-cda5ed0c3d37&page=queryresults
[0m04:26:32.690986 [info ] [Thread-1 (]: 11 of 11 PASS unique_dim_channels_pk_channel_id ................................ [[32mPASS[0m in 2.45s]
[0m04:26:32.693580 [debug] [Thread-1 (]: Finished running node test.youtube_project.unique_dim_channels_pk_channel_id.18ea0b2251
[0m04:26:32.698330 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:26:32.698980 [debug] [MainThread]: Connection 'test.youtube_project.unique_dim_channels_pk_channel_id.18ea0b2251' was properly closed.
[0m04:26:32.699785 [info ] [MainThread]: 
[0m04:26:32.700663 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 28.25 seconds (28.25s).
[0m04:26:32.705107 [debug] [MainThread]: Command end result
[0m04:26:32.790124 [info ] [MainThread]: 
[0m04:26:32.790769 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:26:32.791094 [info ] [MainThread]: 
[0m04:26:32.791493 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m04:26:32.793705 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 29.34054, "process_in_blocks": "0", "process_kernel_time": 0.278575, "process_mem_max_rss": "222740", "process_out_blocks": "5839", "process_user_time": 3.438446}
[0m04:26:32.794407 [debug] [MainThread]: Command `dbt test` succeeded at 04:26:32.794256 after 29.34 seconds
[0m04:26:32.794960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0ca2600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83370410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0067bf0>]}
[0m04:26:32.795415 [debug] [MainThread]: Flushing usage events
[0m04:34:27.287187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff839fd8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84e41a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff839fd7f0>]}


============================== 04:34:27.288457 | 53fb076c-8a9a-4a13-93e7-a52d7da79cde ==============================
[0m04:34:27.288457 [info ] [MainThread]: Running with dbt=1.8.9
[0m04:34:27.288932 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'cache_selected_only': 'False', 'no_print': 'None', 'quiet': 'False', 'write_json': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'version_check': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'log_path': '/usr/local/airflow/include/dbt/logs', 'printer_width': '80', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --models youtube_data.marts.dim_regions', 'empty': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt'}
[0m04:34:27.903305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53fb076c-8a9a-4a13-93e7-a52d7da79cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6710de20>]}
[0m04:34:27.928319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53fb076c-8a9a-4a13-93e7-a52d7da79cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff673c0110>]}
[0m04:34:27.928726 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m04:34:27.996714 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m04:34:28.148111 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:34:28.148440 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:34:28.170641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53fb076c-8a9a-4a13-93e7-a52d7da79cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67037470>]}
[0m04:34:28.253340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53fb076c-8a9a-4a13-93e7-a52d7da79cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66b99f70>]}
[0m04:34:28.253735 [info ] [MainThread]: Found 12 models, 138 data tests, 2 sources, 867 macros
[0m04:34:28.253985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53fb076c-8a9a-4a13-93e7-a52d7da79cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66f362a0>]}
[0m04:34:28.255766 [info ] [MainThread]: 
[0m04:34:28.256230 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m04:34:28.256862 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project'
[0m04:34:28.257130 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:34:29.066323 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project, now list_yt-e2e-data-cycle-project_youtube)
[0m04:34:29.067287 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:34:29.881044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53fb076c-8a9a-4a13-93e7-a52d7da79cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6938e930>]}
[0m04:34:29.882457 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:34:29.883336 [info ] [MainThread]: 
[0m04:34:29.887603 [debug] [Thread-1 (]: Began running node model.youtube_project.dim_regions
[0m04:34:29.888728 [info ] [Thread-1 (]: 1 of 1 START sql table model youtube.dim_regions ............................... [RUN]
[0m04:34:29.889919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now model.youtube_project.dim_regions)
[0m04:34:29.890748 [debug] [Thread-1 (]: Began compiling node model.youtube_project.dim_regions
[0m04:34:29.903957 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_project.dim_regions"
[0m04:34:29.906752 [debug] [Thread-1 (]: Began executing node model.youtube_project.dim_regions
[0m04:34:29.942428 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_project.dim_regions"
[0m04:34:29.943536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:34:29.944791 [debug] [Thread-1 (]: On model.youtube_project.dim_regions: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "model.youtube_project.dim_regions"} */

  
    

    create or replace table `yt-e2e-data-cycle-project`.`youtube`.`dim_regions`
      
    
    

    OPTIONS()
    as (
      WITH region_data AS (
    SELECT * 
    FROM `yt-e2e-data-cycle-project`.`youtube`.`staging_region`  
),

SELECT
    region_code,
    region_name
FROM
    region_data
    );
  
[0m04:34:30.797102 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:64a20ac9-8ce7-46b5-b0da-ad5967e0c225&page=queryresults
[0m04:34:30.799623 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [18:1]; reason: invalidQuery, location: query, message: Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [18:1]')
[0m04:34:31.820025 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:5895e1a9-137f-4793-8d2b-9e261d0a92e1&page=queryresults
[0m04:34:31.823605 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:5895e1a9-137f-4793-8d2b-9e261d0a92e1&page=queryresults
[0m04:34:31.834072 [debug] [Thread-1 (]: Database Error in model dim_regions (models/youtube_data/marts/dim_regions.sql)
  Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [18:1]
  compiled code at target/run/youtube_project/models/youtube_data/marts/dim_regions.sql
[0m04:34:31.836892 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53fb076c-8a9a-4a13-93e7-a52d7da79cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff842c9760>]}
[0m04:34:31.838297 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model youtube.dim_regions ...................... [[31mERROR[0m in 1.95s]
[0m04:34:31.839589 [debug] [Thread-1 (]: Finished running node model.youtube_project.dim_regions
[0m04:34:31.843151 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:34:31.845044 [debug] [MainThread]: Connection 'model.youtube_project.dim_regions' was properly closed.
[0m04:34:31.846189 [info ] [MainThread]: 
[0m04:34:31.847152 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.59 seconds (3.59s).
[0m04:34:31.848684 [debug] [MainThread]: Command end result
[0m04:34:31.914717 [info ] [MainThread]: 
[0m04:34:31.915185 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:34:31.915490 [info ] [MainThread]: 
[0m04:34:31.915898 [error] [MainThread]:   Database Error in model dim_regions (models/youtube_data/marts/dim_regions.sql)
  Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [18:1]
  compiled code at target/run/youtube_project/models/youtube_data/marts/dim_regions.sql
[0m04:34:31.916181 [info ] [MainThread]: 
[0m04:34:31.916510 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m04:34:31.917321 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.6537876, "process_in_blocks": "0", "process_kernel_time": 0.262039, "process_mem_max_rss": "220476", "process_out_blocks": "5702", "process_user_time": 2.3733}
[0m04:34:31.917706 [debug] [MainThread]: Command `dbt run` failed at 04:34:31.917641 after 4.65 seconds
[0m04:34:31.918002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83d83890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67131910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83c3d970>]}
[0m04:34:31.918264 [debug] [MainThread]: Flushing usage events
[0m04:37:00.981737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ee298b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f80e2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f10f290>]}


============================== 04:37:00.983194 | bcbc4169-a25c-4bba-ab2a-1749b7b41c3d ==============================
[0m04:37:00.983194 [info ] [MainThread]: Running with dbt=1.8.9
[0m04:37:00.983562 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/usr/local/airflow/include/dbt', 'partial_parse': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'empty': 'False', 'warn_error': 'None', 'invocation_command': 'dbt run --models youtube_data.marts.dim_regions', 'log_path': '/usr/local/airflow/include/dbt/logs', 'write_json': 'True', 'quiet': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'target_path': 'None', 'printer_width': '80', 'debug': 'False', 'introspect': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False'}
[0m04:37:01.642971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bcbc4169-a25c-4bba-ab2a-1749b7b41c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff804ca960>]}
[0m04:37:01.667590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bcbc4169-a25c-4bba-ab2a-1749b7b41c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f65a660>]}
[0m04:37:01.667990 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m04:37:01.733677 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m04:37:01.856770 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:37:01.857461 [debug] [MainThread]: Partial parsing: updated file: youtube_project://models/youtube_data/marts/dim_regions.sql
[0m04:37:02.066062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bcbc4169-a25c-4bba-ab2a-1749b7b41c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61b246e0>]}
[0m04:37:02.148563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bcbc4169-a25c-4bba-ab2a-1749b7b41c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61def320>]}
[0m04:37:02.148945 [info ] [MainThread]: Found 12 models, 138 data tests, 2 sources, 867 macros
[0m04:37:02.149251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcbc4169-a25c-4bba-ab2a-1749b7b41c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61c83560>]}
[0m04:37:02.151098 [info ] [MainThread]: 
[0m04:37:02.151544 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m04:37:02.152185 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project'
[0m04:37:02.152472 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:37:03.995870 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project, now list_yt-e2e-data-cycle-project_youtube)
[0m04:37:03.996970 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:37:04.907797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcbc4169-a25c-4bba-ab2a-1749b7b41c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff617b9580>]}
[0m04:37:04.908919 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:37:04.909665 [info ] [MainThread]: 
[0m04:37:04.913823 [debug] [Thread-1 (]: Began running node model.youtube_project.dim_regions
[0m04:37:04.914736 [info ] [Thread-1 (]: 1 of 1 START sql table model youtube.dim_regions ............................... [RUN]
[0m04:37:04.915514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now model.youtube_project.dim_regions)
[0m04:37:04.916252 [debug] [Thread-1 (]: Began compiling node model.youtube_project.dim_regions
[0m04:37:04.930003 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_project.dim_regions"
[0m04:37:04.933000 [debug] [Thread-1 (]: Began executing node model.youtube_project.dim_regions
[0m04:37:04.968444 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_project.dim_regions"
[0m04:37:04.970035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:37:04.971269 [debug] [Thread-1 (]: On model.youtube_project.dim_regions: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "model.youtube_project.dim_regions"} */

  
    

    create or replace table `yt-e2e-data-cycle-project`.`youtube`.`dim_regions`
      
    
    

    OPTIONS()
    as (
      WITH region_data AS (
    SELECT * 
    FROM `yt-e2e-data-cycle-project`.`youtube`.`staging_region`  
)

SELECT
    region_code,
    region_name
FROM
    region_data
    );
  
[0m04:37:06.138382 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:7e4c4ec7-3a0a-48e8-a4e2-4df99adc220d&page=queryresults
[0m04:37:09.637290 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcbc4169-a25c-4bba-ab2a-1749b7b41c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63055a60>]}
[0m04:37:09.638493 [info ] [Thread-1 (]: 1 of 1 OK created sql table model youtube.dim_regions .......................... [[32mCREATE TABLE (2.0 rows, 400.0 Bytes processed)[0m in 4.72s]
[0m04:37:09.639907 [debug] [Thread-1 (]: Finished running node model.youtube_project.dim_regions
[0m04:37:09.641790 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:37:09.642209 [debug] [MainThread]: Connection 'model.youtube_project.dim_regions' was properly closed.
[0m04:37:09.642700 [info ] [MainThread]: 
[0m04:37:09.643195 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.49 seconds (7.49s).
[0m04:37:09.644243 [debug] [MainThread]: Command end result
[0m04:37:09.765545 [info ] [MainThread]: 
[0m04:37:09.765944 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:37:09.766276 [info ] [MainThread]: 
[0m04:37:09.766536 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:37:09.767397 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.810116, "process_in_blocks": "0", "process_kernel_time": 0.250679, "process_mem_max_rss": "225696", "process_out_blocks": "8224", "process_user_time": 2.65361}
[0m04:37:09.767743 [debug] [MainThread]: Command `dbt run` succeeded at 04:37:09.767687 after 8.81 seconds
[0m04:37:09.767984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f1af920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6170d100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6170d130>]}
[0m04:37:09.768226 [debug] [MainThread]: Flushing usage events
[0m04:37:27.736326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3a95910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4f9d1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1773950>]}


============================== 04:37:27.737574 | 31e64fb9-fcb8-4cf8-a52d-e29438d23244 ==============================
[0m04:37:27.737574 [info ] [MainThread]: Running with dbt=1.8.9
[0m04:37:27.738060 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'no_print': 'None', 'printer_width': '80', 'target_path': 'None', 'log_format': 'default', 'empty': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --models youtube_data.marts.dim_channels', 'use_experimental_parser': 'False', 'use_colors': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'warn_error': 'None', 'quiet': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'fail_fast': 'False', 'write_json': 'True'}
[0m04:37:28.376378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31e64fb9-fcb8-4cf8-a52d-e29438d23244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94562270>]}
[0m04:37:28.400928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31e64fb9-fcb8-4cf8-a52d-e29438d23244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb240e510>]}
[0m04:37:28.401304 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m04:37:28.465245 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m04:37:28.582528 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:37:28.582847 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:37:28.604957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31e64fb9-fcb8-4cf8-a52d-e29438d23244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff944bbc80>]}
[0m04:37:28.695292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31e64fb9-fcb8-4cf8-a52d-e29438d23244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93d854f0>]}
[0m04:37:28.695661 [info ] [MainThread]: Found 12 models, 138 data tests, 2 sources, 867 macros
[0m04:37:28.695920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31e64fb9-fcb8-4cf8-a52d-e29438d23244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff945efa70>]}
[0m04:37:28.697878 [info ] [MainThread]: 
[0m04:37:28.698307 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m04:37:28.700731 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project_youtube'
[0m04:37:28.700993 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:37:29.489703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31e64fb9-fcb8-4cf8-a52d-e29438d23244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93d754c0>]}
[0m04:37:29.491561 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:37:29.492747 [info ] [MainThread]: 
[0m04:37:29.501196 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0.6dcd79a50a
[0m04:37:29.502570 [info ] [Thread-1 (]: 1 of 11 START test dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0  [RUN]
[0m04:37:29.504056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0.6dcd79a50a)
[0m04:37:29.504899 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0.6dcd79a50a
[0m04:37:29.540512 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0.6dcd79a50a"
[0m04:37:29.542444 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0.6dcd79a50a
[0m04:37:29.558925 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0.6dcd79a50a"
[0m04:37:29.560197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:37:29.561659 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0.6dcd79a50a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0.6dcd79a50a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and length(
        channel_description
    ) >= 0 and length(
        channel_description
    ) <= 1000
)
 as expression


    from `yt-e2e-data-cycle-project`.`youtube`.`dim_channels`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







      
    ) dbt_internal_test
[0m04:37:30.714478 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:3895f6b9-54c6-47d0-a144-100db1e9d765&page=queryresults
[0m04:37:31.200922 [info ] [MainThread]: [33mThe bigquery adapter does not support query cancellation. Some queries may still be running![0m
[0m04:37:31.951031 [info ] [Thread-1 (]: 1 of 11 PASS dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0  [[32mPASS[0m in 2.45s]
[0m04:37:31.953724 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0.6dcd79a50a
[0m04:37:31.954821 [info ] [MainThread]: 
[0m04:37:31.955700 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m04:37:31.956561 [info ] [MainThread]: 
[0m04:37:31.957459 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 TOTAL=0
[0m04:37:31.958251 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:37:31.958925 [debug] [MainThread]: Connection 'test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_channels_channel_description__1000__0.6dcd79a50a' was properly closed.
[0m04:37:31.959684 [info ] [MainThread]: 
[0m04:37:31.960272 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 3.26 seconds (3.26s).
[0m04:37:31.961207 [error] [MainThread]: Encountered an error:

[0m04:37:31.967181 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/cli/main.py", line 816, in test
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/task/runnable.py", line 526, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/task/runnable.py", line 487, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/task/runnable.py", line 397, in execute_nodes
    self.run_queue(pool)
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/task/runnable.py", line 315, in run_queue
    self.job_queue.join()
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/graph/queue.py", line 198, in join
    self.inner.join()
  File "/usr/local/lib/python3.12/queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "/usr/local/lib/python3.12/threading.py", line 355, in wait
    waiter.acquire()
KeyboardInterrupt

[0m04:37:31.969465 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 4.2570343, "process_in_blocks": "216", "process_kernel_time": 0.221242, "process_mem_max_rss": "220392", "process_out_blocks": "3109", "process_user_time": 2.299521}
[0m04:37:31.970320 [debug] [MainThread]: Command `dbt test` failed at 04:37:31.970193 after 4.26 seconds
[0m04:37:31.970908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0e891f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93d769f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93c26cc0>]}
[0m04:37:31.971412 [debug] [MainThread]: Flushing usage events
[0m04:37:37.759478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa702bd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7cf7e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8039f40>]}


============================== 04:37:37.760584 | a6eb0c5f-063a-42f2-9987-1e2f37a2892c ==============================
[0m04:37:37.760584 [info ] [MainThread]: Running with dbt=1.8.9
[0m04:37:37.761000 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'partial_parse': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt test --models youtube_data.marts.dim_regions', 'log_path': '/usr/local/airflow/include/dbt/logs', 'quiet': 'False', 'introspect': 'True', 'warn_error': 'None', 'log_format': 'default', 'printer_width': '80', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'cache_selected_only': 'False', 'debug': 'False'}
[0m04:37:38.373420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6eb0c5f-063a-42f2-9987-1e2f37a2892c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a6021b0>]}
[0m04:37:38.398193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6eb0c5f-063a-42f2-9987-1e2f37a2892c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a0fa120>]}
[0m04:37:38.398570 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m04:37:38.463558 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m04:37:38.583687 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:37:38.584016 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:37:38.606260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6eb0c5f-063a-42f2-9987-1e2f37a2892c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8177770>]}
[0m04:37:38.692974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6eb0c5f-063a-42f2-9987-1e2f37a2892c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89f5daf0>]}
[0m04:37:38.693345 [info ] [MainThread]: Found 12 models, 138 data tests, 2 sources, 867 macros
[0m04:37:38.693597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6eb0c5f-063a-42f2-9987-1e2f37a2892c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a7bfa70>]}
[0m04:37:38.695540 [info ] [MainThread]: 
[0m04:37:38.696023 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m04:37:38.698390 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project_youtube'
[0m04:37:38.698638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:37:39.518682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6eb0c5f-063a-42f2-9987-1e2f37a2892c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a678fb0>]}
[0m04:37:39.519469 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:37:39.519980 [info ] [MainThread]: 
[0m04:37:39.523121 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_regions_region_code__5__2.41f50d5be5
[0m04:37:39.523801 [info ] [Thread-1 (]: 1 of 7 START test dbt_expectations_expect_column_value_lengths_to_be_between_dim_regions_region_code__5__2  [RUN]
[0m04:37:39.524648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_regions_region_code__5__2.41f50d5be5)
[0m04:37:39.525224 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_regions_region_code__5__2.41f50d5be5
[0m04:37:39.552354 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_regions_region_code__5__2.41f50d5be5"
[0m04:37:39.554753 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_regions_region_code__5__2.41f50d5be5
[0m04:37:39.569244 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_regions_region_code__5__2.41f50d5be5"
[0m04:37:39.570750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:37:39.571912 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_regions_region_code__5__2.41f50d5be5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_regions_region_code__5__2.41f50d5be5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and length(
        region_code
    ) >= 2 and length(
        region_code
    ) <= 5
)
 as expression


    from `yt-e2e-data-cycle-project`.`youtube`.`dim_regions`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







      
    ) dbt_internal_test
[0m04:37:40.750422 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:b5c0a2be-381f-439b-a97e-9131110b0da4&page=queryresults
[0m04:37:41.987023 [info ] [Thread-1 (]: 1 of 7 PASS dbt_expectations_expect_column_value_lengths_to_be_between_dim_regions_region_code__5__2  [[32mPASS[0m in 2.46s]
[0m04:37:41.989540 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_regions_region_code__5__2.41f50d5be5
[0m04:37:41.990895 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_regions_region_name__100__1.9e68a66a57
[0m04:37:41.992152 [info ] [Thread-1 (]: 2 of 7 START test dbt_expectations_expect_column_value_lengths_to_be_between_dim_regions_region_name__100__1  [RUN]
[0m04:37:41.993418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_regions_region_code__5__2.41f50d5be5, now test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_regions_region_name__100__1.9e68a66a57)
[0m04:37:41.994408 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_regions_region_name__100__1.9e68a66a57
[0m04:37:42.004658 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_regions_region_name__100__1.9e68a66a57"
[0m04:37:42.006703 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_regions_region_name__100__1.9e68a66a57
[0m04:37:42.010136 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_regions_region_name__100__1.9e68a66a57"
[0m04:37:42.011667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:37:42.014247 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_regions_region_name__100__1.9e68a66a57: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_regions_region_name__100__1.9e68a66a57"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and length(
        region_name
    ) >= 1 and length(
        region_name
    ) <= 100
)
 as expression


    from `yt-e2e-data-cycle-project`.`youtube`.`dim_regions`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







      
    ) dbt_internal_test
[0m04:37:43.411904 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:60d6d331-25f1-4f90-8b9d-b77ce9b7c8b9&page=queryresults
[0m04:37:44.538458 [info ] [Thread-1 (]: 2 of 7 PASS dbt_expectations_expect_column_value_lengths_to_be_between_dim_regions_region_name__100__1  [[32mPASS[0m in 2.54s]
[0m04:37:44.542348 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_regions_region_name__100__1.9e68a66a57
[0m04:37:44.544311 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_regions_region_code__STRING.f26d03cffa
[0m04:37:44.545337 [info ] [Thread-1 (]: 3 of 7 START test dbt_expectations_expect_column_values_to_be_of_type_dim_regions_region_code__STRING  [RUN]
[0m04:37:44.546427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_regions_region_name__100__1.9e68a66a57, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_regions_region_code__STRING.f26d03cffa)
[0m04:37:44.547430 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_regions_region_code__STRING.f26d03cffa
[0m04:37:44.568464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:37:45.365668 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_regions_region_code__STRING.f26d03cffa"
[0m04:37:45.368156 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_regions_region_code__STRING.f26d03cffa
[0m04:37:45.372115 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_regions_region_code__STRING.f26d03cffa"
[0m04:37:45.374078 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_regions_region_code__STRING.f26d03cffa: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_regions_region_code__STRING.f26d03cffa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('REGION_CODE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('REGION_NAME' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'REGION_CODE'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:37:45.972637 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:ce7b010b-b59b-4a11-947b-b22f0a7469fb&page=queryresults
[0m04:37:47.199840 [info ] [Thread-1 (]: 3 of 7 PASS dbt_expectations_expect_column_values_to_be_of_type_dim_regions_region_code__STRING  [[32mPASS[0m in 2.65s]
[0m04:37:47.202815 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_regions_region_code__STRING.f26d03cffa
[0m04:37:47.204568 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_regions_region_name__STRING.ef9b685c3c
[0m04:37:47.205604 [info ] [Thread-1 (]: 4 of 7 START test dbt_expectations_expect_column_values_to_be_of_type_dim_regions_region_name__STRING  [RUN]
[0m04:37:47.206874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_regions_region_code__STRING.f26d03cffa, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_regions_region_name__STRING.ef9b685c3c)
[0m04:37:47.207800 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_regions_region_name__STRING.ef9b685c3c
[0m04:37:47.216314 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:37:48.022575 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_regions_region_name__STRING.ef9b685c3c"
[0m04:37:48.025200 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_regions_region_name__STRING.ef9b685c3c
[0m04:37:48.028923 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_regions_region_name__STRING.ef9b685c3c"
[0m04:37:48.030402 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_regions_region_name__STRING.ef9b685c3c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_regions_region_name__STRING.ef9b685c3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('REGION_CODE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('REGION_NAME' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'REGION_NAME'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:37:48.633184 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:2219cf06-2a39-4357-8ae0-7c6d676683b9&page=queryresults
[0m04:37:49.860815 [info ] [Thread-1 (]: 4 of 7 PASS dbt_expectations_expect_column_values_to_be_of_type_dim_regions_region_name__STRING  [[32mPASS[0m in 2.65s]
[0m04:37:49.863217 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_regions_region_name__STRING.ef9b685c3c
[0m04:37:49.864231 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_dim_regions_region_code.c541f453e2
[0m04:37:49.865124 [info ] [Thread-1 (]: 5 of 7 START test not_null_dim_regions_region_code ............................. [RUN]
[0m04:37:49.866018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_regions_region_name__STRING.ef9b685c3c, now test.youtube_project.not_null_dim_regions_region_code.c541f453e2)
[0m04:37:49.866683 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_dim_regions_region_code.c541f453e2
[0m04:37:49.876592 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_dim_regions_region_code.c541f453e2"
[0m04:37:49.878777 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_dim_regions_region_code.c541f453e2
[0m04:37:49.882944 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_dim_regions_region_code.c541f453e2"
[0m04:37:49.884640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:37:49.887179 [debug] [Thread-1 (]: On test.youtube_project.not_null_dim_regions_region_code.c541f453e2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_dim_regions_region_code.c541f453e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select region_code
from `yt-e2e-data-cycle-project`.`youtube`.`dim_regions`
where region_code is null



      
    ) dbt_internal_test
[0m04:37:51.092773 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:97b0c6a6-38f2-4929-9d96-d5f4192b26e7&page=queryresults
[0m04:37:52.318913 [info ] [Thread-1 (]: 5 of 7 PASS not_null_dim_regions_region_code ................................... [[32mPASS[0m in 2.45s]
[0m04:37:52.321674 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_dim_regions_region_code.c541f453e2
[0m04:37:52.323264 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_dim_regions_region_name.937b764160
[0m04:37:52.324213 [info ] [Thread-1 (]: 6 of 7 START test not_null_dim_regions_region_name ............................. [RUN]
[0m04:37:52.325399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_dim_regions_region_code.c541f453e2, now test.youtube_project.not_null_dim_regions_region_name.937b764160)
[0m04:37:52.326213 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_dim_regions_region_name.937b764160
[0m04:37:52.334178 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_dim_regions_region_name.937b764160"
[0m04:37:52.336232 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_dim_regions_region_name.937b764160
[0m04:37:52.343757 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_dim_regions_region_name.937b764160"
[0m04:37:52.345795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:37:52.348496 [debug] [Thread-1 (]: On test.youtube_project.not_null_dim_regions_region_name.937b764160: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_dim_regions_region_name.937b764160"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select region_name
from `yt-e2e-data-cycle-project`.`youtube`.`dim_regions`
where region_name is null



      
    ) dbt_internal_test
[0m04:37:53.549118 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:616e602e-c60c-49ab-8774-d726591cd2c9&page=queryresults
[0m04:37:54.774441 [info ] [Thread-1 (]: 6 of 7 PASS not_null_dim_regions_region_name ................................... [[32mPASS[0m in 2.45s]
[0m04:37:54.776140 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_dim_regions_region_name.937b764160
[0m04:37:54.777555 [debug] [Thread-1 (]: Began running node test.youtube_project.unique_dim_regions_region_code.18801f59db
[0m04:37:54.778445 [info ] [Thread-1 (]: 7 of 7 START test unique_dim_regions_region_code ............................... [RUN]
[0m04:37:54.779588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_dim_regions_region_name.937b764160, now test.youtube_project.unique_dim_regions_region_code.18801f59db)
[0m04:37:54.780554 [debug] [Thread-1 (]: Began compiling node test.youtube_project.unique_dim_regions_region_code.18801f59db
[0m04:37:54.790546 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.unique_dim_regions_region_code.18801f59db"
[0m04:37:54.793406 [debug] [Thread-1 (]: Began executing node test.youtube_project.unique_dim_regions_region_code.18801f59db
[0m04:37:54.797374 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.unique_dim_regions_region_code.18801f59db"
[0m04:37:54.799168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:37:54.801264 [debug] [Thread-1 (]: On test.youtube_project.unique_dim_regions_region_code.18801f59db: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.unique_dim_regions_region_code.18801f59db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select region_code as unique_field
  from `yt-e2e-data-cycle-project`.`youtube`.`dim_regions`
  where region_code is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m04:37:56.105625 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:34648449-2779-443f-a6ba-09842d35a583&page=queryresults
[0m04:37:57.338699 [info ] [Thread-1 (]: 7 of 7 PASS unique_dim_regions_region_code ..................................... [[32mPASS[0m in 2.56s]
[0m04:37:57.342140 [debug] [Thread-1 (]: Finished running node test.youtube_project.unique_dim_regions_region_code.18801f59db
[0m04:37:57.347620 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:37:57.348442 [debug] [MainThread]: Connection 'test.youtube_project.unique_dim_regions_region_code.18801f59db' was properly closed.
[0m04:37:57.349433 [info ] [MainThread]: 
[0m04:37:57.350626 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 18.65 seconds (18.65s).
[0m04:37:57.355414 [debug] [MainThread]: Command end result
[0m04:37:57.437675 [info ] [MainThread]: 
[0m04:37:57.438748 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:37:57.439492 [info ] [MainThread]: 
[0m04:37:57.440021 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m04:37:57.442108 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 19.705456, "process_in_blocks": "0", "process_kernel_time": 0.223136, "process_mem_max_rss": "222464", "process_out_blocks": "5768", "process_user_time": 2.942803}
[0m04:37:57.442819 [debug] [MainThread]: Command `dbt test` succeeded at 04:37:57.442709 after 19.71 seconds
[0m04:37:57.443293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7553980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa73515b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6f7d670>]}
[0m04:37:57.443635 [debug] [MainThread]: Flushing usage events
[0m04:38:10.568539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f379460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f379340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f379250>]}


============================== 04:38:10.569838 | 68f46269-15b1-4fe1-bde6-4adb364564d8 ==============================
[0m04:38:10.569838 [info ] [MainThread]: Running with dbt=1.8.9
[0m04:38:10.570197 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'use_experimental_parser': 'False', 'invocation_command': 'dbt test --models youtube_data.marts.dim_videos', 'warn_error': 'None', 'quiet': 'False', 'version_check': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'write_json': 'True', 'no_print': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'cache_selected_only': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'printer_width': '80', 'empty': 'None', 'debug': 'False'}
[0m04:38:11.166765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68f46269-15b1-4fe1-bde6-4adb364564d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72ac4290>]}
[0m04:38:11.191371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '68f46269-15b1-4fe1-bde6-4adb364564d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f2d33e0>]}
[0m04:38:11.191765 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m04:38:11.255376 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m04:38:11.375256 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:38:11.375733 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:38:11.399370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68f46269-15b1-4fe1-bde6-4adb364564d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7289c620>]}
[0m04:38:11.490290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68f46269-15b1-4fe1-bde6-4adb364564d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7225d670>]}
[0m04:38:11.490695 [info ] [MainThread]: Found 12 models, 138 data tests, 2 sources, 867 macros
[0m04:38:11.491023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68f46269-15b1-4fe1-bde6-4adb364564d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7224cbf0>]}
[0m04:38:11.493152 [info ] [MainThread]: 
[0m04:38:11.493728 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m04:38:11.496327 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project_youtube'
[0m04:38:11.496581 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:38:12.293688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68f46269-15b1-4fe1-bde6-4adb364564d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7224ee40>]}
[0m04:38:12.294952 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:38:12.295673 [info ] [MainThread]: 
[0m04:38:12.300981 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__1000__0.8be96026f1
[0m04:38:12.302003 [info ] [Thread-1 (]: 1 of 13 START test dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__1000__0  [RUN]
[0m04:38:12.303091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__1000__0.8be96026f1)
[0m04:38:12.303905 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__1000__0.8be96026f1
[0m04:38:12.337788 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__1000__0.8be96026f1"
[0m04:38:12.339335 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__1000__0.8be96026f1
[0m04:38:12.356454 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__1000__0.8be96026f1"
[0m04:38:12.357573 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:38:12.359009 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__1000__0.8be96026f1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__1000__0.8be96026f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and length(
        description
    ) >= 0 and length(
        description
    ) <= 1000
)
 as expression


    from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







      
    ) dbt_internal_test
[0m04:38:13.312274 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:0b878173-dc93-477c-a719-9ebfe69454e8&page=queryresults
[0m04:38:13.314644 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:0b878173-dc93-477c-a719-9ebfe69454e8&page=queryresults
[0m04:38:13.324772 [debug] [Thread-1 (]: Database Error in test dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__1000__0 (models/youtube_data/marts/schema.yml)
  Not found: Table yt-e2e-data-cycle-project:youtube.dim_videos was not found in location US
  compiled code at target/run/youtube_project/models/youtube_data/marts/schema.yml/dbt_expectations_expect_column_13f5ea41244b9d04c2f93b4f12209c17.sql
[0m04:38:13.326241 [error] [Thread-1 (]: 1 of 13 ERROR dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__1000__0  [[31mERROR[0m in 1.02s]
[0m04:38:13.327668 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__1000__0.8be96026f1
[0m04:38:13.329131 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718
[0m04:38:13.330979 [info ] [Thread-1 (]: 2 of 13 START test dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1  [RUN]
[0m04:38:13.332222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__1000__0.8be96026f1, now test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718)
[0m04:38:13.333017 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718
[0m04:38:13.340272 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718"
[0m04:38:13.342035 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718
[0m04:38:13.345310 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718"
[0m04:38:13.346905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:38:13.348957 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and length(
        title
    ) >= 1 and length(
        title
    ) <= 255
)
 as expression


    from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







      
    ) dbt_internal_test
[0m04:38:14.336694 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:0248d532-feed-43f8-961a-e7f74e8aee1e&page=queryresults
[0m04:38:14.339702 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:0248d532-feed-43f8-961a-e7f74e8aee1e&page=queryresults
[0m04:38:14.347343 [debug] [Thread-1 (]: Database Error in test dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1 (models/youtube_data/marts/schema.yml)
  Not found: Table yt-e2e-data-cycle-project:youtube.dim_videos was not found in location US
  compiled code at target/run/youtube_project/models/youtube_data/marts/schema.yml/dbt_expectations_expect_column_68caf04df3376cf7e2dda8af8a24b521.sql
[0m04:38:14.348666 [error] [Thread-1 (]: 2 of 13 ERROR dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1  [[31mERROR[0m in 1.02s]
[0m04:38:14.350241 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718
[0m04:38:14.351271 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0
[0m04:38:14.352252 [info ] [Thread-1 (]: 3 of 13 START test dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64  [RUN]
[0m04:38:14.353365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0)
[0m04:38:14.354081 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0
[0m04:38:14.370348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:38:15.151787 [debug] [Thread-1 (]: BigQuery adapter: get_columns_in_relation error: 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/yt-e2e-data-cycle-project/datasets/youtube/tables/dim_videos?prettyPrint=false: Not found: Table yt-e2e-data-cycle-project:youtube.dim_videos
[0m04:38:15.153104 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0"
[0m04:38:15.156310 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0
[0m04:38:15.160891 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0"
[0m04:38:15.162725 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'CATEGORY_ID'
            and
            relation_column_type not in ('INT64')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:38:15.560982 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:d9e39f27-bc87-407d-8029-3be2994c12b7&page=queryresults
[0m04:38:15.562070 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected ")" at [10:5]; reason: invalidQuery, location: query, message: Syntax error: Unexpected ")" at [10:5]')
[0m04:38:16.688684 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:1a04a1c5-34ee-4dc8-a205-cc3763ebc0b3&page=queryresults
[0m04:38:16.689798 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:1a04a1c5-34ee-4dc8-a205-cc3763ebc0b3&page=queryresults
[0m04:38:16.693249 [debug] [Thread-1 (]: Database Error in test dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64 (models/youtube_data/marts/schema.yml)
  Syntax error: Unexpected ")" at [10:5]
  compiled code at target/run/youtube_project/models/youtube_data/marts/schema.yml/dbt_expectations_expect_column_44668d6742702eeb8e20aaff03f6f538.sql
[0m04:38:16.693837 [error] [Thread-1 (]: 3 of 13 ERROR dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64  [[31mERROR[0m in 2.34s]
[0m04:38:16.694523 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0
[0m04:38:16.694998 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897
[0m04:38:16.695493 [info ] [Thread-1 (]: 4 of 13 START test dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING  [RUN]
[0m04:38:16.696070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897)
[0m04:38:16.696541 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897
[0m04:38:16.701457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:38:17.509382 [debug] [Thread-1 (]: BigQuery adapter: get_columns_in_relation error: 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/yt-e2e-data-cycle-project/datasets/youtube/tables/dim_videos?prettyPrint=false: Not found: Table yt-e2e-data-cycle-project:youtube.dim_videos
[0m04:38:17.512126 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897"
[0m04:38:17.515562 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897
[0m04:38:17.521115 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897"
[0m04:38:17.523752 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'CHANNEL_ID'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:38:17.915329 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:31ce2eb9-7342-4502-a05f-c5b1a6ba9017&page=queryresults
[0m04:38:17.916623 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected ")" at [10:5]; reason: invalidQuery, location: query, message: Syntax error: Unexpected ")" at [10:5]')
[0m04:38:19.148910 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:7347cd57-5c5a-47d3-aee9-b7e6b366744f&page=queryresults
[0m04:38:19.151308 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:7347cd57-5c5a-47d3-aee9-b7e6b366744f&page=queryresults
[0m04:38:19.157444 [debug] [Thread-1 (]: Database Error in test dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING (models/youtube_data/marts/schema.yml)
  Syntax error: Unexpected ")" at [10:5]
  compiled code at target/run/youtube_project/models/youtube_data/marts/schema.yml/dbt_expectations_expect_column_3b57f01d2e35a867efce197c267f724a.sql
[0m04:38:19.158636 [error] [Thread-1 (]: 4 of 13 ERROR dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING  [[31mERROR[0m in 2.46s]
[0m04:38:19.160055 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897
[0m04:38:19.161028 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603
[0m04:38:19.162022 [info ] [Thread-1 (]: 5 of 13 START test dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING  [RUN]
[0m04:38:19.163138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603)
[0m04:38:19.164050 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603
[0m04:38:19.171755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:38:19.964641 [debug] [Thread-1 (]: BigQuery adapter: get_columns_in_relation error: 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/yt-e2e-data-cycle-project/datasets/youtube/tables/dim_videos?prettyPrint=false: Not found: Table yt-e2e-data-cycle-project:youtube.dim_videos
[0m04:38:19.965842 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603"
[0m04:38:19.968212 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603
[0m04:38:19.973081 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603"
[0m04:38:19.975019 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'DESCRIPTION'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:38:20.378022 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:87d5d334-c165-4973-ada7-d3c8bd5406fc&page=queryresults
[0m04:38:20.380522 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected ")" at [10:5]; reason: invalidQuery, location: query, message: Syntax error: Unexpected ")" at [10:5]')
[0m04:38:21.603312 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:0e3f11b0-d9da-4905-8566-2be3c3c5c249&page=queryresults
[0m04:38:21.604584 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:0e3f11b0-d9da-4905-8566-2be3c3c5c249&page=queryresults
[0m04:38:21.609609 [debug] [Thread-1 (]: Database Error in test dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING (models/youtube_data/marts/schema.yml)
  Syntax error: Unexpected ")" at [10:5]
  compiled code at target/run/youtube_project/models/youtube_data/marts/schema.yml/dbt_expectations_expect_column_9d06a4d4b58deefc993eda068e284d4a.sql
[0m04:38:21.610510 [error] [Thread-1 (]: 5 of 13 ERROR dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING  [[31mERROR[0m in 2.45s]
[0m04:38:21.611723 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603
[0m04:38:21.612509 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc
[0m04:38:21.613275 [info ] [Thread-1 (]: 6 of 13 START test dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING  [RUN]
[0m04:38:21.614079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc)
[0m04:38:21.614680 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc
[0m04:38:21.620865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:38:22.424342 [debug] [Thread-1 (]: BigQuery adapter: get_columns_in_relation error: 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/yt-e2e-data-cycle-project/datasets/youtube/tables/dim_videos?prettyPrint=false: Not found: Table yt-e2e-data-cycle-project:youtube.dim_videos
[0m04:38:22.426692 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc"
[0m04:38:22.430220 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc
[0m04:38:22.435352 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc"
[0m04:38:22.438039 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'TITLE'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:38:22.833443 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:ac0a37dd-330c-4c19-84f5-9a48be483626&page=queryresults
[0m04:38:22.834673 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected ")" at [10:5]; reason: invalidQuery, location: query, message: Syntax error: Unexpected ")" at [10:5]')
[0m04:38:24.070530 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:341391ff-e79c-4529-bf7f-f476c0f937b8&page=queryresults
[0m04:38:24.072710 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:341391ff-e79c-4529-bf7f-f476c0f937b8&page=queryresults
[0m04:38:24.079151 [debug] [Thread-1 (]: Database Error in test dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING (models/youtube_data/marts/schema.yml)
  Syntax error: Unexpected ")" at [10:5]
  compiled code at target/run/youtube_project/models/youtube_data/marts/schema.yml/dbt_expectations_expect_column_a375c0503693ce6ae5ed680554c18c0a.sql
[0m04:38:24.080135 [error] [Thread-1 (]: 6 of 13 ERROR dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING  [[31mERROR[0m in 2.47s]
[0m04:38:24.081526 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc
[0m04:38:24.082370 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd
[0m04:38:24.083116 [info ] [Thread-1 (]: 7 of 13 START test dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING  [RUN]
[0m04:38:24.084103 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd)
[0m04:38:24.084863 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd
[0m04:38:24.091951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:38:24.884627 [debug] [Thread-1 (]: BigQuery adapter: get_columns_in_relation error: 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/yt-e2e-data-cycle-project/datasets/youtube/tables/dim_videos?prettyPrint=false: Not found: Table yt-e2e-data-cycle-project:youtube.dim_videos
[0m04:38:24.886277 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd"
[0m04:38:24.892040 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd
[0m04:38:24.897162 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd"
[0m04:38:24.899536 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'VIDEO_ID'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:38:25.395981 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:fc3892f4-e40b-467b-8860-407f6dab7d0a&page=queryresults
[0m04:38:25.398741 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected ")" at [10:5]; reason: invalidQuery, location: query, message: Syntax error: Unexpected ")" at [10:5]')
[0m04:38:25.908404 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:75818855-28c3-43ce-96e3-304398ffc34e&page=queryresults
[0m04:38:25.910878 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:75818855-28c3-43ce-96e3-304398ffc34e&page=queryresults
[0m04:38:25.917641 [debug] [Thread-1 (]: Database Error in test dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING (models/youtube_data/marts/schema.yml)
  Syntax error: Unexpected ")" at [10:5]
  compiled code at target/run/youtube_project/models/youtube_data/marts/schema.yml/dbt_expectations_expect_column_50ce18689bcd2f4e2b9c6185ac50a7a3.sql
[0m04:38:25.919041 [error] [Thread-1 (]: 7 of 13 ERROR dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING  [[31mERROR[0m in 1.83s]
[0m04:38:25.920545 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd
[0m04:38:25.921533 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07
[0m04:38:25.922500 [info ] [Thread-1 (]: 8 of 13 START test not_null_dim_videos_category_id ............................. [RUN]
[0m04:38:25.923587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd, now test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07)
[0m04:38:25.924362 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07
[0m04:38:25.937005 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07"
[0m04:38:25.939108 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07
[0m04:38:25.942362 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07"
[0m04:38:25.943936 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:38:25.946029 [debug] [Thread-1 (]: On test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select category_id
from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
where category_id is null



      
    ) dbt_internal_test
[0m04:38:26.930788 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:586d243f-6389-4ab7-b584-dc3ecadef66d&page=queryresults
[0m04:38:26.933453 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:586d243f-6389-4ab7-b584-dc3ecadef66d&page=queryresults
[0m04:38:26.940479 [debug] [Thread-1 (]: Database Error in test not_null_dim_videos_category_id (models/youtube_data/marts/schema.yml)
  Not found: Table yt-e2e-data-cycle-project:youtube.dim_videos was not found in location US
  compiled code at target/run/youtube_project/models/youtube_data/marts/schema.yml/not_null_dim_videos_category_id.sql
[0m04:38:26.942369 [error] [Thread-1 (]: 8 of 13 ERROR not_null_dim_videos_category_id .................................. [[31mERROR[0m in 1.02s]
[0m04:38:26.944468 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07
[0m04:38:26.945655 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_dim_videos_channel_id.4153a564fb
[0m04:38:26.946663 [info ] [Thread-1 (]: 9 of 13 START test not_null_dim_videos_channel_id .............................. [RUN]
[0m04:38:26.948072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07, now test.youtube_project.not_null_dim_videos_channel_id.4153a564fb)
[0m04:38:26.949430 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_dim_videos_channel_id.4153a564fb
[0m04:38:26.956728 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_dim_videos_channel_id.4153a564fb"
[0m04:38:26.958928 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_dim_videos_channel_id.4153a564fb
[0m04:38:26.966066 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_dim_videos_channel_id.4153a564fb"
[0m04:38:26.968550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:38:26.971034 [debug] [Thread-1 (]: On test.youtube_project.not_null_dim_videos_channel_id.4153a564fb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_dim_videos_channel_id.4153a564fb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select channel_id
from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
where channel_id is null



      
    ) dbt_internal_test
[0m04:38:27.957733 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:d03a3aee-25a3-458c-b1ac-b3f988802e7e&page=queryresults
[0m04:38:27.960415 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:d03a3aee-25a3-458c-b1ac-b3f988802e7e&page=queryresults
[0m04:38:27.967748 [debug] [Thread-1 (]: Database Error in test not_null_dim_videos_channel_id (models/youtube_data/marts/schema.yml)
  Not found: Table yt-e2e-data-cycle-project:youtube.dim_videos was not found in location US
  compiled code at target/run/youtube_project/models/youtube_data/marts/schema.yml/not_null_dim_videos_channel_id.sql
[0m04:38:27.969101 [error] [Thread-1 (]: 9 of 13 ERROR not_null_dim_videos_channel_id ................................... [[31mERROR[0m in 1.02s]
[0m04:38:27.970696 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_dim_videos_channel_id.4153a564fb
[0m04:38:27.971862 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_dim_videos_description.764dd33190
[0m04:38:27.972872 [info ] [Thread-1 (]: 10 of 13 START test not_null_dim_videos_description ............................ [RUN]
[0m04:38:27.973890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_dim_videos_channel_id.4153a564fb, now test.youtube_project.not_null_dim_videos_description.764dd33190)
[0m04:38:27.974584 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_dim_videos_description.764dd33190
[0m04:38:27.983601 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_dim_videos_description.764dd33190"
[0m04:38:27.985787 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_dim_videos_description.764dd33190
[0m04:38:27.990112 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_dim_videos_description.764dd33190"
[0m04:38:27.991992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:38:27.994456 [debug] [Thread-1 (]: On test.youtube_project.not_null_dim_videos_description.764dd33190: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_dim_videos_description.764dd33190"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select description
from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
where description is null



      
    ) dbt_internal_test
[0m04:38:28.981759 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:b333231e-f7d6-4eda-b455-a54c59dadd4e&page=queryresults
[0m04:38:28.984060 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:b333231e-f7d6-4eda-b455-a54c59dadd4e&page=queryresults
[0m04:38:28.990663 [debug] [Thread-1 (]: Database Error in test not_null_dim_videos_description (models/youtube_data/marts/schema.yml)
  Not found: Table yt-e2e-data-cycle-project:youtube.dim_videos was not found in location US
  compiled code at target/run/youtube_project/models/youtube_data/marts/schema.yml/not_null_dim_videos_description.sql
[0m04:38:28.993272 [error] [Thread-1 (]: 10 of 13 ERROR not_null_dim_videos_description ................................. [[31mERROR[0m in 1.02s]
[0m04:38:28.995195 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_dim_videos_description.764dd33190
[0m04:38:28.996413 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_dim_videos_title.197d58b52d
[0m04:38:28.997517 [info ] [Thread-1 (]: 11 of 13 START test not_null_dim_videos_title .................................. [RUN]
[0m04:38:28.999178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_dim_videos_description.764dd33190, now test.youtube_project.not_null_dim_videos_title.197d58b52d)
[0m04:38:28.999941 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_dim_videos_title.197d58b52d
[0m04:38:29.007566 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_dim_videos_title.197d58b52d"
[0m04:38:29.009740 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_dim_videos_title.197d58b52d
[0m04:38:29.013703 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_dim_videos_title.197d58b52d"
[0m04:38:29.015292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:38:29.017583 [debug] [Thread-1 (]: On test.youtube_project.not_null_dim_videos_title.197d58b52d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_dim_videos_title.197d58b52d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select title
from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
where title is null



      
    ) dbt_internal_test
[0m04:38:30.005984 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:0ecf23d3-d547-47fc-8e83-661efa7e0a7f&page=queryresults
[0m04:38:30.008183 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:0ecf23d3-d547-47fc-8e83-661efa7e0a7f&page=queryresults
[0m04:38:30.014635 [debug] [Thread-1 (]: Database Error in test not_null_dim_videos_title (models/youtube_data/marts/schema.yml)
  Not found: Table yt-e2e-data-cycle-project:youtube.dim_videos was not found in location US
  compiled code at target/run/youtube_project/models/youtube_data/marts/schema.yml/not_null_dim_videos_title.sql
[0m04:38:30.015790 [error] [Thread-1 (]: 11 of 13 ERROR not_null_dim_videos_title ....................................... [[31mERROR[0m in 1.02s]
[0m04:38:30.017303 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_dim_videos_title.197d58b52d
[0m04:38:30.018258 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_dim_videos_video_id.074012a872
[0m04:38:30.019128 [info ] [Thread-1 (]: 12 of 13 START test not_null_dim_videos_video_id ............................... [RUN]
[0m04:38:30.020975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_dim_videos_title.197d58b52d, now test.youtube_project.not_null_dim_videos_video_id.074012a872)
[0m04:38:30.021854 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_dim_videos_video_id.074012a872
[0m04:38:30.028584 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_dim_videos_video_id.074012a872"
[0m04:38:30.030789 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_dim_videos_video_id.074012a872
[0m04:38:30.038961 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_dim_videos_video_id.074012a872"
[0m04:38:30.040759 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:38:30.043468 [debug] [Thread-1 (]: On test.youtube_project.not_null_dim_videos_video_id.074012a872: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_dim_videos_video_id.074012a872"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select video_id
from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
where video_id is null



      
    ) dbt_internal_test
[0m04:38:30.925970 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:88731901-5293-49c8-834b-8cf96a1a3645&page=queryresults
[0m04:38:30.928225 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:88731901-5293-49c8-834b-8cf96a1a3645&page=queryresults
[0m04:38:30.934855 [debug] [Thread-1 (]: Database Error in test not_null_dim_videos_video_id (models/youtube_data/marts/schema.yml)
  Not found: Table yt-e2e-data-cycle-project:youtube.dim_videos was not found in location US
  compiled code at target/run/youtube_project/models/youtube_data/marts/schema.yml/not_null_dim_videos_video_id.sql
[0m04:38:30.936101 [error] [Thread-1 (]: 12 of 13 ERROR not_null_dim_videos_video_id .................................... [[31mERROR[0m in 0.92s]
[0m04:38:30.937505 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_dim_videos_video_id.074012a872
[0m04:38:30.938471 [debug] [Thread-1 (]: Began running node test.youtube_project.unique_dim_videos_video_id.e6dc8fa384
[0m04:38:30.939377 [info ] [Thread-1 (]: 13 of 13 START test unique_dim_videos_video_id ................................. [RUN]
[0m04:38:30.940493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_dim_videos_video_id.074012a872, now test.youtube_project.unique_dim_videos_video_id.e6dc8fa384)
[0m04:38:30.941381 [debug] [Thread-1 (]: Began compiling node test.youtube_project.unique_dim_videos_video_id.e6dc8fa384
[0m04:38:30.953635 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.unique_dim_videos_video_id.e6dc8fa384"
[0m04:38:30.956738 [debug] [Thread-1 (]: Began executing node test.youtube_project.unique_dim_videos_video_id.e6dc8fa384
[0m04:38:30.960286 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.unique_dim_videos_video_id.e6dc8fa384"
[0m04:38:30.961932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:38:30.964051 [debug] [Thread-1 (]: On test.youtube_project.unique_dim_videos_video_id.e6dc8fa384: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.unique_dim_videos_video_id.e6dc8fa384"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select video_id as unique_field
  from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
  where video_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m04:38:31.884489 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:28a2d1da-1e58-4c74-b3c5-8225694746f8&page=queryresults
[0m04:38:31.887249 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:28a2d1da-1e58-4c74-b3c5-8225694746f8&page=queryresults
[0m04:38:31.894665 [debug] [Thread-1 (]: Database Error in test unique_dim_videos_video_id (models/youtube_data/marts/schema.yml)
  Not found: Table yt-e2e-data-cycle-project:youtube.dim_videos was not found in location US
  compiled code at target/run/youtube_project/models/youtube_data/marts/schema.yml/unique_dim_videos_video_id.sql
[0m04:38:31.895925 [error] [Thread-1 (]: 13 of 13 ERROR unique_dim_videos_video_id ...................................... [[31mERROR[0m in 0.96s]
[0m04:38:31.897302 [debug] [Thread-1 (]: Finished running node test.youtube_project.unique_dim_videos_video_id.e6dc8fa384
[0m04:38:31.901077 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:38:31.901779 [debug] [MainThread]: Connection 'test.youtube_project.unique_dim_videos_video_id.e6dc8fa384' was properly closed.
[0m04:38:31.902662 [info ] [MainThread]: 
[0m04:38:31.903722 [info ] [MainThread]: Finished running 13 data tests in 0 hours 0 minutes and 20.41 seconds (20.41s).
[0m04:38:31.908101 [debug] [MainThread]: Command end result
[0m04:38:31.979550 [info ] [MainThread]: 
[0m04:38:31.979943 [info ] [MainThread]: [31mCompleted with 13 errors and 0 warnings:[0m
[0m04:38:31.980319 [info ] [MainThread]: 
[0m04:38:31.980735 [error] [MainThread]:   Database Error in test dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__1000__0 (models/youtube_data/marts/schema.yml)
  Not found: Table yt-e2e-data-cycle-project:youtube.dim_videos was not found in location US
  compiled code at target/run/youtube_project/models/youtube_data/marts/schema.yml/dbt_expectations_expect_column_13f5ea41244b9d04c2f93b4f12209c17.sql
[0m04:38:31.981010 [info ] [MainThread]: 
[0m04:38:31.981359 [error] [MainThread]:   Database Error in test dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1 (models/youtube_data/marts/schema.yml)
  Not found: Table yt-e2e-data-cycle-project:youtube.dim_videos was not found in location US
  compiled code at target/run/youtube_project/models/youtube_data/marts/schema.yml/dbt_expectations_expect_column_68caf04df3376cf7e2dda8af8a24b521.sql
[0m04:38:31.981598 [info ] [MainThread]: 
[0m04:38:31.981925 [error] [MainThread]:   Database Error in test dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64 (models/youtube_data/marts/schema.yml)
  Syntax error: Unexpected ")" at [10:5]
  compiled code at target/run/youtube_project/models/youtube_data/marts/schema.yml/dbt_expectations_expect_column_44668d6742702eeb8e20aaff03f6f538.sql
[0m04:38:31.982208 [info ] [MainThread]: 
[0m04:38:31.982496 [error] [MainThread]:   Database Error in test dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING (models/youtube_data/marts/schema.yml)
  Syntax error: Unexpected ")" at [10:5]
  compiled code at target/run/youtube_project/models/youtube_data/marts/schema.yml/dbt_expectations_expect_column_3b57f01d2e35a867efce197c267f724a.sql
[0m04:38:31.982743 [info ] [MainThread]: 
[0m04:38:31.983146 [error] [MainThread]:   Database Error in test dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING (models/youtube_data/marts/schema.yml)
  Syntax error: Unexpected ")" at [10:5]
  compiled code at target/run/youtube_project/models/youtube_data/marts/schema.yml/dbt_expectations_expect_column_9d06a4d4b58deefc993eda068e284d4a.sql
[0m04:38:31.983481 [info ] [MainThread]: 
[0m04:38:31.983959 [error] [MainThread]:   Database Error in test dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING (models/youtube_data/marts/schema.yml)
  Syntax error: Unexpected ")" at [10:5]
  compiled code at target/run/youtube_project/models/youtube_data/marts/schema.yml/dbt_expectations_expect_column_a375c0503693ce6ae5ed680554c18c0a.sql
[0m04:38:31.984372 [info ] [MainThread]: 
[0m04:38:31.984718 [error] [MainThread]:   Database Error in test dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING (models/youtube_data/marts/schema.yml)
  Syntax error: Unexpected ")" at [10:5]
  compiled code at target/run/youtube_project/models/youtube_data/marts/schema.yml/dbt_expectations_expect_column_50ce18689bcd2f4e2b9c6185ac50a7a3.sql
[0m04:38:31.984961 [info ] [MainThread]: 
[0m04:38:31.985275 [error] [MainThread]:   Database Error in test not_null_dim_videos_category_id (models/youtube_data/marts/schema.yml)
  Not found: Table yt-e2e-data-cycle-project:youtube.dim_videos was not found in location US
  compiled code at target/run/youtube_project/models/youtube_data/marts/schema.yml/not_null_dim_videos_category_id.sql
[0m04:38:31.985534 [info ] [MainThread]: 
[0m04:38:31.985817 [error] [MainThread]:   Database Error in test not_null_dim_videos_channel_id (models/youtube_data/marts/schema.yml)
  Not found: Table yt-e2e-data-cycle-project:youtube.dim_videos was not found in location US
  compiled code at target/run/youtube_project/models/youtube_data/marts/schema.yml/not_null_dim_videos_channel_id.sql
[0m04:38:31.986012 [info ] [MainThread]: 
[0m04:38:31.986304 [error] [MainThread]:   Database Error in test not_null_dim_videos_description (models/youtube_data/marts/schema.yml)
  Not found: Table yt-e2e-data-cycle-project:youtube.dim_videos was not found in location US
  compiled code at target/run/youtube_project/models/youtube_data/marts/schema.yml/not_null_dim_videos_description.sql
[0m04:38:31.986523 [info ] [MainThread]: 
[0m04:38:31.986836 [error] [MainThread]:   Database Error in test not_null_dim_videos_title (models/youtube_data/marts/schema.yml)
  Not found: Table yt-e2e-data-cycle-project:youtube.dim_videos was not found in location US
  compiled code at target/run/youtube_project/models/youtube_data/marts/schema.yml/not_null_dim_videos_title.sql
[0m04:38:31.987058 [info ] [MainThread]: 
[0m04:38:31.987368 [error] [MainThread]:   Database Error in test not_null_dim_videos_video_id (models/youtube_data/marts/schema.yml)
  Not found: Table yt-e2e-data-cycle-project:youtube.dim_videos was not found in location US
  compiled code at target/run/youtube_project/models/youtube_data/marts/schema.yml/not_null_dim_videos_video_id.sql
[0m04:38:31.987592 [info ] [MainThread]: 
[0m04:38:31.987898 [error] [MainThread]:   Database Error in test unique_dim_videos_video_id (models/youtube_data/marts/schema.yml)
  Not found: Table yt-e2e-data-cycle-project:youtube.dim_videos was not found in location US
  compiled code at target/run/youtube_project/models/youtube_data/marts/schema.yml/unique_dim_videos_video_id.sql
[0m04:38:31.988178 [info ] [MainThread]: 
[0m04:38:31.988460 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=13 SKIP=0 TOTAL=13
[0m04:38:31.989852 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 21.44567, "process_in_blocks": "0", "process_kernel_time": 0.250065, "process_mem_max_rss": "223612", "process_out_blocks": "5849", "process_user_time": 3.429614}
[0m04:38:31.990354 [debug] [MainThread]: Command `dbt test` failed at 04:38:31.990269 after 21.45 seconds
[0m04:38:31.990736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f34b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91e0c920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f783140>]}
[0m04:38:31.991020 [debug] [MainThread]: Flushing usage events
[0m04:39:15.918876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d3b11f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d5f4aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d5f7800>]}


============================== 04:39:15.920218 | ab4a692d-fb12-4d71-afe3-974031ef3686 ==============================
[0m04:39:15.920218 [info ] [MainThread]: Running with dbt=1.8.9
[0m04:39:15.920655 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'profiles_dir': '/usr/local/airflow/include/dbt', 'empty': 'False', 'use_experimental_parser': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'invocation_command': 'dbt run --models youtube_data.marts.dim_videos', 'use_colors': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'version_check': 'True', 'static_parser': 'True', 'quiet': 'False', 'write_json': 'True', 'debug': 'False', 'partial_parse': 'True', 'no_print': 'None', 'warn_error': 'None', 'fail_fast': 'False'}
[0m04:39:16.546736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab4a692d-fb12-4d71-afe3-974031ef3686', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff709209e0>]}
[0m04:39:16.571349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab4a692d-fb12-4d71-afe3-974031ef3686', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e7aa840>]}
[0m04:39:16.571740 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m04:39:16.641290 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m04:39:16.766629 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:39:16.766959 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:39:16.789044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab4a692d-fb12-4d71-afe3-974031ef3686', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff707a2e40>]}
[0m04:39:16.872047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab4a692d-fb12-4d71-afe3-974031ef3686', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff700ebd70>]}
[0m04:39:16.872443 [info ] [MainThread]: Found 12 models, 138 data tests, 2 sources, 867 macros
[0m04:39:16.872693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab4a692d-fb12-4d71-afe3-974031ef3686', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d087b60>]}
[0m04:39:16.874543 [info ] [MainThread]: 
[0m04:39:16.874996 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m04:39:16.875670 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project'
[0m04:39:16.875927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:39:18.035596 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project, now list_yt-e2e-data-cycle-project_youtube)
[0m04:39:18.036577 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:39:18.954665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab4a692d-fb12-4d71-afe3-974031ef3686', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70252750>]}
[0m04:39:18.955805 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:39:18.956587 [info ] [MainThread]: 
[0m04:39:18.961261 [debug] [Thread-1 (]: Began running node model.youtube_project.dim_videos
[0m04:39:18.962518 [info ] [Thread-1 (]: 1 of 1 START sql table model youtube.dim_videos ................................ [RUN]
[0m04:39:18.963657 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now model.youtube_project.dim_videos)
[0m04:39:18.964415 [debug] [Thread-1 (]: Began compiling node model.youtube_project.dim_videos
[0m04:39:18.977844 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_project.dim_videos"
[0m04:39:18.979656 [debug] [Thread-1 (]: Began executing node model.youtube_project.dim_videos
[0m04:39:19.016593 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_project.dim_videos"
[0m04:39:19.017706 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:39:19.019072 [debug] [Thread-1 (]: On model.youtube_project.dim_videos: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "model.youtube_project.dim_videos"} */

  
    

    create or replace table `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
      
    
    cluster by video_id

    OPTIONS()
    as (
      WITH video_data AS (
    SELECT * 
    FROM `yt-e2e-data-cycle-project`.`youtube`.`staging_video`  
),

video_filled AS (
    SELECT
        video_id,
        
        -- Clean invalid characters from title and provide a default value if necessary
        COALESCE(
            REGEXP_REPLACE(title, r'[\x00-\x1F\x7F-\x9F\xAD\uFFFD]', ''), 
            'No Title Available'
        ) AS title,
        
        -- Clean invalid characters from description and provide a default value if necessary
        COALESCE(
            REGEXP_REPLACE(description, r'[\x00-\x1F\x7F-\x9F\xAD\uFFFD]', ''), 
            'No Description Available'
        ) AS description,
        
        channel_id,
        category_id
    FROM
        video_data
)

SELECT
    v.video_id,
    v.title,
    v.description,
    v.channel_id,
    v.category_id
FROM
    video_filled v
    );
  
[0m04:39:20.178712 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:5b604fc1-68df-49c3-8ebf-bf342ddc341d&page=queryresults
[0m04:39:20.585345 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Cannot parse regular expression: invalid escape sequence: \\u; reason: invalidQuery, location: query, message: Cannot parse regular expression: invalid escape sequence: \\u')
[0m04:39:22.121251 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:0649e8e1-5dee-45fa-974e-10c7fec78000&page=queryresults
[0m04:39:22.431394 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:0649e8e1-5dee-45fa-974e-10c7fec78000&page=queryresults
[0m04:39:22.442164 [debug] [Thread-1 (]: Database Error in model dim_videos (models/youtube_data/marts/dim_videos.sql)
  Cannot parse regular expression: invalid escape sequence: \u
  compiled code at target/run/youtube_project/models/youtube_data/marts/dim_videos.sql
[0m04:39:22.444723 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab4a692d-fb12-4d71-afe3-974031ef3686', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7049fe90>]}
[0m04:39:22.446005 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model youtube.dim_videos ....................... [[31mERROR[0m in 3.48s]
[0m04:39:22.447415 [debug] [Thread-1 (]: Finished running node model.youtube_project.dim_videos
[0m04:39:22.450395 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:39:22.451003 [debug] [MainThread]: Connection 'model.youtube_project.dim_videos' was properly closed.
[0m04:39:22.451610 [info ] [MainThread]: 
[0m04:39:22.453737 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.58 seconds (5.58s).
[0m04:39:22.455488 [debug] [MainThread]: Command end result
[0m04:39:22.521067 [info ] [MainThread]: 
[0m04:39:22.521469 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:39:22.521820 [info ] [MainThread]: 
[0m04:39:22.522268 [error] [MainThread]:   Database Error in model dim_videos (models/youtube_data/marts/dim_videos.sql)
  Cannot parse regular expression: invalid escape sequence: \u
  compiled code at target/run/youtube_project/models/youtube_data/marts/dim_videos.sql
[0m04:39:22.522577 [info ] [MainThread]: 
[0m04:39:22.522909 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m04:39:22.523671 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.6296916, "process_in_blocks": "0", "process_kernel_time": 0.217152, "process_mem_max_rss": "220684", "process_out_blocks": "5708", "process_user_time": 2.418839}
[0m04:39:22.524037 [debug] [MainThread]: Command `dbt run` failed at 04:39:22.523968 after 6.63 seconds
[0m04:39:22.524328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e07b7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d48f110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d48f9e0>]}
[0m04:39:22.524557 [debug] [MainThread]: Flushing usage events
[0m04:40:39.165307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb501fd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb405d8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4ff6750>]}


============================== 04:40:39.166531 | 26e172a7-4c24-4df8-852e-ad1697e1c4a2 ==============================
[0m04:40:39.166531 [info ] [MainThread]: Running with dbt=1.8.9
[0m04:40:39.166906 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'empty': 'False', 'invocation_command': 'dbt run --models youtube_data.marts.dim_videos', 'log_format': 'default', 'debug': 'False', 'no_print': 'None', 'warn_error': 'None', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/usr/local/airflow/include/dbt/logs', 'quiet': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'partial_parse': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'printer_width': '80', 'version_check': 'True', 'target_path': 'None', 'introspect': 'True'}
[0m04:40:39.769368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26e172a7-4c24-4df8-852e-ad1697e1c4a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5034470>]}
[0m04:40:39.793912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26e172a7-4c24-4df8-852e-ad1697e1c4a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb55663f0>]}
[0m04:40:39.794302 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m04:40:39.858468 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m04:40:39.992363 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:40:39.993068 [debug] [MainThread]: Partial parsing: updated file: youtube_project://models/youtube_data/marts/dim_videos.sql
[0m04:40:40.213819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26e172a7-4c24-4df8-852e-ad1697e1c4a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96e3cf20>]}
[0m04:40:40.294692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26e172a7-4c24-4df8-852e-ad1697e1c4a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97009a00>]}
[0m04:40:40.295088 [info ] [MainThread]: Found 12 models, 138 data tests, 2 sources, 867 macros
[0m04:40:40.295451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26e172a7-4c24-4df8-852e-ad1697e1c4a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96d5ec60>]}
[0m04:40:40.297310 [info ] [MainThread]: 
[0m04:40:40.297767 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m04:40:40.298418 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project'
[0m04:40:40.298686 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:40:41.077885 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project, now list_yt-e2e-data-cycle-project_youtube)
[0m04:40:41.078742 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:40:41.895262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26e172a7-4c24-4df8-852e-ad1697e1c4a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff969be8d0>]}
[0m04:40:41.896403 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:40:41.897230 [info ] [MainThread]: 
[0m04:40:41.902183 [debug] [Thread-1 (]: Began running node model.youtube_project.dim_videos
[0m04:40:41.903307 [info ] [Thread-1 (]: 1 of 1 START sql table model youtube.dim_videos ................................ [RUN]
[0m04:40:41.904150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now model.youtube_project.dim_videos)
[0m04:40:41.904789 [debug] [Thread-1 (]: Began compiling node model.youtube_project.dim_videos
[0m04:40:41.915784 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_project.dim_videos"
[0m04:40:41.917572 [debug] [Thread-1 (]: Began executing node model.youtube_project.dim_videos
[0m04:40:41.952620 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_project.dim_videos"
[0m04:40:41.953753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:40:41.955055 [debug] [Thread-1 (]: On model.youtube_project.dim_videos: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "model.youtube_project.dim_videos"} */

  
    

    create or replace table `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
      
    
    cluster by video_id

    OPTIONS()
    as (
      WITH video_data AS (
    SELECT * 
    FROM `yt-e2e-data-cycle-project`.`youtube`.`staging_video`  
),

video_filled AS (
    SELECT
        video_id,
        
        -- Clean invalid characters from title and provide a default value if necessary
        COALESCE(
            REGEXP_REPLACE(title, r'[\x00-\x1F\x7F-\x9F\xAD�]', ''), 
            'No Title Available'
        ) AS title,
        
        -- Clean invalid characters from description and provide a default value if necessary
        COALESCE(
            REGEXP_REPLACE(description, r'[\x00-\x1F\x7F-\x9F\xAD�]', ''), 
            'No Description Available'
        ) AS description,
        
        channel_id,
        category_id
    FROM
        video_data
)

SELECT
    v.video_id,
    v.title,
    v.description,
    v.channel_id,
    v.category_id
FROM
    video_filled v
    );
  
[0m04:40:43.226410 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:e2e4972a-7a6a-4268-818b-97765e447007&page=queryresults
[0m04:40:45.810380 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26e172a7-4c24-4df8-852e-ad1697e1c4a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98274560>]}
[0m04:40:45.812107 [info ] [Thread-1 (]: 1 of 1 OK created sql table model youtube.dim_videos ........................... [[32mCREATE TABLE (100.0 rows, 80.3 KiB processed)[0m in 3.91s]
[0m04:40:45.813416 [debug] [Thread-1 (]: Finished running node model.youtube_project.dim_videos
[0m04:40:45.815490 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:40:45.816007 [debug] [MainThread]: Connection 'model.youtube_project.dim_videos' was properly closed.
[0m04:40:45.816582 [info ] [MainThread]: 
[0m04:40:45.817265 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.52 seconds (5.52s).
[0m04:40:45.818429 [debug] [MainThread]: Command end result
[0m04:40:45.941310 [info ] [MainThread]: 
[0m04:40:45.941678 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:40:45.942003 [info ] [MainThread]: 
[0m04:40:45.942324 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:40:45.943065 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.8007674, "process_in_blocks": "0", "process_kernel_time": 0.227443, "process_mem_max_rss": "225480", "process_out_blocks": "8226", "process_user_time": 2.615603}
[0m04:40:45.943401 [debug] [MainThread]: Command `dbt run` succeeded at 04:40:45.943340 after 6.80 seconds
[0m04:40:45.943636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97286a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97286c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97287f20>]}
[0m04:40:45.943845 [debug] [MainThread]: Flushing usage events
[0m04:40:50.892585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a1251f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a127ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a35aa20>]}


============================== 04:40:50.893557 | e65b4ab7-399e-4222-8c02-077e0e3cea50 ==============================
[0m04:40:50.893557 [info ] [MainThread]: Running with dbt=1.8.9
[0m04:40:50.893915 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'version_check': 'True', 'empty': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test --models youtube_data.marts.dim_videos', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'target_path': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'debug': 'False', 'printer_width': '80', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'no_print': 'None'}
[0m04:40:51.439509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e65b4ab7-399e-4222-8c02-077e0e3cea50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a8340e0>]}
[0m04:40:51.464762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e65b4ab7-399e-4222-8c02-077e0e3cea50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d698920>]}
[0m04:40:51.465347 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m04:40:51.528603 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m04:40:51.642755 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:40:51.643073 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:40:51.665122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e65b4ab7-399e-4222-8c02-077e0e3cea50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89701e20>]}
[0m04:40:51.750340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e65b4ab7-399e-4222-8c02-077e0e3cea50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c6b11c0>]}
[0m04:40:51.750698 [info ] [MainThread]: Found 12 models, 138 data tests, 2 sources, 867 macros
[0m04:40:51.750931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e65b4ab7-399e-4222-8c02-077e0e3cea50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c3d7a70>]}
[0m04:40:51.752898 [info ] [MainThread]: 
[0m04:40:51.753381 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m04:40:51.755797 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project_youtube'
[0m04:40:51.756038 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:40:52.549732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e65b4ab7-399e-4222-8c02-077e0e3cea50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8972baa0>]}
[0m04:40:52.550901 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:40:52.551542 [info ] [MainThread]: 
[0m04:40:52.556077 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__1000__0.8be96026f1
[0m04:40:52.557040 [info ] [Thread-1 (]: 1 of 13 START test dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__1000__0  [RUN]
[0m04:40:52.558139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__1000__0.8be96026f1)
[0m04:40:52.558967 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__1000__0.8be96026f1
[0m04:40:52.592418 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__1000__0.8be96026f1"
[0m04:40:52.594659 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__1000__0.8be96026f1
[0m04:40:52.611601 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__1000__0.8be96026f1"
[0m04:40:52.612551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:40:52.613781 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__1000__0.8be96026f1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__1000__0.8be96026f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and length(
        description
    ) >= 0 and length(
        description
    ) <= 1000
)
 as expression


    from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







      
    ) dbt_internal_test
[0m04:40:53.876016 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:ccfe52f8-6904-4fb8-b0f6-4d3f82ceef90&page=queryresults
[0m04:40:55.214736 [error] [Thread-1 (]: 1 of 13 FAIL 25 dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__1000__0  [[31mFAIL 25[0m in 2.66s]
[0m04:40:55.216556 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__1000__0.8be96026f1
[0m04:40:55.217700 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718
[0m04:40:55.218704 [info ] [Thread-1 (]: 2 of 13 START test dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1  [RUN]
[0m04:40:55.219811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__1000__0.8be96026f1, now test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718)
[0m04:40:55.220661 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718
[0m04:40:55.228191 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718"
[0m04:40:55.230462 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718
[0m04:40:55.234619 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718"
[0m04:40:55.236247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:40:55.238559 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and length(
        title
    ) >= 1 and length(
        title
    ) <= 255
)
 as expression


    from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







      
    ) dbt_internal_test
[0m04:40:56.538423 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:a3813464-842a-4cda-93bf-31e18042a0b1&page=queryresults
[0m04:40:57.767117 [info ] [Thread-1 (]: 2 of 13 PASS dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1  [[32mPASS[0m in 2.55s]
[0m04:40:57.769795 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718
[0m04:40:57.771220 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0
[0m04:40:57.772230 [info ] [Thread-1 (]: 3 of 13 START test dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64  [RUN]
[0m04:40:57.773427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0)
[0m04:40:57.774245 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0
[0m04:40:57.789766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:40:58.599846 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0"
[0m04:40:58.602128 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0
[0m04:40:58.606077 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0"
[0m04:40:58.607823 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('TITLE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('DESCRIPTION' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CATEGORY_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'CATEGORY_ID'
            and
            relation_column_type not in ('INT64')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:40:59.504475 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:4fcd225a-0edc-4cf3-b960-880a951b437c&page=queryresults
[0m04:41:00.738129 [info ] [Thread-1 (]: 3 of 13 PASS dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64  [[32mPASS[0m in 2.96s]
[0m04:41:00.742501 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0
[0m04:41:00.743963 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897
[0m04:41:00.744953 [info ] [Thread-1 (]: 4 of 13 START test dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING  [RUN]
[0m04:41:00.746163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897)
[0m04:41:00.747091 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897
[0m04:41:00.756897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:41:01.555857 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897"
[0m04:41:01.557925 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897
[0m04:41:01.561716 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897"
[0m04:41:01.563420 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('TITLE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('DESCRIPTION' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CATEGORY_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'CHANNEL_ID'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:41:02.169432 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:1f66bbe9-f040-4659-8d12-45191d243824&page=queryresults
[0m04:41:03.298460 [info ] [Thread-1 (]: 4 of 13 PASS dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING  [[32mPASS[0m in 2.55s]
[0m04:41:03.301860 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897
[0m04:41:03.303555 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603
[0m04:41:03.304640 [info ] [Thread-1 (]: 5 of 13 START test dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING  [RUN]
[0m04:41:03.305809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603)
[0m04:41:03.306596 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603
[0m04:41:03.315618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:41:04.221478 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603"
[0m04:41:04.224156 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603
[0m04:41:04.229260 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603"
[0m04:41:04.231179 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('TITLE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('DESCRIPTION' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CATEGORY_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'DESCRIPTION'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:41:04.831365 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:f1f14857-e993-499d-ba57-2c30ef0eb33b&page=queryresults
[0m04:41:06.060808 [info ] [Thread-1 (]: 5 of 13 PASS dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING  [[32mPASS[0m in 2.75s]
[0m04:41:06.064438 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603
[0m04:41:06.066143 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc
[0m04:41:06.067176 [info ] [Thread-1 (]: 6 of 13 START test dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING  [RUN]
[0m04:41:06.068409 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc)
[0m04:41:06.069332 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc
[0m04:41:06.080246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:41:06.982823 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc"
[0m04:41:06.985183 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc
[0m04:41:06.989830 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc"
[0m04:41:06.991365 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('TITLE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('DESCRIPTION' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CATEGORY_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'TITLE'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:41:07.596588 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:c5305eb3-c571-42c9-9dcb-c2555f69a3e9&page=queryresults
[0m04:41:08.827921 [info ] [Thread-1 (]: 6 of 13 PASS dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING  [[32mPASS[0m in 2.76s]
[0m04:41:08.831543 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc
[0m04:41:08.833143 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd
[0m04:41:08.834268 [info ] [Thread-1 (]: 7 of 13 START test dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING  [RUN]
[0m04:41:08.835565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd)
[0m04:41:08.836582 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd
[0m04:41:08.845400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:41:09.749853 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd"
[0m04:41:09.753156 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd
[0m04:41:09.758314 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd"
[0m04:41:09.760576 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('TITLE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('DESCRIPTION' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CATEGORY_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'VIDEO_ID'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:41:10.565819 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:a2654d6e-9811-4d90-baf0-de9f2367ec58&page=queryresults
[0m04:41:11.795067 [info ] [Thread-1 (]: 7 of 13 PASS dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING  [[32mPASS[0m in 2.96s]
[0m04:41:11.798048 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd
[0m04:41:11.799620 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07
[0m04:41:11.800686 [info ] [Thread-1 (]: 8 of 13 START test not_null_dim_videos_category_id ............................. [RUN]
[0m04:41:11.801894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd, now test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07)
[0m04:41:11.802790 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07
[0m04:41:11.814890 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07"
[0m04:41:11.816878 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07
[0m04:41:11.822214 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07"
[0m04:41:11.824313 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:41:11.827060 [debug] [Thread-1 (]: On test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select category_id
from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
where category_id is null



      
    ) dbt_internal_test
[0m04:41:13.064881 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:a2a5f107-d991-4503-b33f-d14544cb1857&page=queryresults
[0m04:41:14.254773 [info ] [Thread-1 (]: 8 of 13 PASS not_null_dim_videos_category_id ................................... [[32mPASS[0m in 2.45s]
[0m04:41:14.257381 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07
[0m04:41:14.259269 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_dim_videos_channel_id.4153a564fb
[0m04:41:14.260518 [info ] [Thread-1 (]: 9 of 13 START test not_null_dim_videos_channel_id .............................. [RUN]
[0m04:41:14.261639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07, now test.youtube_project.not_null_dim_videos_channel_id.4153a564fb)
[0m04:41:14.262589 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_dim_videos_channel_id.4153a564fb
[0m04:41:14.273583 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_dim_videos_channel_id.4153a564fb"
[0m04:41:14.275439 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_dim_videos_channel_id.4153a564fb
[0m04:41:14.279145 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_dim_videos_channel_id.4153a564fb"
[0m04:41:14.280686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:41:14.282957 [debug] [Thread-1 (]: On test.youtube_project.not_null_dim_videos_channel_id.4153a564fb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_dim_videos_channel_id.4153a564fb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select channel_id
from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
where channel_id is null



      
    ) dbt_internal_test
[0m04:41:15.583171 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:64fe2d75-1503-436e-8ac4-7c2e31af5e68&page=queryresults
[0m04:41:16.710369 [info ] [Thread-1 (]: 9 of 13 PASS not_null_dim_videos_channel_id .................................... [[32mPASS[0m in 2.45s]
[0m04:41:16.713237 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_dim_videos_channel_id.4153a564fb
[0m04:41:16.715774 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_dim_videos_description.764dd33190
[0m04:41:16.716852 [info ] [Thread-1 (]: 10 of 13 START test not_null_dim_videos_description ............................ [RUN]
[0m04:41:16.718080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_dim_videos_channel_id.4153a564fb, now test.youtube_project.not_null_dim_videos_description.764dd33190)
[0m04:41:16.718902 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_dim_videos_description.764dd33190
[0m04:41:16.726448 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_dim_videos_description.764dd33190"
[0m04:41:16.728214 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_dim_videos_description.764dd33190
[0m04:41:16.732044 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_dim_videos_description.764dd33190"
[0m04:41:16.733442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:41:16.735686 [debug] [Thread-1 (]: On test.youtube_project.not_null_dim_videos_description.764dd33190: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_dim_videos_description.764dd33190"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select description
from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
where description is null



      
    ) dbt_internal_test
[0m04:41:17.834728 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:c037362c-1b01-4686-aca5-621c868b9fc2&page=queryresults
[0m04:41:19.064032 [info ] [Thread-1 (]: 10 of 13 PASS not_null_dim_videos_description .................................. [[32mPASS[0m in 2.35s]
[0m04:41:19.066662 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_dim_videos_description.764dd33190
[0m04:41:19.068030 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_dim_videos_title.197d58b52d
[0m04:41:19.068656 [info ] [Thread-1 (]: 11 of 13 START test not_null_dim_videos_title .................................. [RUN]
[0m04:41:19.069380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_dim_videos_description.764dd33190, now test.youtube_project.not_null_dim_videos_title.197d58b52d)
[0m04:41:19.069954 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_dim_videos_title.197d58b52d
[0m04:41:19.075747 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_dim_videos_title.197d58b52d"
[0m04:41:19.077531 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_dim_videos_title.197d58b52d
[0m04:41:19.081042 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_dim_videos_title.197d58b52d"
[0m04:41:19.082460 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:41:19.084416 [debug] [Thread-1 (]: On test.youtube_project.not_null_dim_videos_title.197d58b52d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_dim_videos_title.197d58b52d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select title
from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
where title is null



      
    ) dbt_internal_test
[0m04:41:20.189385 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:cc7927df-4e74-44f8-8d94-7d742081d724&page=queryresults
[0m04:41:21.419608 [info ] [Thread-1 (]: 11 of 13 PASS not_null_dim_videos_title ........................................ [[32mPASS[0m in 2.35s]
[0m04:41:21.423121 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_dim_videos_title.197d58b52d
[0m04:41:21.425050 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_dim_videos_video_id.074012a872
[0m04:41:21.425904 [info ] [Thread-1 (]: 12 of 13 START test not_null_dim_videos_video_id ............................... [RUN]
[0m04:41:21.427365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_dim_videos_title.197d58b52d, now test.youtube_project.not_null_dim_videos_video_id.074012a872)
[0m04:41:21.428438 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_dim_videos_video_id.074012a872
[0m04:41:21.436917 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_dim_videos_video_id.074012a872"
[0m04:41:21.438954 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_dim_videos_video_id.074012a872
[0m04:41:21.446119 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_dim_videos_video_id.074012a872"
[0m04:41:21.447941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:41:21.450478 [debug] [Thread-1 (]: On test.youtube_project.not_null_dim_videos_video_id.074012a872: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_dim_videos_video_id.074012a872"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select video_id
from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
where video_id is null



      
    ) dbt_internal_test
[0m04:41:22.441938 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:8868a2eb-27f2-4c88-88c3-9f6c42b44bb7&page=queryresults
[0m04:41:23.523431 [info ] [Thread-1 (]: 12 of 13 PASS not_null_dim_videos_video_id ..................................... [[32mPASS[0m in 2.10s]
[0m04:41:23.526057 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_dim_videos_video_id.074012a872
[0m04:41:23.527138 [debug] [Thread-1 (]: Began running node test.youtube_project.unique_dim_videos_video_id.e6dc8fa384
[0m04:41:23.527800 [info ] [Thread-1 (]: 13 of 13 START test unique_dim_videos_video_id ................................. [RUN]
[0m04:41:23.528705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_dim_videos_video_id.074012a872, now test.youtube_project.unique_dim_videos_video_id.e6dc8fa384)
[0m04:41:23.529438 [debug] [Thread-1 (]: Began compiling node test.youtube_project.unique_dim_videos_video_id.e6dc8fa384
[0m04:41:23.539687 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.unique_dim_videos_video_id.e6dc8fa384"
[0m04:41:23.541396 [debug] [Thread-1 (]: Began executing node test.youtube_project.unique_dim_videos_video_id.e6dc8fa384
[0m04:41:23.544888 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.unique_dim_videos_video_id.e6dc8fa384"
[0m04:41:23.546615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:41:23.548854 [debug] [Thread-1 (]: On test.youtube_project.unique_dim_videos_video_id.e6dc8fa384: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.unique_dim_videos_video_id.e6dc8fa384"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select video_id as unique_field
  from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
  where video_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m04:41:24.902220 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:c4b7bcff-7f6e-4508-ba83-198d8c7eaadb&page=queryresults
[0m04:41:26.125190 [info ] [Thread-1 (]: 13 of 13 PASS unique_dim_videos_video_id ....................................... [[32mPASS[0m in 2.60s]
[0m04:41:26.127658 [debug] [Thread-1 (]: Finished running node test.youtube_project.unique_dim_videos_video_id.e6dc8fa384
[0m04:41:26.131873 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:41:26.132585 [debug] [MainThread]: Connection 'test.youtube_project.unique_dim_videos_video_id.e6dc8fa384' was properly closed.
[0m04:41:26.133279 [info ] [MainThread]: 
[0m04:41:26.134036 [info ] [MainThread]: Finished running 13 data tests in 0 hours 0 minutes and 34.38 seconds (34.38s).
[0m04:41:26.138194 [debug] [MainThread]: Command end result
[0m04:41:26.220495 [info ] [MainThread]: 
[0m04:41:26.221358 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:41:26.222044 [info ] [MainThread]: 
[0m04:41:26.222629 [error] [MainThread]: [31mFailure in test dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__1000__0 (models/youtube_data/marts/schema.yml)[0m
[0m04:41:26.223078 [error] [MainThread]:   Got 25 results, configured to fail if != 0
[0m04:41:26.223477 [info ] [MainThread]: 
[0m04:41:26.223912 [info ] [MainThread]:   compiled code at target/compiled/youtube_project/models/youtube_data/marts/schema.yml/dbt_expectations_expect_column_13f5ea41244b9d04c2f93b4f12209c17.sql
[0m04:41:26.224213 [info ] [MainThread]: 
[0m04:41:26.224639 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=1 SKIP=0 TOTAL=13
[0m04:41:26.227059 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 35.359116, "process_in_blocks": "0", "process_kernel_time": 0.190134, "process_mem_max_rss": "222928", "process_out_blocks": "5856", "process_user_time": 3.529488}
[0m04:41:26.227895 [debug] [MainThread]: Command `dbt test` failed at 04:41:26.227734 after 35.36 seconds
[0m04:41:26.228460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff897d93a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a97cfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c3d7a70>]}
[0m04:41:26.228908 [debug] [MainThread]: Flushing usage events
[0m04:42:11.516137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf5c6b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad849040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad868050>]}


============================== 04:42:11.517642 | 5355ee4a-0c94-43f0-8bd8-afef1a129786 ==============================
[0m04:42:11.517642 [info ] [MainThread]: Running with dbt=1.8.9
[0m04:42:11.518214 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'quiet': 'False', 'debug': 'False', 'empty': 'None', 'partial_parse': 'True', 'printer_width': '80', 'target_path': 'None', 'warn_error': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt', 'version_check': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'use_colors': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --models youtube_data.marts.dim_videos', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'log_cache_events': 'False'}
[0m04:42:12.128925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5355ee4a-0c94-43f0-8bd8-afef1a129786', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90bd42c0>]}
[0m04:42:12.153324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5355ee4a-0c94-43f0-8bd8-afef1a129786', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90cab4d0>]}
[0m04:42:12.153726 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m04:42:12.219287 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m04:42:12.342612 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:42:12.343451 [debug] [MainThread]: Partial parsing: updated file: youtube_project://models/youtube_data/marts/schema.yml
[0m04:42:12.559037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5355ee4a-0c94-43f0-8bd8-afef1a129786', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff900dafc0>]}
[0m04:42:12.646644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5355ee4a-0c94-43f0-8bd8-afef1a129786', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff902dd8e0>]}
[0m04:42:12.647047 [info ] [MainThread]: Found 12 models, 138 data tests, 2 sources, 867 macros
[0m04:42:12.647315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5355ee4a-0c94-43f0-8bd8-afef1a129786', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff908e75f0>]}
[0m04:42:12.649316 [info ] [MainThread]: 
[0m04:42:12.649764 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m04:42:12.652270 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project_youtube'
[0m04:42:12.652557 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:42:13.550252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5355ee4a-0c94-43f0-8bd8-afef1a129786', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9072acc0>]}
[0m04:42:13.551495 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:42:13.552338 [info ] [MainThread]: 
[0m04:42:13.556990 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__1.575d402bd0
[0m04:42:13.557896 [info ] [Thread-1 (]: 1 of 13 START test dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__1  [RUN]
[0m04:42:13.558973 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__1.575d402bd0)
[0m04:42:13.559802 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__1.575d402bd0
[0m04:42:13.573096 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__1.575d402bd0"
[0m04:42:13.575775 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__1.575d402bd0
[0m04:42:13.597384 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__1.575d402bd0"
[0m04:42:13.599188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:42:13.600796 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__1.575d402bd0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__1.575d402bd0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and length(
        description
    ) >= 1
)
 as expression


    from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







      
    ) dbt_internal_test
[0m04:42:14.770430 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:4822cbb4-b870-474d-8c15-dd125a2d5a26&page=queryresults
[0m04:42:16.007246 [error] [Thread-1 (]: 1 of 13 FAIL 18 dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__1  [[31mFAIL 18[0m in 2.45s]
[0m04:42:16.009090 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__1.575d402bd0
[0m04:42:16.010210 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718
[0m04:42:16.011182 [info ] [Thread-1 (]: 2 of 13 START test dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1  [RUN]
[0m04:42:16.012226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__1.575d402bd0, now test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718)
[0m04:42:16.013085 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718
[0m04:42:16.096222 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718"
[0m04:42:16.098554 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718
[0m04:42:16.100204 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718"
[0m04:42:16.101163 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:42:16.102223 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and length(
        title
    ) >= 1 and length(
        title
    ) <= 255
)
 as expression


    from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







      
    ) dbt_internal_test
[0m04:42:17.125076 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:b93c0208-4133-4986-9a57-a11a241d1882&page=queryresults
[0m04:42:18.259645 [info ] [Thread-1 (]: 2 of 13 PASS dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1  [[32mPASS[0m in 2.25s]
[0m04:42:18.260666 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718
[0m04:42:18.261349 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0
[0m04:42:18.262627 [info ] [Thread-1 (]: 3 of 13 START test dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64  [RUN]
[0m04:42:18.263997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0)
[0m04:42:18.264441 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0
[0m04:42:18.268012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:42:19.086087 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0"
[0m04:42:19.088387 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0
[0m04:42:19.092889 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0"
[0m04:42:19.094633 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('TITLE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('DESCRIPTION' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CATEGORY_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'CATEGORY_ID'
            and
            relation_column_type not in ('INT64')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:42:19.685682 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:4c354c6e-1d2e-45bf-a37d-1911d30fd28e&page=queryresults
[0m04:42:20.916129 [info ] [Thread-1 (]: 3 of 13 PASS dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64  [[32mPASS[0m in 2.65s]
[0m04:42:20.919179 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0
[0m04:42:20.921529 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897
[0m04:42:20.923152 [info ] [Thread-1 (]: 4 of 13 START test dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING  [RUN]
[0m04:42:20.924475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897)
[0m04:42:20.925437 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897
[0m04:42:20.933233 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:42:21.739286 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897"
[0m04:42:21.742588 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897
[0m04:42:21.747438 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897"
[0m04:42:21.749785 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('TITLE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('DESCRIPTION' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CATEGORY_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'CHANNEL_ID'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:42:22.245496 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:f49d7203-5487-4e82-adea-d091bfdd4051&page=queryresults
[0m04:42:23.373717 [info ] [Thread-1 (]: 4 of 13 PASS dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING  [[32mPASS[0m in 2.45s]
[0m04:42:23.376204 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897
[0m04:42:23.378103 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603
[0m04:42:23.379569 [info ] [Thread-1 (]: 5 of 13 START test dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING  [RUN]
[0m04:42:23.381335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603)
[0m04:42:23.382252 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603
[0m04:42:23.394049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:42:24.296959 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603"
[0m04:42:24.300323 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603
[0m04:42:24.304942 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603"
[0m04:42:24.306652 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('TITLE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('DESCRIPTION' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CATEGORY_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'DESCRIPTION'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:42:24.807782 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:cdfa3edb-bb9c-46e4-8a8a-414973321d93&page=queryresults
[0m04:42:26.035606 [info ] [Thread-1 (]: 5 of 13 PASS dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING  [[32mPASS[0m in 2.65s]
[0m04:42:26.039038 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603
[0m04:42:26.040278 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc
[0m04:42:26.041265 [info ] [Thread-1 (]: 6 of 13 START test dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING  [RUN]
[0m04:42:26.042431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc)
[0m04:42:26.043307 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc
[0m04:42:26.050810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:42:26.861059 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc"
[0m04:42:26.864094 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc
[0m04:42:26.868900 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc"
[0m04:42:26.870846 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('TITLE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('DESCRIPTION' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CATEGORY_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'TITLE'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:42:27.362112 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:d64cc4cd-c7cc-46f2-9b4c-f6410f557970&page=queryresults
[0m04:42:28.596620 [info ] [Thread-1 (]: 6 of 13 PASS dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING  [[32mPASS[0m in 2.55s]
[0m04:42:28.599219 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc
[0m04:42:28.601611 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd
[0m04:42:28.602995 [info ] [Thread-1 (]: 7 of 13 START test dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING  [RUN]
[0m04:42:28.604119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd)
[0m04:42:28.605093 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd
[0m04:42:28.612817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:42:29.416046 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd"
[0m04:42:29.418407 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd
[0m04:42:29.426439 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd"
[0m04:42:29.428550 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('TITLE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('DESCRIPTION' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CATEGORY_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'VIDEO_ID'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:42:30.026633 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:1ff653f5-870a-4f8a-beda-7411029038b6&page=queryresults
[0m04:42:31.257805 [info ] [Thread-1 (]: 7 of 13 PASS dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING  [[32mPASS[0m in 2.65s]
[0m04:42:31.261063 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd
[0m04:42:31.262928 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07
[0m04:42:31.264148 [info ] [Thread-1 (]: 8 of 13 START test not_null_dim_videos_category_id ............................. [RUN]
[0m04:42:31.265325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd, now test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07)
[0m04:42:31.266155 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07
[0m04:42:31.277942 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07"
[0m04:42:31.279912 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07
[0m04:42:31.283527 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07"
[0m04:42:31.285084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:42:31.287325 [debug] [Thread-1 (]: On test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select category_id
from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
where category_id is null



      
    ) dbt_internal_test
[0m04:42:32.280440 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:63dd7ed2-936f-49bf-b7a8-bfef9cea6a88&page=queryresults
[0m04:42:33.408543 [info ] [Thread-1 (]: 8 of 13 PASS not_null_dim_videos_category_id ................................... [[32mPASS[0m in 2.14s]
[0m04:42:33.411003 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07
[0m04:42:33.412791 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_dim_videos_channel_id.4153a564fb
[0m04:42:33.414004 [info ] [Thread-1 (]: 9 of 13 START test not_null_dim_videos_channel_id .............................. [RUN]
[0m04:42:33.415041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07, now test.youtube_project.not_null_dim_videos_channel_id.4153a564fb)
[0m04:42:33.415964 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_dim_videos_channel_id.4153a564fb
[0m04:42:33.423550 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_dim_videos_channel_id.4153a564fb"
[0m04:42:33.425462 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_dim_videos_channel_id.4153a564fb
[0m04:42:33.429358 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_dim_videos_channel_id.4153a564fb"
[0m04:42:33.430939 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:42:33.433325 [debug] [Thread-1 (]: On test.youtube_project.not_null_dim_videos_channel_id.4153a564fb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_dim_videos_channel_id.4153a564fb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select channel_id
from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
where channel_id is null



      
    ) dbt_internal_test
[0m04:42:34.536328 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:ad084c10-4b9f-42ea-af3c-55e6e6b1e467&page=queryresults
[0m04:42:35.761782 [info ] [Thread-1 (]: 9 of 13 PASS not_null_dim_videos_channel_id .................................... [[32mPASS[0m in 2.35s]
[0m04:42:35.763777 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_dim_videos_channel_id.4153a564fb
[0m04:42:35.764782 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_dim_videos_description.764dd33190
[0m04:42:35.765521 [info ] [Thread-1 (]: 10 of 13 START test not_null_dim_videos_description ............................ [RUN]
[0m04:42:35.766596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_dim_videos_channel_id.4153a564fb, now test.youtube_project.not_null_dim_videos_description.764dd33190)
[0m04:42:35.767200 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_dim_videos_description.764dd33190
[0m04:42:35.773977 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_dim_videos_description.764dd33190"
[0m04:42:35.775579 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_dim_videos_description.764dd33190
[0m04:42:35.778464 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_dim_videos_description.764dd33190"
[0m04:42:35.779643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:42:35.781598 [debug] [Thread-1 (]: On test.youtube_project.not_null_dim_videos_description.764dd33190: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_dim_videos_description.764dd33190"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select description
from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
where description is null



      
    ) dbt_internal_test
[0m04:42:36.786995 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:85251643-6cd1-494b-839c-87752ab58a09&page=queryresults
[0m04:42:37.913516 [info ] [Thread-1 (]: 10 of 13 PASS not_null_dim_videos_description .................................. [[32mPASS[0m in 2.15s]
[0m04:42:37.916665 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_dim_videos_description.764dd33190
[0m04:42:37.918344 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_dim_videos_title.197d58b52d
[0m04:42:37.919648 [info ] [Thread-1 (]: 11 of 13 START test not_null_dim_videos_title .................................. [RUN]
[0m04:42:37.920866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_dim_videos_description.764dd33190, now test.youtube_project.not_null_dim_videos_title.197d58b52d)
[0m04:42:37.921795 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_dim_videos_title.197d58b52d
[0m04:42:37.936633 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_dim_videos_title.197d58b52d"
[0m04:42:37.938389 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_dim_videos_title.197d58b52d
[0m04:42:37.941824 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_dim_videos_title.197d58b52d"
[0m04:42:37.943256 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:42:37.945689 [debug] [Thread-1 (]: On test.youtube_project.not_null_dim_videos_title.197d58b52d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_dim_videos_title.197d58b52d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select title
from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
where title is null



      
    ) dbt_internal_test
[0m04:42:38.936863 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:151ad85a-89c5-4823-86f8-0104c3d2a55b&page=queryresults
[0m04:42:40.163292 [info ] [Thread-1 (]: 11 of 13 PASS not_null_dim_videos_title ........................................ [[32mPASS[0m in 2.24s]
[0m04:42:40.165903 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_dim_videos_title.197d58b52d
[0m04:42:40.167230 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_dim_videos_video_id.074012a872
[0m04:42:40.168168 [info ] [Thread-1 (]: 12 of 13 START test not_null_dim_videos_video_id ............................... [RUN]
[0m04:42:40.169278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_dim_videos_title.197d58b52d, now test.youtube_project.not_null_dim_videos_video_id.074012a872)
[0m04:42:40.170247 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_dim_videos_video_id.074012a872
[0m04:42:40.178974 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_dim_videos_video_id.074012a872"
[0m04:42:40.181199 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_dim_videos_video_id.074012a872
[0m04:42:40.185117 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_dim_videos_video_id.074012a872"
[0m04:42:40.186975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:42:40.189447 [debug] [Thread-1 (]: On test.youtube_project.not_null_dim_videos_video_id.074012a872: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_dim_videos_video_id.074012a872"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select video_id
from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
where video_id is null



      
    ) dbt_internal_test
[0m04:42:41.292117 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:92797ddc-a2dd-41d1-b977-5cd6d1fd373d&page=queryresults
[0m04:42:42.518772 [info ] [Thread-1 (]: 12 of 13 PASS not_null_dim_videos_video_id ..................................... [[32mPASS[0m in 2.35s]
[0m04:42:42.521502 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_dim_videos_video_id.074012a872
[0m04:42:42.522753 [debug] [Thread-1 (]: Began running node test.youtube_project.unique_dim_videos_video_id.e6dc8fa384
[0m04:42:42.523683 [info ] [Thread-1 (]: 13 of 13 START test unique_dim_videos_video_id ................................. [RUN]
[0m04:42:42.524746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_dim_videos_video_id.074012a872, now test.youtube_project.unique_dim_videos_video_id.e6dc8fa384)
[0m04:42:42.525488 [debug] [Thread-1 (]: Began compiling node test.youtube_project.unique_dim_videos_video_id.e6dc8fa384
[0m04:42:42.539718 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.unique_dim_videos_video_id.e6dc8fa384"
[0m04:42:42.544154 [debug] [Thread-1 (]: Began executing node test.youtube_project.unique_dim_videos_video_id.e6dc8fa384
[0m04:42:42.548032 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.unique_dim_videos_video_id.e6dc8fa384"
[0m04:42:42.549746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:42:42.552082 [debug] [Thread-1 (]: On test.youtube_project.unique_dim_videos_video_id.e6dc8fa384: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.unique_dim_videos_video_id.e6dc8fa384"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select video_id as unique_field
  from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
  where video_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m04:42:43.646991 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:ff3ed71f-5f6a-4404-9463-b7482208297e&page=queryresults
[0m04:42:44.876203 [info ] [Thread-1 (]: 13 of 13 PASS unique_dim_videos_video_id ....................................... [[32mPASS[0m in 2.35s]
[0m04:42:44.879035 [debug] [Thread-1 (]: Finished running node test.youtube_project.unique_dim_videos_video_id.e6dc8fa384
[0m04:42:44.885809 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:42:44.886691 [debug] [MainThread]: Connection 'test.youtube_project.unique_dim_videos_video_id.e6dc8fa384' was properly closed.
[0m04:42:44.887756 [info ] [MainThread]: 
[0m04:42:44.888713 [info ] [MainThread]: Finished running 13 data tests in 0 hours 0 minutes and 32.24 seconds (32.24s).
[0m04:42:44.894476 [debug] [MainThread]: Command end result
[0m04:42:44.973782 [info ] [MainThread]: 
[0m04:42:44.974470 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:42:44.975084 [info ] [MainThread]: 
[0m04:42:44.975764 [error] [MainThread]: [31mFailure in test dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__1 (models/youtube_data/marts/schema.yml)[0m
[0m04:42:44.976271 [error] [MainThread]:   Got 18 results, configured to fail if != 0
[0m04:42:44.976851 [info ] [MainThread]: 
[0m04:42:44.977306 [info ] [MainThread]:   compiled code at target/compiled/youtube_project/models/youtube_data/marts/schema.yml/dbt_expectations_expect_column_3533d02cee5629247dd71ee0d6d1841f.sql
[0m04:42:44.977605 [info ] [MainThread]: 
[0m04:42:44.977945 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=1 SKIP=0 TOTAL=13
[0m04:42:44.979523 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 33.495308, "process_in_blocks": "0", "process_kernel_time": 0.320734, "process_mem_max_rss": "226780", "process_out_blocks": "8376", "process_user_time": 3.79519}
[0m04:42:44.980111 [debug] [MainThread]: Command `dbt test` failed at 04:42:44.980021 after 33.50 seconds
[0m04:42:44.980582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad823ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaff31490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadcb3620>]}
[0m04:42:44.980920 [debug] [MainThread]: Flushing usage events
[0m04:42:54.291466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb189deb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb14b1c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb37313a0>]}


============================== 04:42:54.292679 | 26377bab-ca84-4e24-99c2-02f442b583b4 ==============================
[0m04:42:54.292679 [info ] [MainThread]: Running with dbt=1.8.9
[0m04:42:54.293079 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt test --models youtube_data.marts.dim_videos', 'use_experimental_parser': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/usr/local/airflow/include/dbt/logs', 'no_print': 'None', 'fail_fast': 'False', 'log_format': 'default', 'target_path': 'None', 'indirect_selection': 'eager', 'quiet': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'empty': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'printer_width': '80'}
[0m04:42:54.897729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26377bab-ca84-4e24-99c2-02f442b583b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1b7e360>]}
[0m04:42:54.922364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26377bab-ca84-4e24-99c2-02f442b583b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1b7e360>]}
[0m04:42:54.922767 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m04:42:54.992224 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m04:42:55.115998 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:42:55.116919 [debug] [MainThread]: Partial parsing: updated file: youtube_project://models/youtube_data/marts/schema.yml
[0m04:42:55.334881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26377bab-ca84-4e24-99c2-02f442b583b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94540b30>]}
[0m04:42:55.426064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26377bab-ca84-4e24-99c2-02f442b583b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff935c3770>]}
[0m04:42:55.426438 [info ] [MainThread]: Found 12 models, 138 data tests, 2 sources, 867 macros
[0m04:42:55.426711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26377bab-ca84-4e24-99c2-02f442b583b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93551f70>]}
[0m04:42:55.428752 [info ] [MainThread]: 
[0m04:42:55.429236 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m04:42:55.431766 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project_youtube'
[0m04:42:55.432019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:42:56.251161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26377bab-ca84-4e24-99c2-02f442b583b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9389e570>]}
[0m04:42:56.252711 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:42:56.253724 [info ] [MainThread]: 
[0m04:42:56.259683 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__5000__1.4f59d196fd
[0m04:42:56.260669 [info ] [Thread-1 (]: 1 of 13 START test dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__5000__1  [RUN]
[0m04:42:56.261619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__5000__1.4f59d196fd)
[0m04:42:56.262248 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__5000__1.4f59d196fd
[0m04:42:56.275859 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__5000__1.4f59d196fd"
[0m04:42:56.277656 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__5000__1.4f59d196fd
[0m04:42:56.300184 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__5000__1.4f59d196fd"
[0m04:42:56.301681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:42:56.303387 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__5000__1.4f59d196fd: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__5000__1.4f59d196fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and length(
        description
    ) >= 1 and length(
        description
    ) <= 5000
)
 as expression


    from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







      
    ) dbt_internal_test
[0m04:42:57.472243 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:ca5aca39-95cc-4003-84a8-3ce05fb8c85b&page=queryresults
[0m04:42:58.708986 [error] [Thread-1 (]: 1 of 13 FAIL 18 dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__5000__1  [[31mFAIL 18[0m in 2.45s]
[0m04:42:58.710896 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__5000__1.4f59d196fd
[0m04:42:58.711973 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718
[0m04:42:58.712854 [info ] [Thread-1 (]: 2 of 13 START test dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1  [RUN]
[0m04:42:58.713881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__5000__1.4f59d196fd, now test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718)
[0m04:42:58.714759 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718
[0m04:42:58.801676 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718"
[0m04:42:58.802737 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718
[0m04:42:58.804404 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718"
[0m04:42:58.805110 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:42:58.806118 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and length(
        title
    ) >= 1 and length(
        title
    ) <= 255
)
 as expression


    from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







      
    ) dbt_internal_test
[0m04:42:59.826818 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:e30458ce-69ca-4029-988b-113a43f143e0&page=queryresults
[0m04:43:01.056482 [info ] [Thread-1 (]: 2 of 13 PASS dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1  [[32mPASS[0m in 2.34s]
[0m04:43:01.059598 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718
[0m04:43:01.061140 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0
[0m04:43:01.062095 [info ] [Thread-1 (]: 3 of 13 START test dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64  [RUN]
[0m04:43:01.063390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0)
[0m04:43:01.064289 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0
[0m04:43:01.072409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:43:01.886584 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0"
[0m04:43:01.888855 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0
[0m04:43:01.892761 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0"
[0m04:43:01.894446 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('TITLE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('DESCRIPTION' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CATEGORY_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'CATEGORY_ID'
            and
            relation_column_type not in ('INT64')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:43:02.389065 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:ef026a22-0e99-4a76-b52b-7f5decbb3d06&page=queryresults
[0m04:43:03.615906 [info ] [Thread-1 (]: 3 of 13 PASS dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64  [[32mPASS[0m in 2.55s]
[0m04:43:03.618773 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0
[0m04:43:03.620327 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897
[0m04:43:03.621313 [info ] [Thread-1 (]: 4 of 13 START test dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING  [RUN]
[0m04:43:03.622462 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897)
[0m04:43:03.623337 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897
[0m04:43:03.631070 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:43:04.439062 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897"
[0m04:43:04.441376 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897
[0m04:43:04.446222 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897"
[0m04:43:04.448218 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('TITLE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('DESCRIPTION' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CATEGORY_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'CHANNEL_ID'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:43:04.947301 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:94906600-d0f8-447b-8872-3fa1b6508706&page=queryresults
[0m04:43:06.175860 [info ] [Thread-1 (]: 4 of 13 PASS dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING  [[32mPASS[0m in 2.55s]
[0m04:43:06.178534 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897
[0m04:43:06.180084 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603
[0m04:43:06.181119 [info ] [Thread-1 (]: 5 of 13 START test dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING  [RUN]
[0m04:43:06.182224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603)
[0m04:43:06.183116 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603
[0m04:43:06.194645 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:43:06.997593 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603"
[0m04:43:06.999984 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603
[0m04:43:07.004763 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603"
[0m04:43:07.006682 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('TITLE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('DESCRIPTION' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CATEGORY_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'DESCRIPTION'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:43:07.506063 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:3adae27e-c42d-40bb-b1e8-93b721c8ad59&page=queryresults
[0m04:43:08.735666 [info ] [Thread-1 (]: 5 of 13 PASS dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING  [[32mPASS[0m in 2.55s]
[0m04:43:08.738760 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603
[0m04:43:08.740669 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc
[0m04:43:08.741662 [info ] [Thread-1 (]: 6 of 13 START test dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING  [RUN]
[0m04:43:08.742947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc)
[0m04:43:08.743836 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc
[0m04:43:08.751935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:43:09.570600 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc"
[0m04:43:09.574562 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc
[0m04:43:09.582397 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc"
[0m04:43:09.584459 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('TITLE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('DESCRIPTION' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CATEGORY_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'TITLE'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:43:10.064002 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:1b3c19fa-1514-4cff-ad9c-8e15dc017243&page=queryresults
[0m04:43:11.297105 [info ] [Thread-1 (]: 6 of 13 PASS dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING  [[32mPASS[0m in 2.55s]
[0m04:43:11.300241 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc
[0m04:43:11.302419 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd
[0m04:43:11.303657 [info ] [Thread-1 (]: 7 of 13 START test dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING  [RUN]
[0m04:43:11.304776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd)
[0m04:43:11.305714 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd
[0m04:43:11.314587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:43:12.117013 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd"
[0m04:43:12.120466 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd
[0m04:43:12.129190 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd"
[0m04:43:12.130915 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('TITLE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('DESCRIPTION' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CATEGORY_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'VIDEO_ID'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:43:12.627693 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:cf818fbf-1942-4224-acee-3257c3cfdd71&page=queryresults
[0m04:43:13.854255 [info ] [Thread-1 (]: 7 of 13 PASS dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING  [[32mPASS[0m in 2.55s]
[0m04:43:13.856202 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd
[0m04:43:13.857458 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07
[0m04:43:13.858446 [info ] [Thread-1 (]: 8 of 13 START test not_null_dim_videos_category_id ............................. [RUN]
[0m04:43:13.859625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd, now test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07)
[0m04:43:13.860460 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07
[0m04:43:13.871157 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07"
[0m04:43:13.872941 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07
[0m04:43:13.876039 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07"
[0m04:43:13.877371 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:43:13.879479 [debug] [Thread-1 (]: On test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select category_id
from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
where category_id is null



      
    ) dbt_internal_test
[0m04:43:14.982004 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:629f63a0-42a6-4afa-bae9-9b07c304ca35&page=queryresults
[0m04:43:16.210924 [info ] [Thread-1 (]: 8 of 13 PASS not_null_dim_videos_category_id ................................... [[32mPASS[0m in 2.35s]
[0m04:43:16.213803 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07
[0m04:43:16.215046 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_dim_videos_channel_id.4153a564fb
[0m04:43:16.216002 [info ] [Thread-1 (]: 9 of 13 START test not_null_dim_videos_channel_id .............................. [RUN]
[0m04:43:16.217056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07, now test.youtube_project.not_null_dim_videos_channel_id.4153a564fb)
[0m04:43:16.217987 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_dim_videos_channel_id.4153a564fb
[0m04:43:16.225944 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_dim_videos_channel_id.4153a564fb"
[0m04:43:16.227716 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_dim_videos_channel_id.4153a564fb
[0m04:43:16.231546 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_dim_videos_channel_id.4153a564fb"
[0m04:43:16.232899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:43:16.235236 [debug] [Thread-1 (]: On test.youtube_project.not_null_dim_videos_channel_id.4153a564fb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_dim_videos_channel_id.4153a564fb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select channel_id
from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
where channel_id is null



      
    ) dbt_internal_test
[0m04:43:17.133286 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:c148d092-8669-4f64-ae7d-43d48750793b&page=queryresults
[0m04:43:18.155561 [info ] [Thread-1 (]: 9 of 13 PASS not_null_dim_videos_channel_id .................................... [[32mPASS[0m in 1.94s]
[0m04:43:18.158175 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_dim_videos_channel_id.4153a564fb
[0m04:43:18.160396 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_dim_videos_description.764dd33190
[0m04:43:18.161801 [info ] [Thread-1 (]: 10 of 13 START test not_null_dim_videos_description ............................ [RUN]
[0m04:43:18.162927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_dim_videos_channel_id.4153a564fb, now test.youtube_project.not_null_dim_videos_description.764dd33190)
[0m04:43:18.163860 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_dim_videos_description.764dd33190
[0m04:43:18.172442 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_dim_videos_description.764dd33190"
[0m04:43:18.174228 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_dim_videos_description.764dd33190
[0m04:43:18.177967 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_dim_videos_description.764dd33190"
[0m04:43:18.179363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:43:18.181804 [debug] [Thread-1 (]: On test.youtube_project.not_null_dim_videos_description.764dd33190: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_dim_videos_description.764dd33190"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select description
from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
where description is null



      
    ) dbt_internal_test
[0m04:43:19.180399 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:67ac571a-7062-41b0-82ba-120418b761da&page=queryresults
[0m04:43:20.457110 [info ] [Thread-1 (]: 10 of 13 PASS not_null_dim_videos_description .................................. [[32mPASS[0m in 2.29s]
[0m04:43:20.458756 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_dim_videos_description.764dd33190
[0m04:43:20.459493 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_dim_videos_title.197d58b52d
[0m04:43:20.459980 [info ] [Thread-1 (]: 11 of 13 START test not_null_dim_videos_title .................................. [RUN]
[0m04:43:20.460932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_dim_videos_description.764dd33190, now test.youtube_project.not_null_dim_videos_title.197d58b52d)
[0m04:43:20.461950 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_dim_videos_title.197d58b52d
[0m04:43:20.472335 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_dim_videos_title.197d58b52d"
[0m04:43:20.474155 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_dim_videos_title.197d58b52d
[0m04:43:20.478403 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_dim_videos_title.197d58b52d"
[0m04:43:20.479458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:43:20.481007 [debug] [Thread-1 (]: On test.youtube_project.not_null_dim_videos_title.197d58b52d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_dim_videos_title.197d58b52d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select title
from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
where title is null



      
    ) dbt_internal_test
[0m04:43:21.446291 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:fe073461-7e63-40dc-bf1b-fb2e854c197d&page=queryresults
[0m04:43:22.524293 [info ] [Thread-1 (]: 11 of 13 PASS not_null_dim_videos_title ........................................ [[32mPASS[0m in 2.06s]
[0m04:43:22.530190 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_dim_videos_title.197d58b52d
[0m04:43:22.532410 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_dim_videos_video_id.074012a872
[0m04:43:22.533490 [info ] [Thread-1 (]: 12 of 13 START test not_null_dim_videos_video_id ............................... [RUN]
[0m04:43:22.534438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_dim_videos_title.197d58b52d, now test.youtube_project.not_null_dim_videos_video_id.074012a872)
[0m04:43:22.535106 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_dim_videos_video_id.074012a872
[0m04:43:22.574093 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_dim_videos_video_id.074012a872"
[0m04:43:22.578240 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_dim_videos_video_id.074012a872
[0m04:43:22.591215 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_dim_videos_video_id.074012a872"
[0m04:43:22.595687 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:43:22.600145 [debug] [Thread-1 (]: On test.youtube_project.not_null_dim_videos_video_id.074012a872: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_dim_videos_video_id.074012a872"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select video_id
from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
where video_id is null



      
    ) dbt_internal_test
[0m04:43:23.545152 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:32d48492-c3e7-49f9-bb8b-3d3c0779dcc4&page=queryresults
[0m04:43:24.585365 [info ] [Thread-1 (]: 12 of 13 PASS not_null_dim_videos_video_id ..................................... [[32mPASS[0m in 2.05s]
[0m04:43:24.594421 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_dim_videos_video_id.074012a872
[0m04:43:24.597002 [debug] [Thread-1 (]: Began running node test.youtube_project.unique_dim_videos_video_id.e6dc8fa384
[0m04:43:24.598811 [info ] [Thread-1 (]: 13 of 13 START test unique_dim_videos_video_id ................................. [RUN]
[0m04:43:24.600483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_dim_videos_video_id.074012a872, now test.youtube_project.unique_dim_videos_video_id.e6dc8fa384)
[0m04:43:24.601633 [debug] [Thread-1 (]: Began compiling node test.youtube_project.unique_dim_videos_video_id.e6dc8fa384
[0m04:43:24.627957 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.unique_dim_videos_video_id.e6dc8fa384"
[0m04:43:24.630213 [debug] [Thread-1 (]: Began executing node test.youtube_project.unique_dim_videos_video_id.e6dc8fa384
[0m04:43:24.633160 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.unique_dim_videos_video_id.e6dc8fa384"
[0m04:43:24.634490 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:43:24.637768 [debug] [Thread-1 (]: On test.youtube_project.unique_dim_videos_video_id.e6dc8fa384: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.unique_dim_videos_video_id.e6dc8fa384"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select video_id as unique_field
  from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
  where video_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m04:43:25.644590 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:fec473dd-88d8-4224-a345-f7152b970648&page=queryresults
[0m04:43:26.792288 [info ] [Thread-1 (]: 13 of 13 PASS unique_dim_videos_video_id ....................................... [[32mPASS[0m in 2.19s]
[0m04:43:26.799256 [debug] [Thread-1 (]: Finished running node test.youtube_project.unique_dim_videos_video_id.e6dc8fa384
[0m04:43:26.807970 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:43:26.808642 [debug] [MainThread]: Connection 'test.youtube_project.unique_dim_videos_video_id.e6dc8fa384' was properly closed.
[0m04:43:26.809200 [info ] [MainThread]: 
[0m04:43:26.809955 [info ] [MainThread]: Finished running 13 data tests in 0 hours 0 minutes and 31.38 seconds (31.38s).
[0m04:43:26.814780 [debug] [MainThread]: Command end result
[0m04:43:26.890722 [info ] [MainThread]: 
[0m04:43:26.891359 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:43:26.891847 [info ] [MainThread]: 
[0m04:43:26.892586 [error] [MainThread]: [31mFailure in test dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__5000__1 (models/youtube_data/marts/schema.yml)[0m
[0m04:43:26.893150 [error] [MainThread]:   Got 18 results, configured to fail if != 0
[0m04:43:26.893514 [info ] [MainThread]: 
[0m04:43:26.894347 [info ] [MainThread]:   compiled code at target/compiled/youtube_project/models/youtube_data/marts/schema.yml/dbt_expectations_expect_column_17105a11f4130d753a821d69620c3e82.sql
[0m04:43:26.894732 [info ] [MainThread]: 
[0m04:43:26.895265 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=1 SKIP=0 TOTAL=13
[0m04:43:26.901482 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 32.63395, "process_in_blocks": "0", "process_kernel_time": 0.275859, "process_mem_max_rss": "226964", "process_out_blocks": "8377", "process_user_time": 4.050677}
[0m04:43:26.903072 [debug] [MainThread]: Command `dbt test` failed at 04:43:26.902899 after 32.64 seconds
[0m04:43:26.904455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb500b050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93ef9490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93efa390>]}
[0m04:43:26.905176 [debug] [MainThread]: Flushing usage events
[0m04:44:30.610372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f9097f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff901101a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fc8e2a0>]}


============================== 04:44:30.611884 | d2fad11a-2da3-4ec3-8ae7-57ad1f07f547 ==============================
[0m04:44:30.611884 [info ] [MainThread]: Running with dbt=1.8.9
[0m04:44:30.612379 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'use_colors': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'static_parser': 'True', 'log_format': 'default', 'quiet': 'False', 'invocation_command': 'dbt test --models youtube_data.marts.dim_videos', 'empty': 'None', 'introspect': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'write_json': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt'}
[0m04:44:31.259943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2fad11a-2da3-4ec3-8ae7-57ad1f07f547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff739ff620>]}
[0m04:44:31.284959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2fad11a-2da3-4ec3-8ae7-57ad1f07f547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74061370>]}
[0m04:44:31.285379 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m04:44:31.352760 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m04:44:31.475239 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:44:31.476101 [debug] [MainThread]: Partial parsing: updated file: youtube_project://models/youtube_data/marts/schema.yml
[0m04:44:31.705142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2fad11a-2da3-4ec3-8ae7-57ad1f07f547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72367470>]}
[0m04:44:31.800893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2fad11a-2da3-4ec3-8ae7-57ad1f07f547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71f45bb0>]}
[0m04:44:31.801346 [info ] [MainThread]: Found 12 models, 138 data tests, 2 sources, 867 macros
[0m04:44:31.801698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2fad11a-2da3-4ec3-8ae7-57ad1f07f547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72a0c290>]}
[0m04:44:31.803831 [info ] [MainThread]: 
[0m04:44:31.804312 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m04:44:31.806932 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project_youtube'
[0m04:44:31.807210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:44:32.607196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2fad11a-2da3-4ec3-8ae7-57ad1f07f547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72791be0>]}
[0m04:44:32.609359 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:44:32.610520 [info ] [MainThread]: 
[0m04:44:32.616281 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__10000__1.ca883793a0
[0m04:44:32.617152 [info ] [Thread-1 (]: 1 of 13 START test dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__10000__1  [RUN]
[0m04:44:32.618231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__10000__1.ca883793a0)
[0m04:44:32.618933 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__10000__1.ca883793a0
[0m04:44:32.631829 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__10000__1.ca883793a0"
[0m04:44:32.634652 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__10000__1.ca883793a0
[0m04:44:32.656298 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__10000__1.ca883793a0"
[0m04:44:32.658114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:44:32.659774 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__10000__1.ca883793a0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__10000__1.ca883793a0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and length(
        description
    ) >= 1 and length(
        description
    ) <= 10000
)
 as expression


    from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







      
    ) dbt_internal_test
[0m04:44:33.932216 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:79a2af80-0815-47a7-96ac-b86fc3201aa2&page=queryresults
[0m04:44:35.182598 [error] [Thread-1 (]: 1 of 13 FAIL 18 dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__10000__1  [[31mFAIL 18[0m in 2.56s]
[0m04:44:35.185483 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__10000__1.ca883793a0
[0m04:44:35.186734 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718
[0m04:44:35.187663 [info ] [Thread-1 (]: 2 of 13 START test dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1  [RUN]
[0m04:44:35.188771 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__10000__1.ca883793a0, now test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718)
[0m04:44:35.189557 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718
[0m04:44:35.328329 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718"
[0m04:44:35.329868 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718
[0m04:44:35.331506 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718"
[0m04:44:35.332285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:44:35.333337 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and length(
        title
    ) >= 1 and length(
        title
    ) <= 255
)
 as expression


    from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







      
    ) dbt_internal_test
[0m04:44:36.280051 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:94a910c1-03c6-4a28-b20c-95478f8d18ff&page=queryresults
[0m04:44:37.312763 [info ] [Thread-1 (]: 2 of 13 PASS dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1  [[32mPASS[0m in 2.12s]
[0m04:44:37.315486 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718
[0m04:44:37.316944 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0
[0m04:44:37.317872 [info ] [Thread-1 (]: 3 of 13 START test dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64  [RUN]
[0m04:44:37.318935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0)
[0m04:44:37.319781 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0
[0m04:44:37.328018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:44:38.309676 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0"
[0m04:44:38.310984 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0
[0m04:44:38.312991 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0"
[0m04:44:38.313809 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('TITLE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('DESCRIPTION' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CATEGORY_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'CATEGORY_ID'
            and
            relation_column_type not in ('INT64')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:44:38.802926 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:73aca47a-ce21-47f2-a568-1db991227fbb&page=queryresults
[0m04:44:39.805738 [info ] [Thread-1 (]: 3 of 13 PASS dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64  [[32mPASS[0m in 2.49s]
[0m04:44:39.808676 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0
[0m04:44:39.811128 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897
[0m04:44:39.812326 [info ] [Thread-1 (]: 4 of 13 START test dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING  [RUN]
[0m04:44:39.813416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897)
[0m04:44:39.814268 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897
[0m04:44:39.822433 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:44:40.706293 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897"
[0m04:44:40.711702 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897
[0m04:44:40.727490 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897"
[0m04:44:40.732218 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('TITLE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('DESCRIPTION' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CATEGORY_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'CHANNEL_ID'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:44:41.185538 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:11b0d34e-89cd-4abb-9a27-77814e834a3f&page=queryresults
[0m04:44:42.326630 [info ] [Thread-1 (]: 4 of 13 PASS dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING  [[32mPASS[0m in 2.51s]
[0m04:44:42.331325 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897
[0m04:44:42.333309 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603
[0m04:44:42.334707 [info ] [Thread-1 (]: 5 of 13 START test dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING  [RUN]
[0m04:44:42.335723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603)
[0m04:44:42.336443 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603
[0m04:44:42.374988 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:44:43.228120 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603"
[0m04:44:43.239855 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603
[0m04:44:43.251299 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603"
[0m04:44:43.255611 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('TITLE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('DESCRIPTION' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CATEGORY_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'DESCRIPTION'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:44:43.724745 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:e11eb877-43e6-4f79-a602-845cf24daddb&page=queryresults
[0m04:44:44.753748 [info ] [Thread-1 (]: 5 of 13 PASS dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING  [[32mPASS[0m in 2.41s]
[0m04:44:44.758720 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603
[0m04:44:44.760076 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc
[0m04:44:44.761213 [info ] [Thread-1 (]: 6 of 13 START test dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING  [RUN]
[0m04:44:44.763468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc)
[0m04:44:44.764045 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc
[0m04:44:44.793777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:44:45.682926 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc"
[0m04:44:45.691679 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc
[0m04:44:45.705260 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc"
[0m04:44:45.709969 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('TITLE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('DESCRIPTION' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CATEGORY_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'TITLE'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:44:46.171684 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:f4e4b94b-e2b4-4880-ac05-4e046bfba3b6&page=queryresults
[0m04:44:47.187691 [info ] [Thread-1 (]: 6 of 13 PASS dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING  [[32mPASS[0m in 2.42s]
[0m04:44:47.194704 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc
[0m04:44:47.197555 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd
[0m04:44:47.198346 [info ] [Thread-1 (]: 7 of 13 START test dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING  [RUN]
[0m04:44:47.199334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd)
[0m04:44:47.200080 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd
[0m04:44:47.217795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:44:48.096594 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd"
[0m04:44:48.104648 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd
[0m04:44:48.125874 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd"
[0m04:44:48.128758 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('TITLE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('DESCRIPTION' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CATEGORY_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'VIDEO_ID'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:44:48.589467 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:034ffd4c-eadf-4b3d-acbc-4718d10cd1a9&page=queryresults
[0m04:44:49.638512 [info ] [Thread-1 (]: 7 of 13 PASS dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING  [[32mPASS[0m in 2.43s]
[0m04:44:49.643703 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd
[0m04:44:49.645264 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07
[0m04:44:49.646160 [info ] [Thread-1 (]: 8 of 13 START test not_null_dim_videos_category_id ............................. [RUN]
[0m04:44:49.649624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd, now test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07)
[0m04:44:49.650460 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07
[0m04:44:49.675746 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07"
[0m04:44:49.684500 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07
[0m04:44:49.689292 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07"
[0m04:44:49.693661 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:44:49.708693 [debug] [Thread-1 (]: On test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select category_id
from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
where category_id is null



      
    ) dbt_internal_test
[0m04:44:50.852487 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:ac9ebb3f-00aa-403e-a100-121c1f255cdd&page=queryresults
[0m04:44:51.995971 [info ] [Thread-1 (]: 8 of 13 PASS not_null_dim_videos_category_id ................................... [[32mPASS[0m in 2.35s]
[0m04:44:51.999461 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07
[0m04:44:52.003435 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_dim_videos_channel_id.4153a564fb
[0m04:44:52.006655 [info ] [Thread-1 (]: 9 of 13 START test not_null_dim_videos_channel_id .............................. [RUN]
[0m04:44:52.009053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07, now test.youtube_project.not_null_dim_videos_channel_id.4153a564fb)
[0m04:44:52.010131 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_dim_videos_channel_id.4153a564fb
[0m04:44:52.030626 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_dim_videos_channel_id.4153a564fb"
[0m04:44:52.033775 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_dim_videos_channel_id.4153a564fb
[0m04:44:52.048533 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_dim_videos_channel_id.4153a564fb"
[0m04:44:52.056527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:44:52.074023 [debug] [Thread-1 (]: On test.youtube_project.not_null_dim_videos_channel_id.4153a564fb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_dim_videos_channel_id.4153a564fb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select channel_id
from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
where channel_id is null



      
    ) dbt_internal_test
[0m04:44:53.119104 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:2e1a40bf-245c-4995-b189-a20c9f814fcb&page=queryresults
[0m04:44:54.290860 [info ] [Thread-1 (]: 9 of 13 PASS not_null_dim_videos_channel_id .................................... [[32mPASS[0m in 2.28s]
[0m04:44:54.299637 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_dim_videos_channel_id.4153a564fb
[0m04:44:54.301299 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_dim_videos_description.764dd33190
[0m04:44:54.302403 [info ] [Thread-1 (]: 10 of 13 START test not_null_dim_videos_description ............................ [RUN]
[0m04:44:54.305139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_dim_videos_channel_id.4153a564fb, now test.youtube_project.not_null_dim_videos_description.764dd33190)
[0m04:44:54.306479 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_dim_videos_description.764dd33190
[0m04:44:54.341599 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_dim_videos_description.764dd33190"
[0m04:44:54.348718 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_dim_videos_description.764dd33190
[0m04:44:54.355290 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_dim_videos_description.764dd33190"
[0m04:44:54.358113 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:44:54.365459 [debug] [Thread-1 (]: On test.youtube_project.not_null_dim_videos_description.764dd33190: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_dim_videos_description.764dd33190"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select description
from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
where description is null



      
    ) dbt_internal_test
[0m04:44:55.364692 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:dee5fb4d-5590-4110-a17b-acf1cc6b06ea&page=queryresults
[0m04:44:56.399073 [info ] [Thread-1 (]: 10 of 13 PASS not_null_dim_videos_description .................................. [[32mPASS[0m in 2.09s]
[0m04:44:56.401951 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_dim_videos_description.764dd33190
[0m04:44:56.403727 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_dim_videos_title.197d58b52d
[0m04:44:56.405512 [info ] [Thread-1 (]: 11 of 13 START test not_null_dim_videos_title .................................. [RUN]
[0m04:44:56.407305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_dim_videos_description.764dd33190, now test.youtube_project.not_null_dim_videos_title.197d58b52d)
[0m04:44:56.408049 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_dim_videos_title.197d58b52d
[0m04:44:56.435815 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_dim_videos_title.197d58b52d"
[0m04:44:56.437615 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_dim_videos_title.197d58b52d
[0m04:44:56.440743 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_dim_videos_title.197d58b52d"
[0m04:44:56.442367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:44:56.447685 [debug] [Thread-1 (]: On test.youtube_project.not_null_dim_videos_title.197d58b52d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_dim_videos_title.197d58b52d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select title
from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
where title is null



      
    ) dbt_internal_test
[0m04:44:57.329165 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:f13cf047-960c-460e-837b-3f85eb2b704e&page=queryresults
[0m04:44:58.324897 [info ] [Thread-1 (]: 11 of 13 PASS not_null_dim_videos_title ........................................ [[32mPASS[0m in 1.92s]
[0m04:44:58.328529 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_dim_videos_title.197d58b52d
[0m04:44:58.330560 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_dim_videos_video_id.074012a872
[0m04:44:58.332214 [info ] [Thread-1 (]: 12 of 13 START test not_null_dim_videos_video_id ............................... [RUN]
[0m04:44:58.333723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_dim_videos_title.197d58b52d, now test.youtube_project.not_null_dim_videos_video_id.074012a872)
[0m04:44:58.334724 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_dim_videos_video_id.074012a872
[0m04:44:58.366903 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_dim_videos_video_id.074012a872"
[0m04:44:58.371291 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_dim_videos_video_id.074012a872
[0m04:44:58.383349 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_dim_videos_video_id.074012a872"
[0m04:44:58.385327 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:44:58.391313 [debug] [Thread-1 (]: On test.youtube_project.not_null_dim_videos_video_id.074012a872: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_dim_videos_video_id.074012a872"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select video_id
from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
where video_id is null



      
    ) dbt_internal_test
[0m04:44:59.348783 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:9357a71e-b39c-4e4b-a0e8-f3207d8875ac&page=queryresults
[0m04:45:00.373518 [info ] [Thread-1 (]: 12 of 13 PASS not_null_dim_videos_video_id ..................................... [[32mPASS[0m in 2.04s]
[0m04:45:00.375031 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_dim_videos_video_id.074012a872
[0m04:45:00.375863 [debug] [Thread-1 (]: Began running node test.youtube_project.unique_dim_videos_video_id.e6dc8fa384
[0m04:45:00.376435 [info ] [Thread-1 (]: 13 of 13 START test unique_dim_videos_video_id ................................. [RUN]
[0m04:45:00.377025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_dim_videos_video_id.074012a872, now test.youtube_project.unique_dim_videos_video_id.e6dc8fa384)
[0m04:45:00.377416 [debug] [Thread-1 (]: Began compiling node test.youtube_project.unique_dim_videos_video_id.e6dc8fa384
[0m04:45:00.386290 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.unique_dim_videos_video_id.e6dc8fa384"
[0m04:45:00.387976 [debug] [Thread-1 (]: Began executing node test.youtube_project.unique_dim_videos_video_id.e6dc8fa384
[0m04:45:00.390019 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.unique_dim_videos_video_id.e6dc8fa384"
[0m04:45:00.391569 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:45:00.394111 [debug] [Thread-1 (]: On test.youtube_project.unique_dim_videos_video_id.e6dc8fa384: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.unique_dim_videos_video_id.e6dc8fa384"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select video_id as unique_field
  from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
  where video_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m04:45:01.625353 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:650fabac-2a75-43af-b280-cba630d51f27&page=queryresults
[0m04:45:02.622936 [info ] [Thread-1 (]: 13 of 13 PASS unique_dim_videos_video_id ....................................... [[32mPASS[0m in 2.24s]
[0m04:45:02.627443 [debug] [Thread-1 (]: Finished running node test.youtube_project.unique_dim_videos_video_id.e6dc8fa384
[0m04:45:02.642134 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:45:02.643187 [debug] [MainThread]: Connection 'test.youtube_project.unique_dim_videos_video_id.e6dc8fa384' was properly closed.
[0m04:45:02.645377 [info ] [MainThread]: 
[0m04:45:02.647065 [info ] [MainThread]: Finished running 13 data tests in 0 hours 0 minutes and 30.84 seconds (30.84s).
[0m04:45:02.656935 [debug] [MainThread]: Command end result
[0m04:45:02.796067 [info ] [MainThread]: 
[0m04:45:02.797604 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:45:02.798007 [info ] [MainThread]: 
[0m04:45:02.798805 [error] [MainThread]: [31mFailure in test dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__10000__1 (models/youtube_data/marts/schema.yml)[0m
[0m04:45:02.800415 [error] [MainThread]:   Got 18 results, configured to fail if != 0
[0m04:45:02.802355 [info ] [MainThread]: 
[0m04:45:02.804594 [info ] [MainThread]:   compiled code at target/compiled/youtube_project/models/youtube_data/marts/schema.yml/dbt_expectations_expect_column_c372b6f07908fee71b8ed611b432f1cf.sql
[0m04:45:02.805015 [info ] [MainThread]: 
[0m04:45:02.805431 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=1 SKIP=0 TOTAL=13
[0m04:45:02.810681 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 32.22684, "process_in_blocks": "0", "process_kernel_time": 0.441255, "process_mem_max_rss": "226960", "process_out_blocks": "8377", "process_user_time": 4.821273}
[0m04:45:02.814788 [debug] [MainThread]: Command `dbt test` failed at 04:45:02.813070 after 32.23 seconds
[0m04:45:02.819897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f8bddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72c8caa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71702120>]}
[0m04:45:02.822200 [debug] [MainThread]: Flushing usage events
[0m04:45:31.260133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae7c5520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadaa51f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadda7b60>]}


============================== 04:45:31.261491 | 3bffc8e9-4bbd-4c74-9a6b-27cc5f55debd ==============================
[0m04:45:31.261491 [info ] [MainThread]: Running with dbt=1.8.9
[0m04:45:31.262101 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'invocation_command': 'dbt test --models youtube_data.marts.dim_videos', 'log_format': 'default', 'use_experimental_parser': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'log_cache_events': 'False', 'debug': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'no_print': 'None', 'empty': 'None', 'target_path': 'None', 'use_colors': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'version_check': 'True', 'introspect': 'True'}
[0m04:45:31.894024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3bffc8e9-4bbd-4c74-9a6b-27cc5f55debd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae43af90>]}
[0m04:45:31.918875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3bffc8e9-4bbd-4c74-9a6b-27cc5f55debd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae9f8da0>]}
[0m04:45:31.919270 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m04:45:31.992049 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m04:45:32.139768 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:45:32.140717 [debug] [MainThread]: Partial parsing: updated file: youtube_project://models/youtube_data/marts/schema.yml
[0m04:45:32.358103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3bffc8e9-4bbd-4c74-9a6b-27cc5f55debd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff907046e0>]}
[0m04:45:32.447953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3bffc8e9-4bbd-4c74-9a6b-27cc5f55debd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90335c40>]}
[0m04:45:32.448335 [info ] [MainThread]: Found 12 models, 138 data tests, 2 sources, 867 macros
[0m04:45:32.448618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bffc8e9-4bbd-4c74-9a6b-27cc5f55debd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90706db0>]}
[0m04:45:32.450702 [info ] [MainThread]: 
[0m04:45:32.451176 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m04:45:32.453728 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project_youtube'
[0m04:45:32.453998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:45:33.323405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bffc8e9-4bbd-4c74-9a6b-27cc5f55debd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff907052b0>]}
[0m04:45:33.324197 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:45:33.324674 [info ] [MainThread]: 
[0m04:45:33.327278 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__0.e561186281
[0m04:45:33.327708 [info ] [Thread-1 (]: 1 of 13 START test dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__0  [RUN]
[0m04:45:33.328221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__0.e561186281)
[0m04:45:33.328647 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__0.e561186281
[0m04:45:33.335903 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__0.e561186281"
[0m04:45:33.337808 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__0.e561186281
[0m04:45:33.352921 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__0.e561186281"
[0m04:45:33.354425 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:45:33.355717 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__0.e561186281: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__0.e561186281"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and length(
        description
    ) >= 0
)
 as expression


    from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







      
    ) dbt_internal_test
[0m04:45:34.555755 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:559d00fc-4aa9-432d-8f08-cf7b82fc3245&page=queryresults
[0m04:45:35.793408 [info ] [Thread-1 (]: 1 of 13 PASS dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__0  [[32mPASS[0m in 2.46s]
[0m04:45:35.794927 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__0.e561186281
[0m04:45:35.796599 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718
[0m04:45:35.798111 [info ] [Thread-1 (]: 2 of 13 START test dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1  [RUN]
[0m04:45:35.799066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_description__0.e561186281, now test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718)
[0m04:45:35.799587 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718
[0m04:45:35.929170 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718"
[0m04:45:35.931403 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718
[0m04:45:35.933050 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718"
[0m04:45:35.933777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:45:35.934829 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and length(
        title
    ) >= 1 and length(
        title
    ) <= 255
)
 as expression


    from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







      
    ) dbt_internal_test
[0m04:45:37.011832 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:20667f05-a751-4b18-8d11-88b060483231&page=queryresults
[0m04:45:38.133088 [info ] [Thread-1 (]: 2 of 13 PASS dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1  [[32mPASS[0m in 2.33s]
[0m04:45:38.134733 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718
[0m04:45:38.135673 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0
[0m04:45:38.136515 [info ] [Thread-1 (]: 3 of 13 START test dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64  [RUN]
[0m04:45:38.137491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_dim_videos_title__255__1.33b390f718, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0)
[0m04:45:38.138166 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0
[0m04:45:38.144552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:45:38.980445 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0"
[0m04:45:38.983679 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0
[0m04:45:38.987981 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0"
[0m04:45:38.989763 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('TITLE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('DESCRIPTION' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CATEGORY_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'CATEGORY_ID'
            and
            relation_column_type not in ('INT64')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:45:39.466527 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:e094b77e-bb92-4a51-8685-4017aa84d706&page=queryresults
[0m04:45:40.697992 [info ] [Thread-1 (]: 3 of 13 PASS dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64  [[32mPASS[0m in 2.56s]
[0m04:45:40.701671 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0
[0m04:45:40.703430 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897
[0m04:45:40.704526 [info ] [Thread-1 (]: 4 of 13 START test dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING  [RUN]
[0m04:45:40.705790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_category_id__INT64.29006f24d0, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897)
[0m04:45:40.706673 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897
[0m04:45:40.715368 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:45:41.521284 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897"
[0m04:45:41.522794 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897
[0m04:45:41.526084 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897"
[0m04:45:41.527251 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('TITLE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('DESCRIPTION' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CATEGORY_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'CHANNEL_ID'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:45:42.032836 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:52418ac2-d5c5-4e15-8862-e570e0003cb4&page=queryresults
[0m04:45:43.090854 [info ] [Thread-1 (]: 4 of 13 PASS dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING  [[32mPASS[0m in 2.38s]
[0m04:45:43.093994 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897
[0m04:45:43.094996 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603
[0m04:45:43.095885 [info ] [Thread-1 (]: 5 of 13 START test dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING  [RUN]
[0m04:45:43.096674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_channel_id__STRING.a6b1dd2897, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603)
[0m04:45:43.097248 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603
[0m04:45:43.114361 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:45:44.095376 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603"
[0m04:45:44.099849 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603
[0m04:45:44.107125 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603"
[0m04:45:44.109815 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('TITLE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('DESCRIPTION' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CATEGORY_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'DESCRIPTION'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:45:44.634539 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:db5163db-e087-45ef-8e0d-85d44172c934&page=queryresults
[0m04:45:45.634683 [info ] [Thread-1 (]: 5 of 13 PASS dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING  [[32mPASS[0m in 2.54s]
[0m04:45:45.640036 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603
[0m04:45:45.642245 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc
[0m04:45:45.644050 [info ] [Thread-1 (]: 6 of 13 START test dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING  [RUN]
[0m04:45:45.645734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_description__STRING.556898f603, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc)
[0m04:45:45.646714 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc
[0m04:45:45.675044 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:45:46.542128 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc"
[0m04:45:46.549402 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc
[0m04:45:46.553586 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc"
[0m04:45:46.555071 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('TITLE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('DESCRIPTION' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CATEGORY_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'TITLE'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:45:47.045079 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:37aaf8a7-596b-4c2e-a05b-4c5aa3bc5fc6&page=queryresults
[0m04:45:48.282967 [info ] [Thread-1 (]: 6 of 13 PASS dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING  [[32mPASS[0m in 2.64s]
[0m04:45:48.287017 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc
[0m04:45:48.290324 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd
[0m04:45:48.291990 [info ] [Thread-1 (]: 7 of 13 START test dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING  [RUN]
[0m04:45:48.293998 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_title__STRING.b1effa2bfc, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd)
[0m04:45:48.295113 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd
[0m04:45:48.324191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:45:49.206158 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd"
[0m04:45:49.212069 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd
[0m04:45:49.225849 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd"
[0m04:45:49.229371 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('TITLE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('DESCRIPTION' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CHANNEL_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CATEGORY_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'VIDEO_ID'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:45:49.707131 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:7eb10b93-d561-45ac-a102-b423af240e81&page=queryresults
[0m04:45:50.946192 [info ] [Thread-1 (]: 7 of 13 PASS dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING  [[32mPASS[0m in 2.65s]
[0m04:45:50.950726 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd
[0m04:45:50.952370 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07
[0m04:45:50.953793 [info ] [Thread-1 (]: 8 of 13 START test not_null_dim_videos_category_id ............................. [RUN]
[0m04:45:50.954954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_dim_videos_video_id__STRING.7bbac767fd, now test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07)
[0m04:45:50.955810 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07
[0m04:45:50.981419 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07"
[0m04:45:50.982922 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07
[0m04:45:50.984995 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07"
[0m04:45:50.986454 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:45:50.990309 [debug] [Thread-1 (]: On test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select category_id
from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
where category_id is null



      
    ) dbt_internal_test
[0m04:45:52.064471 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:22f96482-7ba6-46e4-8533-340bdd666076&page=queryresults
[0m04:45:53.291551 [info ] [Thread-1 (]: 8 of 13 PASS not_null_dim_videos_category_id ................................... [[32mPASS[0m in 2.34s]
[0m04:45:53.294288 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07
[0m04:45:53.296558 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_dim_videos_channel_id.4153a564fb
[0m04:45:53.298057 [info ] [Thread-1 (]: 9 of 13 START test not_null_dim_videos_channel_id .............................. [RUN]
[0m04:45:53.299473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_dim_videos_category_id.61a1ad0a07, now test.youtube_project.not_null_dim_videos_channel_id.4153a564fb)
[0m04:45:53.300988 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_dim_videos_channel_id.4153a564fb
[0m04:45:53.315386 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_dim_videos_channel_id.4153a564fb"
[0m04:45:53.318874 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_dim_videos_channel_id.4153a564fb
[0m04:45:53.324496 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_dim_videos_channel_id.4153a564fb"
[0m04:45:53.326754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:45:53.330106 [debug] [Thread-1 (]: On test.youtube_project.not_null_dim_videos_channel_id.4153a564fb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_dim_videos_channel_id.4153a564fb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select channel_id
from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
where channel_id is null



      
    ) dbt_internal_test
[0m04:45:54.418774 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:2bc35727-737d-4bb9-bb10-d5d7d757db44&page=queryresults
[0m04:45:55.442586 [info ] [Thread-1 (]: 9 of 13 PASS not_null_dim_videos_channel_id .................................... [[32mPASS[0m in 2.14s]
[0m04:45:55.445415 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_dim_videos_channel_id.4153a564fb
[0m04:45:55.447601 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_dim_videos_description.764dd33190
[0m04:45:55.449011 [info ] [Thread-1 (]: 10 of 13 START test not_null_dim_videos_description ............................ [RUN]
[0m04:45:55.450094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_dim_videos_channel_id.4153a564fb, now test.youtube_project.not_null_dim_videos_description.764dd33190)
[0m04:45:55.451057 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_dim_videos_description.764dd33190
[0m04:45:55.460691 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_dim_videos_description.764dd33190"
[0m04:45:55.463567 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_dim_videos_description.764dd33190
[0m04:45:55.467791 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_dim_videos_description.764dd33190"
[0m04:45:55.469483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:45:55.471819 [debug] [Thread-1 (]: On test.youtube_project.not_null_dim_videos_description.764dd33190: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_dim_videos_description.764dd33190"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select description
from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
where description is null



      
    ) dbt_internal_test
[0m04:45:56.470752 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:1933f407-dfd3-4238-a35f-cfb50312ba9c&page=queryresults
[0m04:45:57.596991 [info ] [Thread-1 (]: 10 of 13 PASS not_null_dim_videos_description .................................. [[32mPASS[0m in 2.15s]
[0m04:45:57.600179 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_dim_videos_description.764dd33190
[0m04:45:57.602062 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_dim_videos_title.197d58b52d
[0m04:45:57.603526 [info ] [Thread-1 (]: 11 of 13 START test not_null_dim_videos_title .................................. [RUN]
[0m04:45:57.604950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_dim_videos_description.764dd33190, now test.youtube_project.not_null_dim_videos_title.197d58b52d)
[0m04:45:57.605947 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_dim_videos_title.197d58b52d
[0m04:45:57.623732 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_dim_videos_title.197d58b52d"
[0m04:45:57.625792 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_dim_videos_title.197d58b52d
[0m04:45:57.629517 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_dim_videos_title.197d58b52d"
[0m04:45:57.631070 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:45:57.633582 [debug] [Thread-1 (]: On test.youtube_project.not_null_dim_videos_title.197d58b52d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_dim_videos_title.197d58b52d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select title
from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
where title is null



      
    ) dbt_internal_test
[0m04:45:58.720790 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:d6d23324-5bd8-457c-93f6-d9c7f8472f2d&page=queryresults
[0m04:45:59.944012 [info ] [Thread-1 (]: 11 of 13 PASS not_null_dim_videos_title ........................................ [[32mPASS[0m in 2.34s]
[0m04:45:59.945524 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_dim_videos_title.197d58b52d
[0m04:45:59.946555 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_dim_videos_video_id.074012a872
[0m04:45:59.947359 [info ] [Thread-1 (]: 12 of 13 START test not_null_dim_videos_video_id ............................... [RUN]
[0m04:45:59.948376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_dim_videos_title.197d58b52d, now test.youtube_project.not_null_dim_videos_video_id.074012a872)
[0m04:45:59.949045 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_dim_videos_video_id.074012a872
[0m04:45:59.957018 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_dim_videos_video_id.074012a872"
[0m04:45:59.959226 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_dim_videos_video_id.074012a872
[0m04:45:59.963319 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_dim_videos_video_id.074012a872"
[0m04:45:59.965025 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:45:59.968683 [debug] [Thread-1 (]: On test.youtube_project.not_null_dim_videos_video_id.074012a872: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_dim_videos_video_id.074012a872"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select video_id
from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
where video_id is null



      
    ) dbt_internal_test
[0m04:46:00.970381 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:4c64a416-8373-4dae-a090-a21d34d34848&page=queryresults
[0m04:46:02.201945 [info ] [Thread-1 (]: 12 of 13 PASS not_null_dim_videos_video_id ..................................... [[32mPASS[0m in 2.25s]
[0m04:46:02.204946 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_dim_videos_video_id.074012a872
[0m04:46:02.206590 [debug] [Thread-1 (]: Began running node test.youtube_project.unique_dim_videos_video_id.e6dc8fa384
[0m04:46:02.207620 [info ] [Thread-1 (]: 13 of 13 START test unique_dim_videos_video_id ................................. [RUN]
[0m04:46:02.208778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_dim_videos_video_id.074012a872, now test.youtube_project.unique_dim_videos_video_id.e6dc8fa384)
[0m04:46:02.209687 [debug] [Thread-1 (]: Began compiling node test.youtube_project.unique_dim_videos_video_id.e6dc8fa384
[0m04:46:02.226621 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.unique_dim_videos_video_id.e6dc8fa384"
[0m04:46:02.228919 [debug] [Thread-1 (]: Began executing node test.youtube_project.unique_dim_videos_video_id.e6dc8fa384
[0m04:46:02.233074 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.unique_dim_videos_video_id.e6dc8fa384"
[0m04:46:02.234507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:46:02.236761 [debug] [Thread-1 (]: On test.youtube_project.unique_dim_videos_video_id.e6dc8fa384: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.unique_dim_videos_video_id.e6dc8fa384"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select video_id as unique_field
  from `yt-e2e-data-cycle-project`.`youtube`.`dim_videos`
  where video_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m04:46:03.343174 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:43052800-42c8-4814-9e80-75c8bbb36f71&page=queryresults
[0m04:46:04.461041 [info ] [Thread-1 (]: 13 of 13 PASS unique_dim_videos_video_id ....................................... [[32mPASS[0m in 2.25s]
[0m04:46:04.464820 [debug] [Thread-1 (]: Finished running node test.youtube_project.unique_dim_videos_video_id.e6dc8fa384
[0m04:46:04.479927 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:46:04.480611 [debug] [MainThread]: Connection 'test.youtube_project.unique_dim_videos_video_id.e6dc8fa384' was properly closed.
[0m04:46:04.481926 [info ] [MainThread]: 
[0m04:46:04.483418 [info ] [MainThread]: Finished running 13 data tests in 0 hours 0 minutes and 32.03 seconds (32.03s).
[0m04:46:04.488429 [debug] [MainThread]: Command end result
[0m04:46:04.578395 [info ] [MainThread]: 
[0m04:46:04.579062 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:46:04.579427 [info ] [MainThread]: 
[0m04:46:04.579949 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m04:46:04.582654 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 33.34896, "process_in_blocks": "0", "process_kernel_time": 0.36177, "process_mem_max_rss": "226860", "process_out_blocks": "8375", "process_user_time": 4.232011}
[0m04:46:04.583529 [debug] [MainThread]: Command `dbt test` succeeded at 04:46:04.583275 after 33.35 seconds
[0m04:46:04.584202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae7c5520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadda7d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadda7320>]}
[0m04:46:04.585084 [debug] [MainThread]: Flushing usage events
[0m04:47:05.524502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0936540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0bcf740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa150a9f0>]}


============================== 04:47:05.526110 | 3725736b-e1f9-4a9f-a7fd-e73e1a207577 ==============================
[0m04:47:05.526110 [info ] [MainThread]: Running with dbt=1.8.9
[0m04:47:05.526763 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'version_check': 'True', 'log_format': 'default', 'quiet': 'False', 'warn_error': 'None', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt run --models youtube_data.marts.fact_video_comments', 'write_json': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'log_path': '/usr/local/airflow/include/dbt/logs', 'use_colors': 'True', 'no_print': 'None', 'debug': 'False', 'cache_selected_only': 'False'}
[0m04:47:06.218977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3725736b-e1f9-4a9f-a7fd-e73e1a207577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa44c7080>]}
[0m04:47:06.248166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3725736b-e1f9-4a9f-a7fd-e73e1a207577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff859a6a20>]}
[0m04:47:06.248956 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m04:47:06.346530 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m04:47:06.502940 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:47:06.503845 [debug] [MainThread]: Partial parsing: updated file: youtube_project://models/youtube_data/marts/fact_video_comments.sql
[0m04:47:06.742941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3725736b-e1f9-4a9f-a7fd-e73e1a207577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff833e77a0>]}
[0m04:47:06.831946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3725736b-e1f9-4a9f-a7fd-e73e1a207577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83163260>]}
[0m04:47:06.832389 [info ] [MainThread]: Found 12 models, 138 data tests, 2 sources, 867 macros
[0m04:47:06.832793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3725736b-e1f9-4a9f-a7fd-e73e1a207577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82d31280>]}
[0m04:47:06.834911 [info ] [MainThread]: 
[0m04:47:06.835477 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m04:47:06.836250 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project'
[0m04:47:06.836533 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:47:07.739632 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project, now list_yt-e2e-data-cycle-project_youtube)
[0m04:47:07.740570 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:47:08.554950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3725736b-e1f9-4a9f-a7fd-e73e1a207577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82d9d4c0>]}
[0m04:47:08.556866 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:47:08.557481 [info ] [MainThread]: 
[0m04:47:08.560894 [debug] [Thread-1 (]: Began running node model.youtube_project.fact_video_comments
[0m04:47:08.561739 [info ] [Thread-1 (]: 1 of 1 START sql incremental model youtube.fact_video_comments ................. [RUN]
[0m04:47:08.562400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now model.youtube_project.fact_video_comments)
[0m04:47:08.562930 [debug] [Thread-1 (]: Began compiling node model.youtube_project.fact_video_comments
[0m04:47:08.571623 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_project.fact_video_comments"
[0m04:47:08.573927 [debug] [Thread-1 (]: Began executing node model.youtube_project.fact_video_comments
[0m04:47:08.626140 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_project.fact_video_comments"
[0m04:47:08.628138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:47:08.629848 [debug] [Thread-1 (]: On model.youtube_project.fact_video_comments: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "model.youtube_project.fact_video_comments"} */

  
    

    create or replace table `yt-e2e-data-cycle-project`.`youtube`.`fact_video_comments`
      
    partition by timestamp_trunc(published_at, day)
    

    OPTIONS()
    as (
      WITH comment_data AS (
    SELECT 
        *
    FROM `yt-e2e-data-cycle-project`.`youtube`.`staging_video_comments`  -- Reference to the staging model for raw YouTube comment data
),

comment_filled AS (
    SELECT
        c.comment_id,
        c.video_id,
        c.comment_author,
        
       -- Clean invalid characters from comment_text
        COALESCE(
            REGEXP_REPLACE(c.comment_text, r'[\x00-\x1F\x7F-\x9F\xAD�]', ''), 
            'No Comment Text Available'
        ) AS comment_text,
        
        -- Safely cast like_count to integer
        SAFE_CAST(c.like_count AS INT64) AS like_count,
        
        -- If published_at is missing, set it to the current timestamp
        COALESCE(c.published_at, CURRENT_TIMESTAMP()) AS published_at,

        -- Join the video_id with dim_video to get the corresponding video
        v.video_id AS dim_video_id
    FROM
        comment_data c
    LEFT JOIN `yt-e2e-data-cycle-project`.`youtube`.`dim_videos` v  -- Reference to the dim_video table to get the corresponding video
)

SELECT 
    -- Unique identifier for each fact record (can use row_number or create a custom ID)
    ROW_NUMBER() OVER (PARTITION BY cf.comment_id ORDER BY cf.published_at) AS fact_comment_id,
    cf.comment_id,
    cf.video_id, 
    cf.comment_author,
    cf.comment_text,
    cf.like_count,
    cf.published_at
FROM 
    comment_filled cf
    );
  
[0m04:47:09.680276 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:b0487703-9550-455e-8922-dded75ed92a6&page=queryresults
[0m04:47:10.087971 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('LEFT JOIN must have an immediately following ON or USING clause at [41:5]; reason: invalidQuery, location: query, message: LEFT JOIN must have an immediately following ON or USING clause at [41:5]')
[0m04:47:11.625703 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:31bab4be-2ff5-4ed0-90f0-aee86d6d483d&page=queryresults
[0m04:47:12.036298 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:31bab4be-2ff5-4ed0-90f0-aee86d6d483d&page=queryresults
[0m04:47:12.049749 [debug] [Thread-1 (]: Database Error in model fact_video_comments (models/youtube_data/marts/fact_video_comments.sql)
  LEFT JOIN must have an immediately following ON or USING clause at [41:5]
  compiled code at target/run/youtube_project/models/youtube_data/marts/fact_video_comments.sql
[0m04:47:12.052732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3725736b-e1f9-4a9f-a7fd-e73e1a207577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff833ae660>]}
[0m04:47:12.054094 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model youtube.fact_video_comments ........ [[31mERROR[0m in 3.49s]
[0m04:47:12.055840 [debug] [Thread-1 (]: Finished running node model.youtube_project.fact_video_comments
[0m04:47:12.060601 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:47:12.061502 [debug] [MainThread]: Connection 'model.youtube_project.fact_video_comments' was properly closed.
[0m04:47:12.062608 [info ] [MainThread]: 
[0m04:47:12.063598 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.23 seconds (5.23s).
[0m04:47:12.065019 [debug] [MainThread]: Command end result
[0m04:47:12.212630 [info ] [MainThread]: 
[0m04:47:12.212995 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:47:12.213392 [info ] [MainThread]: 
[0m04:47:12.213724 [error] [MainThread]:   Database Error in model fact_video_comments (models/youtube_data/marts/fact_video_comments.sql)
  LEFT JOIN must have an immediately following ON or USING clause at [41:5]
  compiled code at target/run/youtube_project/models/youtube_data/marts/fact_video_comments.sql
[0m04:47:12.213953 [info ] [MainThread]: 
[0m04:47:12.214260 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m04:47:12.215101 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.7146406, "process_in_blocks": "0", "process_kernel_time": 0.275995, "process_mem_max_rss": "226664", "process_out_blocks": "8228", "process_user_time": 2.759957}
[0m04:47:12.215469 [debug] [MainThread]: Command `dbt run` failed at 04:47:12.215398 after 6.72 seconds
[0m04:47:12.215748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0a0d640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0936540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff825badb0>]}
[0m04:47:12.216016 [debug] [MainThread]: Flushing usage events
[0m04:49:04.675758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f7010d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e811040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f703c20>]}


============================== 04:49:04.677128 | a2f380c4-10c8-4020-9574-ef3b948c0196 ==============================
[0m04:49:04.677128 [info ] [MainThread]: Running with dbt=1.8.9
[0m04:49:04.677642 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'write_json': 'True', 'version_check': 'True', 'debug': 'False', 'invocation_command': 'dbt run --models youtube_data.marts.fact_video_comments', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'log_path': '/usr/local/airflow/include/dbt/logs', 'printer_width': '80', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'target_path': 'None', 'partial_parse': 'True', 'warn_error': 'None'}
[0m04:49:05.327399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2f380c4-10c8-4020-9574-ef3b948c0196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ec2bc80>]}
[0m04:49:05.352248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2f380c4-10c8-4020-9574-ef3b948c0196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fa0a720>]}
[0m04:49:05.352644 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m04:49:05.418980 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m04:49:05.543551 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:49:05.544307 [debug] [MainThread]: Partial parsing: updated file: youtube_project://models/youtube_data/marts/fact_video_comments.sql
[0m04:49:05.773527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2f380c4-10c8-4020-9574-ef3b948c0196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80f00da0>]}
[0m04:49:05.885855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2f380c4-10c8-4020-9574-ef3b948c0196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff814ba8a0>]}
[0m04:49:05.886270 [info ] [MainThread]: Found 12 models, 138 data tests, 2 sources, 867 macros
[0m04:49:05.886645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2f380c4-10c8-4020-9574-ef3b948c0196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81345100>]}
[0m04:49:05.888598 [info ] [MainThread]: 
[0m04:49:05.889066 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m04:49:05.889782 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project'
[0m04:49:05.890064 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:49:06.736073 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project, now list_yt-e2e-data-cycle-project_youtube)
[0m04:49:06.737887 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:49:07.550100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2f380c4-10c8-4020-9574-ef3b948c0196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81811f40>]}
[0m04:49:07.552096 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:49:07.553247 [info ] [MainThread]: 
[0m04:49:07.560223 [debug] [Thread-1 (]: Began running node model.youtube_project.fact_video_comments
[0m04:49:07.561433 [info ] [Thread-1 (]: 1 of 1 START sql incremental model youtube.fact_video_comments ................. [RUN]
[0m04:49:07.562454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now model.youtube_project.fact_video_comments)
[0m04:49:07.563173 [debug] [Thread-1 (]: Began compiling node model.youtube_project.fact_video_comments
[0m04:49:07.579789 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_project.fact_video_comments"
[0m04:49:07.583302 [debug] [Thread-1 (]: Began executing node model.youtube_project.fact_video_comments
[0m04:49:07.645135 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_project.fact_video_comments"
[0m04:49:07.647112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:49:07.648648 [debug] [Thread-1 (]: On model.youtube_project.fact_video_comments: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "model.youtube_project.fact_video_comments"} */

  
    

    create or replace table `yt-e2e-data-cycle-project`.`youtube`.`fact_video_comments`
      
    partition by timestamp_trunc(published_at, day)
    

    OPTIONS()
    as (
      WITH comment_data AS (
    SELECT 
        *
    FROM `yt-e2e-data-cycle-project`.`youtube`.`staging_video_comments`  -- Reference to the staging model for raw YouTube comment data
),

comment_filled AS (
    SELECT
        c.comment_id,
        c.video_id,
        c.comment_author,
        
       -- Clean invalid characters from comment_text
        COALESCE(
            REGEXP_REPLACE(c.comment_text, r'[\x00-\x1F\x7F-\x9F\xAD�]', ''), 
            'No Comment Text Available'
        ) AS comment_text,
        
        -- Safely cast like_count to integer
        SAFE_CAST(c.like_count AS INT64) AS like_count,
        
        -- If published_at is missing, set it to the current timestamp
        COALESCE(c.published_at, CURRENT_TIMESTAMP()) AS published_at,

        -- Join the video_id with dim_video to get the corresponding video
        v.video_id AS dim_video_id
    FROM
        comment_data c
    LEFT JOIN 
        `yt-e2e-data-cycle-project`.`youtube`.`dim_videos` v  -- Reference to the dim_video table to get the corresponding video
    ON
        c.video_id = v.video_id
)

SELECT 
    -- Unique identifier for each fact record (can use row_number or create a custom ID)
    ROW_NUMBER() OVER (PARTITION BY cf.comment_id ORDER BY cf.published_at) AS fact_comment_id,
    cf.comment_id,
    cf.video_id, 
    cf.comment_author,
    cf.comment_text,
    cf.like_count,
    cf.published_at
FROM 
    comment_filled cf
    );
  
[0m04:49:08.773447 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:2046860d-cc64-4519-aa24-81a5689d081b&page=queryresults
[0m04:49:12.487731 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2f380c4-10c8-4020-9574-ef3b948c0196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82720320>]}
[0m04:49:12.489133 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model youtube.fact_video_comments ............ [[32mCREATE TABLE (4.7k rows, 696.1 KiB processed)[0m in 4.92s]
[0m04:49:12.490405 [debug] [Thread-1 (]: Finished running node model.youtube_project.fact_video_comments
[0m04:49:12.493150 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:49:12.493618 [debug] [MainThread]: Connection 'model.youtube_project.fact_video_comments' was properly closed.
[0m04:49:12.494170 [info ] [MainThread]: 
[0m04:49:12.494818 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 6.61 seconds (6.61s).
[0m04:49:12.496371 [debug] [MainThread]: Command end result
[0m04:49:12.700613 [info ] [MainThread]: 
[0m04:49:12.701135 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:49:12.701514 [info ] [MainThread]: 
[0m04:49:12.701873 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:49:12.703068 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.0529785, "process_in_blocks": "0", "process_kernel_time": 0.288083, "process_mem_max_rss": "226364", "process_out_blocks": "8227", "process_user_time": 2.807812}
[0m04:49:12.703491 [debug] [MainThread]: Command `dbt run` succeeded at 04:49:12.703420 after 8.05 seconds
[0m04:49:12.703762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e550620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e811040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9eff5970>]}
[0m04:49:12.703990 [debug] [MainThread]: Flushing usage events
[0m04:50:59.306771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa99cfef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab6fca40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa19d070>]}


============================== 04:50:59.308153 | bb41bcc2-0d25-447f-8e4c-03857572ec48 ==============================
[0m04:50:59.308153 [info ] [MainThread]: Running with dbt=1.8.9
[0m04:50:59.308611 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'no_print': 'None', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'empty': 'None', 'invocation_command': 'dbt test --models youtube_data.marts.fact_video_comments', 'debug': 'False', 'indirect_selection': 'eager', 'log_path': '/usr/local/airflow/include/dbt/logs', 'write_json': 'True', 'use_colors': 'True', 'static_parser': 'True', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'printer_width': '80'}
[0m04:50:59.931799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb41bcc2-0d25-447f-8e4c-03857572ec48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa97cb590>]}
[0m04:50:59.957877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb41bcc2-0d25-447f-8e4c-03857572ec48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaadda600>]}
[0m04:50:59.958353 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m04:51:00.048177 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m04:51:00.170696 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:51:00.171615 [debug] [MainThread]: Partial parsing: updated file: youtube_project://models/youtube_data/marts/schema.yml
[0m04:51:00.397410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb41bcc2-0d25-447f-8e4c-03857572ec48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c310dd0>]}
[0m04:51:00.486051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb41bcc2-0d25-447f-8e4c-03857572ec48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bfaac90>]}
[0m04:51:00.486420 [info ] [MainThread]: Found 12 models, 137 data tests, 2 sources, 867 macros
[0m04:51:00.486688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb41bcc2-0d25-447f-8e4c-03857572ec48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cc3ad20>]}
[0m04:51:00.488739 [info ] [MainThread]: 
[0m04:51:00.489183 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m04:51:00.491689 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project_youtube'
[0m04:51:00.491959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:51:01.337757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb41bcc2-0d25-447f-8e4c-03857572ec48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c312900>]}
[0m04:51:01.339321 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:51:01.340174 [info ] [MainThread]: 
[0m04:51:01.345105 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__1.85e2196b15
[0m04:51:01.346059 [info ] [Thread-1 (]: 1 of 17 START test dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__1  [RUN]
[0m04:51:01.347168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__1.85e2196b15)
[0m04:51:01.348046 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__1.85e2196b15
[0m04:51:01.362817 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__1.85e2196b15"
[0m04:51:01.366018 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__1.85e2196b15
[0m04:51:01.389296 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__1.85e2196b15"
[0m04:51:01.390964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:51:01.392693 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__1.85e2196b15: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__1.85e2196b15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and length(
        comment_author
    ) >= 1 and length(
        comment_author
    ) <= 255
)
 as expression


    from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_comments`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







      
    ) dbt_internal_test
[0m04:51:02.765443 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:f3b0843a-7157-4e6c-aee8-19ea98cfbb1c&page=queryresults
[0m04:51:03.899000 [error] [Thread-1 (]: 1 of 17 FAIL 2 dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__1  [[31mFAIL 2[0m in 2.55s]
[0m04:51:03.901619 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__1.85e2196b15
[0m04:51:03.902843 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__1.4baeab5dde
[0m04:51:03.903761 [info ] [Thread-1 (]: 2 of 17 START test dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__1  [RUN]
[0m04:51:03.904732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__1.85e2196b15, now test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__1.4baeab5dde)
[0m04:51:03.905597 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__1.4baeab5dde
[0m04:51:03.914749 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__1.4baeab5dde"
[0m04:51:03.917458 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__1.4baeab5dde
[0m04:51:03.921635 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__1.4baeab5dde"
[0m04:51:03.923627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:51:03.926334 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__1.4baeab5dde: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__1.4baeab5dde"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and length(
        comment_text
    ) >= 1
)
 as expression


    from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_comments`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







      
    ) dbt_internal_test
[0m04:51:05.227752 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:9ae93289-329a-4581-980c-ac47c1b46df7&page=queryresults
[0m04:51:06.354571 [error] [Thread-1 (]: 2 of 17 FAIL 283 dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__1  [[31mFAIL 283[0m in 2.45s]
[0m04:51:06.358147 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__1.4baeab5dde
[0m04:51:06.359613 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.b62c18e906
[0m04:51:06.360823 [info ] [Thread-1 (]: 3 of 17 START test dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_  [RUN]
[0m04:51:06.362066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__1.4baeab5dde, now test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.b62c18e906)
[0m04:51:06.363025 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.b62c18e906
[0m04:51:06.374996 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.b62c18e906"
[0m04:51:06.377452 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.b62c18e906
[0m04:51:06.382288 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.b62c18e906"
[0m04:51:06.384539 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:51:06.387107 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.b62c18e906: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.b62c18e906"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and published_at >= TIMESTAMP('1900-01-01 00:00:00') and published_at <= TIMESTAMP('2100-12-31 23:59:59')
)
 as expression


    from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_comments`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m04:51:07.509382 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:72e34545-c190-4283-8e61-3f015434dad1&page=queryresults
[0m04:51:08.708752 [info ] [Thread-1 (]: 3 of 17 PASS dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_  [[32mPASS[0m in 2.35s]
[0m04:51:08.711595 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.b62c18e906
[0m04:51:08.713297 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING.c294e1d9e9
[0m04:51:08.714432 [info ] [Thread-1 (]: 4 of 17 START test dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING  [RUN]
[0m04:51:08.715532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.b62c18e906, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING.c294e1d9e9)
[0m04:51:08.716432 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING.c294e1d9e9
[0m04:51:08.726400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:51:09.539505 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING.c294e1d9e9"
[0m04:51:09.541538 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING.c294e1d9e9
[0m04:51:09.548799 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING.c294e1d9e9"
[0m04:51:09.550714 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING.c294e1d9e9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING.c294e1d9e9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('FACT_COMMENT_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_AUTHOR' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_TEXT' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('LIKE_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'COMMENT_AUTHOR'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:51:10.141669 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:b4ad7168-4e86-4632-a5a3-a946a32e9766&page=queryresults
[0m04:51:11.371913 [info ] [Thread-1 (]: 4 of 17 PASS dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING  [[32mPASS[0m in 2.66s]
[0m04:51:11.374833 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING.c294e1d9e9
[0m04:51:11.377333 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING.67992e0538
[0m04:51:11.378492 [info ] [Thread-1 (]: 5 of 17 START test dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING  [RUN]
[0m04:51:11.379744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING.c294e1d9e9, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING.67992e0538)
[0m04:51:11.380608 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING.67992e0538
[0m04:51:11.390442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:51:12.196703 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING.67992e0538"
[0m04:51:12.199528 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING.67992e0538
[0m04:51:12.204271 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING.67992e0538"
[0m04:51:12.206490 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING.67992e0538: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING.67992e0538"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('FACT_COMMENT_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_AUTHOR' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_TEXT' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('LIKE_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'COMMENT_ID'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:51:12.804441 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:7065edd3-0021-4e90-a439-6bb1e5bafe8e&page=queryresults
[0m04:51:14.029857 [info ] [Thread-1 (]: 5 of 17 PASS dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING  [[32mPASS[0m in 2.65s]
[0m04:51:14.031555 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING.67992e0538
[0m04:51:14.032697 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING.768c2fd511
[0m04:51:14.033748 [info ] [Thread-1 (]: 6 of 17 START test dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING  [RUN]
[0m04:51:14.034924 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING.67992e0538, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING.768c2fd511)
[0m04:51:14.035809 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING.768c2fd511
[0m04:51:14.043832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:51:14.967735 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING.768c2fd511"
[0m04:51:14.971538 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING.768c2fd511
[0m04:51:14.977625 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING.768c2fd511"
[0m04:51:14.979813 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING.768c2fd511: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING.768c2fd511"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('FACT_COMMENT_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_AUTHOR' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_TEXT' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('LIKE_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'COMMENT_TEXT'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:51:15.569186 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:1877e643-39e9-46c9-9f42-39e30302d761&page=queryresults
[0m04:51:16.798727 [info ] [Thread-1 (]: 6 of 17 PASS dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING  [[32mPASS[0m in 2.76s]
[0m04:51:16.801793 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING.768c2fd511
[0m04:51:16.803110 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INTEGER.dc12bef1ff
[0m04:51:16.804281 [info ] [Thread-1 (]: 7 of 17 START test dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INTEGER  [RUN]
[0m04:51:16.805527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING.768c2fd511, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INTEGER.dc12bef1ff)
[0m04:51:16.806482 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INTEGER.dc12bef1ff
[0m04:51:16.815232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:51:17.748707 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INTEGER.dc12bef1ff"
[0m04:51:17.750561 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INTEGER.dc12bef1ff
[0m04:51:17.752191 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INTEGER.dc12bef1ff"
[0m04:51:17.752934 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INTEGER.dc12bef1ff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INTEGER.dc12bef1ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('FACT_COMMENT_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_AUTHOR' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_TEXT' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('LIKE_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'LIKE_COUNT'
            and
            relation_column_type not in ('INTEGER')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:51:18.334773 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:2e9996a9-23fc-47da-b00c-bda8409b6f7e&page=queryresults
[0m04:51:19.562054 [error] [Thread-1 (]: 7 of 17 FAIL 1 dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INTEGER  [[31mFAIL 1[0m in 2.76s]
[0m04:51:19.564766 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INTEGER.dc12bef1ff
[0m04:51:19.566487 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP.d89c440efe
[0m04:51:19.567304 [info ] [Thread-1 (]: 8 of 17 START test dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP  [RUN]
[0m04:51:19.568117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INTEGER.dc12bef1ff, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP.d89c440efe)
[0m04:51:19.568857 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP.d89c440efe
[0m04:51:19.575738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:51:20.389477 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP.d89c440efe"
[0m04:51:20.392706 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP.d89c440efe
[0m04:51:20.397788 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP.d89c440efe"
[0m04:51:20.399904 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP.d89c440efe: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP.d89c440efe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('FACT_COMMENT_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_AUTHOR' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_TEXT' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('LIKE_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'PUBLISHED_AT'
            and
            relation_column_type not in ('TIMESTAMP')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:51:20.997649 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:abcfbb2d-f262-49bc-b278-780714ed1b60&page=queryresults
[0m04:51:22.223030 [info ] [Thread-1 (]: 8 of 17 PASS dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP  [[32mPASS[0m in 2.65s]
[0m04:51:22.225159 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP.d89c440efe
[0m04:51:22.226155 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING.bf8897ea43
[0m04:51:22.226924 [info ] [Thread-1 (]: 9 of 17 START test dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING  [RUN]
[0m04:51:22.227930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP.d89c440efe, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING.bf8897ea43)
[0m04:51:22.228640 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING.bf8897ea43
[0m04:51:22.235844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:51:23.051767 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING.bf8897ea43"
[0m04:51:23.054467 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING.bf8897ea43
[0m04:51:23.059399 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING.bf8897ea43"
[0m04:51:23.062060 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING.bf8897ea43: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING.bf8897ea43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('FACT_COMMENT_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_AUTHOR' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_TEXT' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('LIKE_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'VIDEO_ID'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:51:23.572191 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:390d20f6-f745-4d65-91dc-ba232df51207&page=queryresults
[0m04:51:24.787168 [info ] [Thread-1 (]: 9 of 17 PASS dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING  [[32mPASS[0m in 2.56s]
[0m04:51:24.791243 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING.bf8897ea43
[0m04:51:24.792888 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_fact_video_comments_comment_author.0d82d28fb5
[0m04:51:24.794127 [info ] [Thread-1 (]: 10 of 17 START test not_null_fact_video_comments_comment_author ................ [RUN]
[0m04:51:24.795568 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING.bf8897ea43, now test.youtube_project.not_null_fact_video_comments_comment_author.0d82d28fb5)
[0m04:51:24.796672 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_fact_video_comments_comment_author.0d82d28fb5
[0m04:51:24.816710 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_fact_video_comments_comment_author.0d82d28fb5"
[0m04:51:24.820897 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_fact_video_comments_comment_author.0d82d28fb5
[0m04:51:24.824132 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_fact_video_comments_comment_author.0d82d28fb5"
[0m04:51:24.825330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:51:24.827558 [debug] [Thread-1 (]: On test.youtube_project.not_null_fact_video_comments_comment_author.0d82d28fb5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_fact_video_comments_comment_author.0d82d28fb5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select comment_author
from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_comments`
where comment_author is null



      
    ) dbt_internal_test
[0m04:51:26.001639 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:53503e9c-38ab-4301-8664-5117f6ea6ac0&page=queryresults
[0m04:51:27.244587 [info ] [Thread-1 (]: 10 of 17 PASS not_null_fact_video_comments_comment_author ...................... [[32mPASS[0m in 2.45s]
[0m04:51:27.246564 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_fact_video_comments_comment_author.0d82d28fb5
[0m04:51:27.248018 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_fact_video_comments_comment_id.385f5dce07
[0m04:51:27.249133 [info ] [Thread-1 (]: 11 of 17 START test not_null_fact_video_comments_comment_id .................... [RUN]
[0m04:51:27.250170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_fact_video_comments_comment_author.0d82d28fb5, now test.youtube_project.not_null_fact_video_comments_comment_id.385f5dce07)
[0m04:51:27.250998 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_fact_video_comments_comment_id.385f5dce07
[0m04:51:27.260239 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_fact_video_comments_comment_id.385f5dce07"
[0m04:51:27.262277 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_fact_video_comments_comment_id.385f5dce07
[0m04:51:27.266196 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_fact_video_comments_comment_id.385f5dce07"
[0m04:51:27.268074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:51:27.270904 [debug] [Thread-1 (]: On test.youtube_project.not_null_fact_video_comments_comment_id.385f5dce07: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_fact_video_comments_comment_id.385f5dce07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select comment_id
from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_comments`
where comment_id is null



      
    ) dbt_internal_test
[0m04:51:28.467247 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:e6d1cfc3-ac0e-45eb-a759-0dec8f2c642e&page=queryresults
[0m04:51:29.701584 [info ] [Thread-1 (]: 11 of 17 PASS not_null_fact_video_comments_comment_id .......................... [[32mPASS[0m in 2.45s]
[0m04:51:29.704235 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_fact_video_comments_comment_id.385f5dce07
[0m04:51:29.705888 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_fact_video_comments_comment_text.cbca7f0240
[0m04:51:29.706788 [info ] [Thread-1 (]: 12 of 17 START test not_null_fact_video_comments_comment_text .................. [RUN]
[0m04:51:29.707765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_fact_video_comments_comment_id.385f5dce07, now test.youtube_project.not_null_fact_video_comments_comment_text.cbca7f0240)
[0m04:51:29.708623 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_fact_video_comments_comment_text.cbca7f0240
[0m04:51:29.717973 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_fact_video_comments_comment_text.cbca7f0240"
[0m04:51:29.720490 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_fact_video_comments_comment_text.cbca7f0240
[0m04:51:29.724363 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_fact_video_comments_comment_text.cbca7f0240"
[0m04:51:29.726705 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:51:29.729667 [debug] [Thread-1 (]: On test.youtube_project.not_null_fact_video_comments_comment_text.cbca7f0240: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_fact_video_comments_comment_text.cbca7f0240"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select comment_text
from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_comments`
where comment_text is null



      
    ) dbt_internal_test
[0m04:51:30.828840 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:ad389fea-4e4e-46dc-980a-d8acc1aaedc7&page=queryresults
[0m04:51:32.036268 [info ] [Thread-1 (]: 12 of 17 PASS not_null_fact_video_comments_comment_text ........................ [[32mPASS[0m in 2.33s]
[0m04:51:32.038950 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_fact_video_comments_comment_text.cbca7f0240
[0m04:51:32.040660 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_fact_video_comments_fact_comment_id.c615b514f7
[0m04:51:32.041685 [info ] [Thread-1 (]: 13 of 17 START test not_null_fact_video_comments_fact_comment_id ............... [RUN]
[0m04:51:32.042789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_fact_video_comments_comment_text.cbca7f0240, now test.youtube_project.not_null_fact_video_comments_fact_comment_id.c615b514f7)
[0m04:51:32.043700 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_fact_video_comments_fact_comment_id.c615b514f7
[0m04:51:32.052049 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_fact_video_comments_fact_comment_id.c615b514f7"
[0m04:51:32.054187 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_fact_video_comments_fact_comment_id.c615b514f7
[0m04:51:32.061992 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_fact_video_comments_fact_comment_id.c615b514f7"
[0m04:51:32.063660 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:51:32.066092 [debug] [Thread-1 (]: On test.youtube_project.not_null_fact_video_comments_fact_comment_id.c615b514f7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_fact_video_comments_fact_comment_id.c615b514f7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select fact_comment_id
from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_comments`
where fact_comment_id is null



      
    ) dbt_internal_test
[0m04:51:33.282874 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:9e6b09c3-a54b-45a3-afa5-aa3ee2a45f85&page=queryresults
[0m04:51:34.515178 [info ] [Thread-1 (]: 13 of 17 PASS not_null_fact_video_comments_fact_comment_id ..................... [[32mPASS[0m in 2.47s]
[0m04:51:34.517799 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_fact_video_comments_fact_comment_id.c615b514f7
[0m04:51:34.520533 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_fact_video_comments_published_at.02f4b08fcb
[0m04:51:34.521539 [info ] [Thread-1 (]: 14 of 17 START test not_null_fact_video_comments_published_at .................. [RUN]
[0m04:51:34.522806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_fact_video_comments_fact_comment_id.c615b514f7, now test.youtube_project.not_null_fact_video_comments_published_at.02f4b08fcb)
[0m04:51:34.523705 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_fact_video_comments_published_at.02f4b08fcb
[0m04:51:34.532224 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_fact_video_comments_published_at.02f4b08fcb"
[0m04:51:34.534397 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_fact_video_comments_published_at.02f4b08fcb
[0m04:51:34.538427 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_fact_video_comments_published_at.02f4b08fcb"
[0m04:51:34.540453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:51:34.543073 [debug] [Thread-1 (]: On test.youtube_project.not_null_fact_video_comments_published_at.02f4b08fcb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_fact_video_comments_published_at.02f4b08fcb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select published_at
from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_comments`
where published_at is null



      
    ) dbt_internal_test
[0m04:51:35.640157 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:d507a6c6-0a00-43c8-843e-b9716f885718&page=queryresults
[0m04:51:36.889854 [info ] [Thread-1 (]: 14 of 17 PASS not_null_fact_video_comments_published_at ........................ [[32mPASS[0m in 2.36s]
[0m04:51:36.896114 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_fact_video_comments_published_at.02f4b08fcb
[0m04:51:36.898877 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_fact_video_comments_video_id.852ef10814
[0m04:51:36.900281 [info ] [Thread-1 (]: 15 of 17 START test not_null_fact_video_comments_video_id ...................... [RUN]
[0m04:51:36.902090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_fact_video_comments_published_at.02f4b08fcb, now test.youtube_project.not_null_fact_video_comments_video_id.852ef10814)
[0m04:51:36.903222 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_fact_video_comments_video_id.852ef10814
[0m04:51:36.932101 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_fact_video_comments_video_id.852ef10814"
[0m04:51:36.935181 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_fact_video_comments_video_id.852ef10814
[0m04:51:36.940364 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_fact_video_comments_video_id.852ef10814"
[0m04:51:36.942318 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:51:36.946562 [debug] [Thread-1 (]: On test.youtube_project.not_null_fact_video_comments_video_id.852ef10814: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_fact_video_comments_video_id.852ef10814"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select video_id
from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_comments`
where video_id is null



      
    ) dbt_internal_test
[0m04:51:38.101045 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:c1eb581f-a0ef-4829-a7e7-c6212d357a1d&page=queryresults
[0m04:51:39.324248 [info ] [Thread-1 (]: 15 of 17 PASS not_null_fact_video_comments_video_id ............................ [[32mPASS[0m in 2.42s]
[0m04:51:39.326546 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_fact_video_comments_video_id.852ef10814
[0m04:51:39.328035 [debug] [Thread-1 (]: Began running node test.youtube_project.unique_fact_video_comments_comment_id.44d685a867
[0m04:51:39.329028 [info ] [Thread-1 (]: 16 of 17 START test unique_fact_video_comments_comment_id ...................... [RUN]
[0m04:51:39.330031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_fact_video_comments_video_id.852ef10814, now test.youtube_project.unique_fact_video_comments_comment_id.44d685a867)
[0m04:51:39.330945 [debug] [Thread-1 (]: Began compiling node test.youtube_project.unique_fact_video_comments_comment_id.44d685a867
[0m04:51:39.345344 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.unique_fact_video_comments_comment_id.44d685a867"
[0m04:51:39.348015 [debug] [Thread-1 (]: Began executing node test.youtube_project.unique_fact_video_comments_comment_id.44d685a867
[0m04:51:39.360226 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.unique_fact_video_comments_comment_id.44d685a867"
[0m04:51:39.362654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:51:39.365390 [debug] [Thread-1 (]: On test.youtube_project.unique_fact_video_comments_comment_id.44d685a867: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.unique_fact_video_comments_comment_id.44d685a867"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select comment_id as unique_field
  from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_comments`
  where comment_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m04:51:40.662547 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:f99a466b-52bd-41a6-8a66-a3c011ae7637&page=queryresults
[0m04:51:41.892570 [info ] [Thread-1 (]: 16 of 17 PASS unique_fact_video_comments_comment_id ............................ [[32mPASS[0m in 2.56s]
[0m04:51:41.896099 [debug] [Thread-1 (]: Finished running node test.youtube_project.unique_fact_video_comments_comment_id.44d685a867
[0m04:51:41.898426 [debug] [Thread-1 (]: Began running node test.youtube_project.unique_fact_video_comments_fact_comment_id.5d5768bd2c
[0m04:51:41.899570 [info ] [Thread-1 (]: 17 of 17 START test unique_fact_video_comments_fact_comment_id ................. [RUN]
[0m04:51:41.900941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.unique_fact_video_comments_comment_id.44d685a867, now test.youtube_project.unique_fact_video_comments_fact_comment_id.5d5768bd2c)
[0m04:51:41.902060 [debug] [Thread-1 (]: Began compiling node test.youtube_project.unique_fact_video_comments_fact_comment_id.5d5768bd2c
[0m04:51:41.911920 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.unique_fact_video_comments_fact_comment_id.5d5768bd2c"
[0m04:51:41.914499 [debug] [Thread-1 (]: Began executing node test.youtube_project.unique_fact_video_comments_fact_comment_id.5d5768bd2c
[0m04:51:41.919449 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.unique_fact_video_comments_fact_comment_id.5d5768bd2c"
[0m04:51:41.921801 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:51:41.924546 [debug] [Thread-1 (]: On test.youtube_project.unique_fact_video_comments_fact_comment_id.5d5768bd2c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.unique_fact_video_comments_fact_comment_id.5d5768bd2c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select fact_comment_id as unique_field
  from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_comments`
  where fact_comment_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m04:51:43.219489 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:6e1ce168-1259-42ab-a79d-e1c34ccf0bd0&page=queryresults
[0m04:51:44.341977 [error] [Thread-1 (]: 17 of 17 FAIL 1 unique_fact_video_comments_fact_comment_id ..................... [[31mFAIL 1[0m in 2.44s]
[0m04:51:44.343864 [debug] [Thread-1 (]: Finished running node test.youtube_project.unique_fact_video_comments_fact_comment_id.5d5768bd2c
[0m04:51:44.352321 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:51:44.353113 [debug] [MainThread]: Connection 'test.youtube_project.unique_fact_video_comments_fact_comment_id.5d5768bd2c' was properly closed.
[0m04:51:44.354273 [info ] [MainThread]: 
[0m04:51:44.355277 [info ] [MainThread]: Finished running 17 data tests in 0 hours 0 minutes and 43.86 seconds (43.86s).
[0m04:51:44.364452 [debug] [MainThread]: Command end result
[0m04:51:44.441024 [info ] [MainThread]: 
[0m04:51:44.441625 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m04:51:44.441939 [info ] [MainThread]: 
[0m04:51:44.442428 [error] [MainThread]: [31mFailure in test dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__1 (models/youtube_data/marts/schema.yml)[0m
[0m04:51:44.442872 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m04:51:44.443198 [info ] [MainThread]: 
[0m04:51:44.443593 [info ] [MainThread]:   compiled code at target/compiled/youtube_project/models/youtube_data/marts/schema.yml/dbt_expectations_expect_column_f1a10dc3ee37b63eec7f79a0c2ea1c25.sql
[0m04:51:44.443874 [info ] [MainThread]: 
[0m04:51:44.444417 [error] [MainThread]: [31mFailure in test dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__1 (models/youtube_data/marts/schema.yml)[0m
[0m04:51:44.444781 [error] [MainThread]:   Got 283 results, configured to fail if != 0
[0m04:51:44.445150 [info ] [MainThread]: 
[0m04:51:44.445503 [info ] [MainThread]:   compiled code at target/compiled/youtube_project/models/youtube_data/marts/schema.yml/dbt_expectations_expect_column_69a1ae27b383003d38cf1e5b12ae8158.sql
[0m04:51:44.445844 [info ] [MainThread]: 
[0m04:51:44.446193 [error] [MainThread]: [31mFailure in test dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INTEGER (models/youtube_data/marts/schema.yml)[0m
[0m04:51:44.446490 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m04:51:44.446768 [info ] [MainThread]: 
[0m04:51:44.447070 [info ] [MainThread]:   compiled code at target/compiled/youtube_project/models/youtube_data/marts/schema.yml/dbt_expectations_expect_column_01a8f611f07f4f90e50eaa393c7dbc02.sql
[0m04:51:44.447262 [info ] [MainThread]: 
[0m04:51:44.447606 [error] [MainThread]: [31mFailure in test unique_fact_video_comments_fact_comment_id (models/youtube_data/marts/schema.yml)[0m
[0m04:51:44.447899 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m04:51:44.448117 [info ] [MainThread]: 
[0m04:51:44.448459 [info ] [MainThread]:   compiled code at target/compiled/youtube_project/models/youtube_data/marts/schema.yml/unique_fact_video_comments_fact_comment_id.sql
[0m04:51:44.448735 [info ] [MainThread]: 
[0m04:51:44.449068 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=4 SKIP=0 TOTAL=17
[0m04:51:44.452769 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 45.166428, "process_in_blocks": "0", "process_kernel_time": 0.389048, "process_mem_max_rss": "227096", "process_out_blocks": "8440", "process_user_time": 4.464031}
[0m04:51:44.454047 [debug] [MainThread]: Command `dbt test` failed at 04:51:44.453866 after 45.17 seconds
[0m04:51:44.454682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa19d070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa19f6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c9d1df0>]}
[0m04:51:44.455098 [debug] [MainThread]: Flushing usage events
[0m04:55:53.554911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6aee630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6cdde20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6318d10>]}


============================== 04:55:53.556326 | 9cdb61bb-6dbb-4b49-90c1-6606dd825dfa ==============================
[0m04:55:53.556326 [info ] [MainThread]: Running with dbt=1.8.9
[0m04:55:53.556757 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'no_print': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt test --models youtube_data.marts.fact_video_comments', 'introspect': 'True', 'warn_error': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt', 'partial_parse': 'True', 'version_check': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'use_colors': 'True'}
[0m04:55:54.201146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9cdb61bb-6dbb-4b49-90c1-6606dd825dfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9994ff20>]}
[0m04:55:54.225432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9cdb61bb-6dbb-4b49-90c1-6606dd825dfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff997aa120>]}
[0m04:55:54.225812 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m04:55:54.302519 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m04:55:54.447622 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:55:54.448726 [debug] [MainThread]: Partial parsing: updated file: youtube_project://models/youtube_data/marts/schema.yml
[0m04:55:54.675434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9cdb61bb-6dbb-4b49-90c1-6606dd825dfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98ef20f0>]}
[0m04:55:54.812918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9cdb61bb-6dbb-4b49-90c1-6606dd825dfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98ef2060>]}
[0m04:55:54.814349 [info ] [MainThread]: Found 12 models, 137 data tests, 2 sources, 867 macros
[0m04:55:54.814906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cdb61bb-6dbb-4b49-90c1-6606dd825dfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98b5fd70>]}
[0m04:55:54.819608 [info ] [MainThread]: 
[0m04:55:54.821702 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m04:55:54.831201 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project_youtube'
[0m04:55:54.832507 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:55:55.672147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cdb61bb-6dbb-4b49-90c1-6606dd825dfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff995e61e0>]}
[0m04:55:55.673804 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:55:55.674733 [info ] [MainThread]: 
[0m04:55:55.681386 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__0.32d72b6c2e
[0m04:55:55.682476 [info ] [Thread-1 (]: 1 of 17 START test dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__0  [RUN]
[0m04:55:55.683418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__0.32d72b6c2e)
[0m04:55:55.684336 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__0.32d72b6c2e
[0m04:55:55.698489 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__0.32d72b6c2e"
[0m04:55:55.700700 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__0.32d72b6c2e
[0m04:55:55.723354 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__0.32d72b6c2e"
[0m04:55:55.725119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:55:55.727050 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__0.32d72b6c2e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__0.32d72b6c2e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and length(
        comment_author
    ) >= 0 and length(
        comment_author
    ) <= 255
)
 as expression


    from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_comments`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







      
    ) dbt_internal_test
[0m04:55:56.967572 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:69a2745f-0031-4139-b7c5-827f135d4f50&page=queryresults
[0m04:55:58.198975 [info ] [Thread-1 (]: 1 of 17 PASS dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__0  [[32mPASS[0m in 2.52s]
[0m04:55:58.200362 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__0.32d72b6c2e
[0m04:55:58.201226 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__1.4baeab5dde
[0m04:55:58.201912 [info ] [Thread-1 (]: 2 of 17 START test dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__1  [RUN]
[0m04:55:58.202557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__0.32d72b6c2e, now test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__1.4baeab5dde)
[0m04:55:58.203041 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__1.4baeab5dde
[0m04:55:58.211124 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__1.4baeab5dde"
[0m04:55:58.213911 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__1.4baeab5dde
[0m04:55:58.217891 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__1.4baeab5dde"
[0m04:55:58.219995 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:55:58.221804 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__1.4baeab5dde: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__1.4baeab5dde"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and length(
        comment_text
    ) >= 1
)
 as expression


    from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_comments`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







      
    ) dbt_internal_test
[0m04:55:59.323370 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:9212e0e8-1d76-4fa3-965f-1158d96fc062&page=queryresults
[0m04:56:00.553020 [error] [Thread-1 (]: 2 of 17 FAIL 283 dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__1  [[31mFAIL 283[0m in 2.35s]
[0m04:56:00.555833 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__1.4baeab5dde
[0m04:56:00.557535 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.b62c18e906
[0m04:56:00.558654 [info ] [Thread-1 (]: 3 of 17 START test dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_  [RUN]
[0m04:56:00.559618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__1.4baeab5dde, now test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.b62c18e906)
[0m04:56:00.560546 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.b62c18e906
[0m04:56:00.571836 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.b62c18e906"
[0m04:56:00.574575 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.b62c18e906
[0m04:56:00.578938 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.b62c18e906"
[0m04:56:00.580991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:00.583696 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.b62c18e906: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.b62c18e906"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and published_at >= TIMESTAMP('1900-01-01 00:00:00') and published_at <= TIMESTAMP('2100-12-31 23:59:59')
)
 as expression


    from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_comments`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m04:56:01.678970 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:1bb7d1b6-ef86-43c7-bf05-310bfe836afc&page=queryresults
[0m04:56:02.907766 [info ] [Thread-1 (]: 3 of 17 PASS dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_  [[32mPASS[0m in 2.35s]
[0m04:56:02.910895 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.b62c18e906
[0m04:56:02.912623 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING.c294e1d9e9
[0m04:56:02.913888 [info ] [Thread-1 (]: 4 of 17 START test dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING  [RUN]
[0m04:56:02.915096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.b62c18e906, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING.c294e1d9e9)
[0m04:56:02.916029 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING.c294e1d9e9
[0m04:56:02.924108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:03.844904 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING.c294e1d9e9"
[0m04:56:03.847350 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING.c294e1d9e9
[0m04:56:03.851436 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING.c294e1d9e9"
[0m04:56:03.853037 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING.c294e1d9e9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING.c294e1d9e9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('FACT_COMMENT_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_AUTHOR' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_TEXT' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('LIKE_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'COMMENT_AUTHOR'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:56:04.345653 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:884063c7-8389-486c-970d-21f1d9a3f7cc&page=queryresults
[0m04:56:05.569265 [info ] [Thread-1 (]: 4 of 17 PASS dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING  [[32mPASS[0m in 2.65s]
[0m04:56:05.572885 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING.c294e1d9e9
[0m04:56:05.578368 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING.67992e0538
[0m04:56:05.579426 [info ] [Thread-1 (]: 5 of 17 START test dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING  [RUN]
[0m04:56:05.580660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING.c294e1d9e9, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING.67992e0538)
[0m04:56:05.581531 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING.67992e0538
[0m04:56:05.743446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:06.492401 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING.67992e0538"
[0m04:56:06.494271 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING.67992e0538
[0m04:56:06.497566 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING.67992e0538"
[0m04:56:06.498756 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING.67992e0538: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING.67992e0538"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('FACT_COMMENT_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_AUTHOR' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_TEXT' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('LIKE_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'COMMENT_ID'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:56:07.001939 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:bf8a6102-1d17-416e-8df9-0d9038e722d7&page=queryresults
[0m04:56:08.232931 [info ] [Thread-1 (]: 5 of 17 PASS dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING  [[32mPASS[0m in 2.65s]
[0m04:56:08.235837 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING.67992e0538
[0m04:56:08.237413 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING.768c2fd511
[0m04:56:08.238550 [info ] [Thread-1 (]: 6 of 17 START test dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING  [RUN]
[0m04:56:08.239648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING.67992e0538, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING.768c2fd511)
[0m04:56:08.240632 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING.768c2fd511
[0m04:56:08.249574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:09.056501 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING.768c2fd511"
[0m04:56:09.060120 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING.768c2fd511
[0m04:56:09.065322 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING.768c2fd511"
[0m04:56:09.067083 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING.768c2fd511: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING.768c2fd511"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('FACT_COMMENT_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_AUTHOR' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_TEXT' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('LIKE_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'COMMENT_TEXT'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:56:09.561867 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:c7e15c21-bc7a-492b-a950-8418fbbf2d2a&page=queryresults
[0m04:56:10.788814 [info ] [Thread-1 (]: 6 of 17 PASS dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING  [[32mPASS[0m in 2.55s]
[0m04:56:10.790473 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING.768c2fd511
[0m04:56:10.791732 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INTEGER.dc12bef1ff
[0m04:56:10.792597 [info ] [Thread-1 (]: 7 of 17 START test dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INTEGER  [RUN]
[0m04:56:10.793405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING.768c2fd511, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INTEGER.dc12bef1ff)
[0m04:56:10.794227 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INTEGER.dc12bef1ff
[0m04:56:10.800545 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:11.615582 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INTEGER.dc12bef1ff"
[0m04:56:11.618290 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INTEGER.dc12bef1ff
[0m04:56:11.626628 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INTEGER.dc12bef1ff"
[0m04:56:11.628532 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INTEGER.dc12bef1ff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INTEGER.dc12bef1ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('FACT_COMMENT_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_AUTHOR' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_TEXT' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('LIKE_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'LIKE_COUNT'
            and
            relation_column_type not in ('INTEGER')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:56:12.221137 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:2d54c645-03f7-4ae4-8cad-bed9e1ffb64d&page=queryresults
[0m04:56:13.456791 [error] [Thread-1 (]: 7 of 17 FAIL 1 dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INTEGER  [[31mFAIL 1[0m in 2.66s]
[0m04:56:13.460383 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INTEGER.dc12bef1ff
[0m04:56:13.461586 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP.d89c440efe
[0m04:56:13.462478 [info ] [Thread-1 (]: 8 of 17 START test dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP  [RUN]
[0m04:56:13.463507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INTEGER.dc12bef1ff, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP.d89c440efe)
[0m04:56:13.464269 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP.d89c440efe
[0m04:56:13.474253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:14.383325 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP.d89c440efe"
[0m04:56:14.386330 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP.d89c440efe
[0m04:56:14.391584 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP.d89c440efe"
[0m04:56:14.393714 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP.d89c440efe: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP.d89c440efe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('FACT_COMMENT_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_AUTHOR' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_TEXT' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('LIKE_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'PUBLISHED_AT'
            and
            relation_column_type not in ('TIMESTAMP')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:56:14.886185 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:445c087e-da3f-4d0d-8442-c8a9e2a8b484&page=queryresults
[0m04:56:16.114062 [info ] [Thread-1 (]: 8 of 17 PASS dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP  [[32mPASS[0m in 2.65s]
[0m04:56:16.115643 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP.d89c440efe
[0m04:56:16.116534 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING.bf8897ea43
[0m04:56:16.117274 [info ] [Thread-1 (]: 9 of 17 START test dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING  [RUN]
[0m04:56:16.118037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP.d89c440efe, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING.bf8897ea43)
[0m04:56:16.118656 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING.bf8897ea43
[0m04:56:16.125077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:17.055909 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING.bf8897ea43"
[0m04:56:17.058590 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING.bf8897ea43
[0m04:56:17.062746 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING.bf8897ea43"
[0m04:56:17.064110 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING.bf8897ea43: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING.bf8897ea43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('FACT_COMMENT_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_AUTHOR' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_TEXT' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('LIKE_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'VIDEO_ID'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:56:17.547108 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:8597cd06-1152-4e72-9c8c-1357367ee3bb&page=queryresults
[0m04:56:18.695165 [info ] [Thread-1 (]: 9 of 17 PASS dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING  [[32mPASS[0m in 2.58s]
[0m04:56:18.696090 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING.bf8897ea43
[0m04:56:18.696750 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_fact_video_comments_comment_author.0d82d28fb5
[0m04:56:18.697203 [info ] [Thread-1 (]: 10 of 17 START test not_null_fact_video_comments_comment_author ................ [RUN]
[0m04:56:18.697805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING.bf8897ea43, now test.youtube_project.not_null_fact_video_comments_comment_author.0d82d28fb5)
[0m04:56:18.698253 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_fact_video_comments_comment_author.0d82d28fb5
[0m04:56:18.707193 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_fact_video_comments_comment_author.0d82d28fb5"
[0m04:56:18.708400 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_fact_video_comments_comment_author.0d82d28fb5
[0m04:56:18.711473 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_fact_video_comments_comment_author.0d82d28fb5"
[0m04:56:18.712496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:18.713780 [debug] [Thread-1 (]: On test.youtube_project.not_null_fact_video_comments_comment_author.0d82d28fb5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_fact_video_comments_comment_author.0d82d28fb5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select comment_author
from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_comments`
where comment_author is null



      
    ) dbt_internal_test
[0m04:56:19.801770 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:30f8db9b-dd95-42fd-a644-def3ba277a12&page=queryresults
[0m04:56:21.037336 [info ] [Thread-1 (]: 10 of 17 PASS not_null_fact_video_comments_comment_author ...................... [[32mPASS[0m in 2.34s]
[0m04:56:21.044171 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_fact_video_comments_comment_author.0d82d28fb5
[0m04:56:21.045554 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_fact_video_comments_comment_id.385f5dce07
[0m04:56:21.046342 [info ] [Thread-1 (]: 11 of 17 START test not_null_fact_video_comments_comment_id .................... [RUN]
[0m04:56:21.047126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_fact_video_comments_comment_author.0d82d28fb5, now test.youtube_project.not_null_fact_video_comments_comment_id.385f5dce07)
[0m04:56:21.047889 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_fact_video_comments_comment_id.385f5dce07
[0m04:56:21.057015 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_fact_video_comments_comment_id.385f5dce07"
[0m04:56:21.059052 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_fact_video_comments_comment_id.385f5dce07
[0m04:56:21.061454 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_fact_video_comments_comment_id.385f5dce07"
[0m04:56:21.062359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:21.065588 [debug] [Thread-1 (]: On test.youtube_project.not_null_fact_video_comments_comment_id.385f5dce07: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_fact_video_comments_comment_id.385f5dce07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select comment_id
from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_comments`
where comment_id is null



      
    ) dbt_internal_test
[0m04:56:22.160072 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:c9c82485-4b60-4265-9b46-62359122d78c&page=queryresults
[0m04:56:23.389490 [info ] [Thread-1 (]: 11 of 17 PASS not_null_fact_video_comments_comment_id .......................... [[32mPASS[0m in 2.34s]
[0m04:56:23.392547 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_fact_video_comments_comment_id.385f5dce07
[0m04:56:23.393905 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_fact_video_comments_comment_text.cbca7f0240
[0m04:56:23.394864 [info ] [Thread-1 (]: 12 of 17 START test not_null_fact_video_comments_comment_text .................. [RUN]
[0m04:56:23.395889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_fact_video_comments_comment_id.385f5dce07, now test.youtube_project.not_null_fact_video_comments_comment_text.cbca7f0240)
[0m04:56:23.396663 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_fact_video_comments_comment_text.cbca7f0240
[0m04:56:23.405699 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_fact_video_comments_comment_text.cbca7f0240"
[0m04:56:23.407635 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_fact_video_comments_comment_text.cbca7f0240
[0m04:56:23.411454 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_fact_video_comments_comment_text.cbca7f0240"
[0m04:56:23.412718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:23.414818 [debug] [Thread-1 (]: On test.youtube_project.not_null_fact_video_comments_comment_text.cbca7f0240: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_fact_video_comments_comment_text.cbca7f0240"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select comment_text
from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_comments`
where comment_text is null



      
    ) dbt_internal_test
[0m04:56:24.616502 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:6e470fdd-8de2-4bc1-8517-507e2fee39de&page=queryresults
[0m04:56:25.842195 [info ] [Thread-1 (]: 12 of 17 PASS not_null_fact_video_comments_comment_text ........................ [[32mPASS[0m in 2.45s]
[0m04:56:25.844547 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_fact_video_comments_comment_text.cbca7f0240
[0m04:56:25.845815 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_fact_video_comments_fact_comment_id.c615b514f7
[0m04:56:25.846789 [info ] [Thread-1 (]: 13 of 17 START test not_null_fact_video_comments_fact_comment_id ............... [RUN]
[0m04:56:25.848057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_fact_video_comments_comment_text.cbca7f0240, now test.youtube_project.not_null_fact_video_comments_fact_comment_id.c615b514f7)
[0m04:56:25.849099 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_fact_video_comments_fact_comment_id.c615b514f7
[0m04:56:25.858134 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_fact_video_comments_fact_comment_id.c615b514f7"
[0m04:56:25.861227 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_fact_video_comments_fact_comment_id.c615b514f7
[0m04:56:25.870484 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_fact_video_comments_fact_comment_id.c615b514f7"
[0m04:56:25.872423 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:25.875541 [debug] [Thread-1 (]: On test.youtube_project.not_null_fact_video_comments_fact_comment_id.c615b514f7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_fact_video_comments_fact_comment_id.c615b514f7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select fact_comment_id
from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_comments`
where fact_comment_id is null



      
    ) dbt_internal_test
[0m04:56:27.175021 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:794b335c-8df4-434a-862a-3bb81df6865e&page=queryresults
[0m04:56:28.409412 [info ] [Thread-1 (]: 13 of 17 PASS not_null_fact_video_comments_fact_comment_id ..................... [[32mPASS[0m in 2.56s]
[0m04:56:28.412635 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_fact_video_comments_fact_comment_id.c615b514f7
[0m04:56:28.414290 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_fact_video_comments_published_at.02f4b08fcb
[0m04:56:28.415653 [info ] [Thread-1 (]: 14 of 17 START test not_null_fact_video_comments_published_at .................. [RUN]
[0m04:56:28.417027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_fact_video_comments_fact_comment_id.c615b514f7, now test.youtube_project.not_null_fact_video_comments_published_at.02f4b08fcb)
[0m04:56:28.418163 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_fact_video_comments_published_at.02f4b08fcb
[0m04:56:28.430201 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_fact_video_comments_published_at.02f4b08fcb"
[0m04:56:28.433306 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_fact_video_comments_published_at.02f4b08fcb
[0m04:56:28.436895 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_fact_video_comments_published_at.02f4b08fcb"
[0m04:56:28.438328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:28.440599 [debug] [Thread-1 (]: On test.youtube_project.not_null_fact_video_comments_published_at.02f4b08fcb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_fact_video_comments_published_at.02f4b08fcb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select published_at
from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_comments`
where published_at is null



      
    ) dbt_internal_test
[0m04:56:29.532429 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:e26eab12-f99f-4cb2-ba70-6aec0a9c0781&page=queryresults
[0m04:56:30.659145 [info ] [Thread-1 (]: 14 of 17 PASS not_null_fact_video_comments_published_at ........................ [[32mPASS[0m in 2.24s]
[0m04:56:30.661998 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_fact_video_comments_published_at.02f4b08fcb
[0m04:56:30.663647 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_fact_video_comments_video_id.852ef10814
[0m04:56:30.664667 [info ] [Thread-1 (]: 15 of 17 START test not_null_fact_video_comments_video_id ...................... [RUN]
[0m04:56:30.665698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_fact_video_comments_published_at.02f4b08fcb, now test.youtube_project.not_null_fact_video_comments_video_id.852ef10814)
[0m04:56:30.666516 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_fact_video_comments_video_id.852ef10814
[0m04:56:30.675989 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_fact_video_comments_video_id.852ef10814"
[0m04:56:30.678013 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_fact_video_comments_video_id.852ef10814
[0m04:56:30.681930 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_fact_video_comments_video_id.852ef10814"
[0m04:56:30.683362 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:30.689008 [debug] [Thread-1 (]: On test.youtube_project.not_null_fact_video_comments_video_id.852ef10814: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_fact_video_comments_video_id.852ef10814"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select video_id
from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_comments`
where video_id is null



      
    ) dbt_internal_test
[0m04:56:31.783639 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:e43a8852-9307-4717-b087-8fb1386a78ff&page=queryresults
[0m04:56:33.010907 [info ] [Thread-1 (]: 15 of 17 PASS not_null_fact_video_comments_video_id ............................ [[32mPASS[0m in 2.35s]
[0m04:56:33.012274 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_fact_video_comments_video_id.852ef10814
[0m04:56:33.013299 [debug] [Thread-1 (]: Began running node test.youtube_project.unique_fact_video_comments_comment_id.44d685a867
[0m04:56:33.014059 [info ] [Thread-1 (]: 16 of 17 START test unique_fact_video_comments_comment_id ...................... [RUN]
[0m04:56:33.014996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_fact_video_comments_video_id.852ef10814, now test.youtube_project.unique_fact_video_comments_comment_id.44d685a867)
[0m04:56:33.015643 [debug] [Thread-1 (]: Began compiling node test.youtube_project.unique_fact_video_comments_comment_id.44d685a867
[0m04:56:33.025626 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.unique_fact_video_comments_comment_id.44d685a867"
[0m04:56:33.027397 [debug] [Thread-1 (]: Began executing node test.youtube_project.unique_fact_video_comments_comment_id.44d685a867
[0m04:56:33.030389 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.unique_fact_video_comments_comment_id.44d685a867"
[0m04:56:33.031570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:33.033375 [debug] [Thread-1 (]: On test.youtube_project.unique_fact_video_comments_comment_id.44d685a867: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.unique_fact_video_comments_comment_id.44d685a867"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select comment_id as unique_field
  from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_comments`
  where comment_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m04:56:34.034106 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:dde5def7-3605-40f0-b2ff-227992a695e7&page=queryresults
[0m04:56:35.263131 [info ] [Thread-1 (]: 16 of 17 PASS unique_fact_video_comments_comment_id ............................ [[32mPASS[0m in 2.25s]
[0m04:56:35.265052 [debug] [Thread-1 (]: Finished running node test.youtube_project.unique_fact_video_comments_comment_id.44d685a867
[0m04:56:35.266163 [debug] [Thread-1 (]: Began running node test.youtube_project.unique_fact_video_comments_fact_comment_id.5d5768bd2c
[0m04:56:35.267054 [info ] [Thread-1 (]: 17 of 17 START test unique_fact_video_comments_fact_comment_id ................. [RUN]
[0m04:56:35.268084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.unique_fact_video_comments_comment_id.44d685a867, now test.youtube_project.unique_fact_video_comments_fact_comment_id.5d5768bd2c)
[0m04:56:35.268864 [debug] [Thread-1 (]: Began compiling node test.youtube_project.unique_fact_video_comments_fact_comment_id.5d5768bd2c
[0m04:56:35.280378 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.unique_fact_video_comments_fact_comment_id.5d5768bd2c"
[0m04:56:35.282321 [debug] [Thread-1 (]: Began executing node test.youtube_project.unique_fact_video_comments_fact_comment_id.5d5768bd2c
[0m04:56:35.285831 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.unique_fact_video_comments_fact_comment_id.5d5768bd2c"
[0m04:56:35.286945 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:35.288927 [debug] [Thread-1 (]: On test.youtube_project.unique_fact_video_comments_fact_comment_id.5d5768bd2c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.unique_fact_video_comments_fact_comment_id.5d5768bd2c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select fact_comment_id as unique_field
  from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_comments`
  where fact_comment_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m04:56:36.302625 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:ef15fd00-f622-4a50-9bfa-43f785c0b25d&page=queryresults
[0m04:56:37.520691 [error] [Thread-1 (]: 17 of 17 FAIL 1 unique_fact_video_comments_fact_comment_id ..................... [[31mFAIL 1[0m in 2.25s]
[0m04:56:37.524378 [debug] [Thread-1 (]: Finished running node test.youtube_project.unique_fact_video_comments_fact_comment_id.5d5768bd2c
[0m04:56:37.535634 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:56:37.536522 [debug] [MainThread]: Connection 'test.youtube_project.unique_fact_video_comments_fact_comment_id.5d5768bd2c' was properly closed.
[0m04:56:37.537619 [info ] [MainThread]: 
[0m04:56:37.538588 [info ] [MainThread]: Finished running 17 data tests in 0 hours 0 minutes and 42.72 seconds (42.72s).
[0m04:56:37.546186 [debug] [MainThread]: Command end result
[0m04:56:37.652018 [info ] [MainThread]: 
[0m04:56:37.652832 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m04:56:37.653186 [info ] [MainThread]: 
[0m04:56:37.653790 [error] [MainThread]: [31mFailure in test dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__1 (models/youtube_data/marts/schema.yml)[0m
[0m04:56:37.654454 [error] [MainThread]:   Got 283 results, configured to fail if != 0
[0m04:56:37.654923 [info ] [MainThread]: 
[0m04:56:37.655307 [info ] [MainThread]:   compiled code at target/compiled/youtube_project/models/youtube_data/marts/schema.yml/dbt_expectations_expect_column_69a1ae27b383003d38cf1e5b12ae8158.sql
[0m04:56:37.655639 [info ] [MainThread]: 
[0m04:56:37.655985 [error] [MainThread]: [31mFailure in test dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INTEGER (models/youtube_data/marts/schema.yml)[0m
[0m04:56:37.656356 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m04:56:37.656571 [info ] [MainThread]: 
[0m04:56:37.656928 [info ] [MainThread]:   compiled code at target/compiled/youtube_project/models/youtube_data/marts/schema.yml/dbt_expectations_expect_column_01a8f611f07f4f90e50eaa393c7dbc02.sql
[0m04:56:37.657206 [info ] [MainThread]: 
[0m04:56:37.657548 [error] [MainThread]: [31mFailure in test unique_fact_video_comments_fact_comment_id (models/youtube_data/marts/schema.yml)[0m
[0m04:56:37.657838 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m04:56:37.658109 [info ] [MainThread]: 
[0m04:56:37.658439 [info ] [MainThread]:   compiled code at target/compiled/youtube_project/models/youtube_data/marts/schema.yml/unique_fact_video_comments_fact_comment_id.sql
[0m04:56:37.658681 [info ] [MainThread]: 
[0m04:56:37.658976 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=3 SKIP=0 TOTAL=17
[0m04:56:37.661156 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 44.13364, "process_in_blocks": "0", "process_kernel_time": 0.37752, "process_mem_max_rss": "227048", "process_out_blocks": "8438", "process_user_time": 4.424542}
[0m04:56:37.661823 [debug] [MainThread]: Command `dbt test` failed at 04:56:37.661720 after 44.13 seconds
[0m04:56:37.662397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb71e2240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb66c6f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb705c620>]}
[0m04:56:37.662750 [debug] [MainThread]: Flushing usage events
[0m04:57:46.222869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f3cc170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eda1040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eae50d0>]}


============================== 04:57:46.224384 | dce03afc-ee0a-43fd-a836-5ba9a87a895b ==============================
[0m04:57:46.224384 [info ] [MainThread]: Running with dbt=1.8.9
[0m04:57:46.224803 [debug] [MainThread]: running dbt with arguments {'log_path': '/usr/local/airflow/include/dbt/logs', 'invocation_command': 'dbt test --models youtube_data.marts.fact_video_comments', 'profiles_dir': '/usr/local/airflow/include/dbt', 'no_print': 'None', 'target_path': 'None', 'warn_error': 'None', 'write_json': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'printer_width': '80', 'use_colors': 'True', 'version_check': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'empty': 'None'}
[0m04:57:46.887237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dce03afc-ee0a-43fd-a836-5ba9a87a895b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72531bb0>]}
[0m04:57:46.911733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dce03afc-ee0a-43fd-a836-5ba9a87a895b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72876ea0>]}
[0m04:57:46.912136 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m04:57:46.978086 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m04:57:47.104975 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:57:47.105824 [debug] [MainThread]: Partial parsing: updated file: youtube_project://models/youtube_data/marts/schema.yml
[0m04:57:47.330622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dce03afc-ee0a-43fd-a836-5ba9a87a895b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71517a70>]}
[0m04:57:47.422154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dce03afc-ee0a-43fd-a836-5ba9a87a895b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70d05400>]}
[0m04:57:47.422536 [info ] [MainThread]: Found 12 models, 136 data tests, 2 sources, 867 macros
[0m04:57:47.422807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dce03afc-ee0a-43fd-a836-5ba9a87a895b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71148800>]}
[0m04:57:47.424811 [info ] [MainThread]: 
[0m04:57:47.425273 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m04:57:47.427844 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project_youtube'
[0m04:57:47.428136 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:57:48.283506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dce03afc-ee0a-43fd-a836-5ba9a87a895b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74d3e8d0>]}
[0m04:57:48.284732 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:57:48.285572 [info ] [MainThread]: 
[0m04:57:48.290498 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__0.32d72b6c2e
[0m04:57:48.291537 [info ] [Thread-1 (]: 1 of 16 START test dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__0  [RUN]
[0m04:57:48.292675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__0.32d72b6c2e)
[0m04:57:48.293423 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__0.32d72b6c2e
[0m04:57:48.309123 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__0.32d72b6c2e"
[0m04:57:48.312171 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__0.32d72b6c2e
[0m04:57:48.338688 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__0.32d72b6c2e"
[0m04:57:48.340293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:48.341859 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__0.32d72b6c2e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__0.32d72b6c2e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and length(
        comment_author
    ) >= 0 and length(
        comment_author
    ) <= 255
)
 as expression


    from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_comments`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







      
    ) dbt_internal_test
[0m04:57:49.406090 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:2b0f3121-45ed-4f57-bc6e-77f0e7883a5a&page=queryresults
[0m04:57:50.549343 [info ] [Thread-1 (]: 1 of 16 PASS dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__0  [[32mPASS[0m in 2.25s]
[0m04:57:50.554990 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__0.32d72b6c2e
[0m04:57:50.557010 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__0.25bf74b36d
[0m04:57:50.559021 [info ] [Thread-1 (]: 2 of 16 START test dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__0  [RUN]
[0m04:57:50.561517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__0.32d72b6c2e, now test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__0.25bf74b36d)
[0m04:57:50.564234 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__0.25bf74b36d
[0m04:57:50.598891 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__0.25bf74b36d"
[0m04:57:50.601637 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__0.25bf74b36d
[0m04:57:50.606198 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__0.25bf74b36d"
[0m04:57:50.608167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:50.610781 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__0.25bf74b36d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__0.25bf74b36d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and length(
        comment_text
    ) >= 0
)
 as expression


    from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_comments`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







      
    ) dbt_internal_test
[0m04:57:51.701787 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:1afb53cb-343b-441f-a393-357a9d772c7f&page=queryresults
[0m04:57:52.887285 [info ] [Thread-1 (]: 2 of 16 PASS dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__0  [[32mPASS[0m in 2.33s]
[0m04:57:52.890546 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__0.25bf74b36d
[0m04:57:52.892211 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.b62c18e906
[0m04:57:52.893225 [info ] [Thread-1 (]: 3 of 16 START test dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_  [RUN]
[0m04:57:52.894261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__0.25bf74b36d, now test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.b62c18e906)
[0m04:57:52.895217 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.b62c18e906
[0m04:57:52.903852 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.b62c18e906"
[0m04:57:52.906946 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.b62c18e906
[0m04:57:52.913515 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.b62c18e906"
[0m04:57:52.915540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:52.919617 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.b62c18e906: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.b62c18e906"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and published_at >= TIMESTAMP('1900-01-01 00:00:00') and published_at <= TIMESTAMP('2100-12-31 23:59:59')
)
 as expression


    from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_comments`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m04:57:53.944722 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:b62f20bd-f69e-4d28-bfe4-414206ac4b75&page=queryresults
[0m04:57:55.138642 [info ] [Thread-1 (]: 3 of 16 PASS dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_  [[32mPASS[0m in 2.24s]
[0m04:57:55.141379 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.b62c18e906
[0m04:57:55.142573 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING.c294e1d9e9
[0m04:57:55.143551 [info ] [Thread-1 (]: 4 of 16 START test dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING  [RUN]
[0m04:57:55.144793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.b62c18e906, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING.c294e1d9e9)
[0m04:57:55.145679 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING.c294e1d9e9
[0m04:57:55.154288 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:55.971998 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING.c294e1d9e9"
[0m04:57:55.974174 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING.c294e1d9e9
[0m04:57:55.978155 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING.c294e1d9e9"
[0m04:57:55.979802 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING.c294e1d9e9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING.c294e1d9e9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('FACT_COMMENT_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_AUTHOR' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_TEXT' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('LIKE_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'COMMENT_AUTHOR'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:57:56.470500 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:e0217db4-74d5-4c95-8106-46cc466731d2&page=queryresults
[0m04:57:57.695959 [info ] [Thread-1 (]: 4 of 16 PASS dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING  [[32mPASS[0m in 2.55s]
[0m04:57:57.697790 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING.c294e1d9e9
[0m04:57:57.698996 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING.67992e0538
[0m04:57:57.699883 [info ] [Thread-1 (]: 5 of 16 START test dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING  [RUN]
[0m04:57:57.701063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING.c294e1d9e9, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING.67992e0538)
[0m04:57:57.701783 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING.67992e0538
[0m04:57:57.860988 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:59.137217 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING.67992e0538"
[0m04:57:59.140006 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING.67992e0538
[0m04:57:59.146043 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING.67992e0538"
[0m04:57:59.147834 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING.67992e0538: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING.67992e0538"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('FACT_COMMENT_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_AUTHOR' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_TEXT' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('LIKE_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'COMMENT_ID'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:57:59.743349 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:431c0ae8-5e5d-4154-b887-dddb9ccdc378&page=queryresults
[0m04:58:00.973444 [info ] [Thread-1 (]: 5 of 16 PASS dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING  [[32mPASS[0m in 3.27s]
[0m04:58:00.976197 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING.67992e0538
[0m04:58:00.977642 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING.768c2fd511
[0m04:58:00.978607 [info ] [Thread-1 (]: 6 of 16 START test dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING  [RUN]
[0m04:58:00.979707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING.67992e0538, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING.768c2fd511)
[0m04:58:00.980611 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING.768c2fd511
[0m04:58:00.990117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:58:01.796827 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING.768c2fd511"
[0m04:58:01.798679 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING.768c2fd511
[0m04:58:01.802967 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING.768c2fd511"
[0m04:58:01.804268 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING.768c2fd511: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING.768c2fd511"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('FACT_COMMENT_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_AUTHOR' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_TEXT' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('LIKE_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'COMMENT_TEXT'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:58:02.306890 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:d8ed83ea-1a15-42e7-bdaf-03734af7db71&page=queryresults
[0m04:58:03.443326 [info ] [Thread-1 (]: 6 of 16 PASS dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING  [[32mPASS[0m in 2.46s]
[0m04:58:03.446402 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING.768c2fd511
[0m04:58:03.448157 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INT64.8d184bd22e
[0m04:58:03.449165 [info ] [Thread-1 (]: 7 of 16 START test dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INT64  [RUN]
[0m04:58:03.450306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING.768c2fd511, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INT64.8d184bd22e)
[0m04:58:03.451167 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INT64.8d184bd22e
[0m04:58:03.460495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:58:04.251081 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INT64.8d184bd22e"
[0m04:58:04.254545 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INT64.8d184bd22e
[0m04:58:04.263483 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INT64.8d184bd22e"
[0m04:58:04.265561 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INT64.8d184bd22e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INT64.8d184bd22e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('FACT_COMMENT_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_AUTHOR' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_TEXT' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('LIKE_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'LIKE_COUNT'
            and
            relation_column_type not in ('INT64')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:58:04.866294 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:3107fd3b-b320-4d63-b306-65f0b2d5d637&page=queryresults
[0m04:58:06.091695 [info ] [Thread-1 (]: 7 of 16 PASS dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INT64  [[32mPASS[0m in 2.64s]
[0m04:58:06.092901 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INT64.8d184bd22e
[0m04:58:06.093691 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP.d89c440efe
[0m04:58:06.094408 [info ] [Thread-1 (]: 8 of 16 START test dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP  [RUN]
[0m04:58:06.095144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INT64.8d184bd22e, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP.d89c440efe)
[0m04:58:06.095723 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP.d89c440efe
[0m04:58:06.100940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:58:06.884630 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP.d89c440efe"
[0m04:58:06.887118 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP.d89c440efe
[0m04:58:06.891198 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP.d89c440efe"
[0m04:58:06.892806 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP.d89c440efe: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP.d89c440efe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('FACT_COMMENT_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_AUTHOR' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_TEXT' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('LIKE_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'PUBLISHED_AT'
            and
            relation_column_type not in ('TIMESTAMP')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:58:07.321316 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:838cde33-6874-4ac7-9b27-e8a3ac05c112&page=queryresults
[0m04:58:08.656254 [info ] [Thread-1 (]: 8 of 16 PASS dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP  [[32mPASS[0m in 2.56s]
[0m04:58:08.657155 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP.d89c440efe
[0m04:58:08.657833 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING.bf8897ea43
[0m04:58:08.658337 [info ] [Thread-1 (]: 9 of 16 START test dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING  [RUN]
[0m04:58:08.658932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP.d89c440efe, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING.bf8897ea43)
[0m04:58:08.659396 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING.bf8897ea43
[0m04:58:08.663305 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:58:09.478783 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING.bf8897ea43"
[0m04:58:09.482479 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING.bf8897ea43
[0m04:58:09.487340 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING.bf8897ea43"
[0m04:58:09.489445 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING.bf8897ea43: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING.bf8897ea43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('FACT_COMMENT_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_AUTHOR' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_TEXT' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('LIKE_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'VIDEO_ID'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m04:58:09.985490 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:d0021924-0b96-4898-a39d-dd9f81b28d51&page=queryresults
[0m04:58:11.216136 [info ] [Thread-1 (]: 9 of 16 PASS dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING  [[32mPASS[0m in 2.56s]
[0m04:58:11.219046 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING.bf8897ea43
[0m04:58:11.220954 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_fact_video_comments_comment_author.0d82d28fb5
[0m04:58:11.221957 [info ] [Thread-1 (]: 10 of 16 START test not_null_fact_video_comments_comment_author ................ [RUN]
[0m04:58:11.223144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING.bf8897ea43, now test.youtube_project.not_null_fact_video_comments_comment_author.0d82d28fb5)
[0m04:58:11.223970 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_fact_video_comments_comment_author.0d82d28fb5
[0m04:58:11.238099 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_fact_video_comments_comment_author.0d82d28fb5"
[0m04:58:11.240962 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_fact_video_comments_comment_author.0d82d28fb5
[0m04:58:11.251266 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_fact_video_comments_comment_author.0d82d28fb5"
[0m04:58:11.254072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:58:11.258258 [debug] [Thread-1 (]: On test.youtube_project.not_null_fact_video_comments_comment_author.0d82d28fb5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_fact_video_comments_comment_author.0d82d28fb5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select comment_author
from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_comments`
where comment_author is null



      
    ) dbt_internal_test
[0m04:58:12.342947 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:f3f9dbae-12a0-4bd5-80d6-38efe572af37&page=queryresults
[0m04:58:13.490597 [info ] [Thread-1 (]: 10 of 16 PASS not_null_fact_video_comments_comment_author ...................... [[32mPASS[0m in 2.27s]
[0m04:58:13.492260 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_fact_video_comments_comment_author.0d82d28fb5
[0m04:58:13.493474 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_fact_video_comments_comment_id.385f5dce07
[0m04:58:13.494309 [info ] [Thread-1 (]: 11 of 16 START test not_null_fact_video_comments_comment_id .................... [RUN]
[0m04:58:13.495201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_fact_video_comments_comment_author.0d82d28fb5, now test.youtube_project.not_null_fact_video_comments_comment_id.385f5dce07)
[0m04:58:13.495871 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_fact_video_comments_comment_id.385f5dce07
[0m04:58:13.503176 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_fact_video_comments_comment_id.385f5dce07"
[0m04:58:13.505013 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_fact_video_comments_comment_id.385f5dce07
[0m04:58:13.508200 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_fact_video_comments_comment_id.385f5dce07"
[0m04:58:13.509592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:58:13.511587 [debug] [Thread-1 (]: On test.youtube_project.not_null_fact_video_comments_comment_id.385f5dce07: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_fact_video_comments_comment_id.385f5dce07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select comment_id
from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_comments`
where comment_id is null



      
    ) dbt_internal_test
[0m04:58:14.597579 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:f4f07461-48e4-4830-8781-9cbec24f7895&page=queryresults
[0m04:58:15.827032 [info ] [Thread-1 (]: 11 of 16 PASS not_null_fact_video_comments_comment_id .......................... [[32mPASS[0m in 2.33s]
[0m04:58:15.829880 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_fact_video_comments_comment_id.385f5dce07
[0m04:58:15.830862 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_fact_video_comments_comment_text.cbca7f0240
[0m04:58:15.831590 [info ] [Thread-1 (]: 12 of 16 START test not_null_fact_video_comments_comment_text .................. [RUN]
[0m04:58:15.832308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_fact_video_comments_comment_id.385f5dce07, now test.youtube_project.not_null_fact_video_comments_comment_text.cbca7f0240)
[0m04:58:15.833047 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_fact_video_comments_comment_text.cbca7f0240
[0m04:58:15.840131 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_fact_video_comments_comment_text.cbca7f0240"
[0m04:58:15.842160 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_fact_video_comments_comment_text.cbca7f0240
[0m04:58:15.845291 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_fact_video_comments_comment_text.cbca7f0240"
[0m04:58:15.846562 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:58:15.848623 [debug] [Thread-1 (]: On test.youtube_project.not_null_fact_video_comments_comment_text.cbca7f0240: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_fact_video_comments_comment_text.cbca7f0240"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select comment_text
from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_comments`
where comment_text is null



      
    ) dbt_internal_test
[0m04:58:16.849496 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:6a155892-5092-4c62-b5d9-44067424e734&page=queryresults
[0m04:58:18.074731 [info ] [Thread-1 (]: 12 of 16 PASS not_null_fact_video_comments_comment_text ........................ [[32mPASS[0m in 2.24s]
[0m04:58:18.076688 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_fact_video_comments_comment_text.cbca7f0240
[0m04:58:18.077841 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_fact_video_comments_fact_comment_id.c615b514f7
[0m04:58:18.078785 [info ] [Thread-1 (]: 13 of 16 START test not_null_fact_video_comments_fact_comment_id ............... [RUN]
[0m04:58:18.079659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_fact_video_comments_comment_text.cbca7f0240, now test.youtube_project.not_null_fact_video_comments_fact_comment_id.c615b514f7)
[0m04:58:18.080360 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_fact_video_comments_fact_comment_id.c615b514f7
[0m04:58:18.088936 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_fact_video_comments_fact_comment_id.c615b514f7"
[0m04:58:18.090616 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_fact_video_comments_fact_comment_id.c615b514f7
[0m04:58:18.093869 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_fact_video_comments_fact_comment_id.c615b514f7"
[0m04:58:18.094960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:58:18.097237 [debug] [Thread-1 (]: On test.youtube_project.not_null_fact_video_comments_fact_comment_id.c615b514f7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_fact_video_comments_fact_comment_id.c615b514f7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select fact_comment_id
from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_comments`
where fact_comment_id is null



      
    ) dbt_internal_test
[0m04:58:19.201251 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:95388118-71ae-4a3e-8a4d-fb00894fc92f&page=queryresults
[0m04:58:20.436897 [info ] [Thread-1 (]: 13 of 16 PASS not_null_fact_video_comments_fact_comment_id ..................... [[32mPASS[0m in 2.36s]
[0m04:58:20.440846 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_fact_video_comments_fact_comment_id.c615b514f7
[0m04:58:20.442542 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_fact_video_comments_published_at.02f4b08fcb
[0m04:58:20.443752 [info ] [Thread-1 (]: 14 of 16 START test not_null_fact_video_comments_published_at .................. [RUN]
[0m04:58:20.445079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_fact_video_comments_fact_comment_id.c615b514f7, now test.youtube_project.not_null_fact_video_comments_published_at.02f4b08fcb)
[0m04:58:20.446106 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_fact_video_comments_published_at.02f4b08fcb
[0m04:58:20.457094 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_fact_video_comments_published_at.02f4b08fcb"
[0m04:58:20.459232 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_fact_video_comments_published_at.02f4b08fcb
[0m04:58:20.463038 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_fact_video_comments_published_at.02f4b08fcb"
[0m04:58:20.464401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:58:20.468268 [debug] [Thread-1 (]: On test.youtube_project.not_null_fact_video_comments_published_at.02f4b08fcb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_fact_video_comments_published_at.02f4b08fcb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select published_at
from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_comments`
where published_at is null



      
    ) dbt_internal_test
[0m04:58:21.556958 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:5ede0ff3-c0b5-4812-8493-fa554b77bb5f&page=queryresults
[0m04:58:22.788973 [info ] [Thread-1 (]: 14 of 16 PASS not_null_fact_video_comments_published_at ........................ [[32mPASS[0m in 2.34s]
[0m04:58:22.792360 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_fact_video_comments_published_at.02f4b08fcb
[0m04:58:22.794224 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_fact_video_comments_video_id.852ef10814
[0m04:58:22.795267 [info ] [Thread-1 (]: 15 of 16 START test not_null_fact_video_comments_video_id ...................... [RUN]
[0m04:58:22.796501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_fact_video_comments_published_at.02f4b08fcb, now test.youtube_project.not_null_fact_video_comments_video_id.852ef10814)
[0m04:58:22.797456 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_fact_video_comments_video_id.852ef10814
[0m04:58:22.808182 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_fact_video_comments_video_id.852ef10814"
[0m04:58:22.810526 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_fact_video_comments_video_id.852ef10814
[0m04:58:22.817929 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_fact_video_comments_video_id.852ef10814"
[0m04:58:22.820324 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:58:22.826123 [debug] [Thread-1 (]: On test.youtube_project.not_null_fact_video_comments_video_id.852ef10814: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_fact_video_comments_video_id.852ef10814"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select video_id
from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_comments`
where video_id is null



      
    ) dbt_internal_test
[0m04:58:23.808684 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:86a91e73-30c1-456a-86a4-28573f601179&page=queryresults
[0m04:58:24.938702 [info ] [Thread-1 (]: 15 of 16 PASS not_null_fact_video_comments_video_id ............................ [[32mPASS[0m in 2.14s]
[0m04:58:24.941204 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_fact_video_comments_video_id.852ef10814
[0m04:58:24.943454 [debug] [Thread-1 (]: Began running node test.youtube_project.unique_fact_video_comments_fact_comment_id.5d5768bd2c
[0m04:58:24.944502 [info ] [Thread-1 (]: 16 of 16 START test unique_fact_video_comments_fact_comment_id ................. [RUN]
[0m04:58:24.945505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_fact_video_comments_video_id.852ef10814, now test.youtube_project.unique_fact_video_comments_fact_comment_id.5d5768bd2c)
[0m04:58:24.946482 [debug] [Thread-1 (]: Began compiling node test.youtube_project.unique_fact_video_comments_fact_comment_id.5d5768bd2c
[0m04:58:24.958420 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.unique_fact_video_comments_fact_comment_id.5d5768bd2c"
[0m04:58:24.960320 [debug] [Thread-1 (]: Began executing node test.youtube_project.unique_fact_video_comments_fact_comment_id.5d5768bd2c
[0m04:58:24.964189 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.unique_fact_video_comments_fact_comment_id.5d5768bd2c"
[0m04:58:24.965751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:58:24.968397 [debug] [Thread-1 (]: On test.youtube_project.unique_fact_video_comments_fact_comment_id.5d5768bd2c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.unique_fact_video_comments_fact_comment_id.5d5768bd2c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select fact_comment_id as unique_field
  from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_comments`
  where fact_comment_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m04:58:26.163202 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:fe3c4806-9278-4002-916c-41e0408092c2&page=queryresults
[0m04:58:27.291702 [error] [Thread-1 (]: 16 of 16 FAIL 1 unique_fact_video_comments_fact_comment_id ..................... [[31mFAIL 1[0m in 2.35s]
[0m04:58:27.294235 [debug] [Thread-1 (]: Finished running node test.youtube_project.unique_fact_video_comments_fact_comment_id.5d5768bd2c
[0m04:58:27.306709 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:58:27.307646 [debug] [MainThread]: Connection 'test.youtube_project.unique_fact_video_comments_fact_comment_id.5d5768bd2c' was properly closed.
[0m04:58:27.308910 [info ] [MainThread]: 
[0m04:58:27.309932 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 39.88 seconds (39.88s).
[0m04:58:27.321712 [debug] [MainThread]: Command end result
[0m04:58:27.399888 [info ] [MainThread]: 
[0m04:58:27.400539 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:58:27.400970 [info ] [MainThread]: 
[0m04:58:27.401412 [error] [MainThread]: [31mFailure in test unique_fact_video_comments_fact_comment_id (models/youtube_data/marts/schema.yml)[0m
[0m04:58:27.401797 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m04:58:27.402080 [info ] [MainThread]: 
[0m04:58:27.402429 [info ] [MainThread]:   compiled code at target/compiled/youtube_project/models/youtube_data/marts/schema.yml/unique_fact_video_comments_fact_comment_id.sql
[0m04:58:27.402711 [info ] [MainThread]: 
[0m04:58:27.402995 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=1 SKIP=0 TOTAL=16
[0m04:58:27.404903 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 41.208675, "process_in_blocks": "0", "process_kernel_time": 0.3514, "process_mem_max_rss": "227028", "process_out_blocks": "8413", "process_user_time": 4.329936}
[0m04:58:27.405505 [debug] [MainThread]: Command `dbt test` failed at 04:58:27.405384 after 41.21 seconds
[0m04:58:27.405995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8edb9430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff720d5b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f2f9580>]}
[0m04:58:27.406356 [debug] [MainThread]: Flushing usage events
[0m05:03:51.193332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e4a1940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e56a0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f63c290>]}


============================== 05:03:51.194725 | 09d88a4b-ffbe-4054-a5d3-48310f4f5a07 ==============================
[0m05:03:51.194725 [info ] [MainThread]: Running with dbt=1.8.9
[0m05:03:51.195345 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'warn_error': 'None', 'invocation_command': 'dbt run --models youtube_data.marts.fact_video_comments', 'log_path': '/usr/local/airflow/include/dbt/logs', 'use_colors': 'True', 'static_parser': 'True', 'log_format': 'default', 'fail_fast': 'False', 'target_path': 'None', 'no_print': 'None', 'partial_parse': 'True', 'empty': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'printer_width': '80', 'profiles_dir': '/usr/local/airflow/include/dbt', 'version_check': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'debug': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m05:03:51.842539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09d88a4b-ffbe-4054-a5d3-48310f4f5a07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73bc6480>]}
[0m05:03:51.867236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09d88a4b-ffbe-4054-a5d3-48310f4f5a07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72808bc0>]}
[0m05:03:51.867641 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m05:03:51.947149 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m05:03:52.097180 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m05:03:52.098117 [debug] [MainThread]: Partial parsing: updated file: youtube_project://models/youtube_data/marts/schema.yml
[0m05:03:52.098368 [debug] [MainThread]: Partial parsing: updated file: youtube_project://models/youtube_data/marts/fact_video_comments.sql
[0m05:03:52.176636 [error] [MainThread]: Encountered an error:
Compilation Error in model fact_video_comments (models/youtube_data/marts/fact_video_comments.sql)
  
  Warning: `dbt_utils.surrogate_key` has been replaced by `dbt_utils.generate_surrogate_key`. The new macro treats null values differently to empty strings. To restore the behaviour of the original macro, add a global variable in dbt_project.yml called `surrogate_key_treat_nulls_as_empty_strings` to your dbt_project.yml file with a value of True. The youtube_project.fact_video_comments model triggered this warning. 
  
  > in macro default__surrogate_key (macros/sql/surrogate_key.sql)
  > called by macro surrogate_key (macros/sql/surrogate_key.sql)
  > called by model fact_video_comments (models/youtube_data/marts/fact_video_comments.sql)
[0m05:03:52.177630 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0112804, "process_in_blocks": "16", "process_kernel_time": 0.257998, "process_mem_max_rss": "217456", "process_out_blocks": "6", "process_user_time": 2.081123}
[0m05:03:52.177975 [debug] [MainThread]: Command `dbt run` failed at 05:03:52.177913 after 1.01 seconds
[0m05:03:52.178246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e8009b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7167fb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70f73020>]}
[0m05:03:52.178526 [debug] [MainThread]: Flushing usage events
[0m05:04:15.532266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae3a31a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae6c1a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaea93f80>]}


============================== 05:04:15.533573 | e019721c-5738-41cc-bb83-b8fe3545a288 ==============================
[0m05:04:15.533573 [info ] [MainThread]: Running with dbt=1.8.9
[0m05:04:15.533969 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'use_experimental_parser': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'fail_fast': 'False', 'debug': 'False', 'introspect': 'True', 'printer_width': '80', 'target_path': 'None', 'log_cache_events': 'False', 'write_json': 'True', 'empty': 'False', 'use_colors': 'True', 'version_check': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --models youtube_data.marts.fact_video_comments', 'static_parser': 'True', 'indirect_selection': 'eager'}
[0m05:04:16.208484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e019721c-5738-41cc-bb83-b8fe3545a288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf17e480>]}
[0m05:04:16.233370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e019721c-5738-41cc-bb83-b8fe3545a288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff924a0ec0>]}
[0m05:04:16.233800 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m05:04:16.300151 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m05:04:16.429016 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m05:04:16.429933 [debug] [MainThread]: Partial parsing: updated file: youtube_project://models/youtube_data/marts/schema.yml
[0m05:04:16.430194 [debug] [MainThread]: Partial parsing: updated file: youtube_project://models/youtube_data/marts/fact_video_comments.sql
[0m05:04:16.662908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e019721c-5738-41cc-bb83-b8fe3545a288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff908745c0>]}
[0m05:04:16.749131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e019721c-5738-41cc-bb83-b8fe3545a288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90c08050>]}
[0m05:04:16.749531 [info ] [MainThread]: Found 12 models, 137 data tests, 2 sources, 867 macros
[0m05:04:16.749940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e019721c-5738-41cc-bb83-b8fe3545a288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90e741a0>]}
[0m05:04:16.751984 [info ] [MainThread]: 
[0m05:04:16.752441 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m05:04:16.753122 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project'
[0m05:04:16.753446 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:04:17.629141 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project, now list_yt-e2e-data-cycle-project_youtube)
[0m05:04:17.631974 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:04:18.534320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e019721c-5738-41cc-bb83-b8fe3545a288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff909206e0>]}
[0m05:04:18.537030 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:04:18.539093 [info ] [MainThread]: 
[0m05:04:18.548232 [debug] [Thread-1 (]: Began running node model.youtube_project.fact_video_comments
[0m05:04:18.549652 [info ] [Thread-1 (]: 1 of 1 START sql incremental model youtube.fact_video_comments ................. [RUN]
[0m05:04:18.550551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now model.youtube_project.fact_video_comments)
[0m05:04:18.551336 [debug] [Thread-1 (]: Began compiling node model.youtube_project.fact_video_comments
[0m05:04:18.578399 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_project.fact_video_comments"
[0m05:04:18.581017 [debug] [Thread-1 (]: Began executing node model.youtube_project.fact_video_comments
[0m05:04:18.636523 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_project.fact_video_comments"
[0m05:04:18.638474 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:04:18.639674 [debug] [Thread-1 (]: On model.youtube_project.fact_video_comments: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "model.youtube_project.fact_video_comments"} */

  
    

    create or replace table `yt-e2e-data-cycle-project`.`youtube`.`fact_video_comments`
      
    partition by timestamp_trunc(published_at, day)
    

    OPTIONS()
    as (
      WITH comment_data AS (
    SELECT 
        *
    FROM `yt-e2e-data-cycle-project`.`youtube`.`staging_video_comments`  -- Reference to the staging model for raw YouTube comment data
),

comment_filled AS (
    SELECT
        c.comment_id,
        c.video_id,
        c.comment_author,
        
       -- Clean invalid characters from comment_text
        COALESCE(
            REGEXP_REPLACE(c.comment_text, r'[\x00-\x1F\x7F-\x9F\xAD�]', ''), 
            'No Comment Text Available'
        ) AS comment_text,
        
        -- Safely cast like_count to integer
        SAFE_CAST(c.like_count AS INT64) AS like_count,
        
        -- If published_at is missing, set it to the current timestamp
        COALESCE(c.published_at, CURRENT_TIMESTAMP()) AS published_at,

        -- Join the video_id with dim_video to get the corresponding video
        v.video_id AS dim_video_id
    FROM
        comment_data c
    LEFT JOIN 
        `yt-e2e-data-cycle-project`.`youtube`.`dim_videos` v  -- Reference to the dim_video table to get the corresponding video
    ON
        c.video_id = v.video_id
)

SELECT 
    to_hex(md5(cast(coalesce(cast(cf.comment_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(cf.video_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(cf.published_at as string), '_dbt_utils_surrogate_key_null_') as string))) AS fact_comment_id,  -- Surrogate key based on the combination of comment_id, video_id, and published_at
    cf.comment_id,
    cf.video_id, 
    cf.comment_author,
    cf.comment_text,
    cf.like_count,
    cf.published_at
FROM 
    comment_filled cf
    );
  
[0m05:04:19.960137 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:4e4de3e3-5e61-44a6-bfa1-5b3bcdcc5704&page=queryresults
[0m05:04:23.088634 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e019721c-5738-41cc-bb83-b8fe3545a288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91d02f90>]}
[0m05:04:23.096015 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model youtube.fact_video_comments ............ [[32mCREATE TABLE (4.7k rows, 696.1 KiB processed)[0m in 4.53s]
[0m05:04:23.097845 [debug] [Thread-1 (]: Finished running node model.youtube_project.fact_video_comments
[0m05:04:23.101306 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:04:23.101737 [debug] [MainThread]: Connection 'model.youtube_project.fact_video_comments' was properly closed.
[0m05:04:23.102234 [info ] [MainThread]: 
[0m05:04:23.102919 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 6.35 seconds (6.35s).
[0m05:04:23.104471 [debug] [MainThread]: Command end result
[0m05:04:23.318474 [info ] [MainThread]: 
[0m05:04:23.319009 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:04:23.319401 [info ] [MainThread]: 
[0m05:04:23.319776 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:04:23.321175 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.8142247, "process_in_blocks": "0", "process_kernel_time": 0.324725, "process_mem_max_rss": "226080", "process_out_blocks": "8219", "process_user_time": 2.888348}
[0m05:04:23.321585 [debug] [MainThread]: Command `dbt run` succeeded at 05:04:23.321512 after 7.81 seconds
[0m05:04:23.321891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaee92210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaee913a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90643380>]}
[0m05:04:23.322148 [debug] [MainThread]: Flushing usage events
[0m05:04:59.732598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1c289e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb19c8290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1c2b1d0>]}


============================== 05:04:59.733966 | 00e95517-9ece-4743-9657-ed8aa6018a62 ==============================
[0m05:04:59.733966 [info ] [MainThread]: Running with dbt=1.8.9
[0m05:04:59.734553 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt test --models youtube_data.marts.fact_video_comments', 'indirect_selection': 'eager', 'no_print': 'None', 'fail_fast': 'False', 'version_check': 'True', 'introspect': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'printer_width': '80', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'debug': 'False', 'warn_error': 'None', 'static_parser': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'target_path': 'None', 'empty': 'None', 'log_format': 'default', 'use_colors': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'use_experimental_parser': 'False'}
[0m05:05:00.419712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00e95517-9ece-4743-9657-ed8aa6018a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9622e480>]}
[0m05:05:00.447961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00e95517-9ece-4743-9657-ed8aa6018a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94bbeea0>]}
[0m05:05:00.448475 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m05:05:00.520566 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m05:05:00.665082 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:05:00.665593 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:05:00.690346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00e95517-9ece-4743-9657-ed8aa6018a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94ebdf40>]}
[0m05:05:00.798371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00e95517-9ece-4743-9657-ed8aa6018a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff948c5280>]}
[0m05:05:00.799163 [info ] [MainThread]: Found 12 models, 137 data tests, 2 sources, 867 macros
[0m05:05:00.799791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00e95517-9ece-4743-9657-ed8aa6018a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94b6ee40>]}
[0m05:05:00.802492 [info ] [MainThread]: 
[0m05:05:00.803277 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m05:05:00.807239 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project_youtube'
[0m05:05:00.807819 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:05:01.651635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00e95517-9ece-4743-9657-ed8aa6018a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9477d190>]}
[0m05:05:01.655542 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:05:01.656651 [info ] [MainThread]: 
[0m05:05:01.666327 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__0.32d72b6c2e
[0m05:05:01.667930 [info ] [Thread-1 (]: 1 of 17 START test dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__0  [RUN]
[0m05:05:01.669633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__0.32d72b6c2e)
[0m05:05:01.670651 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__0.32d72b6c2e
[0m05:05:01.716821 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__0.32d72b6c2e"
[0m05:05:01.719129 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__0.32d72b6c2e
[0m05:05:01.732027 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__0.32d72b6c2e"
[0m05:05:01.733385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:05:01.735420 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__0.32d72b6c2e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__0.32d72b6c2e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and length(
        comment_author
    ) >= 0 and length(
        comment_author
    ) <= 255
)
 as expression


    from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_comments`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







      
    ) dbt_internal_test
[0m05:05:02.970540 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:047e9902-963c-4417-978b-8785410e276a&page=queryresults
[0m05:05:04.211159 [info ] [Thread-1 (]: 1 of 17 PASS dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__0  [[32mPASS[0m in 2.54s]
[0m05:05:04.214378 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__0.32d72b6c2e
[0m05:05:04.215991 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__0.25bf74b36d
[0m05:05:04.217475 [info ] [Thread-1 (]: 2 of 17 START test dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__0  [RUN]
[0m05:05:04.219056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_author__255__0.32d72b6c2e, now test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__0.25bf74b36d)
[0m05:05:04.220135 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__0.25bf74b36d
[0m05:05:04.233381 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__0.25bf74b36d"
[0m05:05:04.237329 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__0.25bf74b36d
[0m05:05:04.241882 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__0.25bf74b36d"
[0m05:05:04.243662 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:05:04.245950 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__0.25bf74b36d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__0.25bf74b36d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and length(
        comment_text
    ) >= 0
)
 as expression


    from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_comments`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







      
    ) dbt_internal_test
[0m05:05:05.633956 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:6f689e3f-efda-4ceb-913f-49f256d4cd76&page=queryresults
[0m05:05:06.761744 [info ] [Thread-1 (]: 2 of 17 PASS dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__0  [[32mPASS[0m in 2.54s]
[0m05:05:06.765063 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__0.25bf74b36d
[0m05:05:06.767105 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.b62c18e906
[0m05:05:06.768405 [info ] [Thread-1 (]: 3 of 17 START test dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_  [RUN]
[0m05:05:06.769764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_value_lengths_to_be_between_fact_video_comments_comment_text__0.25bf74b36d, now test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.b62c18e906)
[0m05:05:06.770897 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.b62c18e906
[0m05:05:06.801555 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.b62c18e906"
[0m05:05:06.804611 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.b62c18e906
[0m05:05:06.808597 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.b62c18e906"
[0m05:05:06.810202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:05:06.813749 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.b62c18e906: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.b62c18e906"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and published_at >= TIMESTAMP('1900-01-01 00:00:00') and published_at <= TIMESTAMP('2100-12-31 23:59:59')
)
 as expression


    from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_comments`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m05:05:07.984740 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:cd0d6232-b9a0-487a-97ba-bba669e13ad8&page=queryresults
[0m05:05:09.216137 [info ] [Thread-1 (]: 3 of 17 PASS dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_  [[32mPASS[0m in 2.45s]
[0m05:05:09.219308 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.b62c18e906
[0m05:05:09.220826 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING.c294e1d9e9
[0m05:05:09.221955 [info ] [Thread-1 (]: 4 of 17 START test dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING  [RUN]
[0m05:05:09.223118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_comments_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.b62c18e906, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING.c294e1d9e9)
[0m05:05:09.224044 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING.c294e1d9e9
[0m05:05:09.245657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:05:10.148891 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING.c294e1d9e9"
[0m05:05:10.151798 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING.c294e1d9e9
[0m05:05:10.156002 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING.c294e1d9e9"
[0m05:05:10.157537 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING.c294e1d9e9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING.c294e1d9e9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('FACT_COMMENT_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_AUTHOR' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_TEXT' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('LIKE_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'COMMENT_AUTHOR'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m05:05:10.648967 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:897deb5f-13f1-4037-9ce1-8dd8b3400c24&page=queryresults
[0m05:05:11.836136 [info ] [Thread-1 (]: 4 of 17 PASS dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING  [[32mPASS[0m in 2.61s]
[0m05:05:11.838292 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING.c294e1d9e9
[0m05:05:11.839459 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING.67992e0538
[0m05:05:11.840458 [info ] [Thread-1 (]: 5 of 17 START test dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING  [RUN]
[0m05:05:11.841370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_author__STRING.c294e1d9e9, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING.67992e0538)
[0m05:05:11.842060 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING.67992e0538
[0m05:05:11.849373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:05:12.701250 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING.67992e0538"
[0m05:05:12.704029 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING.67992e0538
[0m05:05:12.707418 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING.67992e0538"
[0m05:05:12.708949 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING.67992e0538: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING.67992e0538"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('FACT_COMMENT_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_AUTHOR' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_TEXT' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('LIKE_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'COMMENT_ID'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m05:05:13.307372 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:dea3f5f5-5272-4c73-984a-f87f6a1b4b06&page=queryresults
[0m05:05:14.544025 [info ] [Thread-1 (]: 5 of 17 PASS dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING  [[32mPASS[0m in 2.70s]
[0m05:05:14.547254 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING.67992e0538
[0m05:05:14.549091 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING.768c2fd511
[0m05:05:14.550295 [info ] [Thread-1 (]: 6 of 17 START test dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING  [RUN]
[0m05:05:14.551761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_id__STRING.67992e0538, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING.768c2fd511)
[0m05:05:14.552881 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING.768c2fd511
[0m05:05:14.563903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:05:15.374614 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING.768c2fd511"
[0m05:05:15.377179 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING.768c2fd511
[0m05:05:15.382313 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING.768c2fd511"
[0m05:05:15.384473 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING.768c2fd511: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING.768c2fd511"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('FACT_COMMENT_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_AUTHOR' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_TEXT' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('LIKE_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'COMMENT_TEXT'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m05:05:15.970089 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:2481afef-e3bd-431c-9093-36dcd5fc4a07&page=queryresults
[0m05:05:17.203134 [info ] [Thread-1 (]: 6 of 17 PASS dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING  [[32mPASS[0m in 2.65s]
[0m05:05:17.206065 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING.768c2fd511
[0m05:05:17.208198 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INT64.8d184bd22e
[0m05:05:17.209284 [info ] [Thread-1 (]: 7 of 17 START test dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INT64  [RUN]
[0m05:05:17.210403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_comment_text__STRING.768c2fd511, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INT64.8d184bd22e)
[0m05:05:17.211414 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INT64.8d184bd22e
[0m05:05:17.221366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:05:18.132553 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INT64.8d184bd22e"
[0m05:05:18.135528 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INT64.8d184bd22e
[0m05:05:18.141727 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INT64.8d184bd22e"
[0m05:05:18.143500 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INT64.8d184bd22e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INT64.8d184bd22e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('FACT_COMMENT_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_AUTHOR' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_TEXT' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('LIKE_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'LIKE_COUNT'
            and
            relation_column_type not in ('INT64')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m05:05:18.736924 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:632c15f0-567a-48cb-b7c0-0f8940466617&page=queryresults
[0m05:05:19.970537 [info ] [Thread-1 (]: 7 of 17 PASS dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INT64  [[32mPASS[0m in 2.76s]
[0m05:05:19.974422 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INT64.8d184bd22e
[0m05:05:19.976330 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP.d89c440efe
[0m05:05:19.977736 [info ] [Thread-1 (]: 8 of 17 START test dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP  [RUN]
[0m05:05:19.979960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_like_count__INT64.8d184bd22e, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP.d89c440efe)
[0m05:05:19.981766 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP.d89c440efe
[0m05:05:19.996666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:05:20.893462 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP.d89c440efe"
[0m05:05:20.895128 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP.d89c440efe
[0m05:05:20.900539 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP.d89c440efe"
[0m05:05:20.901863 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP.d89c440efe: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP.d89c440efe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('FACT_COMMENT_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_AUTHOR' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_TEXT' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('LIKE_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'PUBLISHED_AT'
            and
            relation_column_type not in ('TIMESTAMP')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m05:05:21.503685 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:4a99c99c-c534-4369-a452-dd0de2b64397&page=queryresults
[0m05:05:22.633029 [info ] [Thread-1 (]: 8 of 17 PASS dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP  [[32mPASS[0m in 2.65s]
[0m05:05:22.637276 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP.d89c440efe
[0m05:05:22.639105 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING.bf8897ea43
[0m05:05:22.640697 [info ] [Thread-1 (]: 9 of 17 START test dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING  [RUN]
[0m05:05:22.642248 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_published_at__TIMESTAMP.d89c440efe, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING.bf8897ea43)
[0m05:05:22.643248 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING.bf8897ea43
[0m05:05:22.659601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:05:23.455677 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING.bf8897ea43"
[0m05:05:23.459283 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING.bf8897ea43
[0m05:05:23.464415 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING.bf8897ea43"
[0m05:05:23.466249 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING.bf8897ea43: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING.bf8897ea43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('FACT_COMMENT_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_AUTHOR' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_TEXT' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('LIKE_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'VIDEO_ID'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m05:05:24.062204 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:0ed4e067-0bb5-4801-83b5-9c5797cca729&page=queryresults
[0m05:05:25.146513 [info ] [Thread-1 (]: 9 of 17 PASS dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING  [[32mPASS[0m in 2.50s]
[0m05:05:25.147772 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING.bf8897ea43
[0m05:05:25.148481 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_fact_video_comments_comment_author.0d82d28fb5
[0m05:05:25.149086 [info ] [Thread-1 (]: 10 of 17 START test not_null_fact_video_comments_comment_author ................ [RUN]
[0m05:05:25.149725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_comments_video_id__STRING.bf8897ea43, now test.youtube_project.not_null_fact_video_comments_comment_author.0d82d28fb5)
[0m05:05:25.150205 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_fact_video_comments_comment_author.0d82d28fb5
[0m05:05:25.158024 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_fact_video_comments_comment_author.0d82d28fb5"
[0m05:05:25.159671 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_fact_video_comments_comment_author.0d82d28fb5
[0m05:05:25.162790 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_fact_video_comments_comment_author.0d82d28fb5"
[0m05:05:25.163972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:05:25.167343 [debug] [Thread-1 (]: On test.youtube_project.not_null_fact_video_comments_comment_author.0d82d28fb5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_fact_video_comments_comment_author.0d82d28fb5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select comment_author
from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_comments`
where comment_author is null



      
    ) dbt_internal_test
[0m05:05:26.260945 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:81cf046c-6684-43f1-9490-fcb39d1dbaca&page=queryresults
[0m05:05:27.348076 [info ] [Thread-1 (]: 10 of 17 PASS not_null_fact_video_comments_comment_author ...................... [[32mPASS[0m in 2.19s]
[0m05:05:27.353032 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_fact_video_comments_comment_author.0d82d28fb5
[0m05:05:27.357959 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_fact_video_comments_comment_id.385f5dce07
[0m05:05:27.359827 [info ] [Thread-1 (]: 11 of 17 START test not_null_fact_video_comments_comment_id .................... [RUN]
[0m05:05:27.361146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_fact_video_comments_comment_author.0d82d28fb5, now test.youtube_project.not_null_fact_video_comments_comment_id.385f5dce07)
[0m05:05:27.362002 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_fact_video_comments_comment_id.385f5dce07
[0m05:05:27.380378 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_fact_video_comments_comment_id.385f5dce07"
[0m05:05:27.382606 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_fact_video_comments_comment_id.385f5dce07
[0m05:05:27.387340 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_fact_video_comments_comment_id.385f5dce07"
[0m05:05:27.390135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:05:27.395617 [debug] [Thread-1 (]: On test.youtube_project.not_null_fact_video_comments_comment_id.385f5dce07: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_fact_video_comments_comment_id.385f5dce07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select comment_id
from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_comments`
where comment_id is null



      
    ) dbt_internal_test
[0m05:05:28.673831 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:6dc14a1e-f4cc-4ded-90ae-dc64c9bbb5b3&page=queryresults
[0m05:05:29.879124 [info ] [Thread-1 (]: 11 of 17 PASS not_null_fact_video_comments_comment_id .......................... [[32mPASS[0m in 2.52s]
[0m05:05:29.882952 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_fact_video_comments_comment_id.385f5dce07
[0m05:05:29.885344 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_fact_video_comments_comment_text.cbca7f0240
[0m05:05:29.886393 [info ] [Thread-1 (]: 12 of 17 START test not_null_fact_video_comments_comment_text .................. [RUN]
[0m05:05:29.887497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_fact_video_comments_comment_id.385f5dce07, now test.youtube_project.not_null_fact_video_comments_comment_text.cbca7f0240)
[0m05:05:29.888515 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_fact_video_comments_comment_text.cbca7f0240
[0m05:05:29.904920 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_fact_video_comments_comment_text.cbca7f0240"
[0m05:05:29.907213 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_fact_video_comments_comment_text.cbca7f0240
[0m05:05:29.910654 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_fact_video_comments_comment_text.cbca7f0240"
[0m05:05:29.912452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:05:29.915258 [debug] [Thread-1 (]: On test.youtube_project.not_null_fact_video_comments_comment_text.cbca7f0240: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_fact_video_comments_comment_text.cbca7f0240"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select comment_text
from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_comments`
where comment_text is null



      
    ) dbt_internal_test
[0m05:05:31.229745 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:ae9eb7f3-5cb4-4154-aae8-dcedf2e15de1&page=queryresults
[0m05:05:32.338697 [info ] [Thread-1 (]: 12 of 17 PASS not_null_fact_video_comments_comment_text ........................ [[32mPASS[0m in 2.45s]
[0m05:05:32.339996 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_fact_video_comments_comment_text.cbca7f0240
[0m05:05:32.340720 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_fact_video_comments_fact_comment_id.c615b514f7
[0m05:05:32.341249 [info ] [Thread-1 (]: 13 of 17 START test not_null_fact_video_comments_fact_comment_id ............... [RUN]
[0m05:05:32.341874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_fact_video_comments_comment_text.cbca7f0240, now test.youtube_project.not_null_fact_video_comments_fact_comment_id.c615b514f7)
[0m05:05:32.342357 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_fact_video_comments_fact_comment_id.c615b514f7
[0m05:05:32.346935 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_fact_video_comments_fact_comment_id.c615b514f7"
[0m05:05:32.348292 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_fact_video_comments_fact_comment_id.c615b514f7
[0m05:05:32.350779 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_fact_video_comments_fact_comment_id.c615b514f7"
[0m05:05:32.351651 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:05:32.353108 [debug] [Thread-1 (]: On test.youtube_project.not_null_fact_video_comments_fact_comment_id.c615b514f7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_fact_video_comments_fact_comment_id.c615b514f7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select fact_comment_id
from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_comments`
where fact_comment_id is null



      
    ) dbt_internal_test
[0m05:05:33.588186 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:d5d35619-e6b9-43cf-b627-9472adcca85e&page=queryresults
[0m05:05:34.818454 [info ] [Thread-1 (]: 13 of 17 PASS not_null_fact_video_comments_fact_comment_id ..................... [[32mPASS[0m in 2.48s]
[0m05:05:34.822390 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_fact_video_comments_fact_comment_id.c615b514f7
[0m05:05:34.824010 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_fact_video_comments_published_at.02f4b08fcb
[0m05:05:34.825325 [info ] [Thread-1 (]: 14 of 17 START test not_null_fact_video_comments_published_at .................. [RUN]
[0m05:05:34.826728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_fact_video_comments_fact_comment_id.c615b514f7, now test.youtube_project.not_null_fact_video_comments_published_at.02f4b08fcb)
[0m05:05:34.827764 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_fact_video_comments_published_at.02f4b08fcb
[0m05:05:34.841908 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_fact_video_comments_published_at.02f4b08fcb"
[0m05:05:34.843812 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_fact_video_comments_published_at.02f4b08fcb
[0m05:05:34.847708 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_fact_video_comments_published_at.02f4b08fcb"
[0m05:05:34.849234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:05:34.852745 [debug] [Thread-1 (]: On test.youtube_project.not_null_fact_video_comments_published_at.02f4b08fcb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_fact_video_comments_published_at.02f4b08fcb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select published_at
from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_comments`
where published_at is null



      
    ) dbt_internal_test
[0m05:05:36.145685 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:2b99fba2-64a9-4a30-b032-973cc9d533d0&page=queryresults
[0m05:05:37.374903 [info ] [Thread-1 (]: 14 of 17 PASS not_null_fact_video_comments_published_at ........................ [[32mPASS[0m in 2.55s]
[0m05:05:37.378379 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_fact_video_comments_published_at.02f4b08fcb
[0m05:05:37.379817 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_fact_video_comments_video_id.852ef10814
[0m05:05:37.380848 [info ] [Thread-1 (]: 15 of 17 START test not_null_fact_video_comments_video_id ...................... [RUN]
[0m05:05:37.381973 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_fact_video_comments_published_at.02f4b08fcb, now test.youtube_project.not_null_fact_video_comments_video_id.852ef10814)
[0m05:05:37.382863 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_fact_video_comments_video_id.852ef10814
[0m05:05:37.391130 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_fact_video_comments_video_id.852ef10814"
[0m05:05:37.393203 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_fact_video_comments_video_id.852ef10814
[0m05:05:37.401119 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_fact_video_comments_video_id.852ef10814"
[0m05:05:37.402697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:05:37.405142 [debug] [Thread-1 (]: On test.youtube_project.not_null_fact_video_comments_video_id.852ef10814: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_fact_video_comments_video_id.852ef10814"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select video_id
from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_comments`
where video_id is null



      
    ) dbt_internal_test
[0m05:05:38.704031 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:a81bd5d8-2386-40f3-bd1d-4eff6fec4e61&page=queryresults
[0m05:05:39.934530 [info ] [Thread-1 (]: 15 of 17 PASS not_null_fact_video_comments_video_id ............................ [[32mPASS[0m in 2.55s]
[0m05:05:39.937498 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_fact_video_comments_video_id.852ef10814
[0m05:05:39.940093 [debug] [Thread-1 (]: Began running node test.youtube_project.unique_fact_video_comments_comment_id.44d685a867
[0m05:05:39.941563 [info ] [Thread-1 (]: 16 of 17 START test unique_fact_video_comments_comment_id ...................... [RUN]
[0m05:05:39.942885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_fact_video_comments_video_id.852ef10814, now test.youtube_project.unique_fact_video_comments_comment_id.44d685a867)
[0m05:05:39.943826 [debug] [Thread-1 (]: Began compiling node test.youtube_project.unique_fact_video_comments_comment_id.44d685a867
[0m05:05:39.956496 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.unique_fact_video_comments_comment_id.44d685a867"
[0m05:05:39.958920 [debug] [Thread-1 (]: Began executing node test.youtube_project.unique_fact_video_comments_comment_id.44d685a867
[0m05:05:39.963157 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.unique_fact_video_comments_comment_id.44d685a867"
[0m05:05:39.964666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:05:39.967755 [debug] [Thread-1 (]: On test.youtube_project.unique_fact_video_comments_comment_id.44d685a867: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.unique_fact_video_comments_comment_id.44d685a867"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select comment_id as unique_field
  from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_comments`
  where comment_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m05:05:41.174060 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:de83c10c-8435-4524-b787-3681f5009879&page=queryresults
[0m05:05:42.393988 [info ] [Thread-1 (]: 16 of 17 PASS unique_fact_video_comments_comment_id ............................ [[32mPASS[0m in 2.45s]
[0m05:05:42.396656 [debug] [Thread-1 (]: Finished running node test.youtube_project.unique_fact_video_comments_comment_id.44d685a867
[0m05:05:42.398187 [debug] [Thread-1 (]: Began running node test.youtube_project.unique_fact_video_comments_fact_comment_id.5d5768bd2c
[0m05:05:42.399455 [info ] [Thread-1 (]: 17 of 17 START test unique_fact_video_comments_fact_comment_id ................. [RUN]
[0m05:05:42.400722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.unique_fact_video_comments_comment_id.44d685a867, now test.youtube_project.unique_fact_video_comments_fact_comment_id.5d5768bd2c)
[0m05:05:42.401692 [debug] [Thread-1 (]: Began compiling node test.youtube_project.unique_fact_video_comments_fact_comment_id.5d5768bd2c
[0m05:05:42.414753 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.unique_fact_video_comments_fact_comment_id.5d5768bd2c"
[0m05:05:42.418014 [debug] [Thread-1 (]: Began executing node test.youtube_project.unique_fact_video_comments_fact_comment_id.5d5768bd2c
[0m05:05:42.423158 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.unique_fact_video_comments_fact_comment_id.5d5768bd2c"
[0m05:05:42.424870 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:05:42.427786 [debug] [Thread-1 (]: On test.youtube_project.unique_fact_video_comments_fact_comment_id.5d5768bd2c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.unique_fact_video_comments_fact_comment_id.5d5768bd2c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select fact_comment_id as unique_field
  from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_comments`
  where fact_comment_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m05:05:44.033874 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:5c7d2274-688d-40ee-a010-eb197a93a536&page=queryresults
[0m05:05:45.151956 [info ] [Thread-1 (]: 17 of 17 PASS unique_fact_video_comments_fact_comment_id ....................... [[32mPASS[0m in 2.75s]
[0m05:05:45.155099 [debug] [Thread-1 (]: Finished running node test.youtube_project.unique_fact_video_comments_fact_comment_id.5d5768bd2c
[0m05:05:45.162253 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:05:45.163257 [debug] [MainThread]: Connection 'test.youtube_project.unique_fact_video_comments_fact_comment_id.5d5768bd2c' was properly closed.
[0m05:05:45.164454 [info ] [MainThread]: 
[0m05:05:45.165955 [info ] [MainThread]: Finished running 17 data tests in 0 hours 0 minutes and 44.36 seconds (44.36s).
[0m05:05:45.177988 [debug] [MainThread]: Command end result
[0m05:05:45.264139 [info ] [MainThread]: 
[0m05:05:45.264732 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:05:45.265252 [info ] [MainThread]: 
[0m05:05:45.265923 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m05:05:45.268316 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 45.56333, "process_in_blocks": "0", "process_kernel_time": 0.390896, "process_mem_max_rss": "223096", "process_out_blocks": "5922", "process_user_time": 4.279711}
[0m05:05:45.269161 [debug] [MainThread]: Command `dbt test` succeeded at 05:05:45.269031 after 45.56 seconds
[0m05:05:45.269993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1e06ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb596b050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb596b080>]}
[0m05:05:45.270609 [debug] [MainThread]: Flushing usage events
[0m05:07:32.765421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e121220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e123320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e5033e0>]}


============================== 05:07:32.766619 | 0c5d1c3d-bbd8-4063-9759-af8f37a55975 ==============================
[0m05:07:32.766619 [info ] [MainThread]: Running with dbt=1.8.9
[0m05:07:32.767009 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'introspect': 'True', 'empty': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --models youtube_data.marts.fact_video_metrics', 'quiet': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'log_format': 'default', 'profiles_dir': '/usr/local/airflow/include/dbt', 'version_check': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'use_colors': 'True', 'fail_fast': 'False', 'no_print': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'write_json': 'True'}
[0m05:07:33.431694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c5d1c3d-bbd8-4063-9759-af8f37a55975', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71ad7950>]}
[0m05:07:33.456558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c5d1c3d-bbd8-4063-9759-af8f37a55975', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7391f530>]}
[0m05:07:33.456954 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m05:07:33.522164 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m05:07:33.647347 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:07:33.648092 [debug] [MainThread]: Partial parsing: updated file: youtube_project://models/youtube_data/marts/fact_video_metrics.sql
[0m05:07:33.876259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c5d1c3d-bbd8-4063-9759-af8f37a55975', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70e7fa70>]}
[0m05:07:33.961057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c5d1c3d-bbd8-4063-9759-af8f37a55975', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff716835f0>]}
[0m05:07:33.961477 [info ] [MainThread]: Found 12 models, 137 data tests, 2 sources, 867 macros
[0m05:07:33.961760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c5d1c3d-bbd8-4063-9759-af8f37a55975', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e0f3b60>]}
[0m05:07:33.963637 [info ] [MainThread]: 
[0m05:07:33.964108 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m05:07:33.964831 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project'
[0m05:07:33.965110 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:07:34.943719 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project, now list_yt-e2e-data-cycle-project_youtube)
[0m05:07:34.944838 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:07:35.758094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c5d1c3d-bbd8-4063-9759-af8f37a55975', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70ff2d20>]}
[0m05:07:35.759816 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:07:35.761091 [info ] [MainThread]: 
[0m05:07:35.767006 [debug] [Thread-1 (]: Began running node model.youtube_project.fact_video_metrics
[0m05:07:35.768268 [info ] [Thread-1 (]: 1 of 1 START sql incremental model youtube.fact_video_metrics .................. [RUN]
[0m05:07:35.769165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now model.youtube_project.fact_video_metrics)
[0m05:07:35.769902 [debug] [Thread-1 (]: Began compiling node model.youtube_project.fact_video_metrics
[0m05:07:35.784954 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_project.fact_video_metrics"
[0m05:07:35.788987 [debug] [Thread-1 (]: Began executing node model.youtube_project.fact_video_metrics
[0m05:07:35.849420 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_project.fact_video_metrics"
[0m05:07:35.851722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:07:35.852982 [debug] [Thread-1 (]: On model.youtube_project.fact_video_metrics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "model.youtube_project.fact_video_metrics"} */

  
    

    create or replace table `yt-e2e-data-cycle-project`.`youtube`.`fact_video_metrics`
      
    partition by timestamp_trunc(published_at, day)
    

    OPTIONS()
    as (
      WITH video_metrics_data AS (
    SELECT
        *
    FROM `yt-e2e-data-cycle-project`.`youtube`.`staging_video_metrics`  -- Reference to the staging table for video metrics
),

metrics_filled AS (
    SELECT
        vmd.video_id,
        vmd.region_code,
        vmd.view_count, 
        vmd.like_count, 
        vmd.comment_count, 
        
        -- Use COALESCE to fill in missing values for published_at
        COALESCE(vmd.published_at, CURRENT_TIMESTAMP()) AS published_at,
        
        -- Join with dim_video to get the corresponding video details
        dv.video_id AS dim_video_id,
        
        -- Join with dim_region to get the corresponding region details
        dr.region_code AS dim_region_code
    FROM
        video_metrics_data vmd
    LEFT JOIN `yt-e2e-data-cycle-project`.`youtube`.`dim_videos` dv  -- Reference to the dim_video table to get the corresponding video
        ON vmd.video_id = dv.video_id  -- Join condition for dim_videos
    LEFT JOIN `yt-e2e-data-cycle-project`.`youtube`.`dim_regions` dr  -- Reference to the dim_region table to get the corresponding region
        ON vmd.region_code = dr.region_code  -- Join condition for dim_regions
)

SELECT 
    -- Generate unique fact ID for each record
    ROW_NUMBER() OVER (PARTITION BY mf.video_id, mf.region_code ORDER BY mf.published_at) AS fact_video_id,
    mf.video_id,
    mf.region_code,
    mf.view_count,
    mf.like_count,
    mf.comment_count,
    mf.published_at
FROM 
    metrics_filled mf
    );
  
[0m05:07:37.030289 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:2907ce1f-fbaf-4f2c-9611-3bdf0f8f1b05&page=queryresults
[0m05:07:40.692810 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c5d1c3d-bbd8-4063-9759-af8f37a55975', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72404680>]}
[0m05:07:40.694652 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model youtube.fact_video_metrics ............. [[32mCREATE TABLE (100.0 rows, 6.1 KiB processed)[0m in 4.92s]
[0m05:07:40.696118 [debug] [Thread-1 (]: Finished running node model.youtube_project.fact_video_metrics
[0m05:07:40.698619 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:07:40.699103 [debug] [MainThread]: Connection 'model.youtube_project.fact_video_metrics' was properly closed.
[0m05:07:40.699716 [info ] [MainThread]: 
[0m05:07:40.700385 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 6.74 seconds (6.74s).
[0m05:07:40.701878 [debug] [MainThread]: Command end result
[0m05:07:40.838671 [info ] [MainThread]: 
[0m05:07:40.839080 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:07:40.839423 [info ] [MainThread]: 
[0m05:07:40.839781 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:07:40.840668 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.101413, "process_in_blocks": "0", "process_kernel_time": 0.293788, "process_mem_max_rss": "226316", "process_out_blocks": "8217", "process_user_time": 2.727603}
[0m05:07:40.841009 [debug] [MainThread]: Command `dbt run` succeeded at 05:07:40.840947 after 8.10 seconds
[0m05:07:40.841253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff707a6e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff707a6cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff707a6ba0>]}
[0m05:07:40.841464 [debug] [MainThread]: Flushing usage events
[0m05:08:39.345895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6429280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa63a6cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8e023f0>]}


============================== 05:08:39.347391 | 5ead62a8-7de6-4681-b2d5-3e477e5843f5 ==============================
[0m05:08:39.347391 [info ] [MainThread]: Running with dbt=1.8.9
[0m05:08:39.347820 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'introspect': 'True', 'static_parser': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'debug': 'False', 'target_path': 'None', 'warn_error': 'None', 'log_cache_events': 'False', 'log_format': 'default', 'write_json': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'cache_selected_only': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'quiet': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'invocation_command': 'dbt test --models youtube_data.marts.fact_video_metrics', 'empty': 'None', 'partial_parse': 'True'}
[0m05:08:39.974891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ead62a8-7de6-4681-b2d5-3e477e5843f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89c32810>]}
[0m05:08:40.003278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ead62a8-7de6-4681-b2d5-3e477e5843f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89b36cf0>]}
[0m05:08:40.003937 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m05:08:40.069540 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m05:08:40.192268 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:08:40.192627 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:08:40.215043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ead62a8-7de6-4681-b2d5-3e477e5843f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89bd4c20>]}
[0m05:08:40.307527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ead62a8-7de6-4681-b2d5-3e477e5843f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89074e30>]}
[0m05:08:40.307885 [info ] [MainThread]: Found 12 models, 137 data tests, 2 sources, 867 macros
[0m05:08:40.308242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ead62a8-7de6-4681-b2d5-3e477e5843f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89948440>]}
[0m05:08:40.310393 [info ] [MainThread]: 
[0m05:08:40.310855 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m05:08:40.313308 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project_youtube'
[0m05:08:40.313639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:08:41.190921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ead62a8-7de6-4681-b2d5-3e477e5843f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89880b00>]}
[0m05:08:41.192221 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:08:41.193245 [info ] [MainThread]: 
[0m05:08:41.198764 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_metrics_published_at__2100_12_31__1900_01_01.3c852280c7
[0m05:08:41.199770 [info ] [Thread-1 (]: 1 of 18 START test dbt_expectations_expect_column_values_to_be_between_fact_video_metrics_published_at__2100_12_31__1900_01_01  [RUN]
[0m05:08:41.200697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_metrics_published_at__2100_12_31__1900_01_01.3c852280c7)
[0m05:08:41.201381 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_metrics_published_at__2100_12_31__1900_01_01.3c852280c7
[0m05:08:41.237771 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_metrics_published_at__2100_12_31__1900_01_01.3c852280c7"
[0m05:08:41.239688 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_metrics_published_at__2100_12_31__1900_01_01.3c852280c7
[0m05:08:41.256521 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_metrics_published_at__2100_12_31__1900_01_01.3c852280c7"
[0m05:08:41.257972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:08:41.259297 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_metrics_published_at__2100_12_31__1900_01_01.3c852280c7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_metrics_published_at__2100_12_31__1900_01_01.3c852280c7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and published_at >= 1900-01-01 and published_at <= 2100-12-31
)
 as expression


    from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_metrics`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m05:08:42.516556 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:9c1e062d-9810-439d-b3b5-4d81cb41055d&page=queryresults
[0m05:08:42.518716 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for operator >= for argument types: TIMESTAMP, INT64. Supported signature: ANY >= ANY at [20:11]; reason: invalidQuery, location: query, message: No matching signature for operator >= for argument types: TIMESTAMP, INT64. Supported signature: ANY >= ANY at [20:11]')
[0m05:08:43.949390 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:276bb637-5e1b-4390-90d6-8124cd75f795&page=queryresults
[0m05:08:43.951889 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:276bb637-5e1b-4390-90d6-8124cd75f795&page=queryresults
[0m05:08:43.963796 [debug] [Thread-1 (]: Database Error in test dbt_expectations_expect_column_values_to_be_between_fact_video_metrics_published_at__2100_12_31__1900_01_01 (models/youtube_data/marts/schema.yml)
  No matching signature for operator >= for argument types: TIMESTAMP, INT64. Supported signature: ANY >= ANY at [20:11]
  compiled code at target/run/youtube_project/models/youtube_data/marts/schema.yml/dbt_expectations_expect_column_bdf479113831ae5b8192f7c829611f50.sql
[0m05:08:43.965159 [error] [Thread-1 (]: 1 of 18 ERROR dbt_expectations_expect_column_values_to_be_between_fact_video_metrics_published_at__2100_12_31__1900_01_01  [[31mERROR[0m in 2.76s]
[0m05:08:43.966505 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_metrics_published_at__2100_12_31__1900_01_01.3c852280c7
[0m05:08:43.967512 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_comment_count__0.160decec9b
[0m05:08:43.969658 [info ] [Thread-1 (]: 2 of 18 START test dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_comment_count__0  [RUN]
[0m05:08:43.972146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_metrics_published_at__2100_12_31__1900_01_01.3c852280c7, now test.youtube_project.dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_comment_count__0.160decec9b)
[0m05:08:43.973394 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_comment_count__0.160decec9b
[0m05:08:43.989945 [debug] [Thread-1 (]: Compilation Error in test dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_comment_count__0 (models/youtube_data/marts/schema.yml)
  'dict object' has no attribute 'test_expect_column_values_to_be_greater_than'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m05:08:43.991077 [error] [Thread-1 (]: 2 of 18 ERROR dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_comment_count__0  [[31mERROR[0m in 0.02s]
[0m05:08:43.991917 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_comment_count__0.160decec9b
[0m05:08:43.992495 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_like_count__0.65d8859b10
[0m05:08:43.992988 [info ] [Thread-1 (]: 3 of 18 START test dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_like_count__0  [RUN]
[0m05:08:43.993668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_comment_count__0.160decec9b, now test.youtube_project.dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_like_count__0.65d8859b10)
[0m05:08:43.994173 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_like_count__0.65d8859b10
[0m05:08:44.000152 [debug] [Thread-1 (]: Compilation Error in test dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_like_count__0 (models/youtube_data/marts/schema.yml)
  'dict object' has no attribute 'test_expect_column_values_to_be_greater_than'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m05:08:44.001121 [error] [Thread-1 (]: 3 of 18 ERROR dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_like_count__0  [[31mERROR[0m in 0.01s]
[0m05:08:44.001911 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_like_count__0.65d8859b10
[0m05:08:44.002666 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_view_count__0.2667080168
[0m05:08:44.003178 [info ] [Thread-1 (]: 4 of 18 START test dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_view_count__0  [RUN]
[0m05:08:44.003710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_like_count__0.65d8859b10, now test.youtube_project.dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_view_count__0.2667080168)
[0m05:08:44.004244 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_view_count__0.2667080168
[0m05:08:44.009184 [debug] [Thread-1 (]: Compilation Error in test dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_view_count__0 (models/youtube_data/marts/schema.yml)
  'dict object' has no attribute 'test_expect_column_values_to_be_greater_than'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m05:08:44.009736 [error] [Thread-1 (]: 4 of 18 ERROR dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_view_count__0  [[31mERROR[0m in 0.01s]
[0m05:08:44.010313 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_view_count__0.2667080168
[0m05:08:44.010830 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_comment_count__INT64.1fa9eb6b79
[0m05:08:44.011267 [info ] [Thread-1 (]: 5 of 18 START test dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_comment_count__INT64  [RUN]
[0m05:08:44.011738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_view_count__0.2667080168, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_comment_count__INT64.1fa9eb6b79)
[0m05:08:44.012163 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_comment_count__INT64.1fa9eb6b79
[0m05:08:44.020767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:08:44.993777 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_comment_count__INT64.1fa9eb6b79"
[0m05:08:44.996893 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_comment_count__INT64.1fa9eb6b79
[0m05:08:45.003520 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_comment_count__INT64.1fa9eb6b79"
[0m05:08:45.005600 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_comment_count__INT64.1fa9eb6b79: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_comment_count__INT64.1fa9eb6b79"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('FACT_VIDEO_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('REGION_CODE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIEW_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('LIKE_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'COMMENT_COUNT'
            and
            relation_column_type not in ('INT64')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m05:08:45.511005 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:7ed839c6-fe20-475c-a8d4-18ad04deccf3&page=queryresults
[0m05:08:46.726472 [info ] [Thread-1 (]: 5 of 18 PASS dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_comment_count__INT64  [[32mPASS[0m in 2.71s]
[0m05:08:46.728515 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_comment_count__INT64.1fa9eb6b79
[0m05:08:46.729868 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_like_count__INT64.c4ebcf4945
[0m05:08:46.731233 [info ] [Thread-1 (]: 6 of 18 START test dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_like_count__INT64  [RUN]
[0m05:08:46.732312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_comment_count__INT64.1fa9eb6b79, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_like_count__INT64.c4ebcf4945)
[0m05:08:46.733282 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_like_count__INT64.c4ebcf4945
[0m05:08:46.745073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:08:47.540881 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_like_count__INT64.c4ebcf4945"
[0m05:08:47.543634 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_like_count__INT64.c4ebcf4945
[0m05:08:47.548613 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_like_count__INT64.c4ebcf4945"
[0m05:08:47.550947 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_like_count__INT64.c4ebcf4945: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_like_count__INT64.c4ebcf4945"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('FACT_VIDEO_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('REGION_CODE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIEW_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('LIKE_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'LIKE_COUNT'
            and
            relation_column_type not in ('INT64')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m05:08:48.148835 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:c6f58be0-222c-4b3e-86f1-d7d51a2d9d4c&page=queryresults
[0m05:08:49.380593 [info ] [Thread-1 (]: 6 of 18 PASS dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_like_count__INT64  [[32mPASS[0m in 2.64s]
[0m05:08:49.384115 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_like_count__INT64.c4ebcf4945
[0m05:08:49.385669 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_published_at__TIMESTAMP.7fe1f661cb
[0m05:08:49.386261 [info ] [Thread-1 (]: 7 of 18 START test dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_published_at__TIMESTAMP  [RUN]
[0m05:08:49.386898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_like_count__INT64.c4ebcf4945, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_published_at__TIMESTAMP.7fe1f661cb)
[0m05:08:49.387897 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_published_at__TIMESTAMP.7fe1f661cb
[0m05:08:49.397491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:08:50.201450 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_published_at__TIMESTAMP.7fe1f661cb"
[0m05:08:50.205694 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_published_at__TIMESTAMP.7fe1f661cb
[0m05:08:50.211592 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_published_at__TIMESTAMP.7fe1f661cb"
[0m05:08:50.213790 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_published_at__TIMESTAMP.7fe1f661cb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_published_at__TIMESTAMP.7fe1f661cb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('FACT_VIDEO_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('REGION_CODE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIEW_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('LIKE_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'PUBLISHED_AT'
            and
            relation_column_type not in ('TIMESTAMP')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m05:08:50.809860 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:453782ed-6b34-41cf-af07-92b75f3b58e6&page=queryresults
[0m05:08:51.955942 [info ] [Thread-1 (]: 7 of 18 PASS dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_published_at__TIMESTAMP  [[32mPASS[0m in 2.57s]
[0m05:08:51.956842 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_published_at__TIMESTAMP.7fe1f661cb
[0m05:08:51.957444 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_region_code__STRING.2e2ff280d9
[0m05:08:51.957978 [info ] [Thread-1 (]: 8 of 18 START test dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_region_code__STRING  [RUN]
[0m05:08:51.958538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_published_at__TIMESTAMP.7fe1f661cb, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_region_code__STRING.2e2ff280d9)
[0m05:08:51.958964 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_region_code__STRING.2e2ff280d9
[0m05:08:51.965406 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:08:52.761743 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_region_code__STRING.2e2ff280d9"
[0m05:08:52.764337 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_region_code__STRING.2e2ff280d9
[0m05:08:52.769248 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_region_code__STRING.2e2ff280d9"
[0m05:08:52.771395 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_region_code__STRING.2e2ff280d9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_region_code__STRING.2e2ff280d9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('FACT_VIDEO_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('REGION_CODE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIEW_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('LIKE_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'REGION_CODE'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m05:08:53.369532 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:d5615adc-c865-4e75-9287-1166c695370b&page=queryresults
[0m05:08:54.598794 [info ] [Thread-1 (]: 8 of 18 PASS dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_region_code__STRING  [[32mPASS[0m in 2.64s]
[0m05:08:54.601201 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_region_code__STRING.2e2ff280d9
[0m05:08:54.602846 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_video_id__STRING.065a6b3e3b
[0m05:08:54.603977 [info ] [Thread-1 (]: 9 of 18 START test dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_video_id__STRING  [RUN]
[0m05:08:54.605773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_region_code__STRING.2e2ff280d9, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_video_id__STRING.065a6b3e3b)
[0m05:08:54.606813 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_video_id__STRING.065a6b3e3b
[0m05:08:54.614694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:08:55.426182 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_video_id__STRING.065a6b3e3b"
[0m05:08:55.429290 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_video_id__STRING.065a6b3e3b
[0m05:08:55.434384 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_video_id__STRING.065a6b3e3b"
[0m05:08:55.436509 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_video_id__STRING.065a6b3e3b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_video_id__STRING.065a6b3e3b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('FACT_VIDEO_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('REGION_CODE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIEW_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('LIKE_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'VIDEO_ID'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m05:08:56.029530 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:c07b7ba9-c966-4499-814b-73260264bf69&page=queryresults
[0m05:08:57.264351 [info ] [Thread-1 (]: 9 of 18 PASS dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_video_id__STRING  [[32mPASS[0m in 2.66s]
[0m05:08:57.267241 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_video_id__STRING.065a6b3e3b
[0m05:08:57.268235 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_view_count__INT64.4054ccb7f8
[0m05:08:57.268987 [info ] [Thread-1 (]: 10 of 18 START test dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_view_count__INT64  [RUN]
[0m05:08:57.270464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_video_id__STRING.065a6b3e3b, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_view_count__INT64.4054ccb7f8)
[0m05:08:57.271212 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_view_count__INT64.4054ccb7f8
[0m05:08:57.281185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:08:58.093835 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_view_count__INT64.4054ccb7f8"
[0m05:08:58.097008 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_view_count__INT64.4054ccb7f8
[0m05:08:58.106492 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_view_count__INT64.4054ccb7f8"
[0m05:08:58.109379 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_view_count__INT64.4054ccb7f8: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_view_count__INT64.4054ccb7f8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('FACT_VIDEO_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('REGION_CODE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIEW_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('LIKE_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'VIEW_COUNT'
            and
            relation_column_type not in ('INT64')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m05:08:58.696425 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:23193b30-de1f-4467-bdd7-4404b4322bb0&page=queryresults
[0m05:08:59.821387 [info ] [Thread-1 (]: 10 of 18 PASS dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_view_count__INT64  [[32mPASS[0m in 2.55s]
[0m05:08:59.824511 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_view_count__INT64.4054ccb7f8
[0m05:08:59.826629 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_fact_video_metrics_comment_count.c76bd6c0f5
[0m05:08:59.827832 [info ] [Thread-1 (]: 11 of 18 START test not_null_fact_video_metrics_comment_count .................. [RUN]
[0m05:08:59.828904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_view_count__INT64.4054ccb7f8, now test.youtube_project.not_null_fact_video_metrics_comment_count.c76bd6c0f5)
[0m05:08:59.830058 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_fact_video_metrics_comment_count.c76bd6c0f5
[0m05:08:59.841765 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_fact_video_metrics_comment_count.c76bd6c0f5"
[0m05:08:59.843818 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_fact_video_metrics_comment_count.c76bd6c0f5
[0m05:08:59.847730 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_fact_video_metrics_comment_count.c76bd6c0f5"
[0m05:08:59.849362 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:08:59.851775 [debug] [Thread-1 (]: On test.youtube_project.not_null_fact_video_metrics_comment_count.c76bd6c0f5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_fact_video_metrics_comment_count.c76bd6c0f5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select comment_count
from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_metrics`
where comment_count is null



      
    ) dbt_internal_test
[0m05:09:01.053141 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:b5268cec-d12d-41a5-a3b1-3b3e2d342495&page=queryresults
[0m05:09:02.073808 [info ] [Thread-1 (]: 11 of 18 PASS not_null_fact_video_metrics_comment_count ........................ [[32mPASS[0m in 2.24s]
[0m05:09:02.076755 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_fact_video_metrics_comment_count.c76bd6c0f5
[0m05:09:02.079492 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_fact_video_metrics_fact_video_id.15e13bac2f
[0m05:09:02.080753 [info ] [Thread-1 (]: 12 of 18 START test not_null_fact_video_metrics_fact_video_id .................. [RUN]
[0m05:09:02.081869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_fact_video_metrics_comment_count.c76bd6c0f5, now test.youtube_project.not_null_fact_video_metrics_fact_video_id.15e13bac2f)
[0m05:09:02.082882 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_fact_video_metrics_fact_video_id.15e13bac2f
[0m05:09:02.091306 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_fact_video_metrics_fact_video_id.15e13bac2f"
[0m05:09:02.094240 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_fact_video_metrics_fact_video_id.15e13bac2f
[0m05:09:02.098055 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_fact_video_metrics_fact_video_id.15e13bac2f"
[0m05:09:02.099766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:09:02.102638 [debug] [Thread-1 (]: On test.youtube_project.not_null_fact_video_metrics_fact_video_id.15e13bac2f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_fact_video_metrics_fact_video_id.15e13bac2f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select fact_video_id
from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_metrics`
where fact_video_id is null



      
    ) dbt_internal_test
[0m05:09:03.504809 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:55a641a4-c1a2-4350-bdef-4afb8b8cb51d&page=queryresults
[0m05:09:04.637968 [info ] [Thread-1 (]: 12 of 18 PASS not_null_fact_video_metrics_fact_video_id ........................ [[32mPASS[0m in 2.55s]
[0m05:09:04.641273 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_fact_video_metrics_fact_video_id.15e13bac2f
[0m05:09:04.642668 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_fact_video_metrics_like_count.6aaf587688
[0m05:09:04.643772 [info ] [Thread-1 (]: 13 of 18 START test not_null_fact_video_metrics_like_count ..................... [RUN]
[0m05:09:04.644885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_fact_video_metrics_fact_video_id.15e13bac2f, now test.youtube_project.not_null_fact_video_metrics_like_count.6aaf587688)
[0m05:09:04.645633 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_fact_video_metrics_like_count.6aaf587688
[0m05:09:04.656687 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_fact_video_metrics_like_count.6aaf587688"
[0m05:09:04.658581 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_fact_video_metrics_like_count.6aaf587688
[0m05:09:04.662622 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_fact_video_metrics_like_count.6aaf587688"
[0m05:09:04.664423 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:09:04.666541 [debug] [Thread-1 (]: On test.youtube_project.not_null_fact_video_metrics_like_count.6aaf587688: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_fact_video_metrics_like_count.6aaf587688"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select like_count
from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_metrics`
where like_count is null



      
    ) dbt_internal_test
[0m05:09:05.964314 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:6f589401-581b-4bf5-8b96-9dca3946f4db&page=queryresults
[0m05:09:07.067374 [info ] [Thread-1 (]: 13 of 18 PASS not_null_fact_video_metrics_like_count ........................... [[32mPASS[0m in 2.42s]
[0m05:09:07.070466 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_fact_video_metrics_like_count.6aaf587688
[0m05:09:07.072527 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_fact_video_metrics_published_at.b92c10a174
[0m05:09:07.073648 [info ] [Thread-1 (]: 14 of 18 START test not_null_fact_video_metrics_published_at ................... [RUN]
[0m05:09:07.074763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_fact_video_metrics_like_count.6aaf587688, now test.youtube_project.not_null_fact_video_metrics_published_at.b92c10a174)
[0m05:09:07.075817 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_fact_video_metrics_published_at.b92c10a174
[0m05:09:07.084659 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_fact_video_metrics_published_at.b92c10a174"
[0m05:09:07.086849 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_fact_video_metrics_published_at.b92c10a174
[0m05:09:07.090830 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_fact_video_metrics_published_at.b92c10a174"
[0m05:09:07.092612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:09:07.095802 [debug] [Thread-1 (]: On test.youtube_project.not_null_fact_video_metrics_published_at.b92c10a174: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_fact_video_metrics_published_at.b92c10a174"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select published_at
from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_metrics`
where published_at is null



      
    ) dbt_internal_test
[0m05:09:08.215058 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:0e144b6c-f144-42e3-afd0-f127037b7d3a&page=queryresults
[0m05:09:09.366220 [info ] [Thread-1 (]: 14 of 18 PASS not_null_fact_video_metrics_published_at ......................... [[32mPASS[0m in 2.29s]
[0m05:09:09.368573 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_fact_video_metrics_published_at.b92c10a174
[0m05:09:09.370017 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_fact_video_metrics_region_code.344b167021
[0m05:09:09.370762 [info ] [Thread-1 (]: 15 of 18 START test not_null_fact_video_metrics_region_code .................... [RUN]
[0m05:09:09.371502 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_fact_video_metrics_published_at.b92c10a174, now test.youtube_project.not_null_fact_video_metrics_region_code.344b167021)
[0m05:09:09.372109 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_fact_video_metrics_region_code.344b167021
[0m05:09:09.378742 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_fact_video_metrics_region_code.344b167021"
[0m05:09:09.380587 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_fact_video_metrics_region_code.344b167021
[0m05:09:09.384087 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_fact_video_metrics_region_code.344b167021"
[0m05:09:09.385825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:09:09.387972 [debug] [Thread-1 (]: On test.youtube_project.not_null_fact_video_metrics_region_code.344b167021: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_fact_video_metrics_region_code.344b167021"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select region_code
from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_metrics`
where region_code is null



      
    ) dbt_internal_test
[0m05:09:10.604631 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:e36e597a-5ece-4185-bf45-4ac80d5dc535&page=queryresults
[0m05:09:11.701708 [info ] [Thread-1 (]: 15 of 18 PASS not_null_fact_video_metrics_region_code .......................... [[32mPASS[0m in 2.33s]
[0m05:09:11.705440 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_fact_video_metrics_region_code.344b167021
[0m05:09:11.707088 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_fact_video_metrics_video_id.b4384e6217
[0m05:09:11.708315 [info ] [Thread-1 (]: 16 of 18 START test not_null_fact_video_metrics_video_id ....................... [RUN]
[0m05:09:11.709599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_fact_video_metrics_region_code.344b167021, now test.youtube_project.not_null_fact_video_metrics_video_id.b4384e6217)
[0m05:09:11.710614 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_fact_video_metrics_video_id.b4384e6217
[0m05:09:11.721464 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_fact_video_metrics_video_id.b4384e6217"
[0m05:09:11.723533 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_fact_video_metrics_video_id.b4384e6217
[0m05:09:11.727443 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_fact_video_metrics_video_id.b4384e6217"
[0m05:09:11.729089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:09:11.731506 [debug] [Thread-1 (]: On test.youtube_project.not_null_fact_video_metrics_video_id.b4384e6217: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_fact_video_metrics_video_id.b4384e6217"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select video_id
from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_metrics`
where video_id is null



      
    ) dbt_internal_test
[0m05:09:12.927031 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:830a7de8-a59a-4d7c-93b6-6b82a3a95bd9&page=queryresults
[0m05:09:14.090501 [info ] [Thread-1 (]: 16 of 18 PASS not_null_fact_video_metrics_video_id ............................. [[32mPASS[0m in 2.38s]
[0m05:09:14.093383 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_fact_video_metrics_video_id.b4384e6217
[0m05:09:14.095601 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_fact_video_metrics_view_count.d321f0cf92
[0m05:09:14.096722 [info ] [Thread-1 (]: 17 of 18 START test not_null_fact_video_metrics_view_count ..................... [RUN]
[0m05:09:14.097869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_fact_video_metrics_video_id.b4384e6217, now test.youtube_project.not_null_fact_video_metrics_view_count.d321f0cf92)
[0m05:09:14.098687 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_fact_video_metrics_view_count.d321f0cf92
[0m05:09:14.111559 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_fact_video_metrics_view_count.d321f0cf92"
[0m05:09:14.113603 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_fact_video_metrics_view_count.d321f0cf92
[0m05:09:14.117399 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_fact_video_metrics_view_count.d321f0cf92"
[0m05:09:14.118751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:09:14.121443 [debug] [Thread-1 (]: On test.youtube_project.not_null_fact_video_metrics_view_count.d321f0cf92: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_fact_video_metrics_view_count.d321f0cf92"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select view_count
from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_metrics`
where view_count is null



      
    ) dbt_internal_test
[0m05:09:15.489106 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:e1890f6e-07cc-40e8-96fb-7a47bb47fde9&page=queryresults
[0m05:09:16.719026 [info ] [Thread-1 (]: 17 of 18 PASS not_null_fact_video_metrics_view_count ........................... [[32mPASS[0m in 2.62s]
[0m05:09:16.722176 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_fact_video_metrics_view_count.d321f0cf92
[0m05:09:16.724033 [debug] [Thread-1 (]: Began running node test.youtube_project.unique_fact_video_metrics_fact_video_id.64a80544d1
[0m05:09:16.725218 [info ] [Thread-1 (]: 18 of 18 START test unique_fact_video_metrics_fact_video_id .................... [RUN]
[0m05:09:16.726505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_fact_video_metrics_view_count.d321f0cf92, now test.youtube_project.unique_fact_video_metrics_fact_video_id.64a80544d1)
[0m05:09:16.727434 [debug] [Thread-1 (]: Began compiling node test.youtube_project.unique_fact_video_metrics_fact_video_id.64a80544d1
[0m05:09:16.741091 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.unique_fact_video_metrics_fact_video_id.64a80544d1"
[0m05:09:16.743428 [debug] [Thread-1 (]: Began executing node test.youtube_project.unique_fact_video_metrics_fact_video_id.64a80544d1
[0m05:09:16.746989 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.unique_fact_video_metrics_fact_video_id.64a80544d1"
[0m05:09:16.748634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:09:16.751919 [debug] [Thread-1 (]: On test.youtube_project.unique_fact_video_metrics_fact_video_id.64a80544d1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.unique_fact_video_metrics_fact_video_id.64a80544d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select fact_video_id as unique_field
  from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_metrics`
  where fact_video_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m05:09:18.045425 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:8c0645c8-fc82-4fcd-b2dc-56e305a206af&page=queryresults
[0m05:09:19.277688 [error] [Thread-1 (]: 18 of 18 FAIL 1 unique_fact_video_metrics_fact_video_id ........................ [[31mFAIL 1[0m in 2.55s]
[0m05:09:19.281280 [debug] [Thread-1 (]: Finished running node test.youtube_project.unique_fact_video_metrics_fact_video_id.64a80544d1
[0m05:09:19.288191 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:09:19.289116 [debug] [MainThread]: Connection 'test.youtube_project.unique_fact_video_metrics_fact_video_id.64a80544d1' was properly closed.
[0m05:09:19.290442 [info ] [MainThread]: 
[0m05:09:19.291527 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 38.98 seconds (38.98s).
[0m05:09:19.297902 [debug] [MainThread]: Command end result
[0m05:09:19.385060 [info ] [MainThread]: 
[0m05:09:19.385643 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m05:09:19.385949 [info ] [MainThread]: 
[0m05:09:19.386453 [error] [MainThread]:   Database Error in test dbt_expectations_expect_column_values_to_be_between_fact_video_metrics_published_at__2100_12_31__1900_01_01 (models/youtube_data/marts/schema.yml)
  No matching signature for operator >= for argument types: TIMESTAMP, INT64. Supported signature: ANY >= ANY at [20:11]
  compiled code at target/run/youtube_project/models/youtube_data/marts/schema.yml/dbt_expectations_expect_column_bdf479113831ae5b8192f7c829611f50.sql
[0m05:09:19.386720 [info ] [MainThread]: 
[0m05:09:19.387065 [error] [MainThread]:   Compilation Error in test dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_comment_count__0 (models/youtube_data/marts/schema.yml)
  'dict object' has no attribute 'test_expect_column_values_to_be_greater_than'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m05:09:19.387432 [info ] [MainThread]: 
[0m05:09:19.387786 [error] [MainThread]:   Compilation Error in test dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_like_count__0 (models/youtube_data/marts/schema.yml)
  'dict object' has no attribute 'test_expect_column_values_to_be_greater_than'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m05:09:19.388053 [info ] [MainThread]: 
[0m05:09:19.388423 [error] [MainThread]:   Compilation Error in test dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_view_count__0 (models/youtube_data/marts/schema.yml)
  'dict object' has no attribute 'test_expect_column_values_to_be_greater_than'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m05:09:19.388660 [info ] [MainThread]: 
[0m05:09:19.389056 [error] [MainThread]: [31mFailure in test unique_fact_video_metrics_fact_video_id (models/youtube_data/marts/schema.yml)[0m
[0m05:09:19.389330 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m05:09:19.389615 [info ] [MainThread]: 
[0m05:09:19.389959 [info ] [MainThread]:   compiled code at target/compiled/youtube_project/models/youtube_data/marts/schema.yml/unique_fact_video_metrics_fact_video_id.sql
[0m05:09:19.390284 [info ] [MainThread]: 
[0m05:09:19.390602 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=5 SKIP=0 TOTAL=18
[0m05:09:19.393007 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 40.079796, "process_in_blocks": "192", "process_kernel_time": 0.364693, "process_mem_max_rss": "224220", "process_out_blocks": "5917", "process_user_time": 3.940293}
[0m05:09:19.394146 [debug] [MainThread]: Command `dbt test` failed at 05:09:19.394027 after 40.08 seconds
[0m05:09:19.395177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa649ff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89877650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89a12d80>]}
[0m05:09:19.395667 [debug] [MainThread]: Flushing usage events
[0m05:14:46.933435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9de90b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ca4e2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c939130>]}


============================== 05:14:46.934935 | d9d94861-40ac-4f38-ad39-12428062e117 ==============================
[0m05:14:46.934935 [info ] [MainThread]: Running with dbt=1.8.9
[0m05:14:46.935350 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'use_colors': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'write_json': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'profiles_dir': '/usr/local/airflow/include/dbt', 'no_print': 'None', 'cache_selected_only': 'False', 'invocation_command': 'dbt test --models youtube_data.marts.fact_video_metrics', 'empty': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'quiet': 'False', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m05:14:47.620479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9d94861-40ac-4f38-ad39-12428062e117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f719790>]}
[0m05:14:47.646645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9d94861-40ac-4f38-ad39-12428062e117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bf3f530>]}
[0m05:14:47.647092 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m05:14:47.714370 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m05:14:47.851346 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m05:14:47.852226 [debug] [MainThread]: Partial parsing: updated file: youtube_project://models/youtube_data/marts/schema.yml
[0m05:14:47.852486 [debug] [MainThread]: Partial parsing: updated file: youtube_project://models/youtube_data/marts/fact_video_metrics.sql
[0m05:14:48.083516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9d94861-40ac-4f38-ad39-12428062e117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bf67a70>]}
[0m05:14:48.170720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9d94861-40ac-4f38-ad39-12428062e117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ed41ee0>]}
[0m05:14:48.171165 [info ] [MainThread]: Found 12 models, 138 data tests, 2 sources, 867 macros
[0m05:14:48.171544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9d94861-40ac-4f38-ad39-12428062e117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eeca7b0>]}
[0m05:14:48.173685 [info ] [MainThread]: 
[0m05:14:48.174144 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m05:14:48.176711 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project_youtube'
[0m05:14:48.177070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:14:49.113055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9d94861-40ac-4f38-ad39-12428062e117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f6b2d20>]}
[0m05:14:49.113890 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:14:49.114457 [info ] [MainThread]: 
[0m05:14:49.117395 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_metrics_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.95f4a75ab3
[0m05:14:49.117983 [info ] [Thread-1 (]: 1 of 19 START test dbt_expectations_expect_column_values_to_be_between_fact_video_metrics_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_  [RUN]
[0m05:14:49.118607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_metrics_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.95f4a75ab3)
[0m05:14:49.119083 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_metrics_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.95f4a75ab3
[0m05:14:49.129657 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_metrics_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.95f4a75ab3"
[0m05:14:49.132591 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_metrics_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.95f4a75ab3
[0m05:14:49.148643 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_metrics_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.95f4a75ab3"
[0m05:14:49.150219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:14:49.151551 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_metrics_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.95f4a75ab3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_metrics_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.95f4a75ab3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and published_at >= TIMESTAMP('1900-01-01 00:00:00') and published_at <= TIMESTAMP('2100-12-31 23:59:59')
)
 as expression


    from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_metrics`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m05:14:50.449712 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:4ff32f01-48f1-43da-9686-49114f966a23&page=queryresults
[0m05:14:51.691519 [info ] [Thread-1 (]: 1 of 19 PASS dbt_expectations_expect_column_values_to_be_between_fact_video_metrics_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_  [[32mPASS[0m in 2.57s]
[0m05:14:51.694153 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_metrics_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.95f4a75ab3
[0m05:14:51.695493 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_comment_count__0.160decec9b
[0m05:14:51.696556 [info ] [Thread-1 (]: 2 of 19 START test dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_comment_count__0  [RUN]
[0m05:14:51.697761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_metrics_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.95f4a75ab3, now test.youtube_project.dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_comment_count__0.160decec9b)
[0m05:14:51.698683 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_comment_count__0.160decec9b
[0m05:14:51.717059 [debug] [Thread-1 (]: Compilation Error in test dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_comment_count__0 (models/youtube_data/marts/schema.yml)
  'dict object' has no attribute 'test_expect_column_values_to_be_greater_than'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m05:14:51.718008 [error] [Thread-1 (]: 2 of 19 ERROR dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_comment_count__0  [[31mERROR[0m in 0.02s]
[0m05:14:51.718867 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_comment_count__0.160decec9b
[0m05:14:51.719508 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_like_count__0.65d8859b10
[0m05:14:51.721207 [info ] [Thread-1 (]: 3 of 19 START test dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_like_count__0  [RUN]
[0m05:14:51.721824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_comment_count__0.160decec9b, now test.youtube_project.dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_like_count__0.65d8859b10)
[0m05:14:51.722306 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_like_count__0.65d8859b10
[0m05:14:51.728045 [debug] [Thread-1 (]: Compilation Error in test dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_like_count__0 (models/youtube_data/marts/schema.yml)
  'dict object' has no attribute 'test_expect_column_values_to_be_greater_than'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m05:14:51.728707 [error] [Thread-1 (]: 3 of 19 ERROR dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_like_count__0  [[31mERROR[0m in 0.01s]
[0m05:14:51.729422 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_like_count__0.65d8859b10
[0m05:14:51.730030 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_view_count__0.2667080168
[0m05:14:51.730534 [info ] [Thread-1 (]: 4 of 19 START test dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_view_count__0  [RUN]
[0m05:14:51.731093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_like_count__0.65d8859b10, now test.youtube_project.dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_view_count__0.2667080168)
[0m05:14:51.731478 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_view_count__0.2667080168
[0m05:14:51.737366 [debug] [Thread-1 (]: Compilation Error in test dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_view_count__0 (models/youtube_data/marts/schema.yml)
  'dict object' has no attribute 'test_expect_column_values_to_be_greater_than'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m05:14:51.738133 [error] [Thread-1 (]: 4 of 19 ERROR dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_view_count__0  [[31mERROR[0m in 0.01s]
[0m05:14:51.738810 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_view_count__0.2667080168
[0m05:14:51.739303 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_comment_count__INT64.1fa9eb6b79
[0m05:14:51.739841 [info ] [Thread-1 (]: 5 of 19 START test dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_comment_count__INT64  [RUN]
[0m05:14:51.740320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_view_count__0.2667080168, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_comment_count__INT64.1fa9eb6b79)
[0m05:14:51.740701 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_comment_count__INT64.1fa9eb6b79
[0m05:14:51.744517 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:14:52.598253 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_comment_count__INT64.1fa9eb6b79"
[0m05:14:52.601421 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_comment_count__INT64.1fa9eb6b79
[0m05:14:52.607797 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_comment_count__INT64.1fa9eb6b79"
[0m05:14:52.609725 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_comment_count__INT64.1fa9eb6b79: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_comment_count__INT64.1fa9eb6b79"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('FACT_VIDEO_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('REGION_CODE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIEW_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('LIKE_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'COMMENT_COUNT'
            and
            relation_column_type not in ('INT64')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m05:14:53.104152 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:0afaf603-c314-4adc-baf7-516e6967f4bc&page=queryresults
[0m05:14:54.108060 [info ] [Thread-1 (]: 5 of 19 PASS dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_comment_count__INT64  [[32mPASS[0m in 2.37s]
[0m05:14:54.111546 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_comment_count__INT64.1fa9eb6b79
[0m05:14:54.113025 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_like_count__INT64.c4ebcf4945
[0m05:14:54.114500 [info ] [Thread-1 (]: 6 of 19 START test dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_like_count__INT64  [RUN]
[0m05:14:54.115796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_comment_count__INT64.1fa9eb6b79, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_like_count__INT64.c4ebcf4945)
[0m05:14:54.116739 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_like_count__INT64.c4ebcf4945
[0m05:14:54.136789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:14:56.089311 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_like_count__INT64.c4ebcf4945"
[0m05:14:56.095132 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_like_count__INT64.c4ebcf4945
[0m05:14:56.107203 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_like_count__INT64.c4ebcf4945"
[0m05:14:56.110339 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_like_count__INT64.c4ebcf4945: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_like_count__INT64.c4ebcf4945"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('FACT_VIDEO_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('REGION_CODE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIEW_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('LIKE_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'LIKE_COUNT'
            and
            relation_column_type not in ('INT64')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m05:14:56.686868 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:802e3a2d-f8a3-4265-9d84-9a0838f80ccd&page=queryresults
[0m05:14:57.824309 [info ] [Thread-1 (]: 6 of 19 PASS dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_like_count__INT64  [[32mPASS[0m in 3.71s]
[0m05:14:57.828002 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_like_count__INT64.c4ebcf4945
[0m05:14:57.829491 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_published_at__TIMESTAMP.7fe1f661cb
[0m05:14:57.830882 [info ] [Thread-1 (]: 7 of 19 START test dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_published_at__TIMESTAMP  [RUN]
[0m05:14:57.832280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_like_count__INT64.c4ebcf4945, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_published_at__TIMESTAMP.7fe1f661cb)
[0m05:14:57.833173 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_published_at__TIMESTAMP.7fe1f661cb
[0m05:14:57.848241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:14:58.742254 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_published_at__TIMESTAMP.7fe1f661cb"
[0m05:14:58.745271 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_published_at__TIMESTAMP.7fe1f661cb
[0m05:14:58.751979 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_published_at__TIMESTAMP.7fe1f661cb"
[0m05:14:58.753748 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_published_at__TIMESTAMP.7fe1f661cb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_published_at__TIMESTAMP.7fe1f661cb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('FACT_VIDEO_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('REGION_CODE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIEW_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('LIKE_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'PUBLISHED_AT'
            and
            relation_column_type not in ('TIMESTAMP')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m05:14:59.350324 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:2ff707cd-8cb5-45a1-97da-cf6efc049c0e&page=queryresults
[0m05:15:00.478613 [info ] [Thread-1 (]: 7 of 19 PASS dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_published_at__TIMESTAMP  [[32mPASS[0m in 2.65s]
[0m05:15:00.481938 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_published_at__TIMESTAMP.7fe1f661cb
[0m05:15:00.483657 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_region_code__STRING.2e2ff280d9
[0m05:15:00.485141 [info ] [Thread-1 (]: 8 of 19 START test dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_region_code__STRING  [RUN]
[0m05:15:00.486397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_published_at__TIMESTAMP.7fe1f661cb, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_region_code__STRING.2e2ff280d9)
[0m05:15:00.487294 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_region_code__STRING.2e2ff280d9
[0m05:15:00.496789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:15:01.416556 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_region_code__STRING.2e2ff280d9"
[0m05:15:01.418955 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_region_code__STRING.2e2ff280d9
[0m05:15:01.620361 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_region_code__STRING.2e2ff280d9"
[0m05:15:01.621401 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_region_code__STRING.2e2ff280d9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_region_code__STRING.2e2ff280d9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('FACT_VIDEO_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('REGION_CODE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIEW_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('LIKE_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'REGION_CODE'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m05:15:02.217853 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:088037db-3c20-4c88-8223-0cddea30225f&page=queryresults
[0m05:15:03.449802 [info ] [Thread-1 (]: 8 of 19 PASS dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_region_code__STRING  [[32mPASS[0m in 2.96s]
[0m05:15:03.453265 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_region_code__STRING.2e2ff280d9
[0m05:15:03.454502 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_video_id__STRING.065a6b3e3b
[0m05:15:03.455571 [info ] [Thread-1 (]: 9 of 19 START test dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_video_id__STRING  [RUN]
[0m05:15:03.456799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_region_code__STRING.2e2ff280d9, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_video_id__STRING.065a6b3e3b)
[0m05:15:03.457625 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_video_id__STRING.065a6b3e3b
[0m05:15:03.467239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:15:04.371882 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_video_id__STRING.065a6b3e3b"
[0m05:15:04.374357 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_video_id__STRING.065a6b3e3b
[0m05:15:04.380914 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_video_id__STRING.065a6b3e3b"
[0m05:15:04.383582 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_video_id__STRING.065a6b3e3b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_video_id__STRING.065a6b3e3b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('FACT_VIDEO_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('REGION_CODE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIEW_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('LIKE_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'VIDEO_ID'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m05:15:04.919856 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:170d0438-364f-44cb-a077-d822506e6a65&page=queryresults
[0m05:15:06.113037 [info ] [Thread-1 (]: 9 of 19 PASS dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_video_id__STRING  [[32mPASS[0m in 2.66s]
[0m05:15:06.117007 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_video_id__STRING.065a6b3e3b
[0m05:15:06.118685 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_view_count__INT64.4054ccb7f8
[0m05:15:06.120374 [info ] [Thread-1 (]: 10 of 19 START test dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_view_count__INT64  [RUN]
[0m05:15:06.121887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_video_id__STRING.065a6b3e3b, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_view_count__INT64.4054ccb7f8)
[0m05:15:06.122941 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_view_count__INT64.4054ccb7f8
[0m05:15:06.137319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:15:07.238226 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_view_count__INT64.4054ccb7f8"
[0m05:15:07.240557 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_view_count__INT64.4054ccb7f8
[0m05:15:07.245208 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_view_count__INT64.4054ccb7f8"
[0m05:15:07.247214 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_view_count__INT64.4054ccb7f8: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_view_count__INT64.4054ccb7f8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('FACT_VIDEO_ID' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('REGION_CODE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIEW_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('LIKE_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'VIEW_COUNT'
            and
            relation_column_type not in ('INT64')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m05:15:07.848031 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:c42de5e0-9262-45ed-a4e6-d8f112b1b088&page=queryresults
[0m05:15:09.034242 [info ] [Thread-1 (]: 10 of 19 PASS dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_view_count__INT64  [[32mPASS[0m in 2.91s]
[0m05:15:09.037372 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_view_count__INT64.4054ccb7f8
[0m05:15:09.039628 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_fact_video_metrics_comment_count.c76bd6c0f5
[0m05:15:09.040445 [info ] [Thread-1 (]: 11 of 19 START test not_null_fact_video_metrics_comment_count .................. [RUN]
[0m05:15:09.041334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_view_count__INT64.4054ccb7f8, now test.youtube_project.not_null_fact_video_metrics_comment_count.c76bd6c0f5)
[0m05:15:09.041971 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_fact_video_metrics_comment_count.c76bd6c0f5
[0m05:15:09.073276 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_fact_video_metrics_comment_count.c76bd6c0f5"
[0m05:15:09.074772 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_fact_video_metrics_comment_count.c76bd6c0f5
[0m05:15:09.077278 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_fact_video_metrics_comment_count.c76bd6c0f5"
[0m05:15:09.078483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:15:09.081054 [debug] [Thread-1 (]: On test.youtube_project.not_null_fact_video_metrics_comment_count.c76bd6c0f5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_fact_video_metrics_comment_count.c76bd6c0f5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select comment_count
from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_metrics`
where comment_count is null



      
    ) dbt_internal_test
[0m05:15:10.411952 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:360d7edb-48dd-4079-a5c1-9519e35c0d74&page=queryresults
[0m05:15:11.637009 [info ] [Thread-1 (]: 11 of 19 PASS not_null_fact_video_metrics_comment_count ........................ [[32mPASS[0m in 2.60s]
[0m05:15:11.639193 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_fact_video_metrics_comment_count.c76bd6c0f5
[0m05:15:11.640652 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_fact_video_metrics_fact_video_id.15e13bac2f
[0m05:15:11.641758 [info ] [Thread-1 (]: 12 of 19 START test not_null_fact_video_metrics_fact_video_id .................. [RUN]
[0m05:15:11.643063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_fact_video_metrics_comment_count.c76bd6c0f5, now test.youtube_project.not_null_fact_video_metrics_fact_video_id.15e13bac2f)
[0m05:15:11.644036 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_fact_video_metrics_fact_video_id.15e13bac2f
[0m05:15:11.653564 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_fact_video_metrics_fact_video_id.15e13bac2f"
[0m05:15:11.655690 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_fact_video_metrics_fact_video_id.15e13bac2f
[0m05:15:11.658560 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_fact_video_metrics_fact_video_id.15e13bac2f"
[0m05:15:11.659785 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:15:11.662291 [debug] [Thread-1 (]: On test.youtube_project.not_null_fact_video_metrics_fact_video_id.15e13bac2f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_fact_video_metrics_fact_video_id.15e13bac2f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select fact_video_id
from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_metrics`
where fact_video_id is null



      
    ) dbt_internal_test
[0m05:15:12.627667 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:13d4ce0f-90e6-4272-84c1-6cdbfaed6541&page=queryresults
[0m05:15:13.799834 [info ] [Thread-1 (]: 12 of 19 PASS not_null_fact_video_metrics_fact_video_id ........................ [[32mPASS[0m in 2.15s]
[0m05:15:13.808145 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_fact_video_metrics_fact_video_id.15e13bac2f
[0m05:15:13.809916 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_fact_video_metrics_like_count.6aaf587688
[0m05:15:13.811105 [info ] [Thread-1 (]: 13 of 19 START test not_null_fact_video_metrics_like_count ..................... [RUN]
[0m05:15:13.812433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_fact_video_metrics_fact_video_id.15e13bac2f, now test.youtube_project.not_null_fact_video_metrics_like_count.6aaf587688)
[0m05:15:13.813449 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_fact_video_metrics_like_count.6aaf587688
[0m05:15:13.827943 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_fact_video_metrics_like_count.6aaf587688"
[0m05:15:13.830484 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_fact_video_metrics_like_count.6aaf587688
[0m05:15:13.834295 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_fact_video_metrics_like_count.6aaf587688"
[0m05:15:13.835758 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:15:13.838567 [debug] [Thread-1 (]: On test.youtube_project.not_null_fact_video_metrics_like_count.6aaf587688: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_fact_video_metrics_like_count.6aaf587688"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select like_count
from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_metrics`
where like_count is null



      
    ) dbt_internal_test
[0m05:15:14.813520 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:3735893d-1b9a-458d-a843-0a34dcf5bd1b&page=queryresults
[0m05:15:15.961237 [info ] [Thread-1 (]: 13 of 19 PASS not_null_fact_video_metrics_like_count ........................... [[32mPASS[0m in 2.15s]
[0m05:15:15.965718 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_fact_video_metrics_like_count.6aaf587688
[0m05:15:15.968165 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_fact_video_metrics_published_at.b92c10a174
[0m05:15:15.969567 [info ] [Thread-1 (]: 14 of 19 START test not_null_fact_video_metrics_published_at ................... [RUN]
[0m05:15:15.970968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_fact_video_metrics_like_count.6aaf587688, now test.youtube_project.not_null_fact_video_metrics_published_at.b92c10a174)
[0m05:15:15.971866 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_fact_video_metrics_published_at.b92c10a174
[0m05:15:15.982151 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_fact_video_metrics_published_at.b92c10a174"
[0m05:15:15.984108 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_fact_video_metrics_published_at.b92c10a174
[0m05:15:15.992753 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_fact_video_metrics_published_at.b92c10a174"
[0m05:15:15.994365 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:15:15.997560 [debug] [Thread-1 (]: On test.youtube_project.not_null_fact_video_metrics_published_at.b92c10a174: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_fact_video_metrics_published_at.b92c10a174"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select published_at
from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_metrics`
where published_at is null



      
    ) dbt_internal_test
[0m05:15:16.967016 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:f534c7d0-f190-477c-9ae1-f9dc90784163&page=queryresults
[0m05:15:18.140840 [info ] [Thread-1 (]: 14 of 19 PASS not_null_fact_video_metrics_published_at ......................... [[32mPASS[0m in 2.17s]
[0m05:15:18.146022 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_fact_video_metrics_published_at.b92c10a174
[0m05:15:18.148603 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_fact_video_metrics_region_code.344b167021
[0m05:15:18.149914 [info ] [Thread-1 (]: 15 of 19 START test not_null_fact_video_metrics_region_code .................... [RUN]
[0m05:15:18.151810 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_fact_video_metrics_published_at.b92c10a174, now test.youtube_project.not_null_fact_video_metrics_region_code.344b167021)
[0m05:15:18.152359 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_fact_video_metrics_region_code.344b167021
[0m05:15:18.162037 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_fact_video_metrics_region_code.344b167021"
[0m05:15:18.163439 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_fact_video_metrics_region_code.344b167021
[0m05:15:18.168070 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_fact_video_metrics_region_code.344b167021"
[0m05:15:18.169525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:15:18.171940 [debug] [Thread-1 (]: On test.youtube_project.not_null_fact_video_metrics_region_code.344b167021: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_fact_video_metrics_region_code.344b167021"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select region_code
from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_metrics`
where region_code is null



      
    ) dbt_internal_test
[0m05:15:19.431205 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:fedcd3e2-d01b-452f-9cd3-41429de717c5&page=queryresults
[0m05:15:20.448443 [info ] [Thread-1 (]: 15 of 19 PASS not_null_fact_video_metrics_region_code .......................... [[32mPASS[0m in 2.29s]
[0m05:15:20.451222 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_fact_video_metrics_region_code.344b167021
[0m05:15:20.452375 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_fact_video_metrics_video_id.b4384e6217
[0m05:15:20.453426 [info ] [Thread-1 (]: 16 of 19 START test not_null_fact_video_metrics_video_id ....................... [RUN]
[0m05:15:20.454539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_fact_video_metrics_region_code.344b167021, now test.youtube_project.not_null_fact_video_metrics_video_id.b4384e6217)
[0m05:15:20.455211 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_fact_video_metrics_video_id.b4384e6217
[0m05:15:20.470396 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_fact_video_metrics_video_id.b4384e6217"
[0m05:15:20.473572 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_fact_video_metrics_video_id.b4384e6217
[0m05:15:20.477699 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_fact_video_metrics_video_id.b4384e6217"
[0m05:15:20.479042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:15:20.483312 [debug] [Thread-1 (]: On test.youtube_project.not_null_fact_video_metrics_video_id.b4384e6217: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_fact_video_metrics_video_id.b4384e6217"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select video_id
from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_metrics`
where video_id is null



      
    ) dbt_internal_test
[0m05:15:21.471180 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:c25395d5-e2bd-4113-9495-4098fb66f2be&page=queryresults
[0m05:15:22.514616 [info ] [Thread-1 (]: 16 of 19 PASS not_null_fact_video_metrics_video_id ............................. [[32mPASS[0m in 2.06s]
[0m05:15:22.516822 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_fact_video_metrics_video_id.b4384e6217
[0m05:15:22.518118 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_fact_video_metrics_view_count.d321f0cf92
[0m05:15:22.518821 [info ] [Thread-1 (]: 17 of 19 START test not_null_fact_video_metrics_view_count ..................... [RUN]
[0m05:15:22.519517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_fact_video_metrics_video_id.b4384e6217, now test.youtube_project.not_null_fact_video_metrics_view_count.d321f0cf92)
[0m05:15:22.520007 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_fact_video_metrics_view_count.d321f0cf92
[0m05:15:22.529585 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_fact_video_metrics_view_count.d321f0cf92"
[0m05:15:22.531128 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_fact_video_metrics_view_count.d321f0cf92
[0m05:15:22.533488 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_fact_video_metrics_view_count.d321f0cf92"
[0m05:15:22.534853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:15:22.538646 [debug] [Thread-1 (]: On test.youtube_project.not_null_fact_video_metrics_view_count.d321f0cf92: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_fact_video_metrics_view_count.d321f0cf92"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select view_count
from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_metrics`
where view_count is null



      
    ) dbt_internal_test
[0m05:15:23.620320 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:f26c473b-ea29-4cf9-aac4-99db3a7cc6ff&page=queryresults
[0m05:15:24.743886 [info ] [Thread-1 (]: 17 of 19 PASS not_null_fact_video_metrics_view_count ........................... [[32mPASS[0m in 2.22s]
[0m05:15:24.745783 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_fact_video_metrics_view_count.d321f0cf92
[0m05:15:24.747089 [debug] [Thread-1 (]: Began running node test.youtube_project.unique_fact_video_metrics_fact_video_id.64a80544d1
[0m05:15:24.748002 [info ] [Thread-1 (]: 18 of 19 START test unique_fact_video_metrics_fact_video_id .................... [RUN]
[0m05:15:24.749002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_fact_video_metrics_view_count.d321f0cf92, now test.youtube_project.unique_fact_video_metrics_fact_video_id.64a80544d1)
[0m05:15:24.749808 [debug] [Thread-1 (]: Began compiling node test.youtube_project.unique_fact_video_metrics_fact_video_id.64a80544d1
[0m05:15:24.760762 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.unique_fact_video_metrics_fact_video_id.64a80544d1"
[0m05:15:24.762599 [debug] [Thread-1 (]: Began executing node test.youtube_project.unique_fact_video_metrics_fact_video_id.64a80544d1
[0m05:15:24.766012 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.unique_fact_video_metrics_fact_video_id.64a80544d1"
[0m05:15:24.767397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:15:24.769467 [debug] [Thread-1 (]: On test.youtube_project.unique_fact_video_metrics_fact_video_id.64a80544d1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.unique_fact_video_metrics_fact_video_id.64a80544d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select fact_video_id as unique_field
  from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_metrics`
  where fact_video_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m05:15:25.716794 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:fe0dc81b-3fd0-4061-ac63-9d62b48fec28&page=queryresults
[0m05:15:26.792398 [error] [Thread-1 (]: 18 of 19 FAIL 1 unique_fact_video_metrics_fact_video_id ........................ [[31mFAIL 1[0m in 2.04s]
[0m05:15:26.793550 [debug] [Thread-1 (]: Finished running node test.youtube_project.unique_fact_video_metrics_fact_video_id.64a80544d1
[0m05:15:26.794232 [debug] [Thread-1 (]: Began running node test.youtube_project.unique_fact_video_metrics_video_id.fab5773825
[0m05:15:26.794672 [info ] [Thread-1 (]: 19 of 19 START test unique_fact_video_metrics_video_id ......................... [RUN]
[0m05:15:26.795258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.unique_fact_video_metrics_fact_video_id.64a80544d1, now test.youtube_project.unique_fact_video_metrics_video_id.fab5773825)
[0m05:15:26.795638 [debug] [Thread-1 (]: Began compiling node test.youtube_project.unique_fact_video_metrics_video_id.fab5773825
[0m05:15:26.800501 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.unique_fact_video_metrics_video_id.fab5773825"
[0m05:15:26.801679 [debug] [Thread-1 (]: Began executing node test.youtube_project.unique_fact_video_metrics_video_id.fab5773825
[0m05:15:26.803773 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.unique_fact_video_metrics_video_id.fab5773825"
[0m05:15:26.804642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:15:26.806095 [debug] [Thread-1 (]: On test.youtube_project.unique_fact_video_metrics_video_id.fab5773825: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.unique_fact_video_metrics_video_id.fab5773825"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select video_id as unique_field
  from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_metrics`
  where video_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m05:15:28.332036 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:0a0209cc-c26b-4ba0-84e1-0428a92ddece&page=queryresults
[0m05:15:29.363462 [info ] [Thread-1 (]: 19 of 19 PASS unique_fact_video_metrics_video_id ............................... [[32mPASS[0m in 2.56s]
[0m05:15:29.366315 [debug] [Thread-1 (]: Finished running node test.youtube_project.unique_fact_video_metrics_video_id.fab5773825
[0m05:15:29.384086 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:15:29.384696 [debug] [MainThread]: Connection 'test.youtube_project.unique_fact_video_metrics_video_id.fab5773825' was properly closed.
[0m05:15:29.385881 [info ] [MainThread]: 
[0m05:15:29.386853 [info ] [MainThread]: Finished running 19 data tests in 0 hours 0 minutes and 41.21 seconds (41.21s).
[0m05:15:29.394665 [debug] [MainThread]: Command end result
[0m05:15:29.468704 [info ] [MainThread]: 
[0m05:15:29.469534 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m05:15:29.469881 [info ] [MainThread]: 
[0m05:15:29.470480 [error] [MainThread]:   Compilation Error in test dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_comment_count__0 (models/youtube_data/marts/schema.yml)
  'dict object' has no attribute 'test_expect_column_values_to_be_greater_than'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m05:15:29.470875 [info ] [MainThread]: 
[0m05:15:29.471487 [error] [MainThread]:   Compilation Error in test dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_like_count__0 (models/youtube_data/marts/schema.yml)
  'dict object' has no attribute 'test_expect_column_values_to_be_greater_than'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m05:15:29.471745 [info ] [MainThread]: 
[0m05:15:29.472097 [error] [MainThread]:   Compilation Error in test dbt_expectations_expect_column_values_to_be_greater_than_fact_video_metrics_view_count__0 (models/youtube_data/marts/schema.yml)
  'dict object' has no attribute 'test_expect_column_values_to_be_greater_than'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m05:15:29.472348 [info ] [MainThread]: 
[0m05:15:29.472742 [error] [MainThread]: [31mFailure in test unique_fact_video_metrics_fact_video_id (models/youtube_data/marts/schema.yml)[0m
[0m05:15:29.473090 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m05:15:29.473362 [info ] [MainThread]: 
[0m05:15:29.473711 [info ] [MainThread]:   compiled code at target/compiled/youtube_project/models/youtube_data/marts/schema.yml/unique_fact_video_metrics_fact_video_id.sql
[0m05:15:29.474041 [info ] [MainThread]: 
[0m05:15:29.474392 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=4 SKIP=0 TOTAL=19
[0m05:15:29.478613 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 42.57485, "process_in_blocks": "0", "process_kernel_time": 0.42792, "process_mem_max_rss": "227220", "process_out_blocks": "8453", "process_user_time": 4.635294}
[0m05:15:29.479970 [debug] [MainThread]: Command `dbt test` failed at 05:15:29.479812 after 42.58 seconds
[0m05:15:29.480505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fa17530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c8d1b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c8d0c20>]}
[0m05:15:29.480891 [debug] [MainThread]: Flushing usage events
[0m05:18:56.232839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff832d09e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff829af470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81952f60>]}


============================== 05:18:56.234357 | 7c1a1906-8faf-454c-951c-94c2326a1933 ==============================
[0m05:18:56.234357 [info ] [MainThread]: Running with dbt=1.8.9
[0m05:18:56.234857 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'empty': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'use_experimental_parser': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run --models youtube_data.marts.fact_video_metrics', 'version_check': 'True', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_format': 'default', 'fail_fast': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'no_print': 'None', 'static_parser': 'True', 'partial_parse': 'True'}
[0m05:18:57.047403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c1a1906-8faf-454c-951c-94c2326a1933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65c65340>]}
[0m05:18:57.073084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c1a1906-8faf-454c-951c-94c2326a1933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82052120>]}
[0m05:18:57.073508 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m05:18:57.151846 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m05:18:57.310935 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m05:18:57.312177 [debug] [MainThread]: Partial parsing: updated file: youtube_project://models/youtube_data/marts/schema.yml
[0m05:18:57.312476 [debug] [MainThread]: Partial parsing: updated file: youtube_project://models/youtube_data/marts/fact_video_metrics.sql
[0m05:18:57.614648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c1a1906-8faf-454c-951c-94c2326a1933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff641f79e0>]}
[0m05:18:57.715404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c1a1906-8faf-454c-951c-94c2326a1933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64267920>]}
[0m05:18:57.715888 [info ] [MainThread]: Found 12 models, 138 data tests, 2 sources, 867 macros
[0m05:18:57.716271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c1a1906-8faf-454c-951c-94c2326a1933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff641739e0>]}
[0m05:18:57.718688 [info ] [MainThread]: 
[0m05:18:57.719353 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m05:18:57.720296 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project'
[0m05:18:57.720634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:18:58.530521 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project, now list_yt-e2e-data-cycle-project_youtube)
[0m05:18:58.531768 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:18:59.379101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c1a1906-8faf-454c-951c-94c2326a1933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64a04f50>]}
[0m05:18:59.380177 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:18:59.380586 [info ] [MainThread]: 
[0m05:18:59.386258 [debug] [Thread-1 (]: Began running node model.youtube_project.fact_video_metrics
[0m05:18:59.387194 [info ] [Thread-1 (]: 1 of 1 START sql incremental model youtube.fact_video_metrics .................. [RUN]
[0m05:18:59.387696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now model.youtube_project.fact_video_metrics)
[0m05:18:59.388157 [debug] [Thread-1 (]: Began compiling node model.youtube_project.fact_video_metrics
[0m05:18:59.404650 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_project.fact_video_metrics"
[0m05:18:59.407166 [debug] [Thread-1 (]: Began executing node model.youtube_project.fact_video_metrics
[0m05:18:59.457802 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_project.fact_video_metrics"
[0m05:18:59.461481 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:18:59.462902 [debug] [Thread-1 (]: On model.youtube_project.fact_video_metrics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "model.youtube_project.fact_video_metrics"} */

  
    

    create or replace table `yt-e2e-data-cycle-project`.`youtube`.`fact_video_metrics`
      
    partition by timestamp_trunc(published_at, day)
    

    OPTIONS()
    as (
      WITH video_metrics_data AS (
    SELECT
        *
    FROM `yt-e2e-data-cycle-project`.`youtube`.`staging_video_metrics`  -- Reference to the staging table for video metrics
),

metrics_filled AS (
    SELECT
        vmd.video_id,
        vmd.region_code,
        vmd.view_count, 
        vmd.like_count, 
        vmd.comment_count, 
        
        -- Use COALESCE to fill in missing values for published_at
        COALESCE(vmd.published_at, CURRENT_TIMESTAMP()) AS published_at,
        
        -- Join with dim_video to get the corresponding video details
        dv.video_id AS dim_video_id,
        
        -- Join with dim_region to get the corresponding region details
        dr.region_code AS dim_region_code
    FROM
        video_metrics_data vmd
    LEFT JOIN `yt-e2e-data-cycle-project`.`youtube`.`dim_videos` dv  -- Reference to the dim_video table to get the corresponding video
        ON vmd.video_id = dv.video_id  -- Join condition for dim_videos
    LEFT JOIN `yt-e2e-data-cycle-project`.`youtube`.`dim_regions` dr  -- Reference to the dim_region table to get the corresponding region
        ON vmd.region_code = dr.region_code  -- Join condition for dim_regions
)

SELECT 
    to_hex(md5(cast(coalesce(cast(mf.video_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(mf.published_at as string), '_dbt_utils_surrogate_key_null_') as string))) AS fact_video_id,  -- Surrogate key based on the combination of mf.video_id and mf.published_at
    mf.video_id,
    mf.region_code,
    mf.view_count,
    mf.like_count,
    mf.comment_count,
    mf.published_at
FROM 
    metrics_filled mf
    );
  
[0m05:19:00.711643 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:8582c95a-9e49-41f3-b911-ef6f7c3df10e&page=queryresults
[0m05:19:03.645792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c1a1906-8faf-454c-951c-94c2326a1933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff640ab920>]}
[0m05:19:03.647210 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model youtube.fact_video_metrics ............. [[32mCREATE TABLE (100.0 rows, 6.1 KiB processed)[0m in 4.26s]
[0m05:19:03.648368 [debug] [Thread-1 (]: Finished running node model.youtube_project.fact_video_metrics
[0m05:19:03.650559 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:19:03.650897 [debug] [MainThread]: Connection 'model.youtube_project.fact_video_metrics' was properly closed.
[0m05:19:03.651397 [info ] [MainThread]: 
[0m05:19:03.651804 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.93 seconds (5.93s).
[0m05:19:03.652771 [debug] [MainThread]: Command end result
[0m05:19:03.909346 [info ] [MainThread]: 
[0m05:19:03.909899 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:19:03.910272 [info ] [MainThread]: 
[0m05:19:03.910632 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:19:03.912055 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.7052746, "process_in_blocks": "0", "process_kernel_time": 0.43771, "process_mem_max_rss": "226344", "process_out_blocks": "8237", "process_user_time": 2.96659}
[0m05:19:03.912493 [debug] [MainThread]: Command `dbt run` succeeded at 05:19:03.912422 after 7.71 seconds
[0m05:19:03.912801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8269d730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74fcaae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83506870>]}
[0m05:19:03.913097 [debug] [MainThread]: Flushing usage events
[0m05:19:10.661718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d669850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d669820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e603b30>]}


============================== 05:19:10.662914 | e088a60b-32aa-4e66-9b71-4fbdcc232df4 ==============================
[0m05:19:10.662914 [info ] [MainThread]: Running with dbt=1.8.9
[0m05:19:10.663473 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'invocation_command': 'dbt test --models youtube_data.marts.fact_video_metrics', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'use_experimental_parser': 'False', 'version_check': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'log_path': '/usr/local/airflow/include/dbt/logs', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt', 'partial_parse': 'True', 'quiet': 'False', 'static_parser': 'True', 'introspect': 'True', 'fail_fast': 'False', 'debug': 'False', 'log_cache_events': 'False', 'empty': 'None', 'warn_error': 'None'}
[0m05:19:11.358236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e088a60b-32aa-4e66-9b71-4fbdcc232df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80d18350>]}
[0m05:19:11.383332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e088a60b-32aa-4e66-9b71-4fbdcc232df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e0a4dd0>]}
[0m05:19:11.383792 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m05:19:11.464243 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m05:19:11.601334 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:19:11.601767 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:19:11.624579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e088a60b-32aa-4e66-9b71-4fbdcc232df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff807306e0>]}
[0m05:19:11.719243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e088a60b-32aa-4e66-9b71-4fbdcc232df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80d3e300>]}
[0m05:19:11.719661 [info ] [MainThread]: Found 12 models, 138 data tests, 2 sources, 867 macros
[0m05:19:11.719982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e088a60b-32aa-4e66-9b71-4fbdcc232df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff804c5370>]}
[0m05:19:11.722244 [info ] [MainThread]: 
[0m05:19:11.722754 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m05:19:11.725704 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project_youtube'
[0m05:19:11.726100 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:19:12.533725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e088a60b-32aa-4e66-9b71-4fbdcc232df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff804d58e0>]}
[0m05:19:12.535813 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:19:12.536619 [info ] [MainThread]: 
[0m05:19:12.541354 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_distinct_count_to_be_greater_than_fact_video_metrics_comment_count__0.a76ca819f8
[0m05:19:12.542191 [info ] [Thread-1 (]: 1 of 19 START test dbt_expectations_expect_column_distinct_count_to_be_greater_than_fact_video_metrics_comment_count__0  [RUN]
[0m05:19:12.543083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now test.youtube_project.dbt_expectations_expect_column_distinct_count_to_be_greater_than_fact_video_metrics_comment_count__0.a76ca819f8)
[0m05:19:12.543808 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_distinct_count_to_be_greater_than_fact_video_metrics_comment_count__0.a76ca819f8
[0m05:19:12.570797 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_distinct_count_to_be_greater_than_fact_video_metrics_comment_count__0.a76ca819f8"
[0m05:19:12.572825 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_distinct_count_to_be_greater_than_fact_video_metrics_comment_count__0.a76ca819f8
[0m05:19:12.588381 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_distinct_count_to_be_greater_than_fact_video_metrics_comment_count__0.a76ca819f8"
[0m05:19:12.589765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:19:12.591089 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_distinct_count_to_be_greater_than_fact_video_metrics_comment_count__0.a76ca819f8: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_distinct_count_to_be_greater_than_fact_video_metrics_comment_count__0.a76ca819f8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      


    with grouped_expression as (
    select
        
        
    
  
count(distinct comment_count) > 0
 as expression


    from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_metrics`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m05:19:13.871847 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:23289572-496b-4d80-9606-61aadc4029e2&page=queryresults
[0m05:19:15.047048 [info ] [Thread-1 (]: 1 of 19 PASS dbt_expectations_expect_column_distinct_count_to_be_greater_than_fact_video_metrics_comment_count__0  [[32mPASS[0m in 2.50s]
[0m05:19:15.048697 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_distinct_count_to_be_greater_than_fact_video_metrics_comment_count__0.a76ca819f8
[0m05:19:15.049871 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_distinct_count_to_be_greater_than_fact_video_metrics_like_count__0.ce23d97f3b
[0m05:19:15.051168 [info ] [Thread-1 (]: 2 of 19 START test dbt_expectations_expect_column_distinct_count_to_be_greater_than_fact_video_metrics_like_count__0  [RUN]
[0m05:19:15.052015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_distinct_count_to_be_greater_than_fact_video_metrics_comment_count__0.a76ca819f8, now test.youtube_project.dbt_expectations_expect_column_distinct_count_to_be_greater_than_fact_video_metrics_like_count__0.ce23d97f3b)
[0m05:19:15.052561 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_distinct_count_to_be_greater_than_fact_video_metrics_like_count__0.ce23d97f3b
[0m05:19:15.060670 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_distinct_count_to_be_greater_than_fact_video_metrics_like_count__0.ce23d97f3b"
[0m05:19:15.062050 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_distinct_count_to_be_greater_than_fact_video_metrics_like_count__0.ce23d97f3b
[0m05:19:15.065096 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_distinct_count_to_be_greater_than_fact_video_metrics_like_count__0.ce23d97f3b"
[0m05:19:15.066644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:19:15.068787 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_distinct_count_to_be_greater_than_fact_video_metrics_like_count__0.ce23d97f3b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_distinct_count_to_be_greater_than_fact_video_metrics_like_count__0.ce23d97f3b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      


    with grouped_expression as (
    select
        
        
    
  
count(distinct like_count) > 0
 as expression


    from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_metrics`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m05:19:16.379106 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:9a2accad-6d85-4985-930b-2805b143ab0b&page=queryresults
[0m05:19:17.607392 [info ] [Thread-1 (]: 2 of 19 PASS dbt_expectations_expect_column_distinct_count_to_be_greater_than_fact_video_metrics_like_count__0  [[32mPASS[0m in 2.55s]
[0m05:19:17.610865 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_distinct_count_to_be_greater_than_fact_video_metrics_like_count__0.ce23d97f3b
[0m05:19:17.612806 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_distinct_count_to_be_greater_than_fact_video_metrics_view_count__0.7430c5880c
[0m05:19:17.614877 [info ] [Thread-1 (]: 3 of 19 START test dbt_expectations_expect_column_distinct_count_to_be_greater_than_fact_video_metrics_view_count__0  [RUN]
[0m05:19:17.616061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_distinct_count_to_be_greater_than_fact_video_metrics_like_count__0.ce23d97f3b, now test.youtube_project.dbt_expectations_expect_column_distinct_count_to_be_greater_than_fact_video_metrics_view_count__0.7430c5880c)
[0m05:19:17.616834 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_distinct_count_to_be_greater_than_fact_video_metrics_view_count__0.7430c5880c
[0m05:19:17.631073 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_distinct_count_to_be_greater_than_fact_video_metrics_view_count__0.7430c5880c"
[0m05:19:17.633701 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_distinct_count_to_be_greater_than_fact_video_metrics_view_count__0.7430c5880c
[0m05:19:17.640262 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_distinct_count_to_be_greater_than_fact_video_metrics_view_count__0.7430c5880c"
[0m05:19:17.645714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:19:17.648394 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_distinct_count_to_be_greater_than_fact_video_metrics_view_count__0.7430c5880c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_distinct_count_to_be_greater_than_fact_video_metrics_view_count__0.7430c5880c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      


    with grouped_expression as (
    select
        
        
    
  
count(distinct view_count) > 0
 as expression


    from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_metrics`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m05:19:18.864532 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:601f27ef-a08d-440d-bfdd-efb72938956d&page=queryresults
[0m05:19:20.173753 [info ] [Thread-1 (]: 3 of 19 PASS dbt_expectations_expect_column_distinct_count_to_be_greater_than_fact_video_metrics_view_count__0  [[32mPASS[0m in 2.56s]
[0m05:19:20.177700 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_distinct_count_to_be_greater_than_fact_video_metrics_view_count__0.7430c5880c
[0m05:19:20.179662 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_metrics_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.95f4a75ab3
[0m05:19:20.181148 [info ] [Thread-1 (]: 4 of 19 START test dbt_expectations_expect_column_values_to_be_between_fact_video_metrics_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_  [RUN]
[0m05:19:20.182309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_distinct_count_to_be_greater_than_fact_video_metrics_view_count__0.7430c5880c, now test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_metrics_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.95f4a75ab3)
[0m05:19:20.183257 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_metrics_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.95f4a75ab3
[0m05:19:20.207019 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_metrics_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.95f4a75ab3"
[0m05:19:20.209415 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_metrics_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.95f4a75ab3
[0m05:19:20.213796 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_metrics_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.95f4a75ab3"
[0m05:19:20.215367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:19:20.220220 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_metrics_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.95f4a75ab3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_metrics_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.95f4a75ab3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and published_at >= TIMESTAMP('1900-01-01 00:00:00') and published_at <= TIMESTAMP('2100-12-31 23:59:59')
)
 as expression


    from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_metrics`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m05:19:21.396236 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:7efa9aae-b0a0-441e-9566-35c149c59972&page=queryresults
[0m05:19:22.624510 [info ] [Thread-1 (]: 4 of 19 PASS dbt_expectations_expect_column_values_to_be_between_fact_video_metrics_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_  [[32mPASS[0m in 2.44s]
[0m05:19:22.627995 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_metrics_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.95f4a75ab3
[0m05:19:22.629860 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_comment_count__INT64.1fa9eb6b79
[0m05:19:22.631334 [info ] [Thread-1 (]: 5 of 19 START test dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_comment_count__INT64  [RUN]
[0m05:19:22.632698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_between_fact_video_metrics_published_at__TIMESTAMP_2100_12_31_23_59_59___TIMESTAMP_1900_01_01_00_00_00_.95f4a75ab3, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_comment_count__INT64.1fa9eb6b79)
[0m05:19:22.633771 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_comment_count__INT64.1fa9eb6b79
[0m05:19:22.652594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:19:23.458382 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_comment_count__INT64.1fa9eb6b79"
[0m05:19:23.461551 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_comment_count__INT64.1fa9eb6b79
[0m05:19:23.466481 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_comment_count__INT64.1fa9eb6b79"
[0m05:19:23.468174 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_comment_count__INT64.1fa9eb6b79: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_comment_count__INT64.1fa9eb6b79"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('FACT_VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('REGION_CODE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIEW_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('LIKE_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'COMMENT_COUNT'
            and
            relation_column_type not in ('INT64')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m05:19:24.083771 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:91e4206a-5a50-44a7-b701-8b2a4ec9c99e&page=queryresults
[0m05:19:25.285995 [info ] [Thread-1 (]: 5 of 19 PASS dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_comment_count__INT64  [[32mPASS[0m in 2.65s]
[0m05:19:25.288941 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_comment_count__INT64.1fa9eb6b79
[0m05:19:25.291070 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_like_count__INT64.c4ebcf4945
[0m05:19:25.292046 [info ] [Thread-1 (]: 6 of 19 START test dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_like_count__INT64  [RUN]
[0m05:19:25.293081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_comment_count__INT64.1fa9eb6b79, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_like_count__INT64.c4ebcf4945)
[0m05:19:25.294061 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_like_count__INT64.c4ebcf4945
[0m05:19:25.302585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:19:26.112052 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_like_count__INT64.c4ebcf4945"
[0m05:19:26.115765 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_like_count__INT64.c4ebcf4945
[0m05:19:26.120518 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_like_count__INT64.c4ebcf4945"
[0m05:19:26.122393 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_like_count__INT64.c4ebcf4945: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_like_count__INT64.c4ebcf4945"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('FACT_VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('REGION_CODE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIEW_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('LIKE_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'LIKE_COUNT'
            and
            relation_column_type not in ('INT64')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m05:19:26.719871 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:44e4d68b-ae29-4f34-a7dd-bba8ec71e0a4&page=queryresults
[0m05:19:27.880076 [info ] [Thread-1 (]: 6 of 19 PASS dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_like_count__INT64  [[32mPASS[0m in 2.59s]
[0m05:19:27.883550 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_like_count__INT64.c4ebcf4945
[0m05:19:27.885573 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_published_at__TIMESTAMP.7fe1f661cb
[0m05:19:27.886915 [info ] [Thread-1 (]: 7 of 19 START test dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_published_at__TIMESTAMP  [RUN]
[0m05:19:27.887938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_like_count__INT64.c4ebcf4945, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_published_at__TIMESTAMP.7fe1f661cb)
[0m05:19:27.888607 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_published_at__TIMESTAMP.7fe1f661cb
[0m05:19:27.899512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:19:28.773110 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_published_at__TIMESTAMP.7fe1f661cb"
[0m05:19:28.776591 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_published_at__TIMESTAMP.7fe1f661cb
[0m05:19:28.782980 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_published_at__TIMESTAMP.7fe1f661cb"
[0m05:19:28.784815 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_published_at__TIMESTAMP.7fe1f661cb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_published_at__TIMESTAMP.7fe1f661cb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('FACT_VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('REGION_CODE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIEW_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('LIKE_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'PUBLISHED_AT'
            and
            relation_column_type not in ('TIMESTAMP')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m05:19:29.483929 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:57bfeb98-ccb0-4878-80d1-95bf554ceae8&page=queryresults
[0m05:19:30.710287 [info ] [Thread-1 (]: 7 of 19 PASS dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_published_at__TIMESTAMP  [[32mPASS[0m in 2.82s]
[0m05:19:30.713976 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_published_at__TIMESTAMP.7fe1f661cb
[0m05:19:30.714753 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_region_code__STRING.2e2ff280d9
[0m05:19:30.715465 [info ] [Thread-1 (]: 8 of 19 START test dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_region_code__STRING  [RUN]
[0m05:19:30.716088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_published_at__TIMESTAMP.7fe1f661cb, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_region_code__STRING.2e2ff280d9)
[0m05:19:30.716552 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_region_code__STRING.2e2ff280d9
[0m05:19:30.721826 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:19:31.537557 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_region_code__STRING.2e2ff280d9"
[0m05:19:31.540297 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_region_code__STRING.2e2ff280d9
[0m05:19:31.545798 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_region_code__STRING.2e2ff280d9"
[0m05:19:31.547958 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_region_code__STRING.2e2ff280d9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_region_code__STRING.2e2ff280d9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('FACT_VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('REGION_CODE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIEW_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('LIKE_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'REGION_CODE'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m05:19:32.143287 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:af5a9535-60db-4fe1-b3f5-027b0ac9ce88&page=queryresults
[0m05:19:33.273037 [info ] [Thread-1 (]: 8 of 19 PASS dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_region_code__STRING  [[32mPASS[0m in 2.56s]
[0m05:19:33.276179 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_region_code__STRING.2e2ff280d9
[0m05:19:33.282919 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_video_id__STRING.065a6b3e3b
[0m05:19:33.283962 [info ] [Thread-1 (]: 9 of 19 START test dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_video_id__STRING  [RUN]
[0m05:19:33.285190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_region_code__STRING.2e2ff280d9, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_video_id__STRING.065a6b3e3b)
[0m05:19:33.286085 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_video_id__STRING.065a6b3e3b
[0m05:19:33.294577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:19:34.094244 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_video_id__STRING.065a6b3e3b"
[0m05:19:34.098000 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_video_id__STRING.065a6b3e3b
[0m05:19:34.102115 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_video_id__STRING.065a6b3e3b"
[0m05:19:34.103655 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_video_id__STRING.065a6b3e3b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_video_id__STRING.065a6b3e3b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('FACT_VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('REGION_CODE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIEW_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('LIKE_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'VIDEO_ID'
            and
            relation_column_type not in ('STRING')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m05:19:34.581307 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:6dcbcb85-2e2c-4d63-a66c-ea43d3d62491&page=queryresults
[0m05:19:35.834824 [info ] [Thread-1 (]: 9 of 19 PASS dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_video_id__STRING  [[32mPASS[0m in 2.55s]
[0m05:19:35.838659 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_video_id__STRING.065a6b3e3b
[0m05:19:35.840202 [debug] [Thread-1 (]: Began running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_view_count__INT64.4054ccb7f8
[0m05:19:35.841363 [info ] [Thread-1 (]: 10 of 19 START test dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_view_count__INT64  [RUN]
[0m05:19:35.842637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_video_id__STRING.065a6b3e3b, now test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_view_count__INT64.4054ccb7f8)
[0m05:19:35.843596 [debug] [Thread-1 (]: Began compiling node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_view_count__INT64.4054ccb7f8
[0m05:19:35.852938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:19:36.653963 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_view_count__INT64.4054ccb7f8"
[0m05:19:36.656717 [debug] [Thread-1 (]: Began executing node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_view_count__INT64.4054ccb7f8
[0m05:19:36.661286 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_view_count__INT64.4054ccb7f8"
[0m05:19:36.662689 [debug] [Thread-1 (]: On test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_view_count__INT64.4054ccb7f8: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_view_count__INT64.4054ccb7f8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('FACT_VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIDEO_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('REGION_CODE' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('VIEW_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('LIKE_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('COMMENT_COUNT' as string) as relation_column,
            cast('INT64' as string) as relation_column_type
        union all
        
        select
            cast('PUBLISHED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'VIEW_COUNT'
            and
            relation_column_type not in ('INT64')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m05:19:37.211583 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:26c7aa20-f341-4fba-ab00-fc1ff4d8326d&page=queryresults
[0m05:19:38.220735 [info ] [Thread-1 (]: 10 of 19 PASS dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_view_count__INT64  [[32mPASS[0m in 2.38s]
[0m05:19:38.224201 [debug] [Thread-1 (]: Finished running node test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_view_count__INT64.4054ccb7f8
[0m05:19:38.226695 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_fact_video_metrics_comment_count.c76bd6c0f5
[0m05:19:38.229708 [info ] [Thread-1 (]: 11 of 19 START test not_null_fact_video_metrics_comment_count .................. [RUN]
[0m05:19:38.231333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.dbt_expectations_expect_column_values_to_be_of_type_fact_video_metrics_view_count__INT64.4054ccb7f8, now test.youtube_project.not_null_fact_video_metrics_comment_count.c76bd6c0f5)
[0m05:19:38.232754 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_fact_video_metrics_comment_count.c76bd6c0f5
[0m05:19:38.256499 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_fact_video_metrics_comment_count.c76bd6c0f5"
[0m05:19:38.259038 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_fact_video_metrics_comment_count.c76bd6c0f5
[0m05:19:38.273164 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_fact_video_metrics_comment_count.c76bd6c0f5"
[0m05:19:38.275701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:19:38.279779 [debug] [Thread-1 (]: On test.youtube_project.not_null_fact_video_metrics_comment_count.c76bd6c0f5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_fact_video_metrics_comment_count.c76bd6c0f5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select comment_count
from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_metrics`
where comment_count is null



      
    ) dbt_internal_test
[0m05:19:39.576801 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:00654099-5e34-4595-8d9b-4af213ffac78&page=queryresults
[0m05:19:40.748899 [info ] [Thread-1 (]: 11 of 19 PASS not_null_fact_video_metrics_comment_count ........................ [[32mPASS[0m in 2.52s]
[0m05:19:40.754568 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_fact_video_metrics_comment_count.c76bd6c0f5
[0m05:19:40.757028 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_fact_video_metrics_fact_video_id.15e13bac2f
[0m05:19:40.758291 [info ] [Thread-1 (]: 12 of 19 START test not_null_fact_video_metrics_fact_video_id .................. [RUN]
[0m05:19:40.759845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_fact_video_metrics_comment_count.c76bd6c0f5, now test.youtube_project.not_null_fact_video_metrics_fact_video_id.15e13bac2f)
[0m05:19:40.760732 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_fact_video_metrics_fact_video_id.15e13bac2f
[0m05:19:40.772092 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_fact_video_metrics_fact_video_id.15e13bac2f"
[0m05:19:40.774978 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_fact_video_metrics_fact_video_id.15e13bac2f
[0m05:19:40.780890 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_fact_video_metrics_fact_video_id.15e13bac2f"
[0m05:19:40.785009 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:19:40.789506 [debug] [Thread-1 (]: On test.youtube_project.not_null_fact_video_metrics_fact_video_id.15e13bac2f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_fact_video_metrics_fact_video_id.15e13bac2f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select fact_video_id
from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_metrics`
where fact_video_id is null



      
    ) dbt_internal_test
[0m05:19:41.979023 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:a3ab4c9f-d80d-4e0a-9e89-444ed793ee61&page=queryresults
[0m05:19:43.105244 [info ] [Thread-1 (]: 12 of 19 PASS not_null_fact_video_metrics_fact_video_id ........................ [[32mPASS[0m in 2.34s]
[0m05:19:43.108865 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_fact_video_metrics_fact_video_id.15e13bac2f
[0m05:19:43.110356 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_fact_video_metrics_like_count.6aaf587688
[0m05:19:43.111535 [info ] [Thread-1 (]: 13 of 19 START test not_null_fact_video_metrics_like_count ..................... [RUN]
[0m05:19:43.112732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_fact_video_metrics_fact_video_id.15e13bac2f, now test.youtube_project.not_null_fact_video_metrics_like_count.6aaf587688)
[0m05:19:43.113632 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_fact_video_metrics_like_count.6aaf587688
[0m05:19:43.126264 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_fact_video_metrics_like_count.6aaf587688"
[0m05:19:43.129525 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_fact_video_metrics_like_count.6aaf587688
[0m05:19:43.134861 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_fact_video_metrics_like_count.6aaf587688"
[0m05:19:43.137055 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:19:43.139187 [debug] [Thread-1 (]: On test.youtube_project.not_null_fact_video_metrics_like_count.6aaf587688: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_fact_video_metrics_like_count.6aaf587688"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select like_count
from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_metrics`
where like_count is null



      
    ) dbt_internal_test
[0m05:19:44.313569 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:698a2e8f-38f4-48bf-a114-15b88d6fa712&page=queryresults
[0m05:19:45.560455 [info ] [Thread-1 (]: 13 of 19 PASS not_null_fact_video_metrics_like_count ........................... [[32mPASS[0m in 2.45s]
[0m05:19:45.563671 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_fact_video_metrics_like_count.6aaf587688
[0m05:19:45.565451 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_fact_video_metrics_published_at.b92c10a174
[0m05:19:45.566642 [info ] [Thread-1 (]: 14 of 19 START test not_null_fact_video_metrics_published_at ................... [RUN]
[0m05:19:45.567863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_fact_video_metrics_like_count.6aaf587688, now test.youtube_project.not_null_fact_video_metrics_published_at.b92c10a174)
[0m05:19:45.568806 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_fact_video_metrics_published_at.b92c10a174
[0m05:19:45.578089 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_fact_video_metrics_published_at.b92c10a174"
[0m05:19:45.581195 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_fact_video_metrics_published_at.b92c10a174
[0m05:19:45.586763 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_fact_video_metrics_published_at.b92c10a174"
[0m05:19:45.589813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:19:45.592887 [debug] [Thread-1 (]: On test.youtube_project.not_null_fact_video_metrics_published_at.b92c10a174: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_fact_video_metrics_published_at.b92c10a174"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select published_at
from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_metrics`
where published_at is null



      
    ) dbt_internal_test
[0m05:19:46.685109 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:bba7953a-5be5-46fd-9dc9-82112033d6fc&page=queryresults
[0m05:19:47.712049 [info ] [Thread-1 (]: 14 of 19 PASS not_null_fact_video_metrics_published_at ......................... [[32mPASS[0m in 2.14s]
[0m05:19:47.714511 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_fact_video_metrics_published_at.b92c10a174
[0m05:19:47.716844 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_fact_video_metrics_region_code.344b167021
[0m05:19:47.718335 [info ] [Thread-1 (]: 15 of 19 START test not_null_fact_video_metrics_region_code .................... [RUN]
[0m05:19:47.719796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_fact_video_metrics_published_at.b92c10a174, now test.youtube_project.not_null_fact_video_metrics_region_code.344b167021)
[0m05:19:47.720655 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_fact_video_metrics_region_code.344b167021
[0m05:19:47.733817 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_fact_video_metrics_region_code.344b167021"
[0m05:19:47.736746 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_fact_video_metrics_region_code.344b167021
[0m05:19:47.740708 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_fact_video_metrics_region_code.344b167021"
[0m05:19:47.742728 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:19:47.745463 [debug] [Thread-1 (]: On test.youtube_project.not_null_fact_video_metrics_region_code.344b167021: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_fact_video_metrics_region_code.344b167021"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select region_code
from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_metrics`
where region_code is null



      
    ) dbt_internal_test
[0m05:19:48.939852 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:292590a2-ee1e-4f15-a100-f4c59aff4a8d&page=queryresults
[0m05:19:50.180568 [info ] [Thread-1 (]: 15 of 19 PASS not_null_fact_video_metrics_region_code .......................... [[32mPASS[0m in 2.46s]
[0m05:19:50.186023 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_fact_video_metrics_region_code.344b167021
[0m05:19:50.188932 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_fact_video_metrics_video_id.b4384e6217
[0m05:19:50.191290 [info ] [Thread-1 (]: 16 of 19 START test not_null_fact_video_metrics_video_id ....................... [RUN]
[0m05:19:50.192791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_fact_video_metrics_region_code.344b167021, now test.youtube_project.not_null_fact_video_metrics_video_id.b4384e6217)
[0m05:19:50.193958 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_fact_video_metrics_video_id.b4384e6217
[0m05:19:50.224790 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_fact_video_metrics_video_id.b4384e6217"
[0m05:19:50.228753 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_fact_video_metrics_video_id.b4384e6217
[0m05:19:50.236314 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_fact_video_metrics_video_id.b4384e6217"
[0m05:19:50.238912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:19:50.244224 [debug] [Thread-1 (]: On test.youtube_project.not_null_fact_video_metrics_video_id.b4384e6217: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_fact_video_metrics_video_id.b4384e6217"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select video_id
from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_metrics`
where video_id is null



      
    ) dbt_internal_test
[0m05:19:51.816080 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:f19c0d7d-566b-4b83-b0fd-e4362bff8cb8&page=queryresults
[0m05:19:52.936502 [info ] [Thread-1 (]: 16 of 19 PASS not_null_fact_video_metrics_video_id ............................. [[32mPASS[0m in 2.74s]
[0m05:19:52.939671 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_fact_video_metrics_video_id.b4384e6217
[0m05:19:52.941243 [debug] [Thread-1 (]: Began running node test.youtube_project.not_null_fact_video_metrics_view_count.d321f0cf92
[0m05:19:52.942276 [info ] [Thread-1 (]: 17 of 19 START test not_null_fact_video_metrics_view_count ..................... [RUN]
[0m05:19:52.943374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_fact_video_metrics_video_id.b4384e6217, now test.youtube_project.not_null_fact_video_metrics_view_count.d321f0cf92)
[0m05:19:52.944228 [debug] [Thread-1 (]: Began compiling node test.youtube_project.not_null_fact_video_metrics_view_count.d321f0cf92
[0m05:19:52.952119 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.not_null_fact_video_metrics_view_count.d321f0cf92"
[0m05:19:52.953991 [debug] [Thread-1 (]: Began executing node test.youtube_project.not_null_fact_video_metrics_view_count.d321f0cf92
[0m05:19:52.958131 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.not_null_fact_video_metrics_view_count.d321f0cf92"
[0m05:19:52.959593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:19:52.961827 [debug] [Thread-1 (]: On test.youtube_project.not_null_fact_video_metrics_view_count.d321f0cf92: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.not_null_fact_video_metrics_view_count.d321f0cf92"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select view_count
from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_metrics`
where view_count is null



      
    ) dbt_internal_test
[0m05:19:54.266959 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:43af0306-20cd-48b8-993b-1a887126477e&page=queryresults
[0m05:19:55.401338 [info ] [Thread-1 (]: 17 of 19 PASS not_null_fact_video_metrics_view_count ........................... [[32mPASS[0m in 2.46s]
[0m05:19:55.404456 [debug] [Thread-1 (]: Finished running node test.youtube_project.not_null_fact_video_metrics_view_count.d321f0cf92
[0m05:19:55.406248 [debug] [Thread-1 (]: Began running node test.youtube_project.unique_fact_video_metrics_fact_video_id.64a80544d1
[0m05:19:55.407978 [info ] [Thread-1 (]: 18 of 19 START test unique_fact_video_metrics_fact_video_id .................... [RUN]
[0m05:19:55.409092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.not_null_fact_video_metrics_view_count.d321f0cf92, now test.youtube_project.unique_fact_video_metrics_fact_video_id.64a80544d1)
[0m05:19:55.410122 [debug] [Thread-1 (]: Began compiling node test.youtube_project.unique_fact_video_metrics_fact_video_id.64a80544d1
[0m05:19:55.447696 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.unique_fact_video_metrics_fact_video_id.64a80544d1"
[0m05:19:55.451522 [debug] [Thread-1 (]: Began executing node test.youtube_project.unique_fact_video_metrics_fact_video_id.64a80544d1
[0m05:19:55.455819 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.unique_fact_video_metrics_fact_video_id.64a80544d1"
[0m05:19:55.457565 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:19:55.462630 [debug] [Thread-1 (]: On test.youtube_project.unique_fact_video_metrics_fact_video_id.64a80544d1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.unique_fact_video_metrics_fact_video_id.64a80544d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select fact_video_id as unique_field
  from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_metrics`
  where fact_video_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m05:19:56.642754 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:1d67a8c1-3b49-4128-8bc1-c0463f284b55&page=queryresults
[0m05:19:57.745367 [info ] [Thread-1 (]: 18 of 19 PASS unique_fact_video_metrics_fact_video_id .......................... [[32mPASS[0m in 2.34s]
[0m05:19:57.746955 [debug] [Thread-1 (]: Finished running node test.youtube_project.unique_fact_video_metrics_fact_video_id.64a80544d1
[0m05:19:57.747939 [debug] [Thread-1 (]: Began running node test.youtube_project.unique_fact_video_metrics_video_id.fab5773825
[0m05:19:57.748729 [info ] [Thread-1 (]: 19 of 19 START test unique_fact_video_metrics_video_id ......................... [RUN]
[0m05:19:57.749524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_project.unique_fact_video_metrics_fact_video_id.64a80544d1, now test.youtube_project.unique_fact_video_metrics_video_id.fab5773825)
[0m05:19:57.750117 [debug] [Thread-1 (]: Began compiling node test.youtube_project.unique_fact_video_metrics_video_id.fab5773825
[0m05:19:57.755963 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_project.unique_fact_video_metrics_video_id.fab5773825"
[0m05:19:57.757940 [debug] [Thread-1 (]: Began executing node test.youtube_project.unique_fact_video_metrics_video_id.fab5773825
[0m05:19:57.762676 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_project.unique_fact_video_metrics_video_id.fab5773825"
[0m05:19:57.764297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:19:57.766965 [debug] [Thread-1 (]: On test.youtube_project.unique_fact_video_metrics_video_id.fab5773825: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "test.youtube_project.unique_fact_video_metrics_video_id.fab5773825"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select video_id as unique_field
  from `yt-e2e-data-cycle-project`.`youtube`.`fact_video_metrics`
  where video_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m05:19:58.966365 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:0d5dae5a-2be8-4674-9570-5e70474c92eb&page=queryresults
[0m05:20:00.210971 [info ] [Thread-1 (]: 19 of 19 PASS unique_fact_video_metrics_video_id ............................... [[32mPASS[0m in 2.46s]
[0m05:20:00.215305 [debug] [Thread-1 (]: Finished running node test.youtube_project.unique_fact_video_metrics_video_id.fab5773825
[0m05:20:00.227641 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:20:00.228375 [debug] [MainThread]: Connection 'test.youtube_project.unique_fact_video_metrics_video_id.fab5773825' was properly closed.
[0m05:20:00.229661 [info ] [MainThread]: 
[0m05:20:00.230890 [info ] [MainThread]: Finished running 19 data tests in 0 hours 0 minutes and 48.51 seconds (48.51s).
[0m05:20:00.241200 [debug] [MainThread]: Command end result
[0m05:20:00.339081 [info ] [MainThread]: 
[0m05:20:00.339801 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:20:00.340508 [info ] [MainThread]: 
[0m05:20:00.341057 [info ] [MainThread]: Done. PASS=19 WARN=0 ERROR=0 SKIP=0 TOTAL=19
[0m05:20:00.343778 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 49.706387, "process_in_blocks": "0", "process_kernel_time": 0.455837, "process_mem_max_rss": "223044", "process_out_blocks": "5955", "process_user_time": 4.404426}
[0m05:20:00.344630 [debug] [MainThread]: Command `dbt test` succeeded at 05:20:00.344516 after 49.71 seconds
[0m05:20:00.345270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ded0ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80d3ecc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff815ad5b0>]}
[0m05:20:00.345693 [debug] [MainThread]: Flushing usage events
[0m02:03:46.389183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbbc8b380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb99562a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9767f80>]}


============================== 02:03:46.395307 | abd7efdf-1ff7-4d69-8535-a375ef3c57d3 ==============================
[0m02:03:46.395307 [info ] [MainThread]: Running with dbt=1.8.9
[0m02:03:46.396141 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'log_format': 'default', 'profiles_dir': '/usr/local/airflow/include/dbt', 'use_colors': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'write_json': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --models youtube_data.dim_channels', 'partial_parse': 'True', 'no_print': 'None', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True'}
[0m02:03:48.820136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'abd7efdf-1ff7-4d69-8535-a375ef3c57d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cb19790>]}
[0m02:03:48.853588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'abd7efdf-1ff7-4d69-8535-a375ef3c57d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dc3a6f0>]}
[0m02:03:48.854170 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m02:03:49.101944 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m02:03:49.990323 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:03:49.998852 [debug] [MainThread]: Partial parsing: updated file: youtube_project://models/youtube_data/marts/dim_channels.sql
[0m02:03:50.528858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'abd7efdf-1ff7-4d69-8535-a375ef3c57d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bf233e0>]}
[0m02:03:50.742517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'abd7efdf-1ff7-4d69-8535-a375ef3c57d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c4373e0>]}
[0m02:03:50.743531 [info ] [MainThread]: Found 12 models, 138 data tests, 2 sources, 867 macros
[0m02:03:50.744421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abd7efdf-1ff7-4d69-8535-a375ef3c57d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c2c2c90>]}
[0m02:03:50.747411 [warn ] [MainThread]: The selection criterion 'youtube_data.dim_channels' does not match any enabled nodes
[0m02:03:50.750417 [info ] [MainThread]: 
[0m02:03:50.752133 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m02:03:50.753476 [debug] [MainThread]: Command end result
[0m02:03:51.175785 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.822429, "process_in_blocks": "208672", "process_kernel_time": 2.65048, "process_mem_max_rss": "224372", "process_out_blocks": "8222", "process_user_time": 3.859837}
[0m02:03:51.177350 [debug] [MainThread]: Command `dbt run` succeeded at 02:03:51.177095 after 4.82 seconds
[0m02:03:51.178539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb99122d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb99103e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bb2f050>]}
[0m02:03:51.179345 [debug] [MainThread]: Flushing usage events
[0m02:04:18.406242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4a354f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2087dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa20853d0>]}


============================== 02:04:18.408233 | 02635a19-575a-4778-aa96-af2746f9d00b ==============================
[0m02:04:18.408233 [info ] [MainThread]: Running with dbt=1.8.9
[0m02:04:18.408713 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'version_check': 'True', 'log_format': 'default', 'quiet': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'no_print': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'invocation_command': 'dbt run --models youtube_data.marts.dim_channels', 'cache_selected_only': 'False', 'debug': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'use_colors': 'True', 'introspect': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'partial_parse': 'True', 'printer_width': '80', 'empty': 'False', 'use_experimental_parser': 'False'}
[0m02:04:19.437156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02635a19-575a-4778-aa96-af2746f9d00b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86b25430>]}
[0m02:04:19.465547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02635a19-575a-4778-aa96-af2746f9d00b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff864cbf20>]}
[0m02:04:19.466356 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m02:04:19.567618 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m02:04:19.731624 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:04:19.732093 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:04:19.760645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02635a19-575a-4778-aa96-af2746f9d00b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1fdf470>]}
[0m02:04:19.881470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02635a19-575a-4778-aa96-af2746f9d00b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff850a1f70>]}
[0m02:04:19.882405 [info ] [MainThread]: Found 12 models, 138 data tests, 2 sources, 867 macros
[0m02:04:19.882810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02635a19-575a-4778-aa96-af2746f9d00b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85269e50>]}
[0m02:04:19.885253 [info ] [MainThread]: 
[0m02:04:19.886520 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:04:19.887613 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project'
[0m02:04:19.888108 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:04:20.675991 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project_youtube'
[0m02:04:20.676837 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:04:21.668165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02635a19-575a-4778-aa96-af2746f9d00b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa360ea20>]}
[0m02:04:21.674548 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:04:21.676013 [info ] [MainThread]: 
[0m02:04:21.691036 [debug] [Thread-1 (]: Began running node model.youtube_project.dim_channels
[0m02:04:21.696331 [info ] [Thread-1 (]: 1 of 1 START sql table model youtube.dim_channels .............................. [RUN]
[0m02:04:21.698392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now model.youtube_project.dim_channels)
[0m02:04:21.699031 [debug] [Thread-1 (]: Began compiling node model.youtube_project.dim_channels
[0m02:04:21.747856 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_project.dim_channels"
[0m02:04:21.755748 [debug] [Thread-1 (]: Began executing node model.youtube_project.dim_channels
[0m02:04:21.778492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:04:22.574956 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_project.dim_channels"
[0m02:04:22.593501 [debug] [Thread-1 (]: On model.youtube_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "model.youtube_project.dim_channels"} */

  
    

    create or replace table `yt-e2e-data-cycle-project`.`youtube`.`dim_channels`
      
    
    cluster by channel_id

    OPTIONS()
    as (
      WITH channel_data AS (
    SELECT * 
    FROM `yt-e2e-data-cycle-project`.`youtube`.`staging_channel`  
),

channel_filled AS (
    SELECT
        channel_id,
        
        -- Clean invalid characters from channel title
        COALESCE(
            REGEXP_REPLACE(channel_title, r'[\x00-\x1F\x7F-\x9F\xAD�]', ''), 
            'No Channel Title Available'
        ) AS channel_title,
        
        -- Clean invalid characters from channel description
        COALESCE(
            REGEXP_REPLACE(channel_description, r'[\x00-\x1F\x7F-\x9F\xAD�]', ''), 
            'No Channel Description Available'
        ) AS channel_description,
        
        -- If channel_published_at is NULL, replace with CURRENT_TIMESTAMP
        COALESCE(channel_published_at, CURRENT_TIMESTAMP()) AS channel_published_at
    FROM
        channel_data
),

ranked_channels AS (
    SELECT
        ROW_NUMBER() OVER (PARTITION BY channel_id ORDER BY channel_id) AS row_num,  
        channel_id,
        channel_title,
        channel_description,
        channel_published_at
    FROM
        channel_filled
)

SELECT
    channel_id,
    channel_title,
    channel_description,
    channel_published_at
FROM
    ranked_channels
WHERE
    row_num = 1;  -- Keeps only the first row for each unique channel_id
    );
  
[0m02:04:23.112554 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:81b40184-a480-41b5-ae7a-702caa2a6f51&page=queryresults
[0m02:04:23.113639 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [59:16]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got ";" at [59:16]')
[0m02:04:24.108932 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:babee6d0-7c5d-4d11-b301-334d9279ed33&page=queryresults
[0m02:04:24.110935 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:babee6d0-7c5d-4d11-b301-334d9279ed33&page=queryresults
[0m02:04:24.132015 [debug] [Thread-1 (]: Database Error in model dim_channels (models/youtube_data/marts/dim_channels.sql)
  Syntax error: Expected ")" but got ";" at [59:16]
  compiled code at target/run/youtube_project/models/youtube_data/marts/dim_channels.sql
[0m02:04:24.137613 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02635a19-575a-4778-aa96-af2746f9d00b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8546c710>]}
[0m02:04:24.145809 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model youtube.dim_channels ..................... [[31mERROR[0m in 2.44s]
[0m02:04:24.151500 [debug] [Thread-1 (]: Finished running node model.youtube_project.dim_channels
[0m02:04:24.161613 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:04:24.162204 [debug] [MainThread]: Connection 'list_yt-e2e-data-cycle-project' was properly closed.
[0m02:04:24.162769 [debug] [MainThread]: Connection 'model.youtube_project.dim_channels' was properly closed.
[0m02:04:24.163330 [info ] [MainThread]: 
[0m02:04:24.164937 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.28 seconds (4.28s).
[0m02:04:24.169110 [debug] [MainThread]: Command end result
[0m02:04:24.285525 [info ] [MainThread]: 
[0m02:04:24.288092 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:04:24.289062 [info ] [MainThread]: 
[0m02:04:24.290360 [error] [MainThread]:   Database Error in model dim_channels (models/youtube_data/marts/dim_channels.sql)
  Syntax error: Expected ")" but got ";" at [59:16]
  compiled code at target/run/youtube_project/models/youtube_data/marts/dim_channels.sql
[0m02:04:24.290736 [info ] [MainThread]: 
[0m02:04:24.291352 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:04:24.303394 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.9366035, "process_in_blocks": "560", "process_kernel_time": 0.873633, "process_mem_max_rss": "220652", "process_out_blocks": "5721", "process_user_time": 2.940895}
[0m02:04:24.307542 [debug] [MainThread]: Command `dbt run` failed at 02:04:24.307242 after 5.94 seconds
[0m02:04:24.309495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa65b7080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa30a3b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa248f020>]}
[0m02:04:24.310357 [debug] [MainThread]: Flushing usage events
[0m02:04:37.405014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2081370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa25c9580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa25cba40>]}


============================== 02:04:37.406207 | c6832b35-53ef-4462-a843-e7b8ec1c0dbd ==============================
[0m02:04:37.406207 [info ] [MainThread]: Running with dbt=1.8.9
[0m02:04:37.406556 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'debug': 'False', 'quiet': 'False', 'empty': 'False', 'static_parser': 'True', 'invocation_command': 'dbt run --models youtube_data.marts.dim_channels', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'version_check': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'warn_error': 'None', 'printer_width': '80', 'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '/usr/local/airflow/include/dbt', 'no_print': 'None'}
[0m02:04:38.046413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6832b35-53ef-4462-a843-e7b8ec1c0dbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1fda3c0>]}
[0m02:04:38.071710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6832b35-53ef-4462-a843-e7b8ec1c0dbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85a91b80>]}
[0m02:04:38.072159 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m02:04:38.135579 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m02:04:38.256727 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:04:38.257419 [debug] [MainThread]: Partial parsing: updated file: youtube_project://models/youtube_data/marts/dim_channels.sql
[0m02:04:38.479949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6832b35-53ef-4462-a843-e7b8ec1c0dbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84b4e840>]}
[0m02:04:38.560892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6832b35-53ef-4462-a843-e7b8ec1c0dbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85210440>]}
[0m02:04:38.561276 [info ] [MainThread]: Found 12 models, 138 data tests, 2 sources, 867 macros
[0m02:04:38.561535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6832b35-53ef-4462-a843-e7b8ec1c0dbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff857bf4a0>]}
[0m02:04:38.563384 [info ] [MainThread]: 
[0m02:04:38.563824 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:04:38.564485 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project'
[0m02:04:38.564744 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:04:39.611189 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project, now list_yt-e2e-data-cycle-project_youtube)
[0m02:04:39.612211 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:04:40.418078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6832b35-53ef-4462-a843-e7b8ec1c0dbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff852129c0>]}
[0m02:04:40.419602 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:04:40.420319 [info ] [MainThread]: 
[0m02:04:40.424966 [debug] [Thread-1 (]: Began running node model.youtube_project.dim_channels
[0m02:04:40.426120 [info ] [Thread-1 (]: 1 of 1 START sql table model youtube.dim_channels .............................. [RUN]
[0m02:04:40.427204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now model.youtube_project.dim_channels)
[0m02:04:40.427977 [debug] [Thread-1 (]: Began compiling node model.youtube_project.dim_channels
[0m02:04:40.440769 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_project.dim_channels"
[0m02:04:40.442716 [debug] [Thread-1 (]: Began executing node model.youtube_project.dim_channels
[0m02:04:40.459155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:04:41.355943 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_project.dim_channels"
[0m02:04:41.357895 [debug] [Thread-1 (]: On model.youtube_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "model.youtube_project.dim_channels"} */

  
    

    create or replace table `yt-e2e-data-cycle-project`.`youtube`.`dim_channels`
      
    
    cluster by channel_id

    OPTIONS()
    as (
      WITH channel_data AS (
    SELECT * 
    FROM `yt-e2e-data-cycle-project`.`youtube`.`staging_channel`  
),

channel_filled AS (
    SELECT
        channel_id,
        
        -- Clean invalid characters from channel title
        COALESCE(
            REGEXP_REPLACE(channel_title, r'[\x00-\x1F\x7F-\x9F\xAD�]', ''), 
            'No Channel Title Available'
        ) AS channel_title,
        
        -- Clean invalid characters from channel description
        COALESCE(
            REGEXP_REPLACE(channel_description, r'[\x00-\x1F\x7F-\x9F\xAD�]', ''), 
            'No Channel Description Available'
        ) AS channel_description,
        
        -- If channel_published_at is NULL, replace with CURRENT_TIMESTAMP
        COALESCE(channel_published_at, CURRENT_TIMESTAMP()) AS channel_published_at
    FROM
        channel_data
),

ranked_channels AS (
    SELECT
        ROW_NUMBER() OVER (PARTITION BY channel_id ORDER BY channel_id) AS row_num,  
        channel_id,
        channel_title,
        channel_description,
        channel_published_at
    FROM
        channel_filled
)

SELECT
    channel_id,
    channel_title,
    channel_description,
    channel_published_at
FROM
    ranked_channels
WHERE
    row_num = 1 -- Keeps only the first row for each unique channel_id
    );
  
[0m02:04:42.087475 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:f97ba5d2-59d1-4768-8e9c-cebfd74461a4&page=queryresults
[0m02:04:45.373173 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6832b35-53ef-4462-a843-e7b8ec1c0dbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff853d89e0>]}
[0m02:04:45.374053 [info ] [Thread-1 (]: 1 of 1 OK created sql table model youtube.dim_channels ......................... [[32mCREATE TABLE (91.0 rows, 28.0 KiB processed)[0m in 4.95s]
[0m02:04:45.375004 [debug] [Thread-1 (]: Finished running node model.youtube_project.dim_channels
[0m02:04:45.376474 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:04:45.376849 [debug] [MainThread]: Connection 'model.youtube_project.dim_channels' was properly closed.
[0m02:04:45.377198 [info ] [MainThread]: 
[0m02:04:45.377646 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.81 seconds (6.81s).
[0m02:04:45.378398 [debug] [MainThread]: Command end result
[0m02:04:45.494752 [info ] [MainThread]: 
[0m02:04:45.495176 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:04:45.495459 [info ] [MainThread]: 
[0m02:04:45.495760 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:04:45.496585 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.117922, "process_in_blocks": "0", "process_kernel_time": 0.31821, "process_mem_max_rss": "225644", "process_out_blocks": "8242", "process_user_time": 2.670428}
[0m02:04:45.496950 [debug] [MainThread]: Command `dbt run` succeeded at 02:04:45.496870 after 8.12 seconds
[0m02:04:45.497205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8538b770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8538a0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85388050>]}
[0m02:04:45.497417 [debug] [MainThread]: Flushing usage events
[0m02:19:59.555766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9036d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90ac3560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff926d5520>]}


============================== 02:19:59.557358 | 668f52e6-824c-4131-9c03-9b00083f9502 ==============================
[0m02:19:59.557358 [info ] [MainThread]: Running with dbt=1.8.9
[0m02:19:59.557812 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'introspect': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'log_path': '/usr/local/airflow/include/dbt/logs', 'use_colors': 'True', 'invocation_command': 'dbt run --models youtube_data.marts.dim_categories', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'cache_selected_only': 'False', 'printer_width': '80', 'partial_parse': 'True', 'debug': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'warn_error': 'None', 'version_check': 'True', 'write_json': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'log_cache_events': 'False'}
[0m02:20:00.188262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '668f52e6-824c-4131-9c03-9b00083f9502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90944c20>]}
[0m02:20:00.213553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '668f52e6-824c-4131-9c03-9b00083f9502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fe12750>]}
[0m02:20:00.214036 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m02:20:00.288019 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m02:20:00.417882 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:20:00.418558 [debug] [MainThread]: Partial parsing: updated file: youtube_project://models/youtube_data/marts/dim_categories.sql
[0m02:20:00.630159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '668f52e6-824c-4131-9c03-9b00083f9502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72eb7860>]}
[0m02:20:00.710300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '668f52e6-824c-4131-9c03-9b00083f9502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7252bd40>]}
[0m02:20:00.710690 [info ] [MainThread]: Found 12 models, 138 data tests, 2 sources, 867 macros
[0m02:20:00.710959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '668f52e6-824c-4131-9c03-9b00083f9502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff730a91f0>]}
[0m02:20:00.712802 [info ] [MainThread]: 
[0m02:20:00.713270 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:20:00.714079 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project'
[0m02:20:00.714373 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:20:01.757927 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project, now list_yt-e2e-data-cycle-project_youtube)
[0m02:20:01.759354 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:20:02.555642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '668f52e6-824c-4131-9c03-9b00083f9502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff730a91f0>]}
[0m02:20:02.557238 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:20:02.558099 [info ] [MainThread]: 
[0m02:20:02.562746 [debug] [Thread-1 (]: Began running node model.youtube_project.dim_categories
[0m02:20:02.563838 [info ] [Thread-1 (]: 1 of 1 START sql table model youtube.dim_categories ............................ [RUN]
[0m02:20:02.564978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now model.youtube_project.dim_categories)
[0m02:20:02.565866 [debug] [Thread-1 (]: Began compiling node model.youtube_project.dim_categories
[0m02:20:02.579403 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_project.dim_categories"
[0m02:20:02.582553 [debug] [Thread-1 (]: Began executing node model.youtube_project.dim_categories
[0m02:20:02.600961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:20:03.417997 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_project.dim_categories"
[0m02:20:03.420442 [debug] [Thread-1 (]: On model.youtube_project.dim_categories: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "model.youtube_project.dim_categories"} */

  
    

    create or replace table `yt-e2e-data-cycle-project`.`youtube`.`dim_categories`
      
    
    

    OPTIONS()
    as (
      WITH category_data AS (
    SELECT * 
    FROM `yt-e2e-data-cycle-project`.`youtube`.`staging_category`
),

category_lookup AS (
    SELECT 
        category_struct.category_id,
        category_struct.category_name,
        category_struct.category_description
    FROM UNNEST([
        STRUCT(1 AS category_id, 'Film & Animation' AS category_name, 'Videos related to film and animation.' AS category_description),
        STRUCT(2 AS category_id, 'Autos & Vehicles' AS category_name, 'Videos related to cars, trucks, motorcycles, and vehicles.' AS category_description),
        STRUCT(10 AS category_id, 'Music' AS category_name, 'Videos related to music, music videos, and performances.' AS category_description),
        STRUCT(15 AS category_id, 'Pets & Animals' AS category_name, 'Videos related to pets, animals, and wildlife.' AS category_description),
        STRUCT(17 AS category_id, 'Sports' AS category_name, 'Videos related to sports events, commentary, and athletics.' AS category_description),
        STRUCT(18 AS category_id, 'Short Movies' AS category_name, 'Short films and independent films.' AS category_description),
        STRUCT(19 AS category_id, 'Travel & Events' AS category_name, 'Videos related to travel and live events.' AS category_description),
        STRUCT(20 AS category_id, 'Gaming' AS category_name, 'Videos related to video games, game commentary, and more.' AS category_description),
        STRUCT(22 AS category_id, 'People & Blogs' AS category_name, 'Personal vlogs and commentary.' AS category_description),
        STRUCT(23 AS category_id, 'Comedy' AS category_name, 'Videos related to comedic content.' AS category_description),
        STRUCT(24 AS category_id, 'Entertainment' AS category_name, 'Content related to entertainment and celebrity culture.' AS category_description),
        STRUCT(25 AS category_id, 'News & Politics' AS category_name, 'News and political commentary or events.' AS category_description),
        STRUCT(26 AS category_id, 'Howto & Style' AS category_name, 'How-to videos and style-related content.' AS category_description),
        STRUCT(27 AS category_id, 'Education' AS category_name, 'Educational content for various fields and topics.' AS category_description),
        STRUCT(28 AS category_id, 'Science & Technology' AS category_name, 'Videos related to science, tech, and innovations.' AS category_description),
        STRUCT(29 AS category_id, 'Nonprofits & Activism' AS category_name, 'Content related to nonprofits, activism, and charitable causes.' AS category_description),
        STRUCT(30 AS category_id, 'Movies' AS category_name, 'Full-length movies, movie trailers, and related content.' AS category_description),
        STRUCT(31 AS category_id, 'Anime & Animation' AS category_name, 'Anime series, animation, and related content.' AS category_description),
        STRUCT(32 AS category_id, 'Action & Adventure' AS category_name, 'Videos related to action and adventure content.' AS category_description),
        STRUCT(33 AS category_id, 'Classics' AS category_name, 'Classic movies, TV shows, and content.' AS category_description),
        STRUCT(34 AS category_id, 'Documentaries' AS category_name, 'Documentaries and docuseries content.' AS category_description),
        STRUCT(35 AS category_id, 'Drama' AS category_name, 'Dramas, TV shows, and related content.' AS category_description),
        STRUCT(36 AS category_id, 'Family & Parenting' AS category_name, 'Videos related to family life and parenting.' AS category_description),
        STRUCT(37 AS category_id, 'Home & Garden' AS category_name, 'Content about home improvement, gardens, and DIY projects.' AS category_description),
        STRUCT(38 AS category_id, 'Lifestyle' AS category_name, 'Videos about lifestyle, health, wellness, and more.' AS category_description),
        STRUCT(39 AS category_id, 'Music Videos' AS category_name, 'Music video content, including live and pre-recorded.' AS category_description),
        STRUCT(40 AS category_id, 'Reality TV' AS category_name, 'Reality TV shows and unscripted content.' AS category_description)
    ]) AS category_struct
)

, deduplicated_categories AS (
    SELECT 
        c.category_id,
        COALESCE(l.category_name, c.category_name, 'Unknown Category') AS category_name,
        COALESCE(l.category_description, c.category_description, 'Description not found') AS category_description,
        ROW_NUMBER() OVER (PARTITION BY c.category_id ORDER BY c.category_id) AS row_num
    FROM category_data c
    LEFT JOIN category_lookup l
        ON c.category_id = l.category_id
)

SELECT
    category_id,
    category_name,
    category_description
FROM
    deduplicated_categories
WHERE
    row_num = 1  -- Only keep the first row for each category_id
ORDER BY
    category_id;
    );
  
[0m02:20:03.944875 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:f7a28b78-6d08-4ec1-8333-0c6fbbc485be&page=queryresults
[0m02:20:03.946351 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [74:16]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got ";" at [74:16]')
[0m02:20:05.228182 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:df7a16e0-2211-424a-a499-2076d3daf985&page=queryresults
[0m02:20:05.231629 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:df7a16e0-2211-424a-a499-2076d3daf985&page=queryresults
[0m02:20:05.242818 [debug] [Thread-1 (]: Database Error in model dim_categories (models/youtube_data/marts/dim_categories.sql)
  Syntax error: Expected ")" but got ";" at [74:16]
  compiled code at target/run/youtube_project/models/youtube_data/marts/dim_categories.sql
[0m02:20:05.245803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '668f52e6-824c-4131-9c03-9b00083f9502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7211f140>]}
[0m02:20:05.247180 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model youtube.dim_categories ................... [[31mERROR[0m in 2.68s]
[0m02:20:05.248620 [debug] [Thread-1 (]: Finished running node model.youtube_project.dim_categories
[0m02:20:05.252927 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:20:05.253710 [debug] [MainThread]: Connection 'model.youtube_project.dim_categories' was properly closed.
[0m02:20:05.254622 [info ] [MainThread]: 
[0m02:20:05.255378 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.54 seconds (4.54s).
[0m02:20:05.257004 [debug] [MainThread]: Command end result
[0m02:20:05.397176 [info ] [MainThread]: 
[0m02:20:05.397607 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:20:05.397940 [info ] [MainThread]: 
[0m02:20:05.398352 [error] [MainThread]:   Database Error in model dim_categories (models/youtube_data/marts/dim_categories.sql)
  Syntax error: Expected ")" but got ";" at [74:16]
  compiled code at target/run/youtube_project/models/youtube_data/marts/dim_categories.sql
[0m02:20:05.398671 [info ] [MainThread]: 
[0m02:20:05.398971 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:20:05.399851 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.8694835, "process_in_blocks": "0", "process_kernel_time": 0.267454, "process_mem_max_rss": "225436", "process_out_blocks": "8283", "process_user_time": 2.694734}
[0m02:20:05.400157 [debug] [MainThread]: Command `dbt run` failed at 02:20:05.400103 after 5.87 seconds
[0m02:20:05.400395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fe10200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90efe000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fdeb140>]}
[0m02:20:05.400616 [debug] [MainThread]: Flushing usage events
[0m02:20:12.469604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa32e46e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa24a9a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa23d3470>]}


============================== 02:20:12.470978 | 19af09f6-1723-46f1-9762-3e4977f1dce3 ==============================
[0m02:20:12.470978 [info ] [MainThread]: Running with dbt=1.8.9
[0m02:20:12.471439 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'log_format': 'default', 'version_check': 'True', 'invocation_command': 'dbt run --models youtube_data.marts.dim_categories', 'no_print': 'None', 'warn_error': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'write_json': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'static_parser': 'True', 'debug': 'False', 'target_path': 'None', 'log_cache_events': 'False', 'empty': 'False', 'printer_width': '80'}
[0m02:20:13.122073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19af09f6-1723-46f1-9762-3e4977f1dce3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85dca690>]}
[0m02:20:13.147038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19af09f6-1723-46f1-9762-3e4977f1dce3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2927a70>]}
[0m02:20:13.147433 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m02:20:13.222588 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m02:20:13.342148 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:20:13.342825 [debug] [MainThread]: Partial parsing: updated file: youtube_project://models/youtube_data/marts/dim_categories.sql
[0m02:20:13.557152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19af09f6-1723-46f1-9762-3e4977f1dce3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85b7b1d0>]}
[0m02:20:13.636419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19af09f6-1723-46f1-9762-3e4977f1dce3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff854c0380>]}
[0m02:20:13.636792 [info ] [MainThread]: Found 12 models, 138 data tests, 2 sources, 867 macros
[0m02:20:13.637024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19af09f6-1723-46f1-9762-3e4977f1dce3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa389a150>]}
[0m02:20:13.638824 [info ] [MainThread]: 
[0m02:20:13.639327 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:20:13.639990 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_yt-e2e-data-cycle-project'
[0m02:20:13.640244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:20:14.453263 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project, now list_yt-e2e-data-cycle-project_youtube)
[0m02:20:14.454209 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:20:15.262738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19af09f6-1723-46f1-9762-3e4977f1dce3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85bbd400>]}
[0m02:20:15.263554 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:20:15.264073 [info ] [MainThread]: 
[0m02:20:15.267424 [debug] [Thread-1 (]: Began running node model.youtube_project.dim_categories
[0m02:20:15.267991 [info ] [Thread-1 (]: 1 of 1 START sql table model youtube.dim_categories ............................ [RUN]
[0m02:20:15.268402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_yt-e2e-data-cycle-project_youtube, now model.youtube_project.dim_categories)
[0m02:20:15.268857 [debug] [Thread-1 (]: Began compiling node model.youtube_project.dim_categories
[0m02:20:15.275553 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_project.dim_categories"
[0m02:20:15.276567 [debug] [Thread-1 (]: Began executing node model.youtube_project.dim_categories
[0m02:20:15.285368 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:20:16.118132 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_project.dim_categories"
[0m02:20:16.121534 [debug] [Thread-1 (]: On model.youtube_project.dim_categories: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "youtube", "target_name": "dev", "node_id": "model.youtube_project.dim_categories"} */

  
    

    create or replace table `yt-e2e-data-cycle-project`.`youtube`.`dim_categories`
      
    
    

    OPTIONS()
    as (
      WITH category_data AS (
    SELECT * 
    FROM `yt-e2e-data-cycle-project`.`youtube`.`staging_category`
),

category_lookup AS (
    SELECT 
        category_struct.category_id,
        category_struct.category_name,
        category_struct.category_description
    FROM UNNEST([
        STRUCT(1 AS category_id, 'Film & Animation' AS category_name, 'Videos related to film and animation.' AS category_description),
        STRUCT(2 AS category_id, 'Autos & Vehicles' AS category_name, 'Videos related to cars, trucks, motorcycles, and vehicles.' AS category_description),
        STRUCT(10 AS category_id, 'Music' AS category_name, 'Videos related to music, music videos, and performances.' AS category_description),
        STRUCT(15 AS category_id, 'Pets & Animals' AS category_name, 'Videos related to pets, animals, and wildlife.' AS category_description),
        STRUCT(17 AS category_id, 'Sports' AS category_name, 'Videos related to sports events, commentary, and athletics.' AS category_description),
        STRUCT(18 AS category_id, 'Short Movies' AS category_name, 'Short films and independent films.' AS category_description),
        STRUCT(19 AS category_id, 'Travel & Events' AS category_name, 'Videos related to travel and live events.' AS category_description),
        STRUCT(20 AS category_id, 'Gaming' AS category_name, 'Videos related to video games, game commentary, and more.' AS category_description),
        STRUCT(22 AS category_id, 'People & Blogs' AS category_name, 'Personal vlogs and commentary.' AS category_description),
        STRUCT(23 AS category_id, 'Comedy' AS category_name, 'Videos related to comedic content.' AS category_description),
        STRUCT(24 AS category_id, 'Entertainment' AS category_name, 'Content related to entertainment and celebrity culture.' AS category_description),
        STRUCT(25 AS category_id, 'News & Politics' AS category_name, 'News and political commentary or events.' AS category_description),
        STRUCT(26 AS category_id, 'Howto & Style' AS category_name, 'How-to videos and style-related content.' AS category_description),
        STRUCT(27 AS category_id, 'Education' AS category_name, 'Educational content for various fields and topics.' AS category_description),
        STRUCT(28 AS category_id, 'Science & Technology' AS category_name, 'Videos related to science, tech, and innovations.' AS category_description),
        STRUCT(29 AS category_id, 'Nonprofits & Activism' AS category_name, 'Content related to nonprofits, activism, and charitable causes.' AS category_description),
        STRUCT(30 AS category_id, 'Movies' AS category_name, 'Full-length movies, movie trailers, and related content.' AS category_description),
        STRUCT(31 AS category_id, 'Anime & Animation' AS category_name, 'Anime series, animation, and related content.' AS category_description),
        STRUCT(32 AS category_id, 'Action & Adventure' AS category_name, 'Videos related to action and adventure content.' AS category_description),
        STRUCT(33 AS category_id, 'Classics' AS category_name, 'Classic movies, TV shows, and content.' AS category_description),
        STRUCT(34 AS category_id, 'Documentaries' AS category_name, 'Documentaries and docuseries content.' AS category_description),
        STRUCT(35 AS category_id, 'Drama' AS category_name, 'Dramas, TV shows, and related content.' AS category_description),
        STRUCT(36 AS category_id, 'Family & Parenting' AS category_name, 'Videos related to family life and parenting.' AS category_description),
        STRUCT(37 AS category_id, 'Home & Garden' AS category_name, 'Content about home improvement, gardens, and DIY projects.' AS category_description),
        STRUCT(38 AS category_id, 'Lifestyle' AS category_name, 'Videos about lifestyle, health, wellness, and more.' AS category_description),
        STRUCT(39 AS category_id, 'Music Videos' AS category_name, 'Music video content, including live and pre-recorded.' AS category_description),
        STRUCT(40 AS category_id, 'Reality TV' AS category_name, 'Reality TV shows and unscripted content.' AS category_description)
    ]) AS category_struct
)

, deduplicated_categories AS (
    SELECT 
        c.category_id,
        COALESCE(l.category_name, c.category_name, 'Unknown Category') AS category_name,
        COALESCE(l.category_description, c.category_description, 'Description not found') AS category_description,
        ROW_NUMBER() OVER (PARTITION BY c.category_id ORDER BY c.category_id) AS row_num
    FROM category_data c
    LEFT JOIN category_lookup l
        ON c.category_id = l.category_id
)

SELECT
    category_id,
    category_name,
    category_description
FROM
    deduplicated_categories
WHERE
    row_num = 1  -- Only keep the first row for each category_id
ORDER BY
    category_id
    );
  
[0m02:20:17.003906 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=yt-e2e-data-cycle-project&j=bq:US:76d1a64c-e1c5-4ff7-8a20-b4edaa9168d2&page=queryresults
[0m02:20:19.602166 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19af09f6-1723-46f1-9762-3e4977f1dce3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86705b80>]}
[0m02:20:19.603689 [info ] [Thread-1 (]: 1 of 1 OK created sql table model youtube.dim_categories ....................... [[32mCREATE TABLE (11.0 rows, 4.5 KiB processed)[0m in 4.33s]
[0m02:20:19.604894 [debug] [Thread-1 (]: Finished running node model.youtube_project.dim_categories
[0m02:20:19.606762 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:20:19.607291 [debug] [MainThread]: Connection 'model.youtube_project.dim_categories' was properly closed.
[0m02:20:19.607841 [info ] [MainThread]: 
[0m02:20:19.608355 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.97 seconds (5.97s).
[0m02:20:19.609531 [debug] [MainThread]: Command end result
[0m02:20:19.729145 [info ] [MainThread]: 
[0m02:20:19.729570 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:20:19.729948 [info ] [MainThread]: 
[0m02:20:19.730338 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:20:19.731225 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.286813, "process_in_blocks": "0", "process_kernel_time": 0.260211, "process_mem_max_rss": "225260", "process_out_blocks": "8281", "process_user_time": 2.685501}
[0m02:20:19.731567 [debug] [MainThread]: Command `dbt run` succeeded at 02:20:19.731509 after 7.29 seconds
[0m02:20:19.731823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8557e210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa32e46e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84f24d40>]}
[0m02:20:19.732071 [debug] [MainThread]: Flushing usage events
